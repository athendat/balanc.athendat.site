(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[1367],{68824:(tt,V,l)=>{"use strict";l.d(V,{f:()=>C});var E=l(2578),N=l(62288),t=l(54438);const I="application/vnd.openxmlformats-officedocument.spreadsheet.sheet;charset=UTF-8",q="text/plain;charset=utf-8";let C=(()=>{class T{constructor(){}exportAsExcelFile(s,p,v=[[]],j=[]){const k=N.Wp.json_to_sheet(s);let F={fill:{fgColor:{rgb:"27086f"}},font:{color:{rgb:"FFFFFF"}}};v[0].length>0&&(N.Wp.sheet_add_aoa(k,v),v[0].forEach((Y,J)=>{let O=N.Wp.encode_cell({c:J,r:0});k[O].s=F})),j.length>0&&(k["!cols"]=j);const z=N.M9({Sheets:{data:k},SheetNames:["data"]},{bookType:"xlsx",type:"array"});this._saveAsFile(z,p,".xlsx",I)}exportAsCsvFile(s,p){const j={Sheets:{data:N.Wp.json_to_sheet(s)},SheetNames:["data"]},k=N.M9(j,{bookType:"csv",type:"array"});this._saveAsFile(k,p,".csv",I)}exportAsFacFile(s,p,v,j){const k="Factura_"+s.no,F=`Numero=${s.no}\nMC=CUBAN PESO\nOM=${s.currency.namev}\nFecha=${Number(s.billDate)}\nEntidad=${s.customer.code}\nConcepto=${s.concept}\nComercial=${s.commercial.name} ${s.commercial.lastname1} ${s.commercial.lastname2}\nCtaBancoMC=${v}\nCtaBancoOM=${j}\nForma=${s.paymentMethod.name}\nOperacion=${s.operationType.name}\nObservacion=${s.obs}\nMA=\nCtoArancel=\nPorcientoAra=0\nTalon=001\nContrato=\nVtaCadena=0\nNomHecho=${p.fullname}\nCargoHecho=${p.title}\nCIHecho=\nNomJA=\nCIJA=\nNomTra=\nChapa=\nLicTra=\nCITra=\nNomCliente=${s.customer.name}\nCargoCliente=\nCICliente=${s.customer.nit}\n[Propiedades]\n\n[Detalle]\n${this._versatInvoiceGenerator(s.productsInBill)}\n\n[PieFirma]\n        `;this._saveAsFile(F,k,".fac",q)}exportAsJsonFile(s){encodeURIComponent(s),this._saveAsFile(s,"data.json",".json",q)}_saveAsFile(s,p,v,j){const k=new Blob([s],{type:j});E.saveAs(k,p+"_export_"+(new Date).getTime()+v)}_versatInvoiceGenerator(s){let p="";return s.forEach(v=>{p+=`0002|002|993449|${v.uom}|1111111|0|0|0|0|0|${v.price}||0|0\n`}),p}static#t=this.\u0275fac=function(p){return new(p||T)};static#e=this.\u0275prov=t.jDH({token:T,factory:T.\u0275fac,providedIn:"root"})}return T})()},47413:(tt,V,l)=>{"use strict";l.d(V,{Dz:()=>N,Lx:()=>t});var E=l(59640);const f=I=>I.pagination,N=(0,E.Mz)(f,I=>I.pagination),t=(0,E.Mz)(f,I=>I.secondaryPagination)},1367:(tt,V,l)=>{"use strict";l.r(V),l.d(V,{default:()=>oi});var E=l(21413),f=l(56977),N=l(10729),t=l(54438),I=l(51188);let q=(()=>{class n{constructor(e,o,i){this._activatedRoute=e,this._changeDetectorRef=o,this._router=i,this.merchantId="",this._unsubscribeAll=new E.B}ngOnInit(){this._activatedRoute.params.pipe((0,f.Q)(this._unsubscribeAll)).subscribe(({merchantId:e})=>{void 0!==e&&(this.merchantId=e,this._changeDetectorRef.markForCheck())})}static#t=this.\u0275fac=function(o){return new(o||n)(t.rXU(I.nX),t.rXU(t.gRc),t.rXU(I.Ix))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["ath-commercial"]],standalone:!0,features:[t.aNF],decls:1,vars:0,template:function(o,i){1&o&&t.nrm(0,"ath-content-menu")},dependencies:[N.k],encapsulation:2,changeDetection:0})}return n})();var P=l(21809),x=l(88834),h=l(99213);const g=["invoiceDetail"],C=()=>["../"];let T=(()=>{class n{constructor(){}ngOnInit(){}generatePDF(e){this.invoiceDetailsComponent.generatePDF(e)}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["invoice-details-header"]],viewQuery:function(o,i){if(1&o&&t.GBs(g,5),2&o){let a;t.mGM(a=t.lsd())&&(i.invoiceDetailsComponent=a.first)}},standalone:!0,features:[t.aNF],decls:35,vars:9,consts:[["invoiceDetail",""],["cdkScrollable","",1,"absolute","flex","flex-col","w-full","inset-0","min-w-0","text-center","overflow-auto","print:overflow-visible"],[1,"flex","flex-col","flex-wrap","p-6","pb-4","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial/",1,"ml-1","text-primary-500","hover:underline"],[1,"ml-1","text-primary-500","hover:underline",3,"routerLink"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2","ml-2","text-left"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],[1,"flex","items-center","flex-shrink-0","mt-6","md:mt-0","sm:ml-4","gap-x-4","justify-center"],["mat-button","",1,"rounded-full","bg-primary-100",3,"click"],[1,"text-primary-700",3,"svgIcon"],[1,"w-full"]],template:function(o,i){if(1&o){const a=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"div",4)(5,"div",5)(6,"a",6),t.EFF(7,"Inicio"),t.k0s()(),t.j41(8,"div",5),t.nrm(9,"mat-icon",7),t.j41(10,"a",8),t.EFF(11,"Gesti\xf3n Comercial"),t.k0s()(),t.j41(12,"div",5),t.nrm(13,"mat-icon",7),t.j41(14,"a",9),t.EFF(15,"Facturas"),t.k0s()()(),t.j41(16,"div",10)(17,"a",11),t.nrm(18,"mat-icon",7),t.j41(19,"span",12),t.EFF(20,"Regresar"),t.k0s()()()(),t.j41(21,"div",13)(22,"div",14)(23,"span"),t.EFF(24,"Detalles de la factura"),t.k0s()()()(),t.j41(25,"div",15)(26,"button",16),t.bIt("click",function(){return t.eBV(a),t.Njj(i.generatePDF("open"))}),t.nrm(27,"mat-icon",17),t.k0s(),t.j41(28,"button",16),t.bIt("click",function(){return t.eBV(a),t.Njj(i.generatePDF("download"))}),t.nrm(29,"mat-icon",17),t.k0s(),t.j41(30,"button",16),t.bIt("click",function(){return t.eBV(a),t.Njj(i.generatePDF("print"))}),t.nrm(31,"mat-icon",17),t.k0s()()(),t.j41(32,"div",18),t.nrm(33,"invoice-details",null,0),t.k0s()()}2&o&&(t.R7$(9),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(),t.Y8G("routerLink",t.lJ4(8,C)),t.R7$(3),t.Y8G("routerLink","./.."),t.R7$(),t.Y8G("svgIcon","mat_solid:chevron_left"),t.R7$(9),t.Y8G("svgIcon","heroicons_outline:eye"),t.R7$(2),t.Y8G("svgIcon","heroicons_outline:download"),t.R7$(2),t.Y8G("svgIcon","heroicons_outline:printer"))},dependencies:[P.F,h.m_,h.An,x.Hl,x.$z,I.Wk],encapsulation:2,changeDetection:0})}return n})();var u=l(60177),s=l(89417),p=l(32102),v=l(59042),j=l(59115),k=l(96695),F=l(2042),$=l(7673),z=l(57786),Y=l(70152),J=l(99172),A=l(25558),O=l(96354),pt=l(94268),Q=l(47413),U=l(87122),et=l(53440),w=l(94794),at=function(n){return n.PendientePago="Pendiente de Pago",n.PagadaParcialmente="Pagada Parcialmente",n.PagadaTotalmente="Pagada Totalmente",n.Cancelada="Cancelada",n.Vencida="Vencida",n}(at||{}),H=l(14823),M=l(75351),W=l(46601),rt=l(9005),X=l(95416),S=l(59640),nt=l(65478);const _t=()=>["Super Administrador"],ft=n=>({"pointer-events-none":n}),ht=()=>[10,25,50,100],gt=(n,r,e,o,i)=>({"bg-amber-50 text-amber-700":n,"bg-blue-50 text-blue-700":r,"bg-green-50 text-green-700":e,"bg-red-50 text-red-700":o,"bg-pink-50 text-pink-700":i}),vt=n=>[n],Ct=()=>[""],bt=n=>({"bg-amber-500 text-amber-50":n}),xt=n=>({"bg-blue-500 text-blue-50":n}),Ft=n=>({"bg-green-500 text-green-50":n}),kt=n=>({"bg-red-500 text-red-50":n}),yt=n=>({"bg-pink-500 text-pink-50":n});function It(n,r){if(1&n&&(t.j41(0,"div",19)(1,"mat-form-field",20),t.nrm(2,"mat-icon",21)(3,"input",22),t.k0s()()),2&n){const e=t.XpG(2);t.R7$(2),t.Y8G("svgIcon","mat_solid:search"),t.R7$(),t.Y8G("formControl",e.searchInputControl)("autocomplete","off")("placeholder","Buscar facturas")}}function Rt(n,r){1&n&&t.eu8(0)}function jt(n,r){if(1&n&&(t.j41(0,"div",35)(1,"span"),t.EFF(2),t.nI1(3,"currency"),t.k0s()()),2&n){const e=r.$implicit;t.R7$(2),t.Lme("",t.i5U(3,2,e.total,t.lJ4(5,Ct))," ",e.currency,"")}}function lt(n,r){1&n&&t.nrm(0,"mat-icon",41),2&n&&t.Y8G("svgIcon","mat_solid:done")}function Et(n,r){1&n&&t.nrm(0,"mat-icon",41),2&n&&t.Y8G("svgIcon","mat_solid:done")}function $t(n,r){1&n&&t.nrm(0,"mat-icon",41),2&n&&t.Y8G("svgIcon","mat_solid:done")}function ct(n,r){1&n&&t.nrm(0,"mat-icon",41),2&n&&t.Y8G("svgIcon","mat_solid:done")}function Gt(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",33)(1,"div"),t.EFF(2),t.k0s(),t.j41(3,"div",34),t.EFF(4),t.k0s(),t.j41(5,"div",28),t.Z7z(6,jt,4,6,"div",35,t.fX1),t.k0s(),t.j41(8,"div",36),t.EFF(9),t.k0s(),t.j41(10,"div",37)(11,"span",38),t.EFF(12),t.k0s()(),t.j41(13,"div",39)(14,"button",40),t.nrm(15,"mat-icon",41),t.k0s(),t.j41(16,"div")(17,"button",42),t.nrm(18,"mat-icon",41),t.k0s(),t.j41(19,"mat-menu",null,2)(21,"button",43)(22,"div",44),t.DNE(23,lt,1,1,"mat-icon",41),t.k0s(),t.j41(24,"span",45),t.EFF(25,"Pendiente de Pago"),t.k0s()(),t.j41(26,"button",46),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(4);return t.Njj(a.updateStatus(i,"Pagada Parcialmente"))}),t.j41(27,"div",44),t.DNE(28,Et,1,1,"mat-icon",41),t.k0s(),t.j41(29,"span",45),t.EFF(30,"Pagada Parcialmente"),t.k0s()(),t.j41(31,"button",46),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(4);return t.Njj(a.updateStatus(i,"Pagada Totalmente"))}),t.j41(32,"div",44),t.DNE(33,$t,1,1,"mat-icon",41),t.k0s(),t.j41(34,"span",45),t.EFF(35,"Pagada Totalmente"),t.k0s()(),t.j41(36,"button",46),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(4);return t.Njj(a.cancelInvoice(i))}),t.j41(37,"div",44),t.DNE(38,ct,1,1,"mat-icon",41),t.k0s(),t.j41(39,"span",45),t.EFF(40,"Cancelada"),t.k0s()()()(),t.j41(41,"button",47),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(4);return t.Njj(a.deleteInvoice(i))}),t.nrm(42,"mat-icon",41),t.k0s()()()}if(2&n){const e=r.$implicit,o=t.sdS(20),i=t.XpG(4);t.R7$(2),t.SpI(" ",e.no," "),t.R7$(2),t.SpI(" ",e.quotationNo," "),t.R7$(2),t.Dyx(i.getTotalAmount(e)),t.R7$(3),t.SpI(" ",e.quotationId.goodsData.length," "),t.R7$(),t.Y8G("matTooltip","Cancelada"===e.status?"Motivo: "+e.canceledReason:"")("ngClass",t.s1E(22,gt,"Pendiente de Pago"===e.status,"Pagada Parcialmente"===e.status,"Pagada Totalmente"===e.status,"Cancelada"===e.status,"Vencida"===e.status)),t.R7$(2),t.JRh(e.status),t.R7$(2),t.Y8G("routerLink",t.eq3(28,vt,e._id)),t.R7$(),t.Y8G("svgIcon","mat_solid:visibility"),t.R7$(2),t.Y8G("matMenuTriggerFor",o)("disabled",e.status.includes("Pagada Totalmente")||e.status.includes("Cancelada")),t.R7$(),t.Y8G("svgIcon","heroicons_solid:clipboard-list"),t.R7$(3),t.Y8G("disabled",!0),t.R7$(2),t.vxM(23,e.status.includes("Pendiente de Pago")?23:-1),t.R7$(3),t.Y8G("disabled",e.status.includes("Pagada Parcialmente")||e.status.includes("Pagada Totalmente")||e.status.includes("Cancelada")),t.R7$(2),t.vxM(28,e.status.includes("Pagada Parcialmente")?28:-1),t.R7$(3),t.Y8G("disabled",e.status.includes("Pagada Totalmente")||e.status.includes("Cancelada")),t.R7$(2),t.vxM(33,e.status.includes("Pagada Totalmente")?33:-1),t.R7$(3),t.Y8G("disabled",!e.status.includes("Pendiente de Pago")),t.R7$(2),t.vxM(38,e.status.includes("Cancelada")?38:-1),t.R7$(3),t.Y8G("matTooltip","Eliminar")("disabled",!e.status.includes("Pendiente de Pago")),t.R7$(),t.Y8G("svgIcon","mat_solid:delete")}}function Dt(n,r){1&n&&t.Z7z(0,Gt,43,30,"div",33,t.BUC().trackByFn,!0),2&n&&t.Dyx(r)}function Tt(n,r){if(1&n&&(t.j41(0,"div",18),t.DNE(1,Rt,1,0,"ng-container",23),t.j41(2,"div",24)(3,"div",25)(4,"div",26)(5,"div",27),t.EFF(6," N\xfamero "),t.k0s(),t.j41(7,"div",27),t.EFF(8," N.Factura "),t.k0s(),t.j41(9,"div",28),t.EFF(10," Importe "),t.k0s(),t.j41(11,"div",29),t.EFF(12," Cantidad "),t.k0s(),t.j41(13,"div",30),t.EFF(14," Estado "),t.k0s(),t.j41(15,"div",31),t.EFF(16," Acciones "),t.k0s()(),t.DNE(17,Dt,2,0),t.nI1(18,"async"),t.nrm(19,"mat-paginator",32),t.k0s()()()),2&n){let e;t.XpG();const o=t.sdS(28),i=t.XpG();t.R7$(),t.Y8G("ngTemplateOutlet",o),t.R7$(4),t.Y8G("mat-sort-header","no"),t.R7$(2),t.Y8G("mat-sort-header","quotationNo"),t.R7$(6),t.Y8G("mat-sort-header","status"),t.R7$(4),t.vxM(17,(e=t.bMT(18,11,i.invoices$))?17:-1,e),t.R7$(2),t.Y8G("ngClass",t.eq3(13,ft,i.isLoading))("length",i.pagination.length)("pageIndex",i.pagination.page)("pageSize",i.pagination.size)("pageSizeOptions",t.lJ4(15,ht))("showFirstLastButtons",!0)}}function wt(n,r){}function At(n,r){if(1&n&&t.DNE(0,wt,0,0,"ng-template",48),2&n){t.XpG();const e=t.sdS(28),o=t.sdS(30),i=t.XpG();t.Y8G("ngTemplateOutlet",i.filterInputControl.value?e:o)}}function St(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",49)(1,"button",50),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.filterInputControl.setValue("Pendiente de Pago"!==i.filterInputControl.value?"Pendiente de Pago":""))}),t.j41(2,"span",51),t.EFF(3,"Pendiente de Pago"),t.k0s(),t.nrm(4,"div",52),t.k0s(),t.j41(5,"button",53),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.filterInputControl.setValue("Pagada Parcialmente"!==i.filterInputControl.value?"Pagada Parcialmente":""))}),t.j41(6,"span",51),t.EFF(7,"Pagada Parcialmente"),t.k0s(),t.nrm(8,"div",54),t.k0s(),t.j41(9,"button",55),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.filterInputControl.setValue("Pagada Totalmente"!==i.filterInputControl.value?"Pagada Totalmente":""))}),t.j41(10,"span",51),t.EFF(11,"Pagada Totalmente"),t.k0s(),t.nrm(12,"div",56),t.k0s(),t.j41(13,"button",57),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.filterInputControl.setValue("Cancelada"!==i.filterInputControl.value?"Cancelada":""))}),t.j41(14,"span",51),t.EFF(15,"Canceladas"),t.k0s(),t.nrm(16,"div",58),t.k0s(),t.j41(17,"button",59),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.filterInputControl.setValue("Vencida"!==i.filterInputControl.value?"Vencida":""))}),t.j41(18,"span",51),t.EFF(19,"Vencidas"),t.k0s(),t.nrm(20,"div",60),t.k0s()()}if(2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(5,bt,"Pendiente de Pago"===e.filterInputControl.value)),t.R7$(4),t.Y8G("ngClass",t.eq3(7,xt,"Pagada Parcialmente"===e.filterInputControl.value)),t.R7$(4),t.Y8G("ngClass",t.eq3(9,Ft,"Pagada Totalmente"===e.filterInputControl.value)),t.R7$(4),t.Y8G("ngClass",t.eq3(11,kt,"Cancelada"===e.filterInputControl.value)),t.R7$(4),t.Y8G("ngClass",t.eq3(13,yt,"Vencida"===e.filterInputControl.value))}}function Pt(n,r){if(1&n&&(t.j41(0,"div",61),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.SpI(" ",e.searchInputControl.value?"\xa1No se han encontrado facturas!":"\xa1No se ha creado ninguna factura a\xfan!"," ")}}function Bt(n,r){1&n&&(t.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"div")(4,"div",6)(5,"div",7)(6,"a",8),t.EFF(7,"Inicio"),t.k0s()(),t.j41(8,"div",7),t.nrm(9,"mat-icon",9),t.j41(10,"a",10),t.EFF(11,"Gesti\xf3n Comercial"),t.k0s()(),t.j41(12,"div",7),t.nrm(13,"mat-icon",9),t.j41(14,"a",11),t.EFF(15,"Facturas"),t.k0s()()(),t.j41(16,"div",12)(17,"a",13),t.nrm(18,"mat-icon",9),t.j41(19,"span",14),t.EFF(20,"Regresar"),t.k0s()()()(),t.j41(21,"div",15)(22,"div",16),t.EFF(23," Facturas "),t.k0s()()(),t.DNE(24,It,4,4,"div",17),t.k0s(),t.DNE(25,Tt,20,16,"div",18)(26,At,1,1)(27,St,21,15,"ng-template",null,0,t.C5r)(29,Pt,2,1,"ng-template",null,1,t.C5r),t.k0s()),2&n&&(t.R7$(9),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("routerLink","./.."),t.R7$(),t.Y8G("svgIcon","mat_solid:chevron_left"),t.R7$(6),t.Y8G("ngxPermissionsExcept",t.lJ4(6,_t)),t.R7$(),t.vxM(25,r.length>0?25:26))}let Nt=(()=>{class n{constructor(e,o,i,a,d,b){this._changeDetectorRef=e,this._dialog=o,this._fuseConfirmationService=i,this._invoiceService=a,this._snackBar=d,this.store=b,this.isLoading=!1,this.searchInputControl=new s.MJ(null),this.filterInputControl=new s.MJ(""),this._unsubscribeAll=new E.B}ngOnInit(){this.invoices$=this.store.select(pt.nX),this.store.select(Q.Dz).pipe((0,f.Q)(this._unsubscribeAll)).subscribe(e=>{this.pagination=e,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,f.Q)(this._unsubscribeAll),(0,Y.B)(300),(0,J.Z)(null),(0,A.n)(e=>null!==e?(this.isLoading=!0,this._invoiceService.getInvoices(0,20,"createdAt","desc",e,this.filterInputControl.value)):(0,$.of)()),(0,O.T)(()=>{this.isLoading=!1})).subscribe(),this.filterInputControl.valueChanges.pipe((0,f.Q)(this._unsubscribeAll),(0,Y.B)(300),(0,A.n)(e=>this._invoiceService.getInvoices(0,20,"createdAt","desc",this.searchInputControl.value,e))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"createdAt",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,f.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,z.h)(this._sort.sortChange,this._paginator.page).pipe((0,A.n)(()=>(this.isLoading=!0,this._invoiceService.getInvoices(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.filterInputControl.value))),(0,O.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}deleteInvoice(e){this._fuseConfirmationService.open({title:"Eliminar Factura",message:`\xbfEst\xe1 seguro que desea eliminar la factura # ${e.no}? Perder\xe1 el acceso a todos los datos asociados al mismo.`,icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._invoiceService.deleteInvoice(e._id,this.pagination.page,this.pagination.size,"createdAt","desc",this.searchInputControl.value,this.filterInputControl.value).subscribe(a=>{this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()})}),this._changeDetectorRef.markForCheck()}updateStatus(e,o){this._fuseConfirmationService.open({title:"Actualizar estado",message:`\xbfEst\xe1 seguro desea actualizar el estado de la factura # ${e.no} a ${o} `,icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(a=>{"confirmed"===a&&this._invoiceService.updateStatus(e._id,o).subscribe(d=>{this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:d.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()})})}cancelInvoice(e){this._dialog.open(et.s,{data:{title:"Cancelar Factura",message:`\xbfEst\xe1 seguro desea cancelar la factura # ${e.no}`,rejectedReason:e.canceledReason,rejectedReasonRequired:!0},panelClass:"ath-reject-dialog-panel",maxWidth:"520px"}).afterClosed().pipe((0,f.Q)(this._unsubscribeAll)).subscribe(i=>{void 0!==i&&this._invoiceService.updateStatus(e._id,at.Cancelada,i.reason).subscribe(d=>{this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:d.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()})})}getTotalAmount(e){return e.quotationId.goodsData.reduce((o,{currency:i})=>{if(!o.some(a=>a.currency===i)){const a=e.quotationId.goodsData.filter(d=>d.currency===i).map(d=>d.quantity).reduce((d,b)=>d+b,0);o.push({currency:i,total:a})}return o},[])}trackByFn(e,o){return o.id||e}static#t=this.\u0275fac=function(o){return new(o||n)(t.rXU(t.gRc),t.rXU(M.bZ),t.rXU(W.G),t.rXU(rt.U),t.rXU(X.UG),t.rXU(S.il))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["commercial-invoices"]],viewQuery:function(o,i){if(1&o&&(t.GBs(k.iy,5),t.GBs(F.B4,5)),2&o){let a;t.mGM(a=t.lsd())&&(i._paginator=a.first),t.mGM(a=t.lsd())&&(i._sort=a.first)}},standalone:!0,features:[t.aNF],decls:2,vars:3,consts:[["filter",""],["noInvoices",""],["listStatusMenu","matMenu"],["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],["class","flex items-center flex-shrink-0 mt-6 sm:mt-0 sm:ml-4",4,"ngxPermissionsExcept"],[1,"flex","flex-col","flex-auto"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-auto","sm:min-w-64","w-full"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[4,"ngTemplateOutlet"],[1,"flex","flex-col","flex-auto","overflow-x-auto","lg:overflow-x-clip"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","invoices-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"text-right"],[1,"text-center"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"pr-8","mr-1","text-right"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","invoices-table","md:px-8"],[1,"whitespace-nowrap"],[1,"flex","flex-col","items-end"],[1,"truncate","text-center"],[1,"flex","h-7","items-center","text-center","lock","truncate","rounded-full","dark:bg-white","dark:bg-opacity-5","mr-4","delay-100",3,"matTooltip","ngClass"],[1,"w-full","text-center"],[1,"flex","justify-end","gap-2","flex-row"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","","matTooltip","Cambiar estado",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matMenuTriggerFor","disabled"],["mat-menu-item","",1,"grid","grid-cols-4",3,"disabled"],[1,"col-span-1"],[1,"col-span-3"],["mat-menu-item","",1,"grid","grid-cols-4",3,"click","disabled"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click","matTooltip","disabled"],[3,"ngTemplateOutlet"],[1,"self-end","h-10","mt-7","mb-3","md:mt-10","md:mb-5","pr-2","pl-2","sm:pr-6","w-full","sm:w-11/12","md:w-full","lg:w-11/12","xl:w-9/12","flex","justify-around"],[1,"flex","justify-center","items-center","pl-6","pr-6","md:pr-4","md:pl-4","mr-1","h-full","text-amber-700","transition-all","ease-in-out","delay-100","bg-amber-50","border-0","rounded-full","w-36","md:w-auto","hover:bg-amber-500","hover:text-amber-50",3,"click","ngClass"],[1,"ml-2","mr-1","text-lg","hidden","md:block"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-amber-500","md:hidden"],[1,"flex","justify-center","items-center","pl-6","pr-6","md:pr-4","md:pl-4","mr-1","h-full","text-blue-700","transition-all","ease-in-out","delay-100","bg-blue-50","border-0","rounded-full","w-36","md:w-auto","hover:bg-blue-500","hover:text-blue-50",3,"click","ngClass"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-blue-500","md:hidden"],[1,"flex","justify-center","items-center","pl-6","pr-6","md:pr-4","md:pl-4","mr-1","h-full","text-green-700","transition-all","ease-in-out","delay-100","bg-green-50","border-0","rounded-full","w-36","md:w-auto","hover:bg-green-500","hover:text-green-50",3,"click","ngClass"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-green-500","md:hidden"],[1,"flex","justify-center","items-center","pl-6","pr-6","md:pr-4","md:pl-4","h-full","text-red-700","transition-all","ease-in-out","delay-50","bg-red-100","border-0","rounded-full","w-36","md:w-auto","hover:bg-red-500","hover:text-red-50",3,"click","ngClass"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-red-500","md:hidden"],[1,"flex","justify-center","items-center","ml-1","sm:ml-0","pl-6","pr-6","md:pr-4","md:pl-4","h-full","text-pink-700","transition-all","ease-in-out","delay-50","bg-pink-100","border-0","rounded-full","w-36","md:w-auto","hover:bg-pink-500","hover:text-pink-50",3,"click","ngClass"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-pink-500","md:hidden"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(o,i){if(1&o&&(t.DNE(0,Bt,31,7,"div",3),t.nI1(1,"async")),2&o){let a;t.vxM(0,(a=t.bMT(1,1,i.invoices$))?0:-1,a)}},dependencies:[u.Jj,u.oe,x.Hl,x.$z,p.RG,p.rl,p.JW,h.m_,h.An,v.fS,v.fg,j.Cn,nt.uv,j.kk,j.fb,j.Cp,k.Ou,k.iy,F.NQ,F.B4,F.aE,H.uc,H.oV,u.YU,s.X1,s.me,s.BC,s.l_,I.Wk],encapsulation:2,data:{animation:U.X},changeDetection:0})}return n})();var dt=l(91602);const mt=n=>n.paymentConditions,ut=((0,S.Mz)(mt,n=>n.paymentCondition),(0,S.Mz)(mt,n=>n.paymentConditions));var c=l(77028),m=l(82765),_=l(5951),R=l(30450),y=l(67398),G=l(63729),ot=l(70819);class Z{}var Ot=l(62621);const Qt=n=>({"cursor-not-allowed":n});function ae(n,r){1&n&&(t.j41(0,"h2",2),t.EFF(1," Agregar forma de pago"),t.k0s())}function se(n,r){1&n&&(t.j41(0,"h2",2),t.EFF(1,"Editar forma de pago "),t.k0s())}function re(n,r){1&n&&(t.j41(0,"h2",2),t.EFF(1,"Detalles del forma de pago"),t.k0s())}function le(n,r){if(1&n&&(t.j41(0,"div",4)(1,"div",7)(2,"div",8)(3,"div",9)(4,"div",10)(5,"h6",11),t.EFF(6,"Nombre"),t.k0s(),t.j41(7,"span",12),t.EFF(8),t.k0s()()()()()()),2&n){const e=t.XpG();t.R7$(8),t.JRh(e.data.paymentCondition.name||"Sin nombre")}}function ce(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," El nombre es obligatorio. "),t.k0s())}function de(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," El nombre debe contener entre 3 y 255 caracteres. "),t.k0s())}function me(n,r){1&n&&(t.j41(0,"mat-label"),t.EFF(1,"Porciento"),t.k0s())}function ue(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," El porciento es obligatorio "),t.k0s())}function pe(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," El valor de este campo debe estar entre 0 y 100 "),t.k0s())}function _e(n,r){if(1&n&&(t.j41(0,"mat-error"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.SpI(" ",e.get("percent").getError("outOfRange")," ")}}function fe(n,r){1&n&&(t.j41(0,"mat-label"),t.EFF(1,"Descripci\xf3n"),t.k0s())}function he(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," La descripci\xf3n es obligatoria "),t.k0s())}function ge(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," La descripci\xf3n debe contener entre 3 y 1000 caracteres. "),t.k0s())}function ve(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",45)(1,"button",46),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$index,a=t.XpG(2);return t.Njj(a.removeTermField(i))}),t.nrm(2,"mat-icon",26),t.k0s()()}2&n&&(t.R7$(2),t.Y8G("svgIcon","mat_solid:delete"))}function Ce(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",24)(1,"mat-form-field",39),t.DNE(2,me,2,0,"mat-label"),t.j41(3,"span",40),t.EFF(4,"%"),t.k0s(),t.j41(5,"input",41),t.bIt("blur",function(i){const a=t.eBV(e).$index,d=t.XpG(2);return t.Njj(d.checkOutOfRange(i.target.value,a))}),t.k0s(),t.DNE(6,ue,2,0,"mat-error")(7,pe,2,0,"mat-error")(8,_e,2,1,"mat-error"),t.k0s(),t.j41(9,"mat-form-field",42),t.DNE(10,fe,2,0,"mat-label"),t.nrm(11,"mat-icon",43)(12,"textarea",44),t.DNE(13,he,2,0,"mat-error")(14,ge,2,0,"mat-error"),t.k0s(),t.DNE(15,ve,3,1,"div",45),t.k0s()}if(2&n){const e=r.$implicit,o=r.$index,i=r.$count;t.R7$(2),t.vxM(2,0===o?2:-1),t.R7$(3),t.Y8G("formControl",e.get("percent"))("spellcheck",!1),t.R7$(),t.vxM(6,e.get("percent").hasError("required")?6:-1),t.R7$(),t.vxM(7,e.get("percent").hasError("min")||e.get("percent").hasError("max")?7:-1),t.R7$(),t.vxM(8,e.get("percent").hasError("outOfRange")?8:-1),t.R7$(2),t.vxM(10,0===o?10:-1),t.R7$(),t.Y8G("svgIcon","mat_solid:subject"),t.R7$(),t.Y8G("formControl",e.get("description"))("placeholder","Descripci\xf3n")("minLength",3)("maxLength",1e3),t.R7$(),t.vxM(13,e.get("description").hasError("required")?13:-1),t.R7$(),t.vxM(14,e.get("description").hasError("maxlength")||e.get("description").hasError("minlength")?14:-1),t.R7$(),t.vxM(15,0===o&&o===i-1?-1:15)}}function be(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",5)(1,"div",7)(2,"form",13)(3,"div",14)(4,"mat-form-field",15)(5,"mat-label"),t.EFF(6,"Nombre"),t.k0s(),t.nrm(7,"input",16),t.DNE(8,ce,2,0,"mat-error")(9,de,2,0,"mat-error"),t.k0s()(),t.j41(10,"div",17)(11,"fuse-alert",18)(12,"span",19),t.EFF(13,"T\xe9rminos"),t.k0s(),t.j41(14,"div",20)(15,"span"),t.EFF(16," Cuando usted factura la forma de pago puede tener tantos t\xe9rminos como usted pacte con sus clientes pero la sumatoria de todos debe ser el 100% del valor de la factura, por ejemplo:"),t.k0s(),t.j41(17,"li",21),t.EFF(18,"50% a la firma del contrato"),t.k0s(),t.j41(19,"li",22),t.EFF(20,"50% a la entrega de la mercanc\xeda"),t.k0s(),t.j41(21,"span"),t.EFF(22," esta forma de pago tiene dos t\xe9rminos y la suma de ambos completa el valor de la factura "),t.k0s()()(),t.j41(23,"div",23),t.Z7z(24,Ce,16,15,"div",24,t.BUC().trackByFn,!0),t.k0s(),t.j41(26,"div",25),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.addTermField())}),t.nrm(27,"mat-icon",26),t.j41(28,"span",27),t.EFF(29,"Agregar t\xe9rmino"),t.k0s()()(),t.j41(30,"div",28)(31,"fuse-alert",18)(32,"span",19),t.EFF(33,"Pagos"),t.k0s(),t.EFF(34," Para que el cliente efect\xfae el pago usted puede marcar y escoger algunas de las siguientes opciones previamente introducida en la gesti\xf3n del negocio: "),t.j41(35,"li",21),t.EFF(36,"Mostrar en la factura su cuenta bancaria."),t.k0s(),t.j41(37,"li",29),t.EFF(38,"Seleccionar los QRs de pago que tiene contratado con Enzona y Transfermovil que se mostrar\xe1n en la factura."),t.k0s()(),t.j41(39,"div",30)(40,"mat-checkbox",31),t.EFF(41),t.nI1(42,"uppercase"),t.k0s(),t.j41(43,"mat-radio-group",32)(44,"mat-radio-button",33),t.EFF(45,"Ninguno"),t.k0s(),t.j41(46,"mat-radio-button",34),t.EFF(47),t.nI1(48,"uppercase"),t.k0s()()(),t.nrm(49,"div",35),t.k0s(),t.j41(50,"div",36)(51,"span",37),t.EFF(52,"Estado"),t.k0s(),t.j41(53,"mat-slide-toggle",38),t.EFF(54),t.k0s()()()()()}if(2&n){const e=t.XpG();t.R7$(2),t.Y8G("formGroup",e.paymentConditionForm)("autocomplete","off"),t.R7$(5),t.Y8G("type","text")("formControlName","name")("minlength",3)("maxlength",255)("placeholder","Nombre del forma de pago"),t.R7$(),t.vxM(8,e.paymentConditionForm.get("name").hasError("required")?8:-1),t.R7$(),t.vxM(9,e.paymentConditionForm.get("name").hasError("maxlength")||e.paymentConditionForm.get("name").hasError("minlength")?9:-1),t.R7$(2),t.Y8G("type","info")("appearance","outline"),t.R7$(13),t.Dyx(e.paymentConditionForm.get("terms").controls),t.R7$(3),t.Y8G("svgIcon","mat_solid:add_circle"),t.R7$(4),t.Y8G("type","info")("appearance","outline"),t.R7$(9),t.Y8G("color","primary")("formControlName","includeBankAccount"),t.R7$(),t.SpI(" Incluir la cuenta bancaria de ",t.bMT(42,23,e.currentMerchant.name),""),t.R7$(2),t.Y8G("color","primary")("formControlName","paymentBy"),t.R7$(4),t.SpI("Pagos por QRs de ",t.bMT(48,25,e.currentMerchant.name),""),t.R7$(6),t.Y8G("formControlName","active")("color","primary"),t.R7$(),t.SpI(" ",!0===e.paymentConditionForm.get("active").value?"Activo":"Inactivo"," ")}}function xe(n,r){if(1&n){const e=t.RV6();t.j41(0,"button",49),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.updatePaymentCondition())}),t.EFF(1," Actualizar "),t.k0s()}if(2&n){const e=t.XpG(2);t.Y8G("color","primary")("matDialogClose","confirmed")("disabled",e.paymentConditionForm.invalid||100!==e.totalPercent||"none"===e.paymentConditionForm.get("paymentBy").value&&!1===e.paymentConditionForm.get("includeBankAccount").value)("ngClass",t.eq3(4,Qt,e.paymentConditionForm.invalid||100!==e.totalPercent||"none"===e.paymentConditionForm.get("paymentBy").value&&!1===e.paymentConditionForm.get("includeBankAccount").value))}}function Fe(n,r){if(1&n){const e=t.RV6();t.j41(0,"button",49),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.createPaymentCondition())}),t.EFF(1," Agregar "),t.k0s()}if(2&n){const e=t.XpG(2);t.Y8G("color","primary")("matDialogClose","confirmed")("disabled",e.paymentConditionForm.invalid||100!==e.totalPercent||"none"===e.paymentConditionForm.get("paymentBy").value&&!1===e.paymentConditionForm.get("includeBankAccount").value)("ngClass",t.eq3(4,Qt,e.paymentConditionForm.invalid||100!==e.totalPercent||"none"===e.paymentConditionForm.get("paymentBy").value&&!1===e.paymentConditionForm.get("includeBankAccount").value))}}function ke(n,r){if(1&n&&(t.j41(0,"div",6)(1,"button",47),t.EFF(2," Cancelar "),t.k0s(),t.DNE(3,xe,2,6,"button",48)(4,Fe,2,6,"button",48),t.k0s()),2&n){const e=t.XpG();t.R7$(),t.Y8G("matDialogClose","cancelled"),t.R7$(2),t.vxM(3,"edit"===e.data.dialogMode?3:-1),t.R7$(),t.vxM(4,"add"===e.data.dialogMode?4:-1)}}let ye=(()=>{class n{constructor(e,o,i,a,d,b,D){this.data=e,this._changeDetectorRef=o,this._formBuilder=i,this._fuseConfirmationService=a,this._paymentConditionsService=d,this._snackBar=b,this.store=D,this.paymentCondition=new Z,this.dialogMode="view",this.merchants=[],this.selectedMerchant$=null,this.user=null,this.user$=(0,$.of)(null),this.totalPercent=0,this._unsubscribeAll=new E.B}ngOnInit(){this.user$=this.store.select(G.SW),this.user$.pipe((0,f.Q)(this._unsubscribeAll)).subscribe(e=>{this.user=e,this._changeDetectorRef.markForCheck()}),this.store.select(ot.Xb).pipe((0,f.Q)(this._unsubscribeAll)).subscribe(e=>{this.currentMerchant=e}),this.paymentConditionForm=this._formBuilder.group({_id:[""],active:[!0,[s.k0.required]],userId:[this.user.id,[s.k0.required]],merchantId:[this.currentMerchant.id,[s.k0.required]],paymentBy:["none",[s.k0.required]],includeBankAccount:[!0],name:["",[s.k0.required,s.k0.minLength(3),s.k0.maxLength(255)]],terms:this._formBuilder.array([])}),"edit"===this.data.dialogMode&&(this.paymentConditionForm.patchValue(this.data.paymentCondition),this.paymentConditionForm.get("merchantId").setValue(this.data.paymentCondition.merchantId._id)),this.setTermsDataOnForm()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}addTermField(){const e=this._formBuilder.group({percent:[0,[s.k0.required,s.k0.min(0),s.k0.max(100)]],description:["",[s.k0.required,s.k0.minLength(3),s.k0.maxLength(1e3)]]}),o=this.paymentConditionForm.get("terms");o.length<=6&&o.push(e),this._changeDetectorRef.markForCheck()}removeTermField(e){this.paymentConditionForm.get("terms").removeAt(e),this.totalPercent=this.paymentConditionForm.get("terms").getRawValue().map(i=>i.percent).reduce((i,a)=>i+a,0),this._changeDetectorRef.markForCheck()}createPaymentCondition(){if(100!==this.totalPercent||this.paymentConditionForm.invalid)return;let e=this.paymentConditionForm.getRawValue();e=(0,y.A)(e,"_id"),this._fuseConfirmationService.open({title:"Crear Forma de pago",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._paymentConditionsService.createPaymentCondition(e).subscribe(a=>{this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}updatePaymentCondition(){if(100!==this.totalPercent||this.paymentConditionForm.invalid)return;const e=this.paymentConditionForm.getRawValue();this._fuseConfirmationService.open({title:"Actualizar Forma de pago",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._paymentConditionsService.updatePaymentCondition(e).subscribe(a=>{this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}checkOutOfRange(e,o){if(+e<=100){const i=this.paymentConditionForm.get("terms").getRawValue().map(d=>d.percent).reduce((d,b)=>d+b,0),a=this.paymentConditionForm.get("terms").controls;i<=100&&a.forEach(d=>{d.get("percent").hasError("outOfRange")&&d.get("percent").setErrors(null)}),i>100&&a.at(o).get("percent").setErrors({outOfRange:"La suma del % de todos los t\xe9rminos no debe superar a 100"}),this.totalPercent=i}}trackByFn(e,o){return o.id||e}setTermsDataOnForm(){if("add"===this.data.dialogMode)return void this.addTermField();const e=[];this.data.paymentCondition.terms.length>0?this.data.paymentCondition.terms.forEach(o=>{e.push(this._formBuilder.group({percent:[o.percent,[s.k0.required,s.k0.min(0),s.k0.max(100)]],description:[o.description,[s.k0.required,s.k0.minLength(3),s.k0.maxLength(255)]]}))}):e.push(this._formBuilder.group({percent:[0,[s.k0.required,s.k0.min(0),s.k0.max(100)]],description:["",[s.k0.required,s.k0.minLength(3),s.k0.maxLength(255)]]})),e.forEach(o=>{this.paymentConditionForm.get("terms").push(o)}),this.totalPercent=this.paymentConditionForm.get("terms").getRawValue().map(o=>o.percent).reduce((o,i)=>o+i,0)}static#t=this.\u0275fac=function(o){return new(o||n)(t.rXU(M.Vh),t.rXU(t.gRc),t.rXU(s.ok),t.rXU(W.G),t.rXU(Ot.W),t.rXU(X.UG),t.rXU(S.il))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["paymentConditions-detail"]],standalone:!0,features:[t.aNF],decls:9,vars:6,consts:[[1,"relative","flex","flex-col","w-full","h-full","overflow-y-auto"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],[1,"text-2xl","text-gray-400"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],[1,"flex-auto"],[1,"w-full","overflow-hidden"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black/10"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"flex","flex-col","w-full","mt-1",3,"formGroup","autocomplete"],[1,"pt-5"],[1,"w-full"],["matInput","","required","",3,"type","formControlName","minlength","maxlength","placeholder"],[1,"mt-4"],[3,"type","appearance"],["fuseAlertTitle",""],[1,"flex","flex-col"],[1,"mt-2","ml-3"],[1,"mb-2","ml-3"],[1,"p-6","pb-0"],[1,"flex","flex-col","sm:flex-row"],[1,"inline-flex","items-center","px-4","mt-2","-ml-4","rounded","cursor-pointer","group",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2","font-medium","text-secondary","group-hover:underline"],[1,"mt-6"],[1,"ml-3"],[1,"grid","gap-4","p-6","pt-7","pb-7","sm:grid-cols-2"],[1,"mb-4",3,"color","formControlName"],["aria-label","Select an option",1,"flex","flex-wrap","justify-between","gap-2","sm:col-span-2",3,"color","formControlName"],["value","none",1,"sm:col-span-1"],["value","UseMerchantPayments",1,"sm:col-span-1"],[1,"w-full","border-t-2"],[1,"flex","flex-col","mt-8"],[1,"font-medium"],[1,"mt-1","sm:mt-3",3,"formControlName","color"],[1,"flex-auto","mt-2","sm:max-w-[20%]"],["matPrefix",""],["matInput","","type","number","min","0","max","100","required","",3,"blur","formControl","spellcheck"],[1,"flex-auto","w-full","mt-2","sm:ml-4","fuse-mat-textarea"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","required","",3,"formControl","placeholder","minLength","maxLength"],[1,"flex","self-end","w-10","mb-2","sm:items-center","sm:pl-2"],["mat-icon-button","","matTooltip","Eliminar",1,"w-8","h-8","min-h-8",3,"click"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","matDialogClose","disabled","ngClass"],["mat-flat-button","",3,"click","color","matDialogClose","disabled","ngClass"]],template:function(o,i){1&o&&(t.j41(0,"div",0)(1,"div",1),t.DNE(2,ae,2,0,"h2",2)(3,se,2,0,"h2",2)(4,re,2,0,"h2",2),t.k0s(),t.j41(5,"div",3),t.DNE(6,le,9,1,"div",4)(7,be,55,27,"div",5),t.k0s(),t.DNE(8,ke,5,3,"div",6),t.k0s()),2&o&&(t.R7$(2),t.vxM(2,null===i.data.paymentCondition._id&&"add"===i.data.dialogMode?2:-1),t.R7$(),t.vxM(3,i.data.paymentCondition._id&&"edit"===i.data.dialogMode?3:-1),t.R7$(),t.vxM(4,i.data.paymentCondition._id&&"view"===i.data.dialogMode?4:-1),t.R7$(2),t.vxM(6,"view"===i.data.dialogMode?6:-1),t.R7$(),t.vxM(7,7),t.R7$(),t.vxM(8,"view"!==i.data.dialogMode?8:-1))},dependencies:[c.F,x.Hl,x.$z,x.iY,m.g7,m.So,M.hM,M.tx,p.RG,p.rl,p.nJ,p.TL,p.JW,h.m_,h.An,v.fS,v.fg,_.Wk,_.VT,_._g,R.mV,R.sG,u.YU,s.X1,s.qT,s.me,s.Q0,s.BC,s.cb,s.YS,s.xh,s.tU,s.VZ,s.zX,s.l_,s.j4,s.JD,u.Pc],encapsulation:2,changeDetection:0})}return n})();const Ie=()=>["Super Administrador"],Re=n=>({"pointer-events-none":n}),je=()=>[10,25,50,100];function Ee(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",17)(1,"mat-form-field",18),t.nrm(2,"mat-icon",19)(3,"input",20),t.k0s(),t.j41(4,"button",21),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.createPaymentCondition())}),t.nrm(5,"mat-icon",22),t.j41(6,"span",23),t.EFF(7,"Nueva"),t.k0s()()()}if(2&n){const e=t.XpG();t.R7$(2),t.Y8G("svgIcon","mat_solid:search"),t.R7$(),t.Y8G("formControl",e.searchInputControl)("autocomplete","off")("placeholder","Buscar formas de pago"),t.R7$(2),t.Y8G("svgIcon","mat_solid:add")}}function $e(n,r){1&n&&t.nrm(0,"mat-icon",33),2&n&&t.Y8G("svgIcon","mat_solid:done")}function Ge(n,r){1&n&&t.nrm(0,"mat-icon",34),2&n&&t.Y8G("svgIcon","mat_solid:close")}function De(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",30)(1,"div",31),t.EFF(2),t.k0s(),t.j41(3,"div",32),t.DNE(4,$e,1,1,"mat-icon",33)(5,Ge,1,1,"mat-icon",34),t.k0s(),t.j41(6,"div",35)(7,"button",36),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(4);return t.Njj(a.editPaymentCondition(i))}),t.nrm(8,"mat-icon",37),t.k0s(),t.j41(9,"button",36),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(4);return t.Njj(a.deletePaymentCondition(i._id))}),t.nrm(10,"mat-icon",37),t.k0s()()()}if(2&n){const e=r.$implicit;t.R7$(2),t.SpI(" ",e.name," "),t.R7$(2),t.vxM(4,e.active?4:-1),t.R7$(),t.vxM(5,e.active?-1:5),t.R7$(3),t.Y8G("svgIcon","mat_solid:edit"),t.R7$(2),t.Y8G("svgIcon","mat_solid:delete")}}function Te(n,r){1&n&&t.Z7z(0,De,11,5,"div",30,t.BUC().trackByFn,!0),2&n&&t.Dyx(r)}function we(n,r){if(1&n&&(t.j41(0,"div",24)(1,"div",25)(2,"div",26),t.EFF(3," Nombre "),t.k0s(),t.j41(4,"div",27),t.EFF(5," Activo "),t.k0s(),t.j41(6,"div",28),t.EFF(7," Acciones "),t.k0s()(),t.DNE(8,Te,2,0),t.nI1(9,"async"),t.nrm(10,"mat-paginator",29),t.k0s()),2&n){let e;const o=t.XpG(2);t.R7$(2),t.Y8G("mat-sort-header","name")("mat-sort-header","name"),t.R7$(2),t.Y8G("mat-sort-header","active"),t.R7$(4),t.vxM(8,(e=t.bMT(9,10,o.paymentConditions$))?8:-1,e),t.R7$(2),t.Y8G("ngClass",t.eq3(12,Re,o.isLoading))("length",o.pagination.length)("pageIndex",o.pagination.page)("pageSize",o.pagination.size)("pageSizeOptions",t.lJ4(14,je))("showFirstLastButtons",!0)}}function Ae(n,r){if(1&n&&(t.j41(0,"div",38),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.JRh(e.searchInputControl.value?"\xa1No se han encontrado formas de pago!":"\xa1No se ha creado ninguna forma de pago a\xfan!")}}function Se(n,r){1&n&&t.DNE(0,we,11,15,"div",24)(1,Ae,2,1),2&n&&t.vxM(0,r.length>0?0:1)}function Pe(n,r){if(1&n&&(t.j41(0,"div",38),t.EFF(1),t.k0s()),2&n){const e=t.XpG();t.R7$(),t.JRh(e.searchInputControl.value?"\xa1No se han encontrado formas de pago!":"\xa1No se ha creado ninguna forma de pago a\xfan!")}}let Be=(()=>{class n{constructor(e,o,i,a,d,b){this._changeDetectorRef=e,this._paymentConditionService=o,this._dialog=i,this._fuseConfirmationService=a,this._snackBar=d,this.store=b,this.merchantId="",this.paymentConditions$=(0,$.of)([]),this.paymentCondition=new Z,this.isLoading=!1,this.searchInputControl=new s.MJ(null),this._unsubscribeAll=new E.B}ngOnInit(){this.paymentConditions$=this.store.select(ut),this.store.select(Q.Dz).pipe((0,f.Q)(this._unsubscribeAll)).subscribe(e=>{this.pagination=e,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,f.Q)(this._unsubscribeAll),(0,Y.B)(300),(0,J.Z)(null),(0,A.n)(e=>null!==e?(this.isLoading=!0,this._paymentConditionService.getPaymentConditions(0,20,"active","desc",e)):(0,$.of)()),(0,O.T)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"active",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,f.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,z.h)(this._sort.sortChange,this._paginator.page).pipe((0,A.n)(()=>(this.isLoading=!0,this._paymentConditionService.getPaymentConditions(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,O.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createPaymentCondition(){this._openDialog(this.paymentCondition,"add")}editPaymentCondition(e){this._openDialog(e,"edit")}deletePaymentCondition(e){this._fuseConfirmationService.open({title:"Eliminar Forma de pago",message:"\xbfEsta seguro que desea Eliminar el Forma de pago? Perder\xe1 el acceso a todos los datos asociados al mismo.",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._paymentConditionService.deletePaymentCondition(e,this.pagination.page,this.pagination.size,"active","desc",this.searchInputControl.value).subscribe(a=>{this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}trackByFn(e,o){return o.id||e}_openDialog(e,o){this._dialog.open(ye,{data:{paymentCondition:e,dialogMode:o},panelClass:"ath-payment-method-dialog-panel"})}static#t=this.\u0275fac=function(o){return new(o||n)(t.rXU(t.gRc),t.rXU(Ot.W),t.rXU(M.bZ),t.rXU(W.G),t.rXU(X.UG),t.rXU(S.il))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["commercial-payment-conditions"]],viewQuery:function(o,i){if(1&o&&(t.GBs(k.iy,5),t.GBs(F.B4,5)),2&o){let a;t.mGM(a=t.lsd())&&(i._paginator=a.first),t.mGM(a=t.lsd())&&(i._sort=a.first)}},standalone:!0,features:[t.aNF],decls:30,vars:9,consts:[["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","overflow-x-auto","overflow-y-auto","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","lg:overflow-x-hidden"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500","hover:underline"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],["class","flex flex-wrap items-center mt-2 shrink-0 sm:mt-0 sm:ml-4",4,"ngxPermissionsExcept"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-wrap","items-center","mt-2","shrink-0","sm:mt-0","sm:ml-4"],[1,"mt-4","mr-4","sm:mt-0","fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"mt-4","text-white","sm:mt-0","bg-gradient-to-r","from-primary-500","to-primary-600","hover:to-primary-900","hover:shadow-lg",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","sm:block"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5","payment-methods-table"],[3,"mat-sort-header"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"mr-4","text-center"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","md:px-8","payment-methods-table"],[1,"truncate"],[1,"text-center","sm:mr-4"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-red-400","icon-size-5",3,"svgIcon"],[1,"flex","flex-row","justify-end","gap-2"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(o,i){if(1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),t.EFF(7,"Inicio"),t.k0s()(),t.j41(8,"div",4),t.nrm(9,"mat-icon",6),t.j41(10,"a",7),t.EFF(11,"Gesti\xf3n Comercial"),t.k0s()(),t.j41(12,"div",4),t.nrm(13,"mat-icon",6),t.j41(14,"a",8),t.EFF(15,"Formas de pago"),t.k0s()()(),t.j41(16,"div",9)(17,"a",10),t.nrm(18,"mat-icon",6),t.j41(19,"span",11),t.EFF(20,"Regresar"),t.k0s()()()(),t.j41(21,"div",12)(22,"div",13),t.EFF(23," Formas de Pago "),t.k0s()()(),t.DNE(24,Ee,8,5,"div",14),t.k0s(),t.j41(25,"div",15)(26,"div",16),t.DNE(27,Se,2,1),t.nI1(28,"async"),t.DNE(29,Pe,2,1),t.k0s()()()),2&o){let a;t.R7$(9),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("routerLink","./.."),t.R7$(),t.Y8G("svgIcon","mat_solid:chevron_left"),t.R7$(6),t.Y8G("ngxPermissionsExcept",t.lJ4(8,Ie)),t.R7$(3),t.vxM(27,(a=t.bMT(28,6,i.paymentConditions$))?27:29,a)}},dependencies:[u.Jj,x.Hl,x.$z,p.RG,p.rl,p.JW,h.m_,h.An,v.fS,v.fg,k.Ou,k.iy,F.NQ,F.B4,F.aE,u.YU,s.X1,s.me,s.BC,s.l_,I.Wk],encapsulation:2,data:{animation:U.X},changeDetection:0})}return n})(),Ne=(()=>{class n{constructor(e){this._paymentConditionsService=e}resolve(e,o){return this._paymentConditionsService.getPaymentConditions(0,20,"name","asc","")}static#t=this.\u0275fac=function(o){return new(o||n)(t.KVO(Ot.W))};static#e=this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Oe=l(5004);const Me=["quotationDetail"],qe=()=>["../"];let Ye=(()=>{class n{constructor(){}ngOnInit(){}generatePDF(e){this.quotationDetailsComponent.generatePDF(e)}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["quotation-details-header"]],viewQuery:function(o,i){if(1&o&&t.GBs(Me,5),2&o){let a;t.mGM(a=t.lsd())&&(i.quotationDetailsComponent=a.first)}},standalone:!0,features:[t.aNF],decls:35,vars:9,consts:[["quotationDetail",""],["cdkScrollable","",1,"absolute","flex","flex-col","w-full","inset-0","min-w-0","text-center","overflow-auto","print:overflow-visible"],[1,"flex","flex-col","flex-wrap","p-6","pb-4","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial/",1,"ml-1","text-primary-500","hover:underline"],[1,"ml-1","text-primary-500","hover:underline",3,"routerLink"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2","ml-2","text-left"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],[1,"flex","items-center","flex-shrink-0","mt-6","md:mt-0","sm:ml-4","gap-x-4","justify-center"],["mat-button","",1,"rounded-full","bg-primary-100",3,"click"],[1,"text-primary-700",3,"svgIcon"],[1,"w-full"]],template:function(o,i){if(1&o){const a=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"div",4)(5,"div",5)(6,"a",6),t.EFF(7,"Inicio"),t.k0s()(),t.j41(8,"div",5),t.nrm(9,"mat-icon",7),t.j41(10,"a",8),t.EFF(11,"Gesti\xf3n Comercial"),t.k0s()(),t.j41(12,"div",5),t.nrm(13,"mat-icon",7),t.j41(14,"a",9),t.EFF(15,"Ofertas"),t.k0s()()(),t.j41(16,"div",10)(17,"a",11),t.nrm(18,"mat-icon",7),t.j41(19,"span",12),t.EFF(20,"Regresar"),t.k0s()()()(),t.j41(21,"div",13)(22,"div",14)(23,"span"),t.EFF(24,"Detalles de la oferta"),t.k0s()()()(),t.j41(25,"div",15)(26,"button",16),t.bIt("click",function(){return t.eBV(a),t.Njj(i.generatePDF("open"))}),t.nrm(27,"mat-icon",17),t.k0s(),t.j41(28,"button",16),t.bIt("click",function(){return t.eBV(a),t.Njj(i.generatePDF("download"))}),t.nrm(29,"mat-icon",17),t.k0s(),t.j41(30,"button",16),t.bIt("click",function(){return t.eBV(a),t.Njj(i.generatePDF("print"))}),t.nrm(31,"mat-icon",17),t.k0s()()(),t.j41(32,"div",18),t.nrm(33,"quotation-details",null,0),t.k0s()()}2&o&&(t.R7$(9),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(),t.Y8G("routerLink",t.lJ4(8,qe)),t.R7$(3),t.Y8G("routerLink","./.."),t.R7$(),t.Y8G("svgIcon","mat_solid:chevron_left"),t.R7$(9),t.Y8G("svgIcon","heroicons_outline:eye"),t.R7$(2),t.Y8G("svgIcon","heroicons_outline:download"),t.R7$(2),t.Y8G("svgIcon","heroicons_outline:printer"))},dependencies:[Oe.Q,h.m_,h.An,x.Hl,x.$z,I.Wk],encapsulation:2,changeDetection:0})}return n})();var Ut=l(82341),Xe=l(78268),Le=l(23309),Mt=l(82798),B=l(9159);const Ve=n=>({"cursor-not-allowed":n});function ze(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Los d\xedas en que expira deben ser mayores igual que 1 o menores igual que 60. "),t.k0s())}let Qe=(()=>{class n{constructor(e,o,i,a,d,b){this.data=e,this._formBuilder=o,this._dialogRef=i,this._invoiceService=a,this._snackBar=d,this.store=b,this.selectedQuotation=null,this.user$=(0,$.of)(null),this._unsubscribeAll=new E.B,this.selectedQuotation=e.quotation}ngOnInit(){this.user$=this.store.select(G.SW),this.user$.pipe((0,f.Q)(this._unsubscribeAll)).subscribe(e=>{this.user=e}),this.invoiceForm=this._formBuilder.group({merchantId:[this.selectedQuotation.merchantId._id,[s.k0.required]],userId:[this.user.id,[s.k0.required]],quotationId:[this.selectedQuotation._id,[s.k0.required]],quotationNo:[{disabled:!0,value:this.selectedQuotation.no},[s.k0.required]],expirationDays:[this.selectedQuotation.merchantId.commercialManagement.expirationInvoiceDays,[s.k0.required,s.k0.min(1),s.k0.max(60)]],bankAccount:["",[s.k0.minLength(16),s.k0.maxLength(24)]],status:[at.PendientePago,[s.k0.required]]}),this.selectedQuotation.paymentMethodData.includeBankAccount&&this.invoiceForm.get("bankAccount").setValue(this.selectedQuotation.merchantId.bankAccount)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createInvoice(){const e=this.invoiceForm.getRawValue();this._invoiceService.createInvoice(e).subscribe(o=>{this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:o.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this.store.dispatch((0,Le.Wh)({quotation:{...this.selectedQuotation,status:"Facturada"}})),this._dialogRef.close()})}static#t=this.\u0275fac=function(o){return new(o||n)(t.rXU(M.Vh),t.rXU(s.ok),t.rXU(M.CP),t.rXU(rt.U),t.rXU(X.UG),t.rXU(S.il))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["commercial-invoice-confirm-dialog"]],standalone:!0,features:[t.aNF],decls:29,vars:15,consts:[[1,"h-full","ng-star-inserted"],[1,"relative","flex","flex-col","w-full","h-full"],[1,"flex","items-center","h-full"],[1,"block","w-full"],[1,"flex","flex-col","items-center","flex-auto","p-8","pb-4","sm:flex-row","sm:items-start","sm:pb-6"],["ng-reflect-ng-class","[object Object]",1,"flex","items-center","justify-center","w-10","h-10","text-blue-600","bg-blue-100","rounded-full","flex-0","sm:mr-4","dark:text-blue-50","dark:bg-blue-600","ng-star-inserted"],["role","img","aria-hidden","true","ng-reflect-svg-icon","heroicons_outline:question-mar","data-mat-icon-type","svg","data-mat-icon-name","question-mark-circle","data-mat-icon-namespace","heroicons_outline",1,"text-current","mat-icon","notranslate","mat-icon-no-color"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","fit","","height","100%","width","100%","preserveAspectRatio","xMidYMid meet","focusable","false"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex","flex-col","items-center","mt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left","ng-star-inserted"],[1,"text-xl","font-medium","leading-6","ng-star-inserted"],[1,"text-secondary","ng-star-inserted"],[1,"pb-6","pl-8","pr-8","mt-10","sm:mt-0","sm:pl-22",3,"formGroup","autocomplete"],[1,"w-full"],["matSuffix","",1,"ml-1"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["type","number","required","","matInput","",3,"formControlName","min","max"],[1,"flex","flex-wrap","justify-center","px-6","py-4","space-x-3","tems-center","md:justify-end","bg-gray-50","dark:bg-black/10","ng-star-inserted"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","","mat-button","",3,"click","color","disabled","ngClass"]],template:function(o,i){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"mat-icon",6),t.qSk(),t.j41(7,"svg",7),t.nrm(8,"path",8),t.k0s()()(),t.joV(),t.j41(9,"div",9)(10,"div",10),t.EFF(11),t.k0s(),t.j41(12,"div",11),t.EFF(13),t.k0s()()(),t.j41(14,"form",12)(15,"div")(16,"mat-form-field",13)(17,"mat-label"),t.EFF(18,"Expira en"),t.k0s(),t.j41(19,"span",14),t.EFF(20,"D\xedas"),t.k0s(),t.nrm(21,"mat-icon",15)(22,"input",16),t.DNE(23,ze,2,0,"mat-error"),t.k0s()()()()(),t.j41(24,"div",17)(25,"button",18),t.EFF(26,"Cancelar"),t.k0s(),t.j41(27,"button",19),t.bIt("click",function(){return i.createInvoice()}),t.EFF(28," Aceptar "),t.k0s()()()()),2&o&&(t.R7$(11),t.JRh(i.data.title),t.R7$(2),t.JRh(i.data.message),t.R7$(),t.Y8G("formGroup",i.invoiceForm)("autocomplete","off"),t.R7$(7),t.Y8G("svgIcon","mat_solid:schedule"),t.R7$(),t.Y8G("formControlName","expirationDays")("min",1)("max",60),t.R7$(),t.vxM(23,i.invoiceForm.get("expirationDays").hasError("min")||i.invoiceForm.get("expirationDays").hasError("max")?23:-1),t.R7$(2),t.Y8G("matDialogClose",!0),t.R7$(2),t.Y8G("color","primary")("disabled",i.invoiceForm.invalid)("ngClass",t.eq3(13,Ve,i.invoiceForm.invalid)))},dependencies:[x.Hl,x.$z,M.hM,M.tx,p.RG,p.rl,p.nJ,p.TL,p.JW,p.yw,h.m_,h.An,v.fS,v.fg,Mt.Ve,F.NQ,B.tP,u.YU,s.X1,s.qT,s.me,s.Q0,s.BC,s.cb,s.YS,s.VZ,s.zX,s.j4,s.JD],encapsulation:2,data:{animation:U.X},changeDetection:0})}return n})();var Jt=l(55181);const Ue=()=>["Super Administrador"],Je=n=>({"pointer-events-none":n}),He=()=>[10,25,50,100],We=(n,r,e,o,i)=>({"bg-amber-50 text-amber-700":n,"bg-green-50 text-green-700":r,"bg-blue-50 text-blue-700":e,"bg-red-50 text-red-700":o,"bg-pink-50 text-pink-700":i}),Ze=n=>[n],Ke=()=>[""],tn=n=>({"bg-amber-500 text-amber-50":n}),en=n=>({"bg-green-500 text-green-50":n}),nn=n=>({"bg-blue-500 text-blue-50":n}),on=n=>({"bg-red-500 text-pink-50 text-red-5":n}),an=n=>({"bg-pink-500 text-pink-50":n});function sn(n,r){if(1&n&&(t.j41(0,"div",18)(1,"mat-form-field",19),t.nrm(2,"mat-icon",20)(3,"input",21),t.k0s()()),2&n){const e=t.XpG(2);t.R7$(2),t.Y8G("svgIcon","mat_solid:search"),t.R7$(),t.Y8G("formControl",e.searchInputControl)("autocomplete","off")("placeholder","Buscar ofertas")}}function rn(n,r){1&n&&t.eu8(0)}function ln(n,r){if(1&n&&(t.j41(0,"div",34)(1,"span"),t.EFF(2),t.nI1(3,"currency"),t.k0s()()),2&n){const e=r.$implicit;t.R7$(2),t.Lme("",t.i5U(3,2,e.total,t.lJ4(5,Ke))," ",e.currency,"")}}function cn(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",32)(1,"div"),t.EFF(2),t.k0s(),t.j41(3,"div",33),t.EFF(4),t.k0s(),t.j41(5,"div",27),t.Z7z(6,ln,4,6,"div",34,t.fX1),t.k0s(),t.j41(8,"div",35),t.EFF(9),t.k0s(),t.j41(10,"div",36)(11,"span",37),t.EFF(12),t.k0s()(),t.j41(13,"div",38)(14,"button",39),t.nrm(15,"mat-icon",40),t.k0s(),t.j41(16,"button",41),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(4);return t.Njj(a.rejectQuotation(i))}),t.nrm(17,"mat-icon",40),t.k0s(),t.j41(18,"button",42),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(4);return t.Njj(a.conformInvoice(i))}),t.nrm(19,"mat-icon",40),t.k0s(),t.j41(20,"button",43),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(4);return t.Njj(a.deleteQuotation(i))}),t.nrm(21,"mat-icon",40),t.k0s()()()}if(2&n){const e=r.$implicit,o=t.XpG(4);t.R7$(2),t.SpI(" ",e.no," "),t.R7$(2),t.SpI(" ",e.requestNo," "),t.R7$(2),t.Dyx(o.getTotalAmount(e)),t.R7$(3),t.SpI(" ",e.goodsData.length," "),t.R7$(),t.Y8G("matTooltip","Rechazada"===e.status?"Motivo: "+e.rejectedReason:"")("ngClass",t.s1E(15,We,"Nueva"===e.status,"Aceptada"===e.status,"Facturada"===e.status,"Rechazada"===e.status,"Vencida"===e.status)),t.R7$(2),t.JRh(e.status),t.R7$(2),t.Y8G("routerLink",t.eq3(21,Ze,e._id)),t.R7$(),t.Y8G("svgIcon","mat_solid:visibility"),t.R7$(),t.Y8G("disabled",!e.status.includes("Nueva")&&!e.status.includes("Aceptada")),t.R7$(),t.Y8G("svgIcon","heroicons_solid:clipboard-copy"),t.R7$(),t.Y8G("disabled",!e.status.includes("Aceptada")),t.R7$(),t.Y8G("svgIcon","heroicons_solid:clipboard-check"),t.R7$(),t.Y8G("matTooltip","Eliminar")("disabled",!e.status.includes("Nueva")),t.R7$(),t.Y8G("svgIcon","mat_solid:delete")}}function dn(n,r){1&n&&t.Z7z(0,cn,22,23,"div",32,t.BUC().trackByFn,!0),2&n&&t.Dyx(r)}function mn(n,r){if(1&n&&(t.j41(0,"div",17),t.DNE(1,rn,1,0,"ng-container",22),t.j41(2,"div",23)(3,"div",24)(4,"div",25)(5,"div",26),t.EFF(6," N\xfamero "),t.k0s(),t.j41(7,"div",26),t.EFF(8," N.Oferta "),t.k0s(),t.j41(9,"div",27),t.EFF(10," Importe "),t.k0s(),t.j41(11,"div",28),t.EFF(12," Cantidad "),t.k0s(),t.j41(13,"div",29),t.EFF(14," Estado "),t.k0s(),t.j41(15,"div",30),t.EFF(16," Acciones "),t.k0s()(),t.DNE(17,dn,2,0),t.nI1(18,"async"),t.nrm(19,"mat-paginator",31),t.k0s()()()),2&n){let e;t.XpG();const o=t.sdS(28),i=t.XpG();t.R7$(),t.Y8G("ngTemplateOutlet",o),t.R7$(4),t.Y8G("mat-sort-header","no"),t.R7$(2),t.Y8G("mat-sort-header","requestNo"),t.R7$(6),t.Y8G("mat-sort-header","status"),t.R7$(4),t.vxM(17,(e=t.bMT(18,11,i.quotations$))?17:-1,e),t.R7$(2),t.Y8G("ngClass",t.eq3(13,Je,i.isLoading))("length",i.pagination.length)("pageIndex",i.pagination.page)("pageSize",i.pagination.size)("pageSizeOptions",t.lJ4(15,He))("showFirstLastButtons",!0)}}function un(n,r){}function pn(n,r){if(1&n&&t.DNE(0,un,0,0,"ng-template",44),2&n){t.XpG();const e=t.sdS(28),o=t.sdS(30),i=t.XpG();t.Y8G("ngTemplateOutlet",i.filterInputControl.value?e:o)}}function _n(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",45)(1,"button",46),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.filterInputControl.setValue("Nueva"!==i.filterInputControl.value?"Nueva":""))}),t.j41(2,"span",47),t.EFF(3,"Nuevas"),t.k0s(),t.nrm(4,"div",48),t.k0s(),t.j41(5,"button",49),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.filterInputControl.setValue("Aceptada"!==i.filterInputControl.value?"Aceptada":""))}),t.j41(6,"span",47),t.EFF(7,"Aceptadas"),t.k0s(),t.nrm(8,"div",50),t.k0s(),t.j41(9,"button",51),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.filterInputControl.setValue("Facturada"!==i.filterInputControl.value?"Facturada":""))}),t.j41(10,"span",47),t.EFF(11,"Facturadas"),t.k0s(),t.nrm(12,"div",52),t.k0s(),t.j41(13,"button",53),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.filterInputControl.setValue("Rechazada"!==i.filterInputControl.value?"Rechazada":""))}),t.j41(14,"span",47),t.EFF(15,"Rechazadas"),t.k0s(),t.nrm(16,"div",54),t.k0s(),t.j41(17,"button",55),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.filterInputControl.setValue("Vencida"!==i.filterInputControl.value?"Vencida":""))}),t.j41(18,"span",47),t.EFF(19,"Vencidas"),t.k0s(),t.nrm(20,"div",56),t.k0s()()}if(2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(5,tn,"Nueva"===e.filterInputControl.value)),t.R7$(4),t.Y8G("ngClass",t.eq3(7,en,"Aceptada"===e.filterInputControl.value)),t.R7$(4),t.Y8G("ngClass",t.eq3(9,nn,"Facturada"===e.filterInputControl.value)),t.R7$(4),t.Y8G("ngClass",t.eq3(11,on,"Rechazada"===e.filterInputControl.value)),t.R7$(4),t.Y8G("ngClass",t.eq3(13,an,"Vencida"===e.filterInputControl.value))}}function fn(n,r){if(1&n&&(t.j41(0,"div",57),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.SpI(" ",e.searchInputControl.value?"\xa1No se han encontrado ofertas!":"\xa1No se ha creado ninguna oferta a\xfan!","")}}function hn(n,r){1&n&&(t.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"div")(4,"div",5)(5,"div",6)(6,"a",7),t.EFF(7,"Inicio"),t.k0s()(),t.j41(8,"div",6),t.nrm(9,"mat-icon",8),t.j41(10,"a",9),t.EFF(11,"Gesti\xf3n Comercial"),t.k0s()(),t.j41(12,"div",6),t.nrm(13,"mat-icon",8),t.j41(14,"a",10),t.EFF(15,"Ofertas"),t.k0s()()(),t.j41(16,"div",11)(17,"a",12),t.nrm(18,"mat-icon",8),t.j41(19,"span",13),t.EFF(20,"Regresar"),t.k0s()()()(),t.j41(21,"div",14)(22,"div",15),t.EFF(23," Ofertas "),t.k0s()()(),t.DNE(24,sn,4,4,"div",16),t.k0s(),t.DNE(25,mn,20,16,"div",17)(26,pn,1,1)(27,_n,21,15,"ng-template",null,0,t.C5r)(29,fn,2,1,"ng-template",null,1,t.C5r),t.k0s()),2&n&&(t.R7$(9),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("routerLink","./.."),t.R7$(),t.Y8G("svgIcon","mat_solid:chevron_left"),t.R7$(6),t.Y8G("ngxPermissionsExcept",t.lJ4(6,Ue)),t.R7$(),t.vxM(25,r.length>0?25:26))}let gn=(()=>{class n{constructor(e,o,i,a,d,b){this._changeDetectorRef=e,this._dialog=o,this._fuseConfirmationService=i,this._quotationService=a,this._snackBar=d,this.store=b,this.isLoading=!1,this.searchInputControl=new s.MJ(null),this.filterInputControl=new s.MJ(""),this._unsubscribeAll=new E.B}ngOnInit(){this.quotations$=this.store.select(Xe.EG),this.store.select(Q.Dz).pipe((0,f.Q)(this._unsubscribeAll)).subscribe(e=>{this.pagination=e,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,f.Q)(this._unsubscribeAll),(0,Y.B)(300),(0,J.Z)(null),(0,A.n)(e=>null!==e?(this.isLoading=!0,this._quotationService.getQuotations(0,20,"createdAt","desc",e,this.filterInputControl.value)):(0,$.of)()),(0,O.T)(()=>{this.isLoading=!1})).subscribe(),this.filterInputControl.valueChanges.pipe((0,f.Q)(this._unsubscribeAll),(0,Y.B)(300),(0,A.n)(e=>this._quotationService.getQuotations(0,20,"createdAt","desc",this.searchInputControl.value,e))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,f.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,z.h)(this._sort.sortChange,this._paginator.page).pipe((0,A.n)(()=>(this.isLoading=!0,this._quotationService.getQuotations(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.filterInputControl.value))),(0,O.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}deleteQuotation(e){this._fuseConfirmationService.open({title:"Eliminar Oferta",message:`\xbfEst\xe1 seguro que desea eliminar la oferta # ${e.no}? Perder\xe1 el acceso a todos los datos asociados al mismo.`,icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._quotationService.deleteQuotation(e._id,this.pagination.page,this.pagination.size,"createdAt","desc",this.searchInputControl.value,this.filterInputControl.value).subscribe(a=>{this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()})}),this._changeDetectorRef.markForCheck()}rejectQuotation(e){this._dialog.open(et.s,{data:{title:"Rechazar Oferta",message:`\xbfEst\xe1 seguro desea Rechazar la oferta # ${e.no}?`,rejectedReason:e.rejectedReason,rejectedReasonRequired:!0},panelClass:"ath-reject-dialog-panel",maxWidth:"520px"}).afterClosed().pipe((0,f.Q)(this._unsubscribeAll)).subscribe(i=>{void 0!==i&&this._quotationService.rejectQuotation(e._id,i.reason).subscribe(d=>{this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:d.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()})})}conformInvoice(e){this._dialog.open(Qe,{data:{title:"Generar Factura",message:`\xbfEst\xe1 seguro que desea generar una factura para la oferta # ${e.no}?`,quotation:e},panelClass:"ath-reject-dialog-panel",maxWidth:"520px"})}getTotalAmount(e){return e.goodsData.reduce((o,{currency:i})=>{if(!o.some(a=>a.currency===i)){const a=e.goodsData.filter(d=>d.currency===i).map(d=>d.quantity).reduce((d,b)=>d+b,0);o.push({currency:i,total:a})}return o},[])}trackByFn(e,o){return o.id||e}static#t=this.\u0275fac=function(o){return new(o||n)(t.rXU(t.gRc),t.rXU(M.bZ),t.rXU(W.G),t.rXU(Jt.X),t.rXU(X.UG),t.rXU(S.il))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["commercial-quotations"]],viewQuery:function(o,i){if(1&o&&(t.GBs(k.iy,5),t.GBs(F.B4,5)),2&o){let a;t.mGM(a=t.lsd())&&(i._paginator=a.first),t.mGM(a=t.lsd())&&(i._sort=a.first)}},standalone:!0,features:[t.aNF],decls:2,vars:3,consts:[["filter",""],["noQuotations",""],["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","overflow-y-auto","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],["class","flex items-center flex-shrink-0 mt-6 sm:mt-0 sm:ml-4",4,"ngxPermissionsExcept"],[1,"flex","flex-col","flex-auto"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],[1,"w-full","fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-auto","sm:min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[4,"ngTemplateOutlet"],[1,"flex","flex-col","flex-auto","overflow-x-auto","lg:overflow-x-clip"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","quotations-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"text-right"],[1,"text-center"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"pr-10","mr-6","text-right"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","quotations-table","md:px-8"],[1,"whitespace-nowrap"],[1,"flex","flex-col","items-end"],[1,"text-center","truncate"],[1,"flex","items-center","mr-4","text-center","truncate","delay-100","rounded-full","h-7","lock","dark:bg-white","dark:bg-opacity-5",3,"matTooltip","ngClass"],[1,"w-full","text-center"],[1,"flex","flex-row","justify-end","gap-2"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["matTooltip","Rechazar Oferta","mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click","disabled"],["matTooltip","Generar Factura","mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click","disabled"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click","matTooltip","disabled"],[3,"ngTemplateOutlet"],[1,"flex","self-end","justify-around","w-full","h-10","pl-2","pr-2","mb-3","mt-7","md:mt-10","md:mb-5","sm:pr-6","md:w-11/12","lg:w-10/12","xl:w-8/12"],[1,"flex","items-center","justify-center","h-full","mr-1","transition-all","ease-in-out","delay-100","border-0","rounded-full","text-amber-700","bg-amber-50","w-36","hover:bg-amber-500","hover:text-amber-50",3,"click","ngClass"],[1,"hidden","ml-2","mr-1","text-lg","md:block"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-amber-500","md:hidden"],[1,"flex","items-center","justify-center","h-full","mr-1","text-green-700","transition-all","ease-in-out","delay-100","border-0","rounded-full","bg-green-50","w-36","hover:bg-green-500","hover:text-green-50",3,"click","ngClass"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-green-500","md:hidden"],[1,"flex","items-center","justify-center","h-full","mr-1","text-blue-700","transition-all","ease-in-out","delay-100","border-0","rounded-full","bg-blue-50","w-36","hover:bg-blue-500","hover:text-blue-50",3,"click","ngClass"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-blue-500","md:hidden"],[1,"flex","items-center","justify-center","h-full","text-red-700","transition-all","ease-in-out","bg-red-100","border-0","rounded-full","delay-50","w-36","hover:bg-red-500","hover:text-red-50",3,"click","ngClass"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-red-500","md:hidden"],[1,"flex","items-center","justify-center","h-full","ml-1","text-pink-700","transition-all","ease-in-out","bg-pink-100","border-0","rounded-full","sm:ml-0","delay-50","w-36","hover:bg-pink-500","hover:text-pink-50",3,"click","ngClass"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-pink-500","md:hidden"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(o,i){if(1&o&&(t.DNE(0,hn,31,7,"div",2),t.nI1(1,"async")),2&o){let a;t.vxM(0,(a=t.bMT(1,1,i.quotations$))?0:-1,a)}},dependencies:[u.Jj,u.oe,x.Hl,x.$z,p.RG,p.rl,p.JW,h.m_,h.An,v.fS,v.fg,k.Ou,k.iy,F.NQ,F.B4,F.aE,H.uc,H.oV,nt.uv,u.YU,Ut.Ov,Ut.f6,I.Wk],encapsulation:2,data:{animation:U.X},changeDetection:0})}return n})();var Ht=l(22674),vn=l(94023);const Cn=["requestDetail"];let bn=(()=>{class n{constructor(){}ngOnInit(){}generatePDF(e){this.quotationDetailsComponent.generatePDF(e)}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["request-details-header"]],viewQuery:function(o,i){if(1&o&&t.GBs(Cn,5),2&o){let a;t.mGM(a=t.lsd())&&(i.quotationDetailsComponent=a.first)}},standalone:!0,features:[t.aNF],decls:35,vars:7,consts:[["requestDetail",""],["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","w-full","min-w-0","overflow-auto","text-center","print:overflow-visible"],[1,"flex","flex-col","flex-wrap","p-6","pb-4","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial/",1,"ml-1","text-primary-500","hover:underline"],["routerLink","/modules/commercial/request",1,"ml-1","text-primary-500","hover:underline"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2","ml-2","text-left"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],[1,"flex","items-center","justify-center","flex-shrink-0","mt-6","md:mt-0","sm:ml-4","gap-x-4"],["mat-button","",1,"rounded-full","bg-primary-100",3,"click"],[1,"text-primary-700",3,"svgIcon"],[1,"w-full"]],template:function(o,i){if(1&o){const a=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"div",4)(5,"div",5)(6,"a",6),t.EFF(7,"Inicio"),t.k0s()(),t.j41(8,"div",5),t.nrm(9,"mat-icon",7),t.j41(10,"a",8),t.EFF(11,"Gesti\xf3n Comercial"),t.k0s()(),t.j41(12,"div",5),t.nrm(13,"mat-icon",7),t.j41(14,"a",9),t.EFF(15,"Solicitudes"),t.k0s()()(),t.j41(16,"div",10)(17,"a",11),t.nrm(18,"mat-icon",7),t.j41(19,"span",12),t.EFF(20,"Regresar"),t.k0s()()()(),t.j41(21,"div",13)(22,"div",14)(23,"span"),t.EFF(24,"Detalles de la solicitud"),t.k0s()()()(),t.j41(25,"div",15)(26,"button",16),t.bIt("click",function(){return t.eBV(a),t.Njj(i.generatePDF("open"))}),t.nrm(27,"mat-icon",17),t.k0s(),t.j41(28,"button",16),t.bIt("click",function(){return t.eBV(a),t.Njj(i.generatePDF("download"))}),t.nrm(29,"mat-icon",17),t.k0s(),t.j41(30,"button",16),t.bIt("click",function(){return t.eBV(a),t.Njj(i.generatePDF("print"))}),t.nrm(31,"mat-icon",17),t.k0s()()(),t.j41(32,"div",18),t.nrm(33,"request-details",null,0),t.k0s()()}2&o&&(t.R7$(9),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("routerLink","./.."),t.R7$(),t.Y8G("svgIcon","mat_solid:chevron_left"),t.R7$(9),t.Y8G("svgIcon","heroicons_outline:eye"),t.R7$(2),t.Y8G("svgIcon","heroicons_outline:download"),t.R7$(2),t.Y8G("svgIcon","heroicons_outline:printer"))},dependencies:[vn.B,h.m_,h.An,x.Hl,x.$z,I.Wk],encapsulation:2,changeDetection:0})}return n})();var xn=l(40740),Wt=l(91013),Zt=l(55867),Fn=l(86600);const kn=n=>({"cursor-not-allowed":n}),yn=(n,r)=>({"text-center pl-8  md:pl-0":n,"min-w-60 lg:w-80":r}),In=(n,r)=>({"text-center":n,"w-60 lg:w-80":r}),Kt=()=>[""],Rn=()=>["$"],jn=(n,r)=>({"text-center":n,truncate:r});function En(n,r){if(1&n&&(t.j41(0,"mat-option",24),t.EFF(1),t.k0s()),2&n){const e=r.$implicit,o=t.XpG(2);t.Y8G("value",o.transformPaymentMethod(e)),t.R7$(),t.SpI(" ",e.name," ")}}function $n(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," El m\xe9todo de pago es obligatoria. "),t.k0s())}function Gn(n,r){if(1&n&&(t.j41(0,"mat-form-field",5)(1,"mat-label"),t.EFF(2,"M\xe9todo de pago"),t.k0s(),t.nrm(3,"mat-icon",7),t.j41(4,"mat-select",23),t.Z7z(5,En,2,2,"mat-option",24,t.fX1),t.k0s(),t.DNE(7,$n,2,0,"mat-error"),t.k0s()),2&n){const e=t.XpG();t.R7$(3),t.Y8G("svgIcon","heroicons_solid:credit-card"),t.R7$(),t.Y8G("formControlName","paymentMethodData"),t.R7$(),t.Dyx(r),t.R7$(2),t.vxM(7,e.quotationForm.get("paymentMethodData").hasError("required")?7:-1)}}function Dn(n,r){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Los d\xedas en que expira deben ser mayores igual que 1 o menores igual que 60. "),t.k0s())}function Tn(n,r){if(1&n&&(t.j41(0,"th",28),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2).$implicit,o=t.XpG();t.Y8G("ngClass",t.l_i(2,yn,"name"!==e,"name"===e)),t.R7$(),t.SpI(" ",o.getFieldsTableHeaderNames(e)," ")}}function wn(n,r){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n){const e=t.XpG().$implicit,o=t.XpG(2).$implicit;t.R7$(),t.Lme("",t.i5U(2,2,e[o],t.lJ4(5,Kt))," ",e.currency," ")}}function An(n,r){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n){const e=t.XpG().$implicit,o=t.XpG(2).$implicit;t.R7$(),t.SpI("",t.i5U(2,1,e[o],t.lJ4(4,Rn))," ")}}function Sn(n,r){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit,o=t.XpG(2).$implicit;t.R7$(),t.SpI("",e[o]," ")}}function Pn(n,r){if(1&n&&(t.j41(0,"td",29),t.DNE(1,wn,3,6,"span")(2,An,3,5,"span")(3,Sn,2,1,"span"),t.k0s()),2&n){const e=t.XpG(2).$implicit;t.Y8G("ngClass",t.l_i(4,In,"name"!==e,"name"===e)),t.R7$(),t.vxM(1,"price"===e?1:-1),t.R7$(),t.vxM(2,"quantity"===e?2:-1),t.R7$(),t.vxM(3,"price"!==e&&"quantity"!==e?3:-1)}}function Bn(n,r){1&n&&(t.j41(0,"span"),t.EFF(1,"Total"),t.k0s())}function Nn(n,r){if(1&n&&(t.j41(0,"td",30),t.DNE(1,Bn,2,0,"span"),t.k0s()),2&n){const e=t.XpG(2).$implicit;t.Y8G("ngClass",t.l_i(2,jn,"name"!==e,"name"===e)),t.R7$(),t.vxM(1,"name"===e?1:-1)}}function On(n,r){1&n&&(t.j41(0,"div"),t.DNE(1,Tn,2,5,"th",25)(2,Pn,4,7,"td",26)(3,Nn,2,5,"td",27),t.k0s())}function Mn(n,r){if(1&n&&(t.j41(0,"th",34),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2).$implicit,o=t.XpG();t.R7$(),t.SpI(" ",o.getFieldsTableHeaderNames(e)," ")}}function qn(n,r){if(1&n&&(t.j41(0,"span",37),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit,o=t.XpG(2).$implicit;t.R7$(),t.SpI(" ",e[o],"")}}function Yn(n,r){if(1&n&&(t.j41(0,"div",37)(1,"mat-form-field",38),t.nrm(2,"input",39),t.k0s()()),2&n){const e=t.XpG().$implicit,o=t.XpG(3);t.R7$(2),t.Y8G("formControl",o.amountFormControl)("min",0)("max",o.getOldGoodsAmountById(e.goodsId))}}function Xn(n,r){if(1&n&&(t.j41(0,"td",35)(1,"div",36),t.DNE(2,qn,2,1,"span",37)(3,Yn,3,3,"div",37),t.k0s()()),2&n){const e=r.$implicit,o=t.XpG(3);t.R7$(2),t.vxM(2,o.selectedGoodDataToEdit&&e.goodsId===(null==o.selectedGoodDataToEdit?null:o.selectedGoodDataToEdit.goodsId)?-1:2),t.R7$(),t.vxM(3,o.selectedGoodDataToEdit&&e.goodsId===(null==o.selectedGoodDataToEdit?null:o.selectedGoodDataToEdit.goodsId)?3:-1)}}function Ln(n,r){1&n&&t.nrm(0,"td",40)}function Vn(n,r){1&n&&(t.j41(0,"div"),t.DNE(1,Mn,2,1,"th",31)(2,Xn,4,2,"td",32)(3,Ln,1,0,"td",33),t.k0s())}function zn(n,r){1&n&&(t.j41(0,"th",44),t.EFF(1," Acciones "),t.k0s())}function Qn(n,r){if(1&n){const e=t.RV6();t.j41(0,"button",50),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG(3);return t.Njj(a.operation(i.goodsId,-1))}),t.nrm(1,"mat-icon",51),t.k0s()}if(2&n){const e=t.XpG().$implicit;t.Y8G("disabled",0===e.amount),t.R7$(),t.Y8G("svgIcon","heroicons_solid:minus-sm")}}function Un(n,r){if(1&n){const e=t.RV6();t.j41(0,"button",50),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG(3);return t.Njj(a.operation(i.goodsId,1))}),t.nrm(1,"mat-icon",51),t.k0s()}if(2&n){const e=t.XpG().$implicit,o=t.XpG(3);t.Y8G("disabled",e.amount===o.getOldGoodsAmountById(e.goodsId)),t.R7$(),t.Y8G("svgIcon","heroicons_solid:plus-sm")}}function Jn(n,r){if(1&n){const e=t.RV6();t.j41(0,"button",52),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG(3);return t.Njj(a.toggleToEditGoods(i))}),t.nrm(1,"mat-icon",51),t.k0s()}2&n&&(t.R7$(),t.Y8G("svgIcon","mat_solid:edit-alt"))}function Hn(n,r){if(1&n){const e=t.RV6();t.j41(0,"button",53),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG(3);return t.Njj(a.toggleToEditGoods(i))}),t.nrm(1,"mat-icon",51),t.k0s()}if(2&n){const e=t.XpG().$implicit,o=t.XpG(3);t.Y8G("color","primary")("disabled",o.selectedGoodDataToEdit&&e.goodsId===(null==o.selectedGoodDataToEdit?null:o.selectedGoodDataToEdit.goodsId)&&o.amountFormControl.invalid),t.R7$(),t.Y8G("svgIcon","mat_solid:edit-alt")}}function Wn(n,r){if(1&n&&(t.j41(0,"td",45)(1,"div",46),t.DNE(2,Qn,2,2,"button",47)(3,Un,2,2,"button",47)(4,Jn,2,1,"button",48)(5,Hn,2,3,"button",49),t.k0s()()),2&n){const e=r.$implicit,o=t.XpG(3);t.R7$(2),t.vxM(2,o.selectedGoodDataToEdit&&e.goodsId===(null==o.selectedGoodDataToEdit?null:o.selectedGoodDataToEdit.goodsId)?-1:2),t.R7$(),t.vxM(3,o.selectedGoodDataToEdit&&e.goodsId===(null==o.selectedGoodDataToEdit?null:o.selectedGoodDataToEdit.goodsId)?-1:3),t.R7$(),t.vxM(4,o.selectedGoodDataToEdit&&e.goodsId===(null==o.selectedGoodDataToEdit?null:o.selectedGoodDataToEdit.goodsId)?-1:4),t.R7$(),t.vxM(5,o.selectedGoodDataToEdit&&e.goodsId===(null==o.selectedGoodDataToEdit?null:o.selectedGoodDataToEdit.goodsId)?5:-1)}}function Zn(n,r){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n){const e=r.$implicit;t.R7$(),t.Lme("",t.i5U(2,2,e.total,t.lJ4(5,Kt))," ",e.currency,"")}}function Kn(n,r){if(1&n&&(t.j41(0,"td",54),t.Z7z(1,Zn,3,6,"div",null,t.fX1),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.Dyx(e.getTotalQuantity())}}function to(n,r){1&n&&(t.j41(0,"div"),t.DNE(1,zn,2,0,"th",41)(2,Wn,6,4,"td",42)(3,Kn,3,0,"td",43),t.k0s())}function eo(n,r){if(1&n&&(t.qex(0,16),t.DNE(1,On,4,0,"div")(2,Vn,4,0,"div")(3,to,4,0,"div"),t.bVm()),2&n){const e=r.$implicit;t.FS9("matColumnDef",e),t.R7$(),t.vxM(1,"actions"!==e&&"amount"!==e?1:-1),t.R7$(),t.vxM(2,"amount"===e?2:-1),t.R7$(),t.vxM(3,"actions"===e?3:-1)}}function no(n,r){1&n&&t.nrm(0,"tr",55)}function oo(n,r){1&n&&t.nrm(0,"tr",56)}function io(n,r){1&n&&t.nrm(0,"tr",57)}let ao=(()=>{class n{constructor(e,o,i,a,d,b){this._changeDetectorRef=e,this._formBuilder=o,this._fuseConfirmationService=i,this._quotationsService=a,this._snackBar=d,this.store=b,this.selectedRequest=null,this.reject=new t.bkB,this.isQuotationCreated=new t.bkB,this.user$=(0,$.of)(null),this.selectedGoodDataToEdit=null,this.amountFormControl=new s.MJ(0),this.paymentMethods$=(0,$.of)(null),this.displayedColumns=["name","type","uom","amount","price","quantity","actions"],this._unsubscribeAll=new E.B,this.amountFormControl.setValidators([s.k0.required])}ngOnInit(){this.goodsData=structuredClone(this.selectedRequest.goodsData),this.user$=this.store.select(G.SW),this.user$.pipe((0,f.Q)(this._unsubscribeAll)).subscribe(e=>{this.user=e,this._changeDetectorRef.markForCheck()}),this.paymentMethods$=this.store.select(ut),this.quotationForm=this._formBuilder.group({merchantId:[this.selectedRequest.merchantId._id,[s.k0.required]],userId:[this.user.id,[s.k0.required]],requestId:[this.selectedRequest._id,[s.k0.required]],requestNo:[{disabled:!0,value:this.selectedRequest.no},[s.k0.required]],expirationDays:[this.selectedRequest.merchantId.commercialManagement.expirationQuotationDays,[s.k0.required,s.k0.min(1),s.k0.max(60)]],status:[Zt.Sb.Nueva,[s.k0.required]],description:["",[s.k0.maxLength(1e3)]],paymentMethodData:[null,[s.k0.required]]})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createQuotation(){let e=this.quotationForm.getRawValue();e={...e,goodsData:this.goodsData},this._fuseConfirmationService.open({title:"Crear Oferta",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._quotationsService.createQuotation(e).subscribe(a=>{this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this.isQuotationCreated.next(this.selectedRequest)}),this._changeDetectorRef.markForCheck()})}transformPaymentMethod(e){return new Zt.me(e)}getTotal(){return this.getTotalQuantity().map(e=>e.total).reduce((e,o)=>e+o,0)}getTotalQuantity(){return this.goodsData.reduce((e,{currency:o})=>{if(!e.some(i=>i.currency===o)){const i=this.goodsData.filter(a=>a.currency===o).map(a=>a.quantity).reduce((a,d)=>a+d,0);e.push({currency:o,total:i})}return e},[])}getFieldsTableHeaderNames(e){switch(e){case"name":return"Nombre";case"uom":return"U.M";case"amount":return"Cantidad";case"price":return"Precio";case"quantity":return"Total unitario";case"type":return"Tipo"}}operation(e,o){const i=this.goodsData.find(a=>a.goodsId===e);i.amount=i.amount+o,i.quantity=i.amount*i.price}getOldGoodsAmountById(e){return this.selectedRequest.goodsData.find(o=>o.goodsId===e).amount}toggleToEditGoods(e){if(this.selectedGoodDataToEdit&&this.selectedGoodDataToEdit.goodsId===e.goodsId){const i=this.amountFormControl.value;this.amountFormControl.clearValidators();const a=this.goodsData.find(d=>d.goodsId===e.goodsId);return a.amount=i,a.quantity=a.amount*a.price,this.amountFormControl.clearValidators(),void(this.selectedGoodDataToEdit=null)}const o=this.selectedRequest.goodsData.find(i=>i.goodsId===e.goodsId);this.amountFormControl.setValidators([s.k0.required,s.k0.min(0),s.k0.max(o.amount)]),this.amountFormControl.setValue(e.amount),this.selectedGoodDataToEdit=e}triggerReject(){this.reject.next(this.selectedRequest)}trackByFn(e,o){return o.id||e}static#t=this.\u0275fac=function(o){return new(o||n)(t.rXU(t.gRc),t.rXU(s.ok),t.rXU(W.G),t.rXU(Jt.X),t.rXU(X.UG),t.rXU(S.il))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["quotation-confirm"]],inputs:{selectedRequest:"selectedRequest"},outputs:{reject:"reject",isQuotationCreated:"isQuotationCreated"},standalone:!0,features:[t.aNF],decls:37,vars:24,consts:[[1,"overflow-hidden","shadow-lg"],[1,"flex","flex-col","justify-between","order-b"],[1,"flex","flex-col","w-full","p-4","space-y-1","sm:p-10"],[1,"grid","w-full","grid-cols-4","gap-y-1","gap-x-6",3,"formGroup"],[1,"col-span-1"],[1,"w-full"],["matSuffix","",1,"ml-1"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["type","number","required","","matInput","",3,"formControlName","min","max"],[1,"col-span-2"],[1,"flex-auto","w-full","fuse-mat-textarea"],["matInput","","matTextareaAutosize","",1,"h-4","min-h-4","max-h-20",3,"formControlName","rows","spellcheck","maxlength"],[1,"flex","flex-col","col-span-4"],[1,"font-medium"],["tabindex","0",1,"mt-2","overflow-auto","rounded-md","max-h-80",2,"box-shadow","0 0 3px 0 rgb(0 0 0 / 10%), 0 1px 2px -1px rgb(0 0 0 / 10%) !important"],["mat-table","",1,"w-full",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","","class","font-medium",4,"matFooterRowDef"],[1,"flex","items-center","justify-between","w-full","px-8","py-4","border-t"],["mat-button","",1,"-ml-4",3,"click","color"],["mat-flat-button","",3,"click","color","disabled","ngClass"],["required","",3,"formControlName"],[3,"value"],["mat-header-cell","","class","w-10 pr-8 md:w-auto md:pr-0",3,"ngClass",4,"matHeaderCellDef"],["mat-cell","",3,"ngClass",4,"matCellDef"],["mat-footer-cell","",3,"ngClass",4,"matFooterCellDef"],["mat-header-cell","",1,"w-10","pr-8","md:w-auto","md:pr-0",3,"ngClass"],["mat-cell","",3,"ngClass"],["mat-footer-cell","",3,"ngClass"],["mat-header-cell","","class","w-10 pl-8 pr-8 text-center md:w-auto md:pr-0 md:pl-0",4,"matHeaderCellDef"],["mat-cell","","class","text-center",4,"matCellDef"],["mat-footer-cell","","class","text-center",4,"matFooterCellDef"],["mat-header-cell","",1,"w-10","pl-8","pr-8","text-center","md:w-auto","md:pr-0","md:pl-0"],["mat-cell","",1,"text-center"],[1,"flex","justify-center"],[1,"w-24"],[1,"w-full","fuse-mat-no-subscript"],["type","number","matInput","","required","",3,"formControl","min","max"],["mat-footer-cell","",1,"text-center"],["mat-header-cell","","class","pl-8 pr-8 text-center md:pr-6 md:pl-0",4,"matHeaderCellDef"],["style","width: 120px;","mat-cell","","class","text-center",4,"matCellDef"],["mat-footer-cell","","class","text-end",4,"matFooterCellDef"],["mat-header-cell","",1,"pl-8","pr-8","text-center","md:pr-6","md:pl-0"],["mat-cell","",1,"text-center",2,"width","120px"],[1,"flex","justify-center","space-x-2",2,"width","120px"],["mat-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"disabled"],["mat-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7"],["mat-flat-button","",1,"px-2","leading-6","min-h-7","h-7",3,"color","disabled"],["mat-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click","disabled"],[1,"icon-size-5",3,"svgIcon"],["mat-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],["mat-flat-button","",1,"px-2","leading-6","min-h-7","h-7",3,"click","color","disabled"],["mat-footer-cell","",1,"text-end"],["mat-header-row",""],["mat-row",""],["mat-footer-row","",1,"font-medium"]],template:function(o,i){if(1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3)(4,"div",4),t.DNE(5,Gn,8,3,"mat-form-field",5),t.nI1(6,"async"),t.k0s(),t.j41(7,"div",4)(8,"mat-form-field",5)(9,"mat-label"),t.EFF(10,"Expira en"),t.k0s(),t.j41(11,"span",6),t.EFF(12,"D\xedas"),t.k0s(),t.nrm(13,"mat-icon",7)(14,"input",8),t.DNE(15,Dn,2,0,"mat-error"),t.k0s()(),t.j41(16,"div",9)(17,"mat-form-field",10)(18,"mat-label"),t.EFF(19,"Descripci\xf3n"),t.k0s(),t.nrm(20,"mat-icon",7)(21,"textarea",11),t.k0s()()(),t.j41(22,"div",12)(23,"mat-label",13),t.EFF(24,"Productos y servicios"),t.k0s(),t.j41(25,"div",14)(26,"table",15),t.Z7z(27,eo,4,4,"ng-container",16,t.fX1),t.DNE(29,no,1,0,"tr",17)(30,oo,1,0,"tr",18)(31,io,1,0,"tr",19),t.k0s()()()(),t.j41(32,"div",20)(33,"button",21),t.bIt("click",function(){return i.triggerReject()}),t.EFF(34," Rechazar Solicitud "),t.k0s(),t.j41(35,"button",22),t.bIt("click",function(){return i.createQuotation()}),t.EFF(36," Conformar Oferta "),t.k0s()()()()),2&o){let a;t.R7$(3),t.Y8G("formGroup",i.quotationForm),t.R7$(2),t.vxM(5,(a=t.bMT(6,20,i.paymentMethods$))?5:-1,a),t.R7$(8),t.Y8G("svgIcon","mat_solid:schedule"),t.R7$(),t.Y8G("formControlName","expirationDays")("min",1)("max",60),t.R7$(),t.vxM(15,i.quotationForm.get("expirationDays").hasError("min")||i.quotationForm.get("expirationDays").hasError("max")?15:-1),t.R7$(5),t.Y8G("svgIcon","mat_solid:subject"),t.R7$(),t.Y8G("formControlName","description")("rows",3)("spellcheck",!1)("maxlength",1e3),t.R7$(5),t.Y8G("dataSource",i.goodsData),t.R7$(),t.Dyx(i.displayedColumns),t.R7$(2),t.Y8G("matHeaderRowDef",i.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",i.displayedColumns),t.R7$(),t.Y8G("matFooterRowDef",i.displayedColumns),t.R7$(2),t.Y8G("color","warn"),t.R7$(2),t.Y8G("color","primary")("disabled",i.quotationForm.invalid||i.amountFormControl.invalid||0===i.getTotal())("ngClass",t.eq3(22,kn,i.quotationForm.invalid||i.amountFormControl.invalid||0===i.getTotal()))}},dependencies:[u.Jj,x.Hl,x.$z,p.RG,p.rl,p.nJ,p.TL,p.JW,p.yw,v.fS,v.fg,h.m_,h.An,Mt.Ve,Mt.VO,Fn.wT,F.NQ,u.YU,s.X1,s.qT,s.me,s.Q0,s.BC,s.cb,s.YS,s.tU,s.VZ,s.zX,s.l_,s.j4,s.JD,B.tP,B.Zl,B.tL,B.ji,B.cC,B.YV,B.iL,B.Zq,B.xW,B.KS,B.$R,B.Qo,B.YZ,B.NB,B.iF],encapsulation:2,changeDetection:0})}return n})();var so=l(22949);const ro=()=>["Super Administrador"],lo=n=>({"pointer-events-none":n}),co=()=>[10,25,50,100],mo=(n,r,e)=>({"bg-amber-50 text-amber-700":n,"bg-blue-50 text-blue-700":r,"bg-red-50 text-red-700":e}),uo=n=>[n],po=()=>[""],_o=n=>({"bg-amber-500 text-amber-50":n}),fo=n=>({"bg-blue-500 text-blue-50":n}),ho=n=>({"bg-red-500 text-red-50":n});function go(n,r){if(1&n&&(t.j41(0,"div",18)(1,"mat-form-field",19),t.nrm(2,"mat-icon",20)(3,"input",21),t.k0s()()),2&n){const e=t.XpG(2);t.R7$(2),t.Y8G("svgIcon","mat_solid:search"),t.R7$(),t.Y8G("formControl",e.searchInputControl)("autocomplete","off")("placeholder","Buscar solicitudes")}}function vo(n,r){1&n&&t.eu8(0)}function Co(n,r){if(1&n&&(t.j41(0,"div",34)(1,"span"),t.EFF(2),t.nI1(3,"currency"),t.k0s()()),2&n){const e=r.$implicit;t.R7$(2),t.Lme("",t.i5U(3,2,e.total,t.lJ4(5,po))," ",e.currency,"")}}function bo(n,r){if(1&n){const e=t.RV6();t.j41(0,"quotation-confirm",44),t.bIt("reject",function(i){t.eBV(e);const a=t.XpG(5);return t.Njj(a.rejectRequest(i))})("isQuotationCreated",function(i){t.eBV(e);const a=t.XpG(5);return t.Njj(a.getRequestById(i))}),t.k0s()}if(2&n){const e=t.XpG().$implicit;t.Y8G("selectedRequest",e)}}function xo(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",32)(1,"div"),t.EFF(2),t.k0s(),t.j41(3,"div",33),t.EFF(4),t.k0s(),t.j41(5,"div",27),t.Z7z(6,Co,4,6,"div",34,t.fX1),t.k0s(),t.j41(8,"div",35),t.EFF(9),t.k0s(),t.j41(10,"div",36)(11,"span",37),t.EFF(12),t.k0s()(),t.j41(13,"div",38)(14,"button",39),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(4);return t.Njj(a.toggleDetails(i))}),t.nrm(15,"mat-icon",40),t.k0s(),t.j41(16,"button",41),t.nrm(17,"mat-icon",40),t.k0s(),t.j41(18,"button",42),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(4);return t.Njj(a.deleteRequest(i))}),t.nrm(19,"mat-icon",40),t.k0s()()(),t.j41(20,"div",24),t.DNE(21,bo,1,1,"quotation-confirm",43),t.k0s()}if(2&n){const e=r.$implicit,o=t.XpG(4);t.R7$(2),t.SpI(" ",e.no," "),t.R7$(2),t.Lme(" ",e.name," ",e.lastname," "),t.R7$(2),t.Dyx(o.getTotalAmount(e)),t.R7$(3),t.SpI(" ",e.goodsData.length," "),t.R7$(),t.Y8G("matTooltip","Rechazada"===e.status?"Motivo: "+e.rejectedReason:"")("ngClass",t.sMw(14,mo,"Nueva"===e.status,"Aceptada"===e.status,"Rechazada"===e.status)),t.R7$(2),t.JRh(e.status),t.R7$(2),t.Y8G("disabled","Nueva"!==e.status),t.R7$(),t.Y8G("svgIcon",(null==o.selectedRequest?null:o.selectedRequest._id)===e._id?"mat_solid:expand_more":"mat_solid:expand_less"),t.R7$(),t.Y8G("routerLink",t.eq3(18,uo,e._id)),t.R7$(),t.Y8G("svgIcon","mat_solid:visibility"),t.R7$(),t.Y8G("matTooltip","Eliminar"),t.R7$(),t.Y8G("svgIcon","mat_solid:delete"),t.R7$(2),t.vxM(21,(null==o.selectedRequest?null:o.selectedRequest._id)===e._id?21:-1)}}function Fo(n,r){1&n&&t.Z7z(0,xo,22,20,null,null,t.BUC().trackByFn,!0),2&n&&t.Dyx(r)}function ko(n,r){if(1&n&&(t.j41(0,"div",17),t.DNE(1,vo,1,0,"ng-container",22),t.j41(2,"div",23)(3,"div",24)(4,"div",25)(5,"div",26),t.EFF(6," N\xfamero "),t.k0s(),t.j41(7,"div",26),t.EFF(8," Nombre "),t.k0s(),t.j41(9,"div",27),t.EFF(10," Importe "),t.k0s(),t.j41(11,"div",28),t.EFF(12," Cantidad "),t.k0s(),t.j41(13,"div",29),t.EFF(14," Estado "),t.k0s(),t.j41(15,"div",30),t.EFF(16," Acciones "),t.k0s()(),t.DNE(17,Fo,2,0),t.nI1(18,"async"),t.nrm(19,"mat-paginator",31),t.k0s()()()),2&n){let e;t.XpG();const o=t.sdS(28),i=t.XpG();t.R7$(),t.Y8G("ngTemplateOutlet",o),t.R7$(4),t.Y8G("mat-sort-header","no"),t.R7$(2),t.Y8G("mat-sort-header","name"),t.R7$(6),t.Y8G("mat-sort-header","status"),t.R7$(4),t.vxM(17,(e=t.bMT(18,11,i.requests$))?17:-1,e),t.R7$(2),t.Y8G("ngClass",t.eq3(13,lo,i.isLoading))("length",i.pagination.length)("pageIndex",i.pagination.page)("pageSize",i.pagination.size)("pageSizeOptions",t.lJ4(15,co))("showFirstLastButtons",!0)}}function yo(n,r){}function Io(n,r){if(1&n&&t.DNE(0,yo,0,0,"ng-template",45),2&n){t.XpG();const e=t.sdS(28),o=t.sdS(30),i=t.XpG();t.Y8G("ngTemplateOutlet",i.filterInputControl.value?e:o)}}function Ro(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",46)(1,"button",47),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.filterInputControl.setValue("Nueva"!==i.filterInputControl.value?"Nueva":""))}),t.j41(2,"span",48),t.EFF(3,"Nuevas"),t.k0s(),t.nrm(4,"div",49),t.k0s(),t.j41(5,"button",50),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.filterInputControl.setValue("Aceptada"!==i.filterInputControl.value?"Aceptada":""))}),t.j41(6,"span",48),t.EFF(7,"Aceptadas"),t.k0s(),t.nrm(8,"div",51),t.k0s(),t.j41(9,"button",52),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.filterInputControl.setValue("Rechazada"!==i.filterInputControl.value?"Rechazada":""))}),t.j41(10,"span",48),t.EFF(11,"Rechazadas"),t.k0s(),t.nrm(12,"div",53),t.k0s()()}if(2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(3,_o,"Nueva"===e.filterInputControl.value)),t.R7$(4),t.Y8G("ngClass",t.eq3(5,fo,"Aceptada"===e.filterInputControl.value)),t.R7$(4),t.Y8G("ngClass",t.eq3(7,ho,"Rechazada"===e.filterInputControl.value))}}function jo(n,r){if(1&n&&(t.j41(0,"div",54),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.JRh(e.searchInputControl.value?"\xa1No se han encontrado solicitudes!":"\xa1No le han enviado ninguna solicitud a\xfan!")}}function Eo(n,r){1&n&&(t.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"div")(4,"div",5)(5,"div",6)(6,"a",7),t.EFF(7,"Inicio"),t.k0s()(),t.j41(8,"div",6),t.nrm(9,"mat-icon",8),t.j41(10,"a",9),t.EFF(11,"Gesti\xf3n Comercial"),t.k0s()(),t.j41(12,"div",6),t.nrm(13,"mat-icon",8),t.j41(14,"a",10),t.EFF(15,"Solicitudes"),t.k0s()()(),t.j41(16,"div",11)(17,"a",12),t.nrm(18,"mat-icon",8),t.j41(19,"span",13),t.EFF(20,"Regresar"),t.k0s()()()(),t.j41(21,"div",14)(22,"div",15),t.EFF(23," Solicitudes "),t.k0s()()(),t.DNE(24,go,4,4,"div",16),t.k0s(),t.DNE(25,ko,20,16,"div",17)(26,Io,1,1)(27,Ro,13,9,"ng-template",null,0,t.C5r)(29,jo,2,1,"ng-template",null,1,t.C5r),t.k0s()),2&n&&(t.R7$(9),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("routerLink","./.."),t.R7$(),t.Y8G("svgIcon","mat_solid:chevron_left"),t.R7$(6),t.Y8G("ngxPermissionsExcept",t.lJ4(6,ro)),t.R7$(),t.vxM(25,r.length>0?25:26))}let $o=(()=>{class n{constructor(e,o,i,a,d,b){this._changeDetectorRef=e,this._dialog=o,this._fuseConfirmationService=i,this._requestService=a,this._snackBar=d,this.store=b,this.isLoading=!1,this.searchInputControl=new s.MJ(null),this.filterInputControl=new s.MJ(""),this._unsubscribeAll=new E.B}ngOnInit(){this.requests$=this.store.select(xn.lz),this.store.select(Q.Dz).pipe((0,f.Q)(this._unsubscribeAll)).subscribe(e=>{this.pagination=e,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,f.Q)(this._unsubscribeAll),(0,Y.B)(300),(0,J.Z)(null),(0,A.n)(e=>(null!==e&&(this.isLoading=!0,this._requestService.getRequests(0,20,"createdAt","desc",e,this.filterInputControl.value)),(0,$.of)())),(0,O.T)(()=>{this.isLoading=!1})).subscribe(),this.filterInputControl.valueChanges.pipe((0,f.Q)(this._unsubscribeAll),(0,Y.B)(300),(0,A.n)(e=>this._requestService.getRequests(0,20,"createdAt","desc",this.searchInputControl.value,e))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,f.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,z.h)(this._sort.sortChange,this._paginator.page).pipe((0,A.n)(()=>(this.isLoading=!0,this._requestService.getRequests(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.filterInputControl.value))),(0,O.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}deleteRequest(e){this._fuseConfirmationService.open({title:"Eliminar Usuario",message:`\xbfEst\xe1 seguro que desea eliminar la solicitud # ${e.no}? Perder\xe1 el acceso a todos los datos asociados al mismo.`,icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._requestService.deleteRequest(e._id,this.pagination.page,this.pagination.size,"createdAt","desc",this.searchInputControl.value,this.filterInputControl.value).subscribe(a=>{this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()})}),this._changeDetectorRef.markForCheck()}rejectRequest(e){this._dialog.open(et.s,{data:{title:"Rechazar Solicitud",message:`\xbfEst\xe1 seguro desea Rechazar la solicitud # ${e.no}?`,rejectedReason:e.rejectedReason,rejectedReasonRequired:!0},panelClass:"ath-reject-dialog-panel",maxWidth:"520px"}).afterClosed().pipe((0,f.Q)(this._unsubscribeAll)).subscribe(i=>{void 0!==i&&this._requestService.rejectRequest(e._id,i.reason).subscribe(d=>{this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:d.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"mat_solid:done"}}),this.closeDetails(),this._changeDetectorRef.markForCheck()})})}getRequestById(e){this._requestService.getRequestById(e._id).subscribe(o=>{this.store.dispatch((0,Wt.H5)({request:o.data})),this.store.dispatch((0,Wt.lt)()),this.closeDetails(),this._changeDetectorRef.markForCheck()})}getTotalAmount(e){return e.goodsData.reduce((o,{currency:i})=>{if(!o.some(a=>a.currency===i)){const a=e.goodsData.filter(d=>d.currency===i).map(d=>d.quantity).reduce((d,b)=>d+b,0);o.push({currency:i,total:a})}return o},[])}toggleDetails(e){this.selectedRequest&&this.selectedRequest._id===e._id?this.closeDetails():this.selectedRequest=e}closeDetails(){this.selectedRequest=null}trackByFn(e,o){return o.id||e}static#t=this.\u0275fac=function(o){return new(o||n)(t.rXU(t.gRc),t.rXU(M.bZ),t.rXU(W.G),t.rXU(so.k),t.rXU(X.UG),t.rXU(S.il))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["hrm-requests"]],viewQuery:function(o,i){if(1&o&&(t.GBs(k.iy,5),t.GBs(F.B4,5)),2&o){let a;t.mGM(a=t.lsd())&&(i._paginator=a.first),t.mGM(a=t.lsd())&&(i._sort=a.first)}},standalone:!0,features:[t.aNF],decls:2,vars:3,consts:[["filter",""],["noRequests",""],["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","overflow-y-auto","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],["class","flex items-center flex-shrink-0 mt-6 sm:mt-0 sm:ml-4",4,"ngxPermissionsExcept"],[1,"flex","flex-col","flex-auto"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],[1,"w-full","fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-auto","sm:min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[4,"ngTemplateOutlet"],[1,"flex","flex-col","flex-auto","overflow-x-auto","lg:overflow-x-clip"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","requests-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"text-right"],[1,"text-center"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"pr-8","mr-1","text-right"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","requests-table","md:px-8"],[1,"truncate","whitespace-nowrap"],[1,"flex","flex-col","items-end"],[1,"text-center","truncate"],[1,"flex","items-center","mr-4","text-center","truncate","delay-100","rounded-full","h-7","lock","dark:bg-white","dark:bg-opacity-5",3,"matTooltip","ngClass"],[1,"w-full","text-center"],[1,"flex","flex-row","justify-end","gap-2"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click","disabled"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click","matTooltip"],[3,"selectedRequest"],[3,"reject","isQuotationCreated","selectedRequest"],[3,"ngTemplateOutlet"],[1,"flex","self-end","justify-around","w-7/12","h-10","pr-6","mb-3","mt-7","md:mt-10","md:mb-5","md:w-7/12","lg:w-6/12","xl:w-5/12"],[1,"flex","items-center","justify-center","h-full","mr-1","transition-all","ease-in-out","delay-100","border-0","rounded-full","text-amber-700","bg-amber-50","w-36","hover:bg-amber-500","hover:text-amber-50",3,"click","ngClass"],[1,"hidden","ml-2","mr-1","text-lg","md:block"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-amber-500","md:hidden"],[1,"flex","items-center","justify-center","h-full","mr-1","text-blue-700","transition-all","ease-in-out","delay-100","border-0","rounded-full","bg-blue-50","w-36","hover:bg-blue-500","hover:text-blue-50",3,"click","ngClass"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-blue-500","md:hidden"],[1,"flex","items-center","justify-center","h-full","text-red-700","transition-all","ease-in-out","bg-red-100","border-0","rounded-full","delay-50","w-36","hover:bg-red-500","hover:text-red-50",3,"click","ngClass"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-red-500","md:hidden"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(o,i){if(1&o&&(t.DNE(0,Eo,31,7,"div",2),t.nI1(1,"async")),2&o){let a;t.vxM(0,(a=t.bMT(1,1,i.requests$))?0:-1,a)}},dependencies:[u.Jj,u.oe,x.Hl,x.$z,p.rl,h.m_,h.An,v.fS,v.fg,p.JW,k.Ou,k.iy,F.NQ,F.B4,F.aE,H.uc,H.oV,nt.uv,u.YU,ao,s.X1,s.me,s.BC,s.l_,I.Wk],encapsulation:2,data:{animation:U.X},changeDetection:0})}return n})();var te=l(48874);let Go=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["selling-orders"]],standalone:!0,features:[t.aNF],decls:1,vars:0,template:function(o,i){1&o&&t.nrm(0,"router-outlet")},dependencies:[I.n3],encapsulation:2})}return n})();var it=l(53473);const Do=it.J1`
    query FindAllOrders($offset: Int, $limit: Int, $sort: String, $order: Order, $search: String) {
        findAllOrders(offset: $offset, limit: $limit, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }
            orders {
                id

                currencyId
                currency {
                    iso
                }

                merchantId
                merchant {
                    name
                }

                clientId
                client {
                    fullname
                }

                beneficiaryId
                beneficiary {
                    idNumber
                    fullname
                    email
                    phone
                    address
                    state
                    city
                }

                paymentMethodId
                paymentMethod {
                    name
                }

                products {
                    productId
                    quantity
                }

                productsInOrder {
                    id
                    name
                    price
                    thumbnail
                }

                canceled
                canceledAt
                cancelObs
                changeStatusAt
                createdAt
                delivered
                deliveredAt
                discount
                no
                obs
                orderType
                payed
                payedAt
                paymentStatus
                ready
                readyAt
                shipped
                shippedAt
                shippingCost
                shippingWay
                status
                subtotal
                tax
                total
                tracking
                volume
                weight

            }
        }
    }
`,To=it.J1`
    query FindOrdersByMerchant($offset: Int, $limit: Int, $sort: String, $order: Order, $search: String) {
        findOrdersByMerchant(offset: $offset, limit: $limit, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            orders {
                id

                currencyId
                currency {
                    iso
                }

                merchantId
                merchant {
                    name
                }

                clientId
                client {
                    fullname
                }

                beneficiaryId
                beneficiary {
                    idNumber
                    fullname
                    email
                    phone
                    address
                    state
                    city
                }

                paymentMethodId
                paymentMethod {
                    name
                }

                products {
                    productId
                    quantity
                }

                productsInOrder {
                    id
                    name
                    price
                    thumbnail
                }

                canceled
                canceledAt
                cancelObs
                changeStatusAt
                createdAt
                delivered
                deliveredAt
                discount
                no
                obs
                orderType
                payed
                payedAt
                paymentStatus
                ready
                readyAt
                shipped
                shippedAt
                shippingCost
                shippingWay
                status
                subtotal
                tax
                total
                tracking
                volume
                weight

            }
        }
    }
`,wo=it.J1`
    query FindOrderById($findOrderByIdId: String!) {
        findOrderById(id: $findOrderByIdId) {
            ok
            message

            order {
                id

                currencyId
                currency {
                    iso
                }

                merchantId
                merchant {
                    name
                    address
                    state
                    city
                    nit
                    website
                }

                clientId
                client {
                    fullname
                    idNumber
                    address
                    state
                    city
                    email
                    phone
                }

                beneficiaryId
                beneficiary {
                    idNumber
                    fullname
                    email
                    phone
                    address
                    state
                    city
                }

                paymentMethodId
                paymentMethod {
                    name
                }

                products {
                    productId
                    quantity
                }

                productsInOrder {
                    id
                    name
                    description
                    price
                    thumbnail
                }

                canceled
                canceledAt
                cancelObs
                changeStatusAt
                createdAt
                delivered
                deliveredAt
                discount
                no
                obs
                orderType
                payed
                payedAt
                paymentStatus
                ready
                readyAt
                shipped
                shippedAt
                shippingCost
                shippingWay
                status
                subtotal
                tax
                total
                tracking
                volume
                weight

            }
        }
    }
`,Ao=it.J1`
    mutation UpdateOrder($updateOrderInput: UpdateOrderInput!) {
        updateOrder(updateOrderInput: $updateOrderInput) {

            ok
            message

            order {
                id

                currencyId
                currency {
                    iso
                }

                merchantId
                merchant {
                    name
                }

                clientId
                client {
                    fullname
                }

                beneficiaryId
                beneficiary {
                    idNumber
                    fullname
                    email
                    phone
                    address
                    state
                    city
                }

                paymentMethodId
                paymentMethod {
                    name
                }

                products {
                    productId
                    quantity
                }

                productsInOrder {
                    id
                    name
                    price
                    thumbnail
                }

                canceled
                canceledAt
                cancelObs
                changeStatusAt
                createdAt
                delivered
                deliveredAt
                discount
                no
                obs
                orderType
                payed
                payedAt
                paymentStatus
                ready
                readyAt
                shipped
                shippedAt
                shippingCost
                shippingWay
                status
                subtotal
                tax
                total
                tracking
                volume
                weight
            }
        }
    }
`,So=it.J1`
    mutation UpdateOrderStatus($updateOrderStatusInput: UpdateOrderStatusInput!) {
        updateOrderStatus(updateOrderStatusInput: $updateOrderStatusInput) {
            ok
            message

            order {
                id

                currencyId
                currency {
                    iso
                }

                merchantId
                merchant {
                    name
                }

                clientId
                client {
                    fullname
                }

                beneficiaryId
                beneficiary {
                    idNumber
                    fullname
                    email
                    phone
                    address
                    state
                    city
                }

                paymentMethodId
                paymentMethod {
                    name
                }

                products {
                    productId
                    quantity
                }

                productsInOrder {
                    id
                    name
                    price
                    thumbnail
                }

                canceled
                canceledAt
                cancelObs
                changeStatusAt
                createdAt
                delivered
                deliveredAt
                discount
                no
                obs
                orderType
                payed
                payedAt
                paymentStatus
                ready
                readyAt
                shipped
                shippedAt
                shippingCost
                shippingWay
                status
                subtotal
                tax
                total
                tracking
                volume
                weight
            }
        }
    }
`;var st=l(88141),ee=l(96697),ne=l(67376),K=l(31897),oe=l(98216);const qt=n=>n.orders,Po=(0,S.Mz)(qt,n=>n.order),Yt=(0,S.Mz)(qt,n=>n.orders);(0,S.Mz)(qt,n=>n.ordersByWeekdayStats);let Xt=(()=>{class n{constructor(e,o,i){this.apolloProvider=e,this._snackBar=o,this.store=i,this._apollo=this.apolloProvider.use("BALANC")}getOrders(e=1,o=10,i="name",a="asc",d=""){return this._apollo.query({query:Do,errorPolicy:"all",variables:{offset:o*(e-1),limit:o,sort:i,order:a,search:d}}).pipe((0,st.M)(({errors:b,data:D})=>{if(b){let L="";b.forEach(Lt=>L+=`\n ${Lt.message}.`),this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:L,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,K.cU)({orders:D.findAllOrders.orders})),this.store.dispatch((0,oe.Bp)({pagination:D.findAllOrders.pagination}))}))}getOrdersByMerchant(e=1,o=10,i="name",a="asc",d=""){return this._apollo.query({query:To,errorPolicy:"all",variables:{offset:o*(e-1),limit:o,sort:i,order:a,search:d}}).pipe((0,st.M)(({errors:b,data:D})=>{if(b){let L="";b.forEach(Lt=>L+=`\n ${Lt.message}.`),this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:L,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,K.cU)({orders:D.findOrdersByMerchant.orders})),this.store.dispatch((0,oe.Bp)({pagination:D.findOrdersByMerchant.pagination}))}))}getOrderById(e){return this._apollo.query({query:wo,variables:{findOrderByIdId:e},errorPolicy:"all"}).pipe((0,st.M)(({errors:o,data:i})=>{if(o){let a="";o.forEach(d=>a+=`\n ${d.message}.`),this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:a,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,K.lw)({order:i.findOrderById.order}))}))}updateOrder(e){return this.store.select(Yt).pipe((0,ee.s)(1),(0,A.n)(o=>this._apollo.mutate({mutation:Ao,variables:{updateOrderInput:e},errorPolicy:"all"}).pipe((0,st.M)(({errors:i,data:a})=>{if(i){let D="";i.forEach(L=>D+=`\n ${L.message}.`),this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:D,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const d=(0,ne.cloneDeep)(o);d[o.findIndex(D=>D.id==D.id)]=a.updateOrder.order,this.store.dispatch((0,K.cU)({orders:d})),this.store.dispatch((0,K.lw)({order:a.updateOrder.order}))}))))}updateOrderStatus(e){return this.store.select(Yt).pipe((0,ee.s)(1),(0,A.n)(o=>this._apollo.mutate({mutation:So,variables:{updateOrderStatusInput:e},errorPolicy:"all"}).pipe((0,st.M)(({errors:i,data:a})=>{if(i){let D="";i.forEach(L=>D+=`\n ${L.message}.`),this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:D,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const d=(0,ne.cloneDeep)(o);d[o.findIndex(D=>D.id==D.id)]=a.updateOrderStatus.order,this.store.dispatch((0,K.cU)({orders:d})),this.store.dispatch((0,K.lw)({order:a.updateOrderStatus.order}))}))))}static#t=this.\u0275fac=function(o){return new(o||n)(t.KVO(it.Ic),t.KVO(X.UG),t.KVO(S.il))};static#e=this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Bo=(()=>{class n{constructor(e){this._ordersService=e}resolve(e,o){const i=e.paramMap.get("orderId");if(null!==i)return this._ordersService.getOrderById(i)}static#t=this.\u0275fac=function(o){return new(o||n)(t.KVO(Xt))};static#e=this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),No=(()=>{class n{constructor(e){this._ordersService=e}resolve(e,o){return this._ordersService.getOrdersByMerchant()}static#t=this.\u0275fac=function(o){return new(o||n)(t.KVO(Xt))};static#e=this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Oo=l(9183),Mo=l(68824);const qo=["htmlOrderList"],Yo=n=>({"pointer-events-none":n}),Xo=()=>[5,10,25,100],Lo=(n,r,e,o,i,a)=>({"bg-pink-200 text-pink-800 dark:bg-pink-600 dark:text-pink-50":n,"bg-teal-200 text-teal-800 dark:bg-teal-600 dark:text-teal-50":r,"bg-orange-200 text-orange-800 dark:bg-orange-600 dark:text-orange-50":e,"bg-yellow-200 text-yellow-800 dark:bg-yellow-600 dark:text-yellow-50":o,"bg-green-200 text-green-800 dark:bg-green-600 dark:text-green-50":i,"bg-red-200 text-red-800 dark:bg-red-600 dark:text-red-50":a}),Vo=n=>["/modules/commercial/orders/invoice/",n];function zo(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",28)(1,"div",29),t.EFF(2),t.k0s(),t.j41(3,"div",30),t.EFF(4),t.nI1(5,"date"),t.k0s(),t.j41(6,"div",31),t.EFF(7),t.k0s(),t.j41(8,"div",31),t.EFF(9),t.k0s(),t.j41(10,"div",25),t.EFF(11),t.nI1(12,"number"),t.k0s(),t.j41(13,"div",32)(14,"span",33)(15,"span",34),t.EFF(16),t.k0s()()(),t.j41(17,"div",35)(18,"button",36),t.nrm(19,"mat-icon",37),t.k0s(),t.j41(20,"button",38),t.nrm(21,"mat-icon",37),t.k0s(),t.j41(22,"mat-menu",39,0)(24,"button",40),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(4);return t.Njj(a.updatedOrderStatus(i.id,"pagada"))}),t.j41(25,"span"),t.EFF(26,"Pagada"),t.k0s()(),t.j41(27,"button",40),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(4);return t.Njj(a.updatedOrderStatus(i.id,"procesando"))}),t.j41(28,"span"),t.EFF(29,"Procesando"),t.k0s()(),t.j41(30,"button",40),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(4);return t.Njj(a.updatedOrderStatus(i.id,"lista"))}),t.j41(31,"span"),t.EFF(32,"Lista"),t.k0s()(),t.j41(33,"button",40),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(4);return t.Njj(a.updatedOrderStatus(i.id,"enviada"))}),t.j41(34,"span"),t.EFF(35,"Enviada"),t.k0s()(),t.j41(36,"button",40),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(4);return t.Njj(a.updatedOrderStatus(i.id,"entregada"))}),t.j41(37,"span"),t.EFF(38,"Entregada"),t.k0s()(),t.j41(39,"button",40),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(4);return t.Njj(a.updatedOrderStatus(i.id,"cancelada"))}),t.j41(40,"span"),t.EFF(41,"Cancelada"),t.k0s()()()()()}if(2&n){const e=r.$implicit,o=t.sdS(23);t.R7$(2),t.SpI(" ",e.no," "),t.R7$(2),t.SpI(" ",t.i5U(5,17,e.createdAt,"shortDate")," "),t.R7$(3),t.SpI(" ",e.client.fullname," "),t.R7$(2),t.SpI(" ",e.beneficiary.fullname," "),t.R7$(2),t.SpI(" $ ",t.i5U(12,20,e.total,"1.2-2")," "),t.R7$(3),t.Y8G("ngClass",t.l4e(23,Lo,"nueva"===e.status,"procesando"===e.status,"lista"===e.status,"enviada"===e.status,"entregada"===e.status,"cancelada"===e.status)),t.R7$(2),t.JRh(e.status),t.R7$(2),t.Y8G("routerLink",t.eq3(30,Vo,e.id)),t.R7$(),t.Y8G("svgIcon","mat_solid:description"),t.R7$(),t.Y8G("matMenuTriggerFor",o),t.R7$(),t.Y8G("svgIcon","mat_solid:drag_indicator"),t.R7$(3),t.Y8G("disabled",e.payed||e.canceled),t.R7$(3),t.Y8G("disabled",e.ready||e.shipped||e.delivered||e.delivered||e.canceled),t.R7$(3),t.Y8G("disabled",e.shipped||e.delivered||e.canceled),t.R7$(3),t.Y8G("disabled",e.delivered||e.canceled),t.R7$(3),t.Y8G("disabled",e.canceled),t.R7$(3),t.Y8G("disabled",e.delivered||e.canceled)}}function Qo(n,r){1&n&&t.Z7z(0,zo,42,32,"div",28,t.BUC().trackByFn,!0),2&n&&t.Dyx(r)}function Uo(n,r){if(1&n&&(t.j41(0,"div",20)(1,"div",21)(2,"div",22),t.EFF(3," N\xfamero "),t.k0s(),t.j41(4,"div",23),t.EFF(5," Fecha "),t.k0s(),t.j41(6,"div",24),t.EFF(7," Cliente "),t.k0s(),t.j41(8,"div",24),t.EFF(9," Beneficiario "),t.k0s(),t.j41(10,"div",25),t.EFF(11," Importe "),t.k0s(),t.j41(12,"div",23),t.EFF(13," Estado "),t.k0s(),t.j41(14,"div",26),t.EFF(15," Acciones "),t.k0s()(),t.DNE(16,Qo,2,0),t.nI1(17,"async"),t.k0s(),t.nrm(18,"mat-paginator",27)),2&n){let e;const o=t.XpG(2);t.R7$(2),t.Y8G("mat-sort-header","orderNo"),t.R7$(14),t.vxM(16,(e=t.bMT(17,8,o.orders$))?16:-1,e),t.R7$(2),t.Y8G("ngClass",t.eq3(10,Yo,o.isLoading))("length",o.pagination.length)("pageIndex",o.pagination.page)("pageSize",o.pagination.size)("pageSizeOptions",t.lJ4(12,Xo))("showFirstLastButtons",!0)}}function Jo(n,r){1&n&&(t.j41(0,"div",41),t.EFF(1,"\xa1No se ha generado ninguna orden!"),t.k0s())}function Ho(n,r){1&n&&t.DNE(0,Uo,19,13)(1,Jo,2,0),2&n&&t.vxM(0,r.length>0?0:1)}function Zo(n,r){if(1&n&&(t.j41(0,"div")(1,"div",8)(2,"div",9)(3,"a",10),t.EFF(4,"Inicio"),t.k0s()(),t.j41(5,"div",9),t.nrm(6,"mat-icon",11),t.j41(7,"a",10),t.EFF(8,"Ventas"),t.k0s()(),t.j41(9,"div",9),t.nrm(10,"mat-icon",11),t.j41(11,"a",10),t.EFF(12,"\xd3rdenes"),t.k0s()(),t.j41(13,"div",9),t.nrm(14,"mat-icon",11),t.j41(15,"a",12),t.EFF(16),t.k0s()(),t.j41(17,"div",13)(18,"a",14),t.nrm(19,"mat-icon",11),t.j41(20,"span",15),t.EFF(21,"Regresar"),t.k0s()()()()(),t.j41(22,"div",16)(23,"h2",17),t.EFF(24),t.k0s()()),2&n){const e=r;t.R7$(3),t.Y8G("routerLink","/home"),t.R7$(3),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(),t.Y8G("routerLink","/selling/panels"),t.R7$(3),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(),t.Y8G("routerLink","/selling/panels/orders"),t.R7$(3),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(2),t.JRh(e.no),t.R7$(2),t.Y8G("routerLink","./.."),t.R7$(),t.Y8G("svgIcon","mat_solid:chevron_left"),t.R7$(5),t.SpI(" Orden ",e.no," ")}}function Ko(n,r){if(1&n&&(t.nrm(0,"div",51),t.j41(1,"div",52)(2,"div",53),t.EFF(3),t.k0s(),t.j41(4,"div",54),t.EFF(5),t.k0s()(),t.j41(6,"div",55),t.EFF(7),t.k0s(),t.j41(8,"div",56),t.EFF(9),t.nI1(10,"currency"),t.k0s(),t.j41(11,"div",57),t.EFF(12),t.nI1(13,"currency"),t.k0s()),2&n){const e=r.$implicit,o=t.XpG(2),i=t.XpG();t.R7$(3),t.JRh(e.name),t.R7$(2),t.SpI(" ",e.description," "),t.R7$(2),t.JRh(i.getProductQty(e.id,o.products)),t.R7$(2),t.SpI("",t.brH(10,5,e.price,o.currency.iso+" ","symbol")," "),t.R7$(3),t.JRh(t.brH(13,9,i.getProductQty(e.id,o.products)*e.price,o.currency.iso+" ","symbol"))}}function ti(n,r){if(1&n&&(t.j41(0,"div",18)(1,"div",19)(2,"div",20)(3,"div",21)(4,"div",22),t.nrm(5,"img",23),t.k0s(),t.j41(6,"div",24)(7,"div",25),t.EFF(8),t.k0s(),t.j41(9,"div"),t.EFF(10),t.k0s(),t.j41(11,"div"),t.EFF(12),t.k0s(),t.j41(13,"div"),t.EFF(14),t.k0s(),t.j41(15,"div"),t.EFF(16),t.k0s(),t.j41(17,"div"),t.EFF(18),t.k0s()()()(),t.j41(19,"div",26)(20,"div",27),t.EFF(21,"FACTURA "),t.k0s(),t.j41(22,"div",28),t.EFF(23),t.k0s(),t.j41(24,"div",29),t.EFF(25,"FECHA"),t.k0s(),t.j41(26,"div",25),t.EFF(27),t.nI1(28,"date"),t.k0s(),t.j41(29,"div",29),t.EFF(30,"VENCIMIENTO"),t.k0s(),t.j41(31,"div",25),t.EFF(32),t.nI1(33,"date"),t.k0s(),t.j41(34,"div",29),t.EFF(35,"TOTAL"),t.k0s(),t.j41(36,"div",25),t.EFF(37),t.nI1(38,"currency"),t.k0s(),t.j41(39,"div",29),t.EFF(40,"ESTADO"),t.k0s(),t.j41(41,"div",25),t.EFF(42),t.k0s()()(),t.j41(43,"table",30)(44,"thead")(45,"tr")(46,"th",31),t.EFF(47,"CLIENTE"),t.k0s(),t.j41(48,"th",32),t.EFF(49,"BENEFICIARIO"),t.k0s()()(),t.j41(50,"tbody")(51,"tr")(52,"td",33)(53,"div",34)(54,"div",25),t.EFF(55),t.k0s(),t.j41(56,"div"),t.EFF(57),t.k0s(),t.j41(58,"div"),t.EFF(59),t.k0s(),t.j41(60,"div"),t.EFF(61),t.k0s(),t.j41(62,"div"),t.EFF(63),t.k0s(),t.j41(64,"div"),t.EFF(65),t.k0s()()(),t.j41(66,"td")(67,"div",35)(68,"div",25),t.EFF(69),t.k0s(),t.j41(70,"div"),t.EFF(71),t.k0s(),t.j41(72,"div"),t.EFF(73),t.k0s(),t.j41(74,"div"),t.EFF(75),t.k0s(),t.j41(76,"div"),t.EFF(77),t.k0s(),t.j41(78,"div"),t.EFF(79),t.k0s()()()()()(),t.j41(80,"div",36)(81,"div",37),t.EFF(82,"PRODUCTO"),t.k0s(),t.j41(83,"div",38),t.EFF(84,"CANTIDAD"),t.k0s(),t.j41(85,"div",39),t.EFF(86,"PRECIO"),t.k0s(),t.j41(87,"div",40),t.EFF(88,"TOTAL"),t.k0s(),t.Z7z(89,Ko,14,13,null,null,t.fX1),t.nrm(91,"div",41),t.j41(92,"div",42),t.EFF(93,"SUBTOTAL"),t.k0s(),t.j41(94,"div",43),t.EFF(95),t.nI1(96,"currency"),t.k0s(),t.nrm(97,"div",44),t.j41(98,"div",42),t.EFF(99,"DESCUENTO"),t.k0s(),t.j41(100,"div",43),t.EFF(101),t.nI1(102,"currency"),t.k0s(),t.nrm(103,"div",44),t.j41(104,"div",42),t.EFF(105,"Recargo"),t.k0s(),t.j41(106,"div",43),t.EFF(107),t.nI1(108,"currency"),t.k0s(),t.nrm(109,"div",44),t.j41(110,"div",42),t.EFF(111,"ENV\xcdO"),t.k0s(),t.j41(112,"div",43),t.EFF(113),t.nI1(114,"currency"),t.k0s(),t.nrm(115,"div",44),t.j41(116,"div",45),t.EFF(117,"TOTAL "),t.k0s(),t.j41(118,"div",46),t.EFF(119),t.nI1(120,"currency"),t.k0s()(),t.j41(121,"div",47)(122,"div",25),t.EFF(123,"\xa1Muchas gracias por su compra!"),t.k0s(),t.j41(124,"div",48),t.nrm(125,"img",49),t.j41(126,"div",50),t.EFF(127,' "La devoluci\xf3n de los fondos depende de la pol\xedtica de devoluciones del vendedor y no es responsabilidad de la empresa que facilita la plataforma de comercio electr\xf3nico." '),t.k0s()()()()),2&n){const e=t.XpG();t.R7$(8),t.JRh(e.merchant.name),t.R7$(2),t.JRh(e.merchant.address),t.R7$(2),t.Lme("provincia ",e.merchant.state,", municipio ",e.merchant.city,""),t.R7$(2),t.JRh(e.merchant.phone),t.R7$(2),t.JRh(e.merchant.email),t.R7$(2),t.JRh(e.merchant.website),t.R7$(5),t.JRh(e.no),t.R7$(4),t.JRh(t.i5U(28,31,e.createdAt,"dd/MM/yyyy")),t.R7$(5),t.JRh(t.i5U(33,34,e.createdAt,"dd/MM/yyyy")),t.R7$(5),t.JRh(t.brH(38,37,e.total,e.currency.iso+" ","symbol")),t.R7$(5),t.JRh(e.status),t.R7$(13),t.SpI("",e.client.fullname," "),t.R7$(2),t.SpI("ID: ",e.client.idNumber,""),t.R7$(2),t.SpI("Direcci\xf3n: ",e.client.address,""),t.R7$(2),t.Lme("Estado: ",e.client.state,", Ciudad: ",e.client.city,""),t.R7$(2),t.SpI("Tel.: ",e.client.cell,""),t.R7$(2),t.SpI("Correo electr\xf3nico: ",e.client.email,""),t.R7$(4),t.JRh(e.beneficiary.fullname),t.R7$(2),t.SpI("ID: ",e.beneficiary.idNumber,""),t.R7$(2),t.SpI("Direcci\xf3n: ",e.beneficiary.address,""),t.R7$(2),t.Lme("Provincia: ",e.beneficiary.state,", Municipio: ",e.beneficiary.city," "),t.R7$(2),t.SpI("Tel.: ",e.beneficiary.phone,""),t.R7$(2),t.SpI("Correo electr\xf3nico: ",e.beneficiary.email,""),t.R7$(10),t.Dyx(e.productsInOrder),t.R7$(6),t.SpI("",t.brH(96,41,e.subtotal,e.currency.iso+" ","symbol")," "),t.R7$(6),t.SpI("",t.brH(102,45,e.discount,e.currency.iso+" ","symbol")," "),t.R7$(6),t.JRh(t.brH(108,49,e.tax,e.currency.iso+" ","symbol")),t.R7$(6),t.SpI("",t.brH(114,53,e.shippingCost,e.currency.iso+" ","symbol")," "),t.R7$(6),t.SpI("",t.brH(120,57,e.total,e.currency.iso+" ","symbol")," ")}}function ei(n,r){1&n&&t.DNE(0,ti,128,61,"div",18),2&n&&t.vxM(0,null!==r?0:-1)}const oi=[{path:"",component:q},{path:"request",component:$o,resolve:{requests:te.R}},{path:"request/:requestId",component:bn,resolve:{request:te.K}},{path:"payment-conditions",component:Be,resolve:{paymentMethod:Ne}},{path:"quotations",component:gn,resolve:{quotations:Ht.G}},{path:"quotations/:quotationId",component:Ye,resolve:{quotation:Ht.z}},{path:"invoices",component:Nt,resolve:{quotations:dt.R}},{path:"invoices/:invoiceId",component:T,resolve:{quotation:dt.M}},{path:"orders",component:Go,resolve:{orders:No},children:[{path:"",component:(()=>{class n{constructor(e,o,i,a,d,b){this._changeDetectorRef=e,this._fileSaverService=o,this._ordersService=i,this._router=a,this._snackBar=d,this.store=b,this.alertTitle=null,this.canceled=!1,this.delivered=!1,this.isLoading=!1,this.order=null,this.orders=[],this.orders$=(0,$.of)([]),this.payed=!1,this.ready=!1,this.roles=[],this.searchInputControl=new s.MJ,this.selectedOrder=null,this.shipped=!1,this._unsubscribeAll=new E.B}ngOnInit(){this.store.select(Q.Dz).pipe((0,f.Q)(this._unsubscribeAll)).subscribe(e=>{this.pagination=e,this._changeDetectorRef.markForCheck()}),this.orders$=this.store.select(Yt),this.orders$.subscribe(e=>this.orders=e),this.store.select(Q.Dz).pipe((0,f.Q)(this._unsubscribeAll)).subscribe(e=>{this.pagination=e,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,f.Q)(this._unsubscribeAll),(0,Y.B)(900),(0,A.n)(e=>this._ordersService.getOrders(0,10,"orderNo","asc",e))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,f.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0,this.closeDetails()}),(0,z.h)(this._sort.sortChange,this._paginator.page).pipe((0,A.n)(()=>(this.closeDetails(),this._ordersService.getOrders(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction)))).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDetails(){this.selectedOrder=null}exportAsExcelFile(){this._fileSaverService.exportAsExcelFile(this.orders,"orders")}exportAsCsvFile(){this._fileSaverService.exportAsCsvFile(this.orders,"orders")}updatedOrderStatus(e,o){this._ordersService.updateOrderStatus({id:e,status:o}).pipe((0,f.Q)(this._unsubscribeAll)).subscribe(({data:i})=>{this._snackBar.openFromComponent(w.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:i.updateOrderStatus.message,type:"success",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()})}viewPurchaseOrder(e){this._router.navigateByUrl(`/modules/commercial/orders/invoice/${e}`)}trackByFn(e,o){return o.id||e}static#t=this.\u0275fac=function(o){return new(o||n)(t.rXU(t.gRc),t.rXU(Mo.f),t.rXU(Xt),t.rXU(I.Ix),t.rXU(X.UG),t.rXU(S.il))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["selling-orders-list"]],viewQuery:function(o,i){if(1&o&&(t.GBs(qo,5),t.GBs(k.iy,5),t.GBs(F.B4,5)),2&o){let a;t.mGM(a=t.lsd())&&(i.htmlOrderList=a.first),t.mGM(a=t.lsd())&&(i._paginator=a.first),t.mGM(a=t.lsd())&&(i._sort=a.first)}},standalone:!0,features:[t.aNF],decls:32,vars:13,consts:[["orderMenu","matMenu"],[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"flex","flex-col","flex-wrap","p-6","py-8","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:px-10","bg-mine-50","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"ml-1","text-primary-700",3,"routerLink"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-700"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"text-2xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:overflow-y-auto","sm:mb-18"],[1,"grid","overflow-auto"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","orders-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"",3,"mat-sort-header"],[1,"text-center","md:block"],[1,"xl:block"],[1,"text-right","sm:block"],[1,"text-center"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","orders-grid","md:px-8"],[1,""],[1,"text-center","truncate","md:block"],[1,"truncate","xl:block"],[1,"flex","items-center","justify-center"],[1,"inline-flex","items-center","font-bold","text-xs","px-2.5","py-0.5","rounded-full","tracking-wide","uppercase",3,"ngClass"],[1,"leading-relaxed","whitespace-nowrap"],[1,"flex","flex-row","items-center","justify-center","gap-1"],["mat-stroked-button","","matTooltip","Ver orden",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","","aria-label","Estados de la orden",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matMenuTriggerFor"],["xPosition","before"],["mat-menu-item","",3,"click","disabled"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(o,i){if(1&o&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"div",4)(5,"div",5)(6,"a",6),t.EFF(7,"Inicio"),t.k0s()(),t.j41(8,"div",5),t.nrm(9,"mat-icon",7),t.j41(10,"a",6),t.EFF(11,"Ventas"),t.k0s()(),t.j41(12,"div",5),t.nrm(13,"mat-icon",7),t.j41(14,"a",8),t.EFF(15,"\xd3rdenes"),t.k0s()(),t.j41(16,"div",9)(17,"a",10),t.nrm(18,"mat-icon",7),t.j41(19,"span",11),t.EFF(20,"Regresar"),t.k0s()()()()(),t.j41(21,"div",12)(22,"h2",13),t.EFF(23," Listado de \xf3rdenes "),t.k0s()()(),t.j41(24,"div",14)(25,"mat-form-field",15),t.nrm(26,"mat-icon",16)(27,"input",17),t.k0s()()(),t.j41(28,"div",18)(29,"div",19),t.DNE(30,Ho,2,1),t.nI1(31,"async"),t.k0s()()()),2&o){let a;t.R7$(6),t.Y8G("routerLink","/home"),t.R7$(3),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(),t.Y8G("routerLink","/selling/panels"),t.R7$(3),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("routerLink","./.."),t.R7$(),t.Y8G("svgIcon","mat_solid:chevron_left"),t.R7$(8),t.Y8G("svgIcon","mat_solid:search"),t.R7$(),t.Y8G("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Buscar \xf3rdenes"),t.R7$(3),t.vxM(30,(a=t.bMT(31,11,i.orders$))?30:-1,a)}},dependencies:[u.Jj,u.vh,u.QX,x.Hl,x.$z,p.RG,p.rl,p.JW,h.m_,h.An,v.fS,v.fg,j.Cn,j.kk,j.fb,j.Cp,k.Ou,k.iy,Oo.D6,R.mV,F.NQ,F.B4,F.aE,u.YU,s.X1,s.me,s.BC,s.l_,I.Wk],styles:[".orders-grid{grid-template-columns:75px 75px 180px 180px 150px 150px auto}\n"],encapsulation:2,data:{animation:U.X},changeDetection:0})}return n})()},{path:"invoice/:orderId",component:(()=>{class n{constructor(e,o,i,a){this._activatedRoute=e,this._changeDetectorRef=o,this._router=i,this.store=a,this.order$=(0,$.of)(null),this._unsubscribeAll=new E.B}ngOnInit(){this.order$=this.store.select(Po)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}printDocument(){window.print()}getProductQty(e,o){return o.find(i=>i.productId===e).quantity}static#t=this.\u0275fac=function(o){return new(o||n)(t.rXU(I.nX),t.rXU(t.gRc),t.rXU(I.Ix),t.rXU(S.il))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["selling-invoice"]],standalone:!0,features:[t.aNF],decls:13,vars:7,consts:[["cdkScrollable","",1,"absolute","inset-0","min-w-0","overflow-auto","text-center","print:overflow-visible"],[1,"flex","flex-col","flex-wrap","p-6","py-8","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:px-10","bg-mine-50","dark:bg-transparent","print:hidden"],[1,"flex-1","min-w-0"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],["mat-raised-button","","mat-button","",1,"ml-4","text-white","bg-primary-500",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"inline-block","p-6","text-left","sm:p-10","print:p-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"ml-1","text-primary-700",3,"routerLink"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-700"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","text-left","truncate","md:text-4xl","sm:leading-10"],[1,"p-16","shadow","w-240","min-w-240","rounded-2xl","bg-card","print:w-auto","print:p-0","print:rounded-none","print:shadow-none","print:bg-transparent"],[1,"flex","items-start"],[1,"grid","place-items-start"],[1,"grid","grid-flow-col","auto-cols-max","gap-x-8"],[1,"w-24","place-self-center"],["src","assets/images/logo/logo.svg",1,"w-24"],[1,"pl-10","border-l","text-md"],[1,"font-medium"],[1,"grid","grid-cols-2","ml-auto","gap-x-4","gap-y-1"],[1,"text-2xl","font-medium","tracking-tight","justify-self-end","text-secondary"],[1,"text-2xl","font-medium"],[1,"font-medium","tracking-tight","justify-self-end","text-secondary"],[1,"w-full","mt-10"],[1,"px-10"],[1,"pl-10"],[1,"border-r"],[1,"flex","flex-col","px-10","text-md"],[1,"flex","flex-col","pl-10","text-md"],[1,"grid","grid-cols-12","mt-16","gap-x-1"],[1,"col-span-6","font-medium","text-md","text-secondary"],[1,"font-medium","text-right","text-md","text-secondary"],[1,"col-span-2","font-medium","text-right","text-md","text-secondary"],[1,"col-span-3","font-medium","text-right","text-md","text-secondary"],[1,"col-span-12","mt-16"],[1,"self-center","col-span-10","font-medium","tracking-tight","text-secondary"],[1,"col-span-2","text-lg","text-right"],[1,"col-span-12","my-3","border-b"],[1,"self-center","col-span-10","text-2xl","font-medium","tracking-tight","text-secondary"],[1,"col-span-2","text-2xl","font-medium","text-right"],[1,"mt-16"],[1,"flex","items-start","mt-4"],["src","assets/images/logo/logo.svg",1,"w-10","mt-2","flex-0"],[1,"ml-6","text-sm","text-secondary"],[1,"col-span-12","my-4","border-b"],[1,"col-span-6"],[1,"text-lg","font-medium"],[1,"mt-2","text-md","text-secondary"],[1,"self-center","text-right"],[1,"self-center","col-span-2","text-right"],[1,"self-center","col-span-3","text-right"]],template:function(o,i){if(1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.DNE(3,Zo,25,10),t.nI1(4,"async"),t.k0s(),t.j41(5,"div",3)(6,"button",4),t.bIt("click",function(){return i.printDocument()}),t.nrm(7,"mat-icon",5),t.j41(8,"span",6),t.EFF(9,"Imprimir"),t.k0s()()()(),t.j41(10,"div",7),t.DNE(11,ei,1,1),t.nI1(12,"async"),t.k0s()()),2&o){let a,d;t.R7$(3),t.vxM(3,(a=t.bMT(4,3,i.order$))?3:-1,a),t.R7$(4),t.Y8G("svgIcon","mat_solid:print"),t.R7$(4),t.vxM(11,(d=t.bMT(12,5,i.order$))?11:-1,d)}},dependencies:[u.Jj,u.vh,u.oe,I.Wk,h.m_,h.An,x.Hl,x.$z],encapsulation:2,changeDetection:0})}return n})(),resolve:{order:Bo}}]}]},2578:function(tt,V){var l,f;void 0!==(f="function"==typeof(l=function(){"use strict";function t(g,C,T){var u=new XMLHttpRequest;u.open("GET",g),u.responseType="blob",u.onload=function(){h(u.response,C,T)},u.onerror=function(){console.error("could not download file")},u.send()}function I(g){var C=new XMLHttpRequest;C.open("HEAD",g,!1);try{C.send()}catch{}return 200<=C.status&&299>=C.status}function q(g){try{g.dispatchEvent(new MouseEvent("click"))}catch{var C=document.createEvent("MouseEvents");C.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),g.dispatchEvent(C)}}var P="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,x=P.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),h=P.saveAs||("object"!=typeof window||window!==P?function(){}:"download"in HTMLAnchorElement.prototype&&!x?function(g,C,T){var u=P.URL||P.webkitURL,s=document.createElement("a");s.download=C=C||g.name||"download",s.rel="noopener","string"==typeof g?(s.href=g,s.origin===location.origin?q(s):I(s.href)?t(g,C,T):q(s,s.target="_blank")):(s.href=u.createObjectURL(g),setTimeout(function(){u.revokeObjectURL(s.href)},4e4),setTimeout(function(){q(s)},0))}:"msSaveOrOpenBlob"in navigator?function(g,C,T){if(C=C||g.name||"download","string"!=typeof g)navigator.msSaveOrOpenBlob(function N(g,C){return typeof C>"u"?C={autoBom:!1}:"object"!=typeof C&&(console.warn("Deprecated: Expected third argument to be a object"),C={autoBom:!C}),C.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(g.type)?new Blob(["\ufeff",g],{type:g.type}):g}(g,T),C);else if(I(g))t(g,C,T);else{var u=document.createElement("a");u.href=g,u.target="_blank",setTimeout(function(){q(u)})}}:function(g,C,T,u){if((u=u||open("","_blank"))&&(u.document.title=u.document.body.innerText="downloading..."),"string"==typeof g)return t(g,C,T);var s="application/octet-stream"===g.type,p=/constructor/i.test(P.HTMLElement)||P.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||s&&p||x)&&typeof FileReader<"u"){var j=new FileReader;j.onloadend=function(){var $=j.result;$=v?$:$.replace(/^data:[^;]*;/,"data:attachment/file;"),u?u.location.href=$:location=$,u=null},j.readAsDataURL(g)}else{var k=P.URL||P.webkitURL,F=k.createObjectURL(g);u?u.location=F:location.href=F,u=null,setTimeout(function(){k.revokeObjectURL(F)},4e4)}});P.saveAs=h.saveAs=h,tt.exports=h})?l.apply(V,[]):l)&&(tt.exports=f)},67398:(tt,V,l)=>{"use strict";l.d(V,{A:()=>ut});const f=function E(c,m){for(var _=-1,R=null==c?0:c.length,y=Array(R);++_<R;)y[_]=m(c[_],_,c);return y};var N=l(71252),t=l(43744),I=l(45281),q=l(42661);const h=function x(c){return"symbol"==typeof c||(0,q.A)(c)&&"[object Symbol]"==(0,I.A)(c)};var g=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,C=/^\w*$/;var s=l(72291);function v(c,m){if("function"!=typeof c||null!=m&&"function"!=typeof m)throw new TypeError("Expected a function");var _=function(){var R=arguments,y=m?m.apply(this,R):R[0],G=_.cache;if(G.has(y))return G.get(y);var ot=c.apply(this,R);return _.cache=G.set(y,ot)||G,ot};return _.cache=new(v.Cache||s.A),_}v.Cache=s.A;const j=v;var z=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Y=/\\(\\)?/g;const A=function F(c){var m=j(c,function(R){return 500===_.size&&_.clear(),R}),_=m.cache;return m}(function(c){var m=[];return 46===c.charCodeAt(0)&&m.push(""),c.replace(z,function(_,R,y,G){m.push(y?G.replace(Y,"$1"):R||_)}),m});var O=l(6944),Q=O.A?O.A.prototype:void 0,U=Q?Q.toString:void 0;const w=function et(c){if("string"==typeof c)return c;if((0,t.A)(c))return f(c,et)+"";if(h(c))return U?U.call(c):"";var m=c+"";return"0"==m&&1/c==-1/0?"-0":m},at=function Vt(c){return null==c?"":w(c)},M=function H(c,m){return(0,t.A)(c)?c:function T(c,m){if((0,t.A)(c))return!1;var _=typeof c;return!("number"!=_&&"symbol"!=_&&"boolean"!=_&&null!=c&&!h(c))||C.test(c)||!g.test(c)||null!=m&&c in Object(m)}(c,m)?[c]:A(at(c))},nt=function S(c){if("string"==typeof c||h(c))return c;var m=c+"";return"0"==m&&1/c==-1/0?"-0":m},Ct=function vt(c,m){return m.length<2?c:function _t(c,m){for(var _=0,R=(m=M(m,c)).length;null!=c&&_<R;)c=c[nt(m[_++])];return _&&_==R?c:void 0}(c,function ht(c,m,_){var R=-1,y=c.length;m<0&&(m=-m>y?0:y+m),(_=_>y?y:_)<0&&(_+=y),y=m>_?0:_-m>>>0,m>>>=0;for(var G=Array(y);++R<y;)G[R]=c[R+m];return G}(m,0,-1))},xt=function bt(c,m){return m=M(m,c),null==(c=Ct(c,m))||delete c[nt(function W(c){var m=null==c?0:c.length;return m?c[m-1]:void 0}(m))]};var Ft=l(77517),kt=l(74294);const It=function yt(c){return(0,kt.A)(c)?void 0:c};var Rt=l(70563),jt=l(66513),lt=O.A?O.A.isConcatSpreadable:void 0;const $t=function Et(c){return(0,t.A)(c)||(0,jt.A)(c)||!!(lt&&c&&c[lt])},Gt=function ct(c,m,_,R,y){var G=-1,ot=c.length;for(_||(_=$t),y||(y=[]);++G<ot;){var Z=c[G];m>0&&_(Z)?m>1?ct(Z,m-1,_,R,y):(0,Rt.A)(y,Z):R||(y[y.length]=Z)}return y},Tt=function Dt(c){return null!=c&&c.length?Gt(c,1):[]};var wt=l(90178),At=l(45974);var Bt=l(57372);const ut=function St(c){return(0,At.A)((0,wt.A)(c,void 0,Tt),c+"")}(function(c,m){var _={};if(null==c)return _;var R=!1;m=f(m,function(G){return G=M(G,c),R||(R=G.length>1),G}),(0,Ft.A)(c,(0,Bt.A)(c),_),R&&(_=(0,N.A)(_,7,It));for(var y=m.length;y--;)xt(_,m[y]);return _})}}]);