"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[2050],{2050:(De,y,r)=>{r.r(y),r.d(y,{default:()=>Ee});var j=r(72831),z=r(10467),$=r(60177),x=r(88834),f=r(32102),v=r(99213),_=r(59042),F=r(96695),w=r(30450),b=r(2042),l=r(89417),R=r(51188),I=r(21413),L=r(7673),V=r(57786),d=r(56977),E=r(70152),D=r(25558),S=r(96354),Y=r(82341),U=r(87122),J=r(47413),T=r(15887),C=r(94794);class Q{clear(){this.id=null,this.name="",this.permissions=[],this.isCoreRole=!1,this.checked=!1,this.active=!1}}var e=r(54438),P=r(46601),X=r(44312),M=r(95416),A=r(59640);const O=()=>["new"];function W(i,a){if(1&i&&(e.j41(0,"div",18)(1,"mat-form-field",19),e.nrm(2,"mat-icon",20)(3,"input",21),e.k0s(),e.j41(4,"button",22),e.nrm(5,"mat-icon",23),e.j41(6,"span",24),e.EFF(7,"Nuevo"),e.k0s()()()),2&i){const t=e.XpG();e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",t.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),e.R7$(),e.Y8G("routerLink",e.lJ4(7,O)),e.R7$(),e.Y8G("svgIcon","mat_solid:add")}}const H=(i,a)=>a.id;function Z(i,a){1&i&&e.nrm(0,"div")}function K(i,a){1&i&&(e.j41(0,"span"),e.EFF(1,"Activo"),e.k0s())}function q(i,a){if(1&i){const t=e.RV6();e.j41(0,"mat-slide-toggle",40),e.bIt("change",function(n){e.eBV(t);const s=e.XpG(2),c=s.$implicit,m=s.$index,h=e.XpG(2);return e.Njj(h.updateRoleStatus(n,c,m))}),e.k0s()}if(2&i){const t=e.XpG(2).$implicit;e.Y8G("checked",t.active)("color","primary")}}function ee(i,a){1&i&&e.nrm(0,"mat-spinner",39),2&i&&e.Y8G("diameter",20)("color","primary")}function te(i,a){if(1&i&&(e.j41(0,"div",37),e.DNE(1,q,1,2,"mat-slide-toggle",38)(2,ee,1,2,"mat-spinner",39),e.k0s()),2&i){const t=e.XpG().$index,o=e.XpG(2);e.R7$(),e.vxM(1,o.isLoading&&o.selectedSlide===t?-1:1),e.R7$(),e.vxM(2,o.isLoading&&o.selectedSlide===t?2:-1)}}function ie(i,a){if(1&i){const t=e.RV6();e.qex(0),e.j41(1,"button",44),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(2);return e.Njj(s.deleteRole(n))}),e.nrm(2,"mat-icon",43),e.k0s(),e.bVm()}2&i&&(e.R7$(2),e.Y8G("svgIcon","mat_solid:delete"))}const oe=i=>[i],u=()=>["Super Administrador"];function ne(i,a){if(1&i&&(e.j41(0,"div",41)(1,"button",42),e.nrm(2,"mat-icon",43),e.k0s(),e.DNE(3,ie,3,1,"ng-container",30),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.Y8G("routerLink",e.eq3(3,oe,t.id)),e.R7$(),e.Y8G("svgIcon","mat_solid:edit"),e.R7$(),e.Y8G("ngxPermissionsExcept",e.lJ4(5,u))}}function se(i,a){if(1&i&&(e.j41(0,"div",32)(1,"div",33),e.EFF(2),e.k0s(),e.j41(3,"div",34),e.EFF(4),e.k0s(),e.DNE(5,te,3,2,"div",35)(6,ne,4,6,"div",36),e.k0s()),2&i){const t=a.$implicit;e.R7$(2),e.SpI(" ",t.name," "),e.R7$(2),e.SpI(" ",t.description," "),e.R7$(),e.Y8G("ngxPermissionsExcept",e.lJ4(4,u)),e.R7$(),e.vxM(6,t.isCoreRole?-1:6)}}function re(i,a){if(1&i&&(e.j41(0,"div",25)(1,"div",26)(2,"div",27),e.EFF(3," Nombre "),e.k0s(),e.j41(4,"div"),e.EFF(5,"Descripci\xf3n"),e.k0s(),e.j41(6,"div",28),e.DNE(7,Z,1,0,"div",29)(8,K,2,0,"span",30),e.k0s(),e.j41(9,"div",31),e.EFF(10,"Acci\xf3n"),e.k0s()(),e.Z7z(11,se,7,5,"div",45,H),e.k0s()),2&i){const t=e.XpG();e.R7$(2),e.Y8G("mat-sort-header","name"),e.R7$(4),e.Y8G("mat-sort-header","active"),e.R7$(),e.Y8G("ngxPermissionsOnly",e.lJ4(4,u)),e.R7$(),e.Y8G("ngxPermissionsExcept",e.lJ4(5,u)),e.R7$(3),e.Dyx(t.roles)}}function ae(i,a){1&i&&(e.j41(0,"div",46),e.EFF(1," \xa1A\xfan ha creado ning\xfan rol a\xfan! "),e.k0s())}const le=i=>({"pointer-events-none":i}),ce=()=>[10,25,50,100];function me(i,a){if(1&i&&e.nrm(0,"mat-paginator",47),2&i){const t=e.XpG();e.Y8G("ngClass",e.eq3(6,le,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.lJ4(8,ce))("showFirstLastButtons",!0)}}let de=(()=>{class i{constructor(t,o,n,s,c){this._changeDetectorRef=t,this._fuseConfirmationService=o,this._roleService=n,this._snackBar=s,this.store=c,this.emptyRole=new Q,this.isLoading=!1,this.selectedSlide=null,this.searchInputControl=new l.MJ,this._unsubscribeAll=new I.B,this.emptyRole.clear()}ngOnInit(){this.store.select(T.y3).pipe((0,d.Q)(this._unsubscribeAll)).subscribe(t=>{this.roles=t,this._changeDetectorRef.markForCheck()}),this.store.select(J.D).pipe((0,d.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,d.Q)(this._unsubscribeAll),(0,E.B)(300),(0,D.n)(t=>t?(this.isLoading=!0,this._roleService.findAllRoles(0,10,"name","asc",t)):(0,L.of)([])),(0,S.T)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this.waitForPaginatorLoad().then(()=>{this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,d.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,V.h)(this._sort.sortChange,this._paginator.page).pipe((0,D.n)(()=>(this.isLoading=!0,this._roleService.findAllRoles(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction))),(0,S.T)(()=>{this.isLoading=!1})).subscribe())})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}updateRoleStatus(t,o,n){this.isLoading=!0,this.selectedSlide=n,this._roleService.updateRoleStatus({id:o.id,active:t.checked}).pipe((0,d.Q)(this._unsubscribeAll)).subscribe(s=>{s&&(this._snackBar.openFromComponent(C.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.isLoading=!1,this.selectedSlide=-1,this._changeDetectorRef.markForCheck())})}deleteRole(t){this._fuseConfirmationService.open({title:"Eliminar rol",message:`\xbfEst\xe1 seguro que desea eliminar el m\xf3dulo ${t.name}? Perder\xe1 el acceso a todos los datos asociados al mismo.`,icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._roleService.removeRole(t.id,this.pagination.page,this.pagination.size,"name","desc").pipe((0,d.Q)(this._unsubscribeAll)).subscribe(({data:s})=>{s&&this._snackBar.openFromComponent(C.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.paginatedRemoveRole.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()})})}trackByFn(t,o){return t||o.id}waitForPaginatorLoad(){var t=this;return(0,z.A)(function*(){for(;!t._paginator||void 0===t._paginator;)yield new Promise(o=>{setTimeout(o,200)});return t._paginator})()}static#e=this.\u0275fac=function(o){return new(o||i)(e.rXU(e.gRc),e.rXU(P.G),e.rXU(X.W),e.rXU(M.UG),e.rXU(A.il))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["ath-roles"]],viewQuery:function(o,n){if(1&o&&(e.GBs(F.iy,5),e.GBs(b.B4,5)),2&o){let s;e.mGM(s=e.lsd())&&(n._paginator=s.first),e.mGM(s=e.lsd())&&(n._sort=s.first)}},standalone:!0,features:[e.aNF],decls:27,vars:8,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","overflow-x-auto","overflow-y-auto","bg-card","dark:bg-transparent","lg:overflow-x-hidden"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"whitespace-nowrap","text-primary-500",3,"routerLink"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight"],["class","flex flex-wrap items-center mt-2 sm:mt-0 shrink-0 md:ml-4",4,"ngxPermissionsExcept"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-col","justify-between","flex-auto"],["class","grid"],["class","z-10 border-b sm:inset-x-0 sm:bottom-0 sm:border-t sm:border-b-0 bg-gray-50 dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"flex","flex-wrap","items-center","mt-2","sm:mt-0","shrink-0","md:ml-4"],[1,"mt-4","mr-4","sm:mt-0","fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"mt-4","text-white","sm:mt-0","bg-gradient-to-r","from-primary-500","to-primary-600","hover:to-primary-900","hover:shadow-lg",3,"routerLink"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","roles-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"hidden","sm:block",3,"mat-sort-header"],[1,"flex","items-center","justify-center",3,"mat-sort-header"],[4,"ngxPermissionsOnly"],[4,"ngxPermissionsExcept"],[1,"pr-6","text-right"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","roles-table","md:px-8"],[1,"flex","truncate"],[1,"truncate"],["class","flex justify-center mr-4 text-center",4,"ngxPermissionsExcept"],["class","flex flex-row justify-end gap-2"],[1,"flex","justify-center","mr-4","text-center"],[3,"checked","color"],[3,"diameter","color"],[3,"checked","color","change"],[1,"flex","flex-row","justify-end","gap-2"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],["class","grid items-center gap-4 px-6 py-3 border-b roles-table md:px-8"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"]],template:function(o,n){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div")(6,"a",4),e.EFF(7,"Inicio"),e.k0s()(),e.j41(8,"div",5),e.nrm(9,"mat-icon",6),e.j41(10,"a",7),e.EFF(11,"Roles"),e.k0s()()(),e.j41(12,"div",8)(13,"a",9),e.nrm(14,"mat-icon",6),e.j41(15,"span",10),e.EFF(16,"Regresar"),e.k0s()()()(),e.j41(17,"div",11)(18,"div",12),e.EFF(19," Gesti\xf3n de Roles "),e.k0s()()(),e.DNE(20,W,8,8,"div",13),e.k0s(),e.j41(21,"div",14)(22,"div",15),e.DNE(23,re,13,6,"div",16)(24,ae,2,0),e.qex(25),e.DNE(26,me,1,9,"mat-paginator",17),e.bVm(),e.k0s()()()),2&o&&(e.R7$(6),e.Y8G("routerLink","/dashboard"),e.R7$(3),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("routerLink","./.."),e.R7$(),e.Y8G("svgIcon","mat_solid:chevron_left"),e.R7$(6),e.Y8G("ngxPermissionsExcept",e.lJ4(7,u)),e.R7$(3),e.vxM(23,n.roles.length>0?23:24),e.R7$(3),e.vxM(26,n.pagination.length>0?26:-1))},dependencies:[x.Hl,x.$z,f.RG,f.rl,f.JW,v.m_,v.An,_.fS,_.fg,F.Ou,F.iy,w.mV,w.sG,b.NQ,b.B4,b.aE,$.YU,Y.Ov,Y.f6,l.X1,l.me,l.BC,l.l_,R.Wk],encapsulation:2,data:{animation:U.X},changeDetection:0})}return i})();var pe=r(99172),fe=r(88141),he=r(63729),g=r(9454),B=r(14823),N=r(82765),ue=r(55542);function ge(i,a){1&i&&(e.j41(0,"a",42),e.EFF(1,"Nuevo"),e.k0s())}function xe(i,a){if(1&i&&(e.j41(0,"a",42),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.selectedRole.name)}}function ve(i,a){1&i&&(e.j41(0,"div",43),e.EFF(1," Nuevo Rol "),e.k0s())}function _e(i,a){if(1&i&&(e.j41(0,"div",43),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(" Informaci\xf3n de ",t.selectedRole.name," ")}}const k=i=>({"cursor-not-allowed":i});function be(i,a){if(1&i){const t=e.RV6();e.j41(0,"button",44),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.createRole())}),e.nrm(1,"mat-icon",45),e.j41(2,"span",46),e.EFF(3,"Guardar"),e.k0s()()}if(2&i){const t=e.XpG();e.Y8G("disabled",t.roleForm.invalid)("ngClass",e.eq3(3,k,t.roleForm.invalid)),e.R7$(),e.Y8G("svgIcon","mat_solid:save")}}function Re(i,a){if(1&i){const t=e.RV6();e.j41(0,"button",44),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.updateRole())}),e.nrm(1,"mat-icon",45),e.j41(2,"span",46),e.EFF(3,"Actualizar"),e.k0s()()}if(2&i){const t=e.XpG();e.Y8G("disabled",t.roleForm.invalid)("ngClass",e.eq3(3,k,t.roleForm.invalid)),e.R7$(),e.Y8G("svgIcon","mat_solid:refresh")}}function Ce(i,a){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El nombre del rol es obligatorio. "),e.k0s())}function ke(i,a){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El nombre rol debe contener entre 3 y 255 caracteres. "),e.k0s())}function Fe(i,a){1&i&&(e.j41(0,"span"),e.EFF(1,"Leer"),e.k0s())}function Ge(i,a){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.name)}}function ye(i,a){if(1&i){const t=e.RV6();e.j41(0,"li")(1,"mat-checkbox",54),e.bIt("ngModelChange",function(n){const c=e.eBV(t).$implicit;return e.Njj(c.checked=n)})("ngModelChange",function(){e.eBV(t);const n=e.XpG().$index,s=e.XpG();return e.Njj(s.updateAsComplete(n))}),e.DNE(2,Fe,2,0,"span")(3,Ge,2,1,"span"),e.k0s()()}if(2&i){const t=a.$implicit,o=e.XpG(),n=o.$index,s=o.$implicit,c=e.sdS(3),m=e.XpG();e.R7$(),e.Y8G("ngModel",t.checked)("disabled",(c.indeterminate&&m.someCompleteExceptRead(n)||s.checked)&&t.id===t.parentId),e.R7$(),e.vxM(2,t.id===t.parentId?2:-1),e.R7$(),e.vxM(3,t.id!==t.parentId?3:-1)}}function je(i,a){if(1&i){const t=e.RV6();e.j41(0,"section",47)(1,"span",48)(2,"mat-checkbox",49,50),e.bIt("change",function(n){const c=e.eBV(t).$index,m=e.XpG();return e.Njj(m.setAll(n.checked,c))}),e.j41(4,"span",51),e.EFF(5),e.k0s()()(),e.j41(6,"span",52)(7,"ul",53),e.Z7z(8,ye,4,4,"li",null,e.fX1),e.k0s()()()}if(2&i){const t=a.$implicit,o=a.$index,n=e.XpG();e.R7$(),e.Y8G("matTooltip",t.name),e.R7$(),e.Y8G("checked",t.checked)("indeterminate",n.someComplete(o)),e.R7$(3),e.SpI(" ",t.name,""),e.R7$(3),e.Dyx(t.permissions)}}function $e(i,a){if(1&i){const t=e.RV6();e.j41(0,"button",44),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.createRole())}),e.nrm(1,"mat-icon",45),e.j41(2,"span",46),e.EFF(3,"Guardar"),e.k0s()()}if(2&i){const t=e.XpG();e.Y8G("disabled",t.roleForm.invalid)("ngClass",e.eq3(3,k,t.roleForm.invalid)),e.R7$(),e.Y8G("svgIcon","mat_solid:save")}}function we(i,a){if(1&i){const t=e.RV6();e.j41(0,"button",44),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.updateRole())}),e.nrm(1,"mat-icon",45),e.j41(2,"span",46),e.EFF(3,"Actualizar"),e.k0s()()}if(2&i){const t=e.XpG();e.Y8G("disabled",t.roleForm.invalid)("ngClass",e.eq3(3,k,t.roleForm.invalid)),e.R7$(),e.Y8G("svgIcon","mat_solid:refresh")}}const Ee=[{path:"",component:de,resolve:{roles:j.Ad}},{path:":roleId",component:(()=>{class i{constructor(t,o,n,s,c,m,h,p){this._activatedRoute=t,this._changeDetectorRef=o,this._formBuilder=n,this._fuseConfirmationService=s,this._router=c,this._snackBar=m,this._roleService=h,this.store=p,this.searchInputControl=new l.MJ(null),this.windowsMode="new",this._unsubscribeAll=new I.B}ngOnInit(){this.store.select(he.SW).pipe((0,d.Q)(this._unsubscribeAll)).subscribe(t=>{this.authUser=t}),this.store.select(T.X7).pipe((0,d.Q)(this._unsubscribeAll)).subscribe(t=>{this.selectedRole=t}),this.roleForm=this._formBuilder.group({id:[""],name:["",[l.k0.required,l.k0.minLength(3),l.k0.maxLength(255)]],description:["",[l.k0.maxLength(1e3)]]}),this._activatedRoute.params.pipe((0,d.Q)(this._unsubscribeAll)).subscribe(({roleId:t})=>{"new"!==t&&(this.windowsMode="edit"),this._fillRoleData()}),this.searchInputControl.valueChanges.pipe((0,d.Q)(this._unsubscribeAll),(0,E.B)(100),(0,pe.Z)(null),(0,fe.M)(t=>{this.filteredPermissions=null!==t?this.permissions.filter(o=>o.name.toLowerCase().includes(t.toLowerCase())):this.permissions,this._changeDetectorRef.markForCheck()})).subscribe()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createRole(){const t=this.buildRole();delete t.id,this._fuseConfirmationService.open({title:"Crear Rol",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._roleService.createRole(t).pipe((0,d.Q)(this._unsubscribeAll)).subscribe(s=>{s&&(this._snackBar.openFromComponent(C.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/settings/roles"))},s=>{console.log(s)})})}updateRole(){const t=this.buildRole();this._fuseConfirmationService.open({title:"Actualizar Rol",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._roleService.updateRole(t).pipe((0,d.Q)(this._unsubscribeAll)).subscribe(s=>{s&&(this._snackBar.openFromComponent(C.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/settings/roles"))},s=>{console.log(s)})})}updateAsComplete(t){if(this.filteredPermissions[t].checked=null!=this.filteredPermissions[t].permissions&&this.filteredPermissions[t].permissions.every(o=>o.checked),this.someComplete(t)){const o=this.filteredPermissions[t].permissions.findIndex(n=>n.id===n.parentId);-1!==o&&(this.filteredPermissions[t].permissions[o].checked=!0)}}someComplete(t){return null!=this.filteredPermissions[t].permissions&&this.filteredPermissions[t].permissions.filter(o=>o.checked).length>0&&!this.filteredPermissions[t].checked}someCompleteExceptRead(t){return null!=this.filteredPermissions[t].permissions&&this.filteredPermissions[t].permissions.filter(o=>o.checked&&o.id!==o.parentId).length>0&&!this.filteredPermissions[t].checked}setAll(t,o){this.filteredPermissions[o].checked=t,null!=this.filteredPermissions[o].permissions&&this.filteredPermissions[o].permissions.forEach(n=>n.checked=t)}trackByFn(t,o){return o.id||t}_fillRoleData(){"new"!==this.windowsMode&&this.roleForm.patchValue(this.selectedRole),this._setRolePermissionsData(),this._changeDetectorRef.markForCheck()}_setRolePermissionsData(){const t=this.authUser.role.permissions.filter(o=>o.id===o.parentId).reduce((o,{id:n,parentId:s,name:c})=>{if(!o.some(m=>m.parentId===s)){let m=this.selectedRole.permissionsId;"new"===this.windowsMode&&(m=[]);const h=this.authUser.role.permissions.filter(p=>p.parentId===s).map(p=>({...p,checked:m.some(G=>G===p.id)})).sort((p,G)=>p.id-G.id);o.push({id:n,parentId:s,name:c,checked:h.every(p=>p.checked),permissions:h})}return o},[]);this.permissions=t}buildRole(){const t=this.roleForm.getRawValue();let o=[];return this.filteredPermissions.forEach(n=>{o=o.concat(n.permissions)}),t.permissionsId=o.filter(n=>n.checked).map(n=>n.id),t}static#e=this.\u0275fac=function(o){return new(o||i)(e.rXU(R.nX),e.rXU(e.gRc),e.rXU(l.ok),e.rXU(P.G),e.rXU(R.Ix),e.rXU(M.UG),e.rXU(X.W),e.rXU(A.il))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["role-detail"]],standalone:!0,features:[e.aNF],decls:71,vars:40,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-wrap","p-6","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/dashboard",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/settings/roles",1,"ml-1","text-primary-500","hover:underline"],["class","ml-1 text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],["class","mt-2 text-3xl font-extrabold leading-tight tracking-tight sm:text-3xl"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],["class","ml-4 text-white bg-primary-500 hover:bg-primary-700 hover:shadow-lg","mat-raised-button","",3,"disabled","ngClass"],[1,"flex-auto","p-4","sm:p-6"],[1,"flex","flex-col","flex-auto","min-w-0"],["multi","",1,"w-full","bg-transparent"],[2,"border-top-left-radius","0.5rem !important","border-top-right-radius","0.5rem !important",3,"expanded"],[3,"collapsedHeight"],[1,"flex","items-center"],[1,"text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"grid","w-full","px-2","py-6","border-t-2","sm:py-8","sm:px-4","gap-y-3","gap-x-6","sm:grid-cols-3",3,"formGroup","autocomplete"],[1,"sm:col-span-1"],[1,"w-full"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","required","",3,"type","formControlName","minlength","maxlength","placeholder"],[1,"w-full","sm:col-span-2","fuse-mat-textarea"],["matInput","","matTextareaAutosize","","matTextareaAutosize","",3,"formControlName","rows","spellcheck","maxlength"],["desc",""],[1,"text-right"],["mPermissionPanel",""],[1,"flex","items-center","justify-evenly"],[1,"hidden","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:block","sm:text-2xl"],[1,"sm:ml-10","fuse-mat-dense","fuse-mat-bold","fuse-mat-rounded","min-w-50",3,"subscriptSizing","click"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","","placeholder","Buscar subm\xf3dulos",3,"formControl","autocomplete"],[1,"w-full","py-6","border-t-2","sm:py-10","sm:px-4"],[1,"flex","flex-wrap","justify-start","gap-y-1","gap-x-1","sm:gap-4"],[1,"flex","flex-col","flex-wrap","justify-end","px-6","pb-10","sm:flex-row","flex-0","sm:items-center","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex","items-center","flex-shrink-0","mt-6","text-right","sm:mt-0","sm:ml-4"],[1,"ml-1","text-primary-500"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],["mat-raised-button","",1,"ml-4","text-white","bg-primary-500","hover:bg-primary-700","hover:shadow-lg",3,"disabled","ngClass","click"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"sm:py-5","sm:px-4","py-3","px-1.5","w-[49%]","sm:w-52","shadow-sm","truncate","bg-gray-100","dark:dark","rounded-md"],[1,"block","w-full","truncate",3,"matTooltip"],["color","primary",1,"sm:mx-2",3,"checked","indeterminate","change"],["checkP",""],[1,"font-bold","whitespace-normal","sm:line-clamp-1"],[1,""],[1,"ml-3","list-none","sm:ml-8"],["color","primary",3,"ngModel","disabled","ngModelChange"],["class","sm:py-5 sm:px-4 py-3 px-1.5 w-[49%] sm:w-52 shadow-sm truncate bg-gray-100 dark:dark rounded-md"]],template:function(o,n){if(1&o){const s=e.RV6();e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e.EFF(7,"Inicio"),e.k0s()(),e.j41(8,"div",4),e.nrm(9,"mat-icon",6),e.j41(10,"a",7),e.EFF(11,"Roles"),e.k0s()(),e.j41(12,"div",4),e.nrm(13,"mat-icon",6),e.DNE(14,ge,2,0,"a",8)(15,xe,2,1,"a",8),e.k0s()(),e.j41(16,"div",9)(17,"a",10),e.nrm(18,"mat-icon",6),e.j41(19,"span",11),e.EFF(20,"Regresar"),e.k0s()()()(),e.j41(21,"div",12),e.DNE(22,ve,2,0,"div",13)(23,_e,2,1,"div",13),e.k0s()(),e.j41(24,"div",14),e.DNE(25,be,4,5,"button",15)(26,Re,4,5,"button",15),e.k0s()(),e.j41(27,"div",16)(28,"div",17)(29,"mat-accordion",18)(30,"mat-expansion-panel",19)(31,"mat-expansion-panel-header",20)(32,"mat-panel-title",21)(33,"div",22),e.EFF(34," Informaci\xf3n General "),e.k0s()()(),e.j41(35,"form",23)(36,"div",24)(37,"mat-form-field",25)(38,"mat-label"),e.EFF(39,"Nombre"),e.k0s(),e.nrm(40,"mat-icon",26)(41,"input",27),e.DNE(42,Ce,2,0,"mat-error")(43,ke,2,0,"mat-error"),e.k0s()(),e.j41(44,"mat-form-field",28)(45,"mat-label"),e.EFF(46,"Descripci\xf3n"),e.k0s(),e.nrm(47,"mat-icon",26)(48,"textarea",29,30),e.j41(50,"mat-hint",31),e.EFF(51),e.k0s()()()(),e.j41(52,"mat-expansion-panel",19,32)(54,"mat-expansion-panel-header",20)(55,"mat-panel-title",21)(56,"div",22)(57,"div",33)(58,"div",34),e.EFF(59," Subm\xf3dulos y Permisos "),e.k0s(),e.j41(60,"mat-form-field",35),e.bIt("click",function(){e.eBV(s);const m=e.sdS(53);return e.Njj(m.expanded=!1)}),e.nrm(61,"mat-icon",36)(62,"input",37),e.k0s()()()()(),e.j41(63,"div",38)(64,"div",39),e.Z7z(65,je,10,4,"section",55,e.fX1),e.k0s()()()()()(),e.j41(67,"div",40)(68,"div",41),e.DNE(69,$e,4,5,"button",15)(70,we,4,5,"button",15),e.k0s()()()}if(2&o){const s=e.sdS(49);e.R7$(9),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(),e.vxM(14,"edit"!==n.windowsMode?14:-1),e.R7$(),e.vxM(15,"edit"===n.windowsMode?15:-1),e.R7$(2),e.Y8G("routerLink","./.."),e.R7$(),e.Y8G("svgIcon","mat_solid:chevron_left"),e.R7$(4),e.vxM(22,"edit"!==n.windowsMode?22:-1),e.R7$(),e.vxM(23,"edit"===n.windowsMode?23:-1),e.R7$(2),e.vxM(25,"new"===n.windowsMode?25:-1),e.R7$(),e.vxM(26,"new"!==n.windowsMode?26:-1),e.R7$(4),e.xc7("border-bottom-left-radius","new"!==n.windowsMode?"0.5rem !important":""),e.Y8G("expanded",!0),e.R7$(),e.Y8G("collapsedHeight","56px"),e.R7$(4),e.Y8G("formGroup",n.roleForm)("autocomplete","off"),e.R7$(5),e.Y8G("svgIcon","mat_solid:notes"),e.R7$(),e.Y8G("type","text")("formControlName","name")("minlength",3)("maxlength",255)("placeholder","Nombre del rol"),e.R7$(),e.vxM(42,n.roleForm.get("name").hasError("required")?42:-1),e.R7$(),e.vxM(43,n.roleForm.get("name").hasError("maxlength")||n.roleForm.get("name").hasError("minlength")?43:-1),e.R7$(4),e.Y8G("svgIcon","mat_solid:notes"),e.R7$(),e.Y8G("formControlName","description")("rows",3)("spellcheck",!1)("maxlength",1e3),e.R7$(3),e.SpI("Total de caracteres ",s.value.length," / 1000"),e.R7$(),e.xc7("border-bottom-left-radius","new"!==n.windowsMode?"0.5rem !important":""),e.Y8G("expanded",!0),e.R7$(2),e.Y8G("collapsedHeight","56px"),e.R7$(6),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.searchInputControl)("autocomplete","off"),e.R7$(3),e.Dyx(n.filteredPermissions),e.R7$(4),e.vxM(69,"new"===n.windowsMode?69:-1),e.R7$(),e.vxM(70,"new"!==n.windowsMode?70:-1)}},dependencies:[l.YN,l.qT,l.me,l.BC,l.cb,l.YS,l.xh,l.tU,l.vS,x.Hl,x.$z,N.g7,N.So,g.MY,g.BS,g.GK,g.Z2,g.WN,f.RG,f.rl,f.nJ,f.MV,f.TL,f.JW,v.m_,v.An,_.fS,_.fg,B.uc,B.oV,ue.uv,$.YU,l.X1,l.l_,l.j4,l.JD,R.Wk],encapsulation:2,changeDetection:0})}return i})(),resolve:{role:j.NH}}]}}]);