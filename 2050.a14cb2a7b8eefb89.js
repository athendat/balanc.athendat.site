"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[2050],{2050:(De,j,r)=>{r.r(j),r.d(j,{default:()=>Ee});var y=r(72831),z=r(10467),$=r(60177),x=r(88834),f=r(32102),v=r(99213),_=r(59042),F=r(96695),w=r(30450),R=r(2042),a=r(89417),b=r(51188),I=r(21413),L=r(7673),V=r(57786),c=r(56977),E=r(70152),D=r(25558),Y=r(96354),P=r(82341),U=r(87122),J=r(47413),S=r(15887),C=r(94794);class Q{clear(){this.id=null,this.name="",this.permissions=[],this.isCoreRole=!1,this.checked=!1,this.active=!1}}var e=r(54438),T=r(46601),X=r(44312),M=r(95416),A=r(59640);const O=(i,l)=>l.id,u=()=>["Super Administrador"],W=()=>["new"],H=i=>[i],Z=i=>({"pointer-events-none":i}),K=()=>[10,25,50,100];function q(i,l){if(1&i&&(e.j41(0,"div",18)(1,"mat-form-field",19),e.nrm(2,"mat-icon",20)(3,"input",21),e.k0s(),e.j41(4,"button",22),e.nrm(5,"mat-icon",23),e.j41(6,"span",24),e.EFF(7,"Nuevo"),e.k0s()()()),2&i){const t=e.XpG();e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",t.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),e.R7$(),e.Y8G("routerLink",e.lJ4(7,W)),e.R7$(),e.Y8G("svgIcon","mat_solid:add")}}function ee(i,l){1&i&&e.nrm(0,"div")}function te(i,l){1&i&&(e.j41(0,"span"),e.EFF(1,"Activo"),e.k0s())}function ie(i,l){if(1&i){const t=e.RV6();e.j41(0,"mat-slide-toggle",39),e.bIt("change",function(n){e.eBV(t);const s=e.XpG(2),m=s.$implicit,d=s.$index,h=e.XpG(2);return e.Njj(h.updateRoleStatus(n,m,d))}),e.k0s()}if(2&i){const t=e.XpG(2).$implicit;e.Y8G("checked",t.active)("color","primary")}}function oe(i,l){1&i&&e.nrm(0,"mat-spinner",38),2&i&&e.Y8G("diameter",20)("color","primary")}function ne(i,l){if(1&i&&(e.j41(0,"div",36),e.DNE(1,ie,1,2,"mat-slide-toggle",37)(2,oe,1,2,"mat-spinner",38),e.k0s()),2&i){const t=e.XpG().$index,o=e.XpG(2);e.R7$(),e.vxM(1,o.isLoading&&o.selectedSlide===t?-1:1),e.R7$(),e.vxM(2,o.isLoading&&o.selectedSlide===t?2:-1)}}function se(i,l){if(1&i){const t=e.RV6();e.qex(0),e.j41(1,"button",42),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(2);return e.Njj(s.deleteRole(n))}),e.nrm(2,"mat-icon",41),e.k0s(),e.bVm()}2&i&&(e.R7$(2),e.Y8G("svgIcon","mat_solid:delete"))}function re(i,l){if(1&i&&(e.j41(0,"div",35)(1,"button",40),e.nrm(2,"mat-icon",41),e.k0s(),e.DNE(3,se,3,1,"ng-container",29),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.Y8G("routerLink",e.eq3(3,H,t.id)),e.R7$(),e.Y8G("svgIcon","mat_solid:edit"),e.R7$(),e.Y8G("ngxPermissionsExcept",e.lJ4(5,u))}}function le(i,l){if(1&i&&(e.j41(0,"div",31)(1,"div",32),e.EFF(2),e.k0s(),e.j41(3,"div",33),e.EFF(4),e.k0s(),e.DNE(5,ne,3,2,"div",34)(6,re,4,6,"div",35),e.k0s()),2&i){const t=l.$implicit;e.R7$(2),e.SpI(" ",t.name," "),e.R7$(2),e.SpI(" ",t.description," "),e.R7$(),e.Y8G("ngxPermissionsExcept",e.lJ4(4,u)),e.R7$(),e.vxM(6,t.isCoreRole?-1:6)}}function ae(i,l){if(1&i&&(e.j41(0,"div",16)(1,"div",25)(2,"div",26),e.EFF(3," Nombre "),e.k0s(),e.j41(4,"div"),e.EFF(5,"Descripci\xf3n"),e.k0s(),e.j41(6,"div",27),e.DNE(7,ee,1,0,"div",28)(8,te,2,0,"span",29),e.k0s(),e.j41(9,"div",30),e.EFF(10,"Acci\xf3n"),e.k0s()(),e.Z7z(11,le,7,5,"div",31,O),e.k0s()),2&i){const t=e.XpG();e.R7$(2),e.Y8G("mat-sort-header","name"),e.R7$(4),e.Y8G("mat-sort-header","active"),e.R7$(),e.Y8G("ngxPermissionsOnly",e.lJ4(4,u)),e.R7$(),e.Y8G("ngxPermissionsExcept",e.lJ4(5,u)),e.R7$(3),e.Dyx(t.roles)}}function ce(i,l){1&i&&(e.j41(0,"div",43),e.EFF(1," \xa1A\xfan ha creado ning\xfan rol a\xfan! "),e.k0s())}function me(i,l){if(1&i&&e.nrm(0,"mat-paginator",17),2&i){const t=e.XpG();e.Y8G("ngClass",e.eq3(6,Z,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.lJ4(8,K))("showFirstLastButtons",!0)}}let de=(()=>{class i{constructor(t,o,n,s,m){this._changeDetectorRef=t,this._fuseConfirmationService=o,this._roleService=n,this._snackBar=s,this.store=m,this.emptyRole=new Q,this.isLoading=!1,this.selectedSlide=null,this.searchInputControl=new a.MJ,this._unsubscribeAll=new I.B,this.emptyRole.clear()}ngOnInit(){this.store.select(S.y3).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(t=>{this.roles=t,this._changeDetectorRef.markForCheck()}),this.store.select(J.D).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,c.Q)(this._unsubscribeAll),(0,E.B)(300),(0,D.n)(t=>t?(this.isLoading=!0,this._roleService.findAllRoles(0,10,"name","asc",t)):(0,L.of)([])),(0,Y.T)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this.waitForPaginatorLoad().then(()=>{this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,c.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,V.h)(this._sort.sortChange,this._paginator.page).pipe((0,D.n)(()=>(this.isLoading=!0,this._roleService.findAllRoles(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction))),(0,Y.T)(()=>{this.isLoading=!1})).subscribe())})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}updateRoleStatus(t,o,n){this.isLoading=!0,this.selectedSlide=n,this._roleService.updateRoleStatus({id:o.id,active:t.checked}).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(s=>{s&&(this._snackBar.openFromComponent(C.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.isLoading=!1,this.selectedSlide=-1,this._changeDetectorRef.markForCheck())})}deleteRole(t){this._fuseConfirmationService.open({title:"Eliminar rol",message:`\xbfEst\xe1 seguro que desea eliminar el m\xf3dulo ${t.name}? Perder\xe1 el acceso a todos los datos asociados al mismo.`,icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._roleService.removeRole(t.id,this.pagination.page,this.pagination.size,"name","desc").pipe((0,c.Q)(this._unsubscribeAll)).subscribe(({data:s})=>{s&&this._snackBar.openFromComponent(C.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.paginatedRemoveRole.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()})})}trackByFn(t,o){return t||o.id}waitForPaginatorLoad(){var t=this;return(0,z.A)(function*(){for(;!t._paginator||void 0===t._paginator;)yield new Promise(o=>{setTimeout(o,200)});return t._paginator})()}static#e=this.\u0275fac=function(o){return new(o||i)(e.rXU(e.gRc),e.rXU(T.G),e.rXU(X.W),e.rXU(M.UG),e.rXU(A.il))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["ath-roles"]],viewQuery:function(o,n){if(1&o&&(e.GBs(F.iy,5),e.GBs(R.B4,5)),2&o){let s;e.mGM(s=e.lsd())&&(n._paginator=s.first),e.mGM(s=e.lsd())&&(n._sort=s.first)}},standalone:!0,features:[e.aNF],decls:27,vars:8,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","overflow-x-auto","overflow-y-auto","bg-card","dark:bg-transparent","lg:overflow-x-hidden"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"whitespace-nowrap","text-primary-500",3,"routerLink"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight"],["class","flex flex-wrap items-center mt-2 sm:mt-0 shrink-0 md:ml-4",4,"ngxPermissionsExcept"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-col","justify-between","flex-auto"],[1,"grid"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"flex","flex-wrap","items-center","mt-2","sm:mt-0","shrink-0","md:ml-4"],[1,"mt-4","mr-4","sm:mt-0","fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"mt-4","text-white","sm:mt-0","bg-gradient-to-r","from-primary-500","to-primary-600","hover:to-primary-900","hover:shadow-lg",3,"routerLink"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","roles-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"hidden","sm:block",3,"mat-sort-header"],[1,"flex","items-center","justify-center",3,"mat-sort-header"],[4,"ngxPermissionsOnly"],[4,"ngxPermissionsExcept"],[1,"pr-6","text-right"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","roles-table","md:px-8"],[1,"flex","truncate"],[1,"truncate"],["class","flex justify-center mr-4 text-center",4,"ngxPermissionsExcept"],[1,"flex","flex-row","justify-end","gap-2"],[1,"flex","justify-center","mr-4","text-center"],[3,"checked","color"],[3,"diameter","color"],[3,"change","checked","color"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(o,n){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div")(6,"a",4),e.EFF(7,"Inicio"),e.k0s()(),e.j41(8,"div",5),e.nrm(9,"mat-icon",6),e.j41(10,"a",7),e.EFF(11,"Roles"),e.k0s()()(),e.j41(12,"div",8)(13,"a",9),e.nrm(14,"mat-icon",6),e.j41(15,"span",10),e.EFF(16,"Regresar"),e.k0s()()()(),e.j41(17,"div",11)(18,"div",12),e.EFF(19," Gesti\xf3n de Roles "),e.k0s()()(),e.DNE(20,q,8,8,"div",13),e.k0s(),e.j41(21,"div",14)(22,"div",15),e.DNE(23,ae,13,6,"div",16)(24,ce,2,0),e.qex(25),e.DNE(26,me,1,9,"mat-paginator",17),e.bVm(),e.k0s()()()),2&o&&(e.R7$(6),e.Y8G("routerLink","/desktop"),e.R7$(3),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("routerLink","./.."),e.R7$(),e.Y8G("svgIcon","mat_solid:chevron_left"),e.R7$(6),e.Y8G("ngxPermissionsExcept",e.lJ4(7,u)),e.R7$(3),e.vxM(23,n.roles.length>0?23:24),e.R7$(3),e.vxM(26,n.pagination.length>0?26:-1))},dependencies:[x.Hl,x.$z,f.RG,f.rl,f.JW,v.m_,v.An,_.fS,_.fg,F.Ou,F.iy,w.mV,w.sG,R.NQ,R.B4,R.aE,$.YU,P.Ov,P.f6,a.X1,a.me,a.BC,a.l_,b.Wk],encapsulation:2,data:{animation:U.X},changeDetection:0})}return i})();var pe=r(99172),fe=r(88141),he=r(63729),g=r(9454),N=r(14823),B=r(82765),ue=r(55542);const k=i=>({"cursor-not-allowed":i});function ge(i,l){1&i&&(e.j41(0,"a",11),e.EFF(1,"Nuevo"),e.k0s())}function xe(i,l){if(1&i&&(e.j41(0,"a",11),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.selectedRole.name)}}function ve(i,l){1&i&&(e.j41(0,"div",16),e.EFF(1," Nuevo Rol "),e.k0s())}function _e(i,l){if(1&i&&(e.j41(0,"div",16),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(" Informaci\xf3n de ",t.selectedRole.name," ")}}function Re(i,l){if(1&i){const t=e.RV6();e.j41(0,"button",44),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.createRole())}),e.nrm(1,"mat-icon",45),e.j41(2,"span",46),e.EFF(3,"Guardar"),e.k0s()()}if(2&i){const t=e.XpG();e.Y8G("disabled",t.roleForm.invalid)("ngClass",e.eq3(3,k,t.roleForm.invalid)),e.R7$(),e.Y8G("svgIcon","mat_solid:save")}}function be(i,l){if(1&i){const t=e.RV6();e.j41(0,"button",44),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.updateRole())}),e.nrm(1,"mat-icon",45),e.j41(2,"span",46),e.EFF(3,"Actualizar"),e.k0s()()}if(2&i){const t=e.XpG();e.Y8G("disabled",t.roleForm.invalid)("ngClass",e.eq3(3,k,t.roleForm.invalid)),e.R7$(),e.Y8G("svgIcon","mat_solid:refresh")}}function Ce(i,l){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El nombre del rol es obligatorio. "),e.k0s())}function ke(i,l){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El nombre rol debe contener entre 3 y 255 caracteres. "),e.k0s())}function Fe(i,l){1&i&&(e.j41(0,"span"),e.EFF(1,"Leer"),e.k0s())}function Ge(i,l){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.name)}}function je(i,l){if(1&i){const t=e.RV6();e.j41(0,"li")(1,"mat-checkbox",52),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.checked,n)||(s.checked=n),e.Njj(n)}),e.bIt("ngModelChange",function(){e.eBV(t);const n=e.XpG().$index,s=e.XpG();return e.Njj(s.updateAsComplete(n))}),e.DNE(2,Fe,2,0,"span")(3,Ge,2,1,"span"),e.k0s()()}if(2&i){const t=l.$implicit,o=e.XpG(),n=o.$implicit,s=o.$index,m=e.sdS(3),d=e.XpG();e.R7$(),e.R50("ngModel",t.checked),e.Y8G("disabled",(m.indeterminate&&d.someCompleteExceptRead(s)||n.checked)&&t.id===t.parentId),e.R7$(),e.vxM(2,t.id===t.parentId?2:-1),e.R7$(),e.vxM(3,t.id!==t.parentId?3:-1)}}function ye(i,l){if(1&i){const t=e.RV6();e.j41(0,"section",41)(1,"span",47)(2,"mat-checkbox",48,2),e.bIt("change",function(n){const s=e.eBV(t).$index,m=e.XpG();return e.Njj(m.setAll(n.checked,s))}),e.j41(4,"span",49),e.EFF(5),e.k0s()()(),e.j41(6,"span",50)(7,"ul",51),e.Z7z(8,je,4,4,"li",null,e.fX1),e.k0s()()()}if(2&i){const t=l.$implicit,o=l.$index,n=e.XpG();e.R7$(),e.Y8G("matTooltip",t.name),e.R7$(),e.Y8G("checked",t.checked)("indeterminate",n.someComplete(o)),e.R7$(3),e.SpI(" ",t.name,""),e.R7$(3),e.Dyx(t.permissions)}}function $e(i,l){if(1&i){const t=e.RV6();e.j41(0,"button",44),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.createRole())}),e.nrm(1,"mat-icon",45),e.j41(2,"span",46),e.EFF(3,"Guardar"),e.k0s()()}if(2&i){const t=e.XpG();e.Y8G("disabled",t.roleForm.invalid)("ngClass",e.eq3(3,k,t.roleForm.invalid)),e.R7$(),e.Y8G("svgIcon","mat_solid:save")}}function we(i,l){if(1&i){const t=e.RV6();e.j41(0,"button",44),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.updateRole())}),e.nrm(1,"mat-icon",45),e.j41(2,"span",46),e.EFF(3,"Actualizar"),e.k0s()()}if(2&i){const t=e.XpG();e.Y8G("disabled",t.roleForm.invalid)("ngClass",e.eq3(3,k,t.roleForm.invalid)),e.R7$(),e.Y8G("svgIcon","mat_solid:refresh")}}const Ee=[{path:"",component:de,resolve:{roles:y.Ad}},{path:":roleId",component:(()=>{class i{constructor(t,o,n,s,m,d,h,p){this._activatedRoute=t,this._changeDetectorRef=o,this._formBuilder=n,this._fuseConfirmationService=s,this._router=m,this._snackBar=d,this._roleService=h,this.store=p,this.searchInputControl=new a.MJ(null),this.windowsMode="new",this._unsubscribeAll=new I.B}ngOnInit(){this.store.select(he.SW).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(t=>{this.authUser=t}),this.store.select(S.X7).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(t=>{this.selectedRole=t}),this.roleForm=this._formBuilder.group({id:[""],name:["",[a.k0.required,a.k0.minLength(3),a.k0.maxLength(255)]],description:["",[a.k0.maxLength(1e3)]]}),this._activatedRoute.params.pipe((0,c.Q)(this._unsubscribeAll)).subscribe(({roleId:t})=>{"new"!==t&&(this.windowsMode="edit"),this._fillRoleData()}),this.searchInputControl.valueChanges.pipe((0,c.Q)(this._unsubscribeAll),(0,E.B)(100),(0,pe.Z)(null),(0,fe.M)(t=>{this.filteredPermissions=null!==t?this.permissions.filter(o=>o.name.toLowerCase().includes(t.toLowerCase())):this.permissions,this._changeDetectorRef.markForCheck()})).subscribe()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createRole(){const t=this.buildRole();delete t.id,this._fuseConfirmationService.open({title:"Crear Rol",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._roleService.createRole(t).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(s=>{s&&(this._snackBar.openFromComponent(C.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/settings/roles"))},s=>{console.log(s)})})}updateRole(){const t=this.buildRole();this._fuseConfirmationService.open({title:"Actualizar Rol",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._roleService.updateRole(t).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(s=>{s&&(this._snackBar.openFromComponent(C.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/settings/roles"))},s=>{console.log(s)})})}updateAsComplete(t){if(this.filteredPermissions[t].checked=null!=this.filteredPermissions[t].permissions&&this.filteredPermissions[t].permissions.every(o=>o.checked),this.someComplete(t)){const o=this.filteredPermissions[t].permissions.findIndex(n=>n.id===n.parentId);-1!==o&&(this.filteredPermissions[t].permissions[o].checked=!0)}}someComplete(t){return null!=this.filteredPermissions[t].permissions&&this.filteredPermissions[t].permissions.filter(o=>o.checked).length>0&&!this.filteredPermissions[t].checked}someCompleteExceptRead(t){return null!=this.filteredPermissions[t].permissions&&this.filteredPermissions[t].permissions.filter(o=>o.checked&&o.id!==o.parentId).length>0&&!this.filteredPermissions[t].checked}setAll(t,o){this.filteredPermissions[o].checked=t,null!=this.filteredPermissions[o].permissions&&this.filteredPermissions[o].permissions.forEach(n=>n.checked=t)}trackByFn(t,o){return o.id||t}_fillRoleData(){"new"!==this.windowsMode&&this.roleForm.patchValue(this.selectedRole),this._setRolePermissionsData(),this._changeDetectorRef.markForCheck()}_setRolePermissionsData(){const t=this.authUser.role.permissions.filter(o=>o.id===o.parentId).reduce((o,{id:n,parentId:s,name:m})=>{if(!o.some(d=>d.parentId===s)){let d=this.selectedRole.permissionsId;"new"===this.windowsMode&&(d=[]);const h=this.authUser.role.permissions.filter(p=>p.parentId===s).map(p=>({...p,checked:d.some(G=>G===p.id)})).sort((p,G)=>p.id-G.id);o.push({id:n,parentId:s,name:m,checked:h.every(p=>p.checked),permissions:h})}return o},[]);this.permissions=t}buildRole(){const t=this.roleForm.getRawValue();let o=[];return this.filteredPermissions.forEach(n=>{o=o.concat(n.permissions)}),t.permissionsId=o.filter(n=>n.checked).map(n=>n.id),t}static#e=this.\u0275fac=function(o){return new(o||i)(e.rXU(b.nX),e.rXU(e.gRc),e.rXU(a.ok),e.rXU(T.G),e.rXU(b.Ix),e.rXU(M.UG),e.rXU(X.W),e.rXU(A.il))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["role-detail"]],standalone:!0,features:[e.aNF],decls:71,vars:40,consts:[["desc",""],["mPermissionPanel",""],["checkP",""],["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-wrap","p-6","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/settings/roles",1,"ml-1","text-primary-500","hover:underline"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],["mat-raised-button","",1,"ml-4","text-white","bg-primary-500","hover:bg-primary-700","hover:shadow-lg",3,"disabled","ngClass"],[1,"flex-auto","p-4","sm:p-6"],[1,"flex","flex-col","flex-auto","min-w-0"],["multi","",1,"w-full","bg-transparent"],[2,"border-top-left-radius","0.5rem !important","border-top-right-radius","0.5rem !important",3,"expanded"],[3,"collapsedHeight"],[1,"flex","items-center"],[1,"text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"grid","w-full","px-2","py-6","border-t-2","sm:py-8","sm:px-4","gap-y-3","gap-x-6","sm:grid-cols-3",3,"formGroup","autocomplete"],[1,"sm:col-span-1"],[1,"w-full"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","required","",3,"type","formControlName","minlength","maxlength","placeholder"],[1,"w-full","sm:col-span-2","fuse-mat-textarea"],["matInput","","matTextareaAutosize","","matTextareaAutosize","",3,"formControlName","rows","spellcheck","maxlength"],[1,"text-right"],[1,"flex","items-center","justify-evenly"],[1,"hidden","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:block","sm:text-2xl"],[1,"sm:ml-10","fuse-mat-dense","fuse-mat-bold","fuse-mat-rounded","min-w-50",3,"click","subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","","placeholder","Buscar subm\xf3dulos",3,"formControl","autocomplete"],[1,"w-full","py-6","border-t-2","sm:py-10","sm:px-4"],[1,"flex","flex-wrap","justify-start","gap-y-1","gap-x-1","sm:gap-4"],[1,"sm:py-5","sm:px-4","py-3","px-1.5","w-[49%]","sm:w-52","shadow-sm","truncate","bg-gray-100","dark:dark","rounded-md"],[1,"flex","flex-col","flex-wrap","justify-end","px-6","pb-10","sm:flex-row","flex-0","sm:items-center","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex","items-center","flex-shrink-0","mt-6","text-right","sm:mt-0","sm:ml-4"],["mat-raised-button","",1,"ml-4","text-white","bg-primary-500","hover:bg-primary-700","hover:shadow-lg",3,"click","disabled","ngClass"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"block","w-full","truncate",3,"matTooltip"],["color","primary",1,"sm:mx-2",3,"change","checked","indeterminate"],[1,"font-bold","whitespace-normal","sm:line-clamp-1"],[1,""],[1,"ml-3","list-none","sm:ml-8"],["color","primary",3,"ngModelChange","ngModel","disabled"]],template:function(o,n){if(1&o){const s=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"div")(4,"div",6)(5,"div",7)(6,"a",8),e.EFF(7,"Inicio"),e.k0s()(),e.j41(8,"div",7),e.nrm(9,"mat-icon",9),e.j41(10,"a",10),e.EFF(11,"Roles"),e.k0s()(),e.j41(12,"div",7),e.nrm(13,"mat-icon",9),e.DNE(14,ge,2,0,"a",11)(15,xe,2,1,"a",11),e.k0s()(),e.j41(16,"div",12)(17,"a",13),e.nrm(18,"mat-icon",9),e.j41(19,"span",14),e.EFF(20,"Regresar"),e.k0s()()()(),e.j41(21,"div",15),e.DNE(22,ve,2,0,"div",16)(23,_e,2,1,"div",16),e.k0s()(),e.j41(24,"div",17),e.DNE(25,Re,4,5,"button",18)(26,be,4,5,"button",18),e.k0s()(),e.j41(27,"div",19)(28,"div",20)(29,"mat-accordion",21)(30,"mat-expansion-panel",22)(31,"mat-expansion-panel-header",23)(32,"mat-panel-title",24)(33,"div",25),e.EFF(34," Informaci\xf3n General "),e.k0s()()(),e.j41(35,"form",26)(36,"div",27)(37,"mat-form-field",28)(38,"mat-label"),e.EFF(39,"Nombre"),e.k0s(),e.nrm(40,"mat-icon",29)(41,"input",30),e.DNE(42,Ce,2,0,"mat-error")(43,ke,2,0,"mat-error"),e.k0s()(),e.j41(44,"mat-form-field",31)(45,"mat-label"),e.EFF(46,"Descripci\xf3n"),e.k0s(),e.nrm(47,"mat-icon",29)(48,"textarea",32,0),e.j41(50,"mat-hint",33),e.EFF(51),e.k0s()()()(),e.j41(52,"mat-expansion-panel",22,1)(54,"mat-expansion-panel-header",23)(55,"mat-panel-title",24)(56,"div",25)(57,"div",34)(58,"div",35),e.EFF(59," Subm\xf3dulos y Permisos "),e.k0s(),e.j41(60,"mat-form-field",36),e.bIt("click",function(){e.eBV(s);const d=e.sdS(53);return e.Njj(d.expanded=!1)}),e.nrm(61,"mat-icon",37)(62,"input",38),e.k0s()()()()(),e.j41(63,"div",39)(64,"div",40),e.Z7z(65,ye,10,4,"section",41,e.fX1),e.k0s()()()()()(),e.j41(67,"div",42)(68,"div",43),e.DNE(69,$e,4,5,"button",18)(70,we,4,5,"button",18),e.k0s()()()}if(2&o){const s=e.sdS(49);e.R7$(9),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(),e.vxM(14,"edit"!==n.windowsMode?14:-1),e.R7$(),e.vxM(15,"edit"===n.windowsMode?15:-1),e.R7$(2),e.Y8G("routerLink","./.."),e.R7$(),e.Y8G("svgIcon","mat_solid:chevron_left"),e.R7$(4),e.vxM(22,"edit"!==n.windowsMode?22:-1),e.R7$(),e.vxM(23,"edit"===n.windowsMode?23:-1),e.R7$(2),e.vxM(25,"new"===n.windowsMode?25:-1),e.R7$(),e.vxM(26,"new"!==n.windowsMode?26:-1),e.R7$(4),e.xc7("border-bottom-left-radius","new"!==n.windowsMode?"0.5rem !important":""),e.Y8G("expanded",!0),e.R7$(),e.Y8G("collapsedHeight","56px"),e.R7$(4),e.Y8G("formGroup",n.roleForm)("autocomplete","off"),e.R7$(5),e.Y8G("svgIcon","mat_solid:notes"),e.R7$(),e.Y8G("type","text")("formControlName","name")("minlength",3)("maxlength",255)("placeholder","Nombre del rol"),e.R7$(),e.vxM(42,n.roleForm.get("name").hasError("required")?42:-1),e.R7$(),e.vxM(43,n.roleForm.get("name").hasError("maxlength")||n.roleForm.get("name").hasError("minlength")?43:-1),e.R7$(4),e.Y8G("svgIcon","mat_solid:notes"),e.R7$(),e.Y8G("formControlName","description")("rows",3)("spellcheck",!1)("maxlength",1e3),e.R7$(3),e.SpI("Total de caracteres ",s.value.length," / 1000"),e.R7$(),e.xc7("border-bottom-left-radius","new"!==n.windowsMode?"0.5rem !important":""),e.Y8G("expanded",!0),e.R7$(2),e.Y8G("collapsedHeight","56px"),e.R7$(6),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.searchInputControl)("autocomplete","off"),e.R7$(3),e.Dyx(n.filteredPermissions),e.R7$(4),e.vxM(69,"new"===n.windowsMode?69:-1),e.R7$(),e.vxM(70,"new"!==n.windowsMode?70:-1)}},dependencies:[a.YN,a.qT,a.me,a.BC,a.cb,a.YS,a.xh,a.tU,a.vS,x.Hl,x.$z,B.g7,B.So,g.MY,g.BS,g.GK,g.Z2,g.WN,f.RG,f.rl,f.nJ,f.MV,f.TL,f.JW,v.m_,v.An,_.fS,_.fg,N.uc,N.oV,ue.uv,$.YU,a.X1,a.l_,a.j4,a.JD,b.Wk],encapsulation:2,changeDetection:0})}return i})(),resolve:{role:y.NH}}]}}]);