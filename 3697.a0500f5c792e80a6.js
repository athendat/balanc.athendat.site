"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[3697],{59013:(W,j,l)=>{l.d(j,{v:()=>P});var I=l(54438),e=l(78693);const P=(d,s)=>(0,I.WQX)(e.q).getPaymentMethods()},84713:(W,j,l)=>{l.d(j,{xi:()=>d});var I=l(59640);const e=s=>s.paymentMethods,d=((0,I.Mz)(e,s=>s.paymentMethod),(0,I.Mz)(e,s=>s.paymentMethods))},78693:(W,j,l)=>{l.d(j,{q:()=>h});var I=l(54438),e=l(96697),P=l(25558),d=l(88141),s=l(73512),b=l(59640),x=l(98216),S=l(20604),k=l(84713),R=l(94794);const A=s.J1`
   query FindAllPaymentMethods($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllPaymentMethods(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            paymentMethods {
                id
                active
                name
                useGateway
            }
        }
    }
`,w=s.J1`
    query FindPaymentMethodById($findPaymentMethodById: String!) {
        findPaymentMethodById(id: $findPaymentMethodById) {
            ok
            message

            paymentMethod {
                id
                active
                name
                useGateway
            }
        }
    }
`,G=s.J1`
    mutation CreatePaymentMethod($createPaymentMethodInput: CreatePaymentMethodInput!) {
        createPaymentMethod(createPaymentMethodInput: $createPaymentMethodInput) {
            ok
            message

            paymentMethod {
                id
                active
                name
                useGateway
            }
        }
    }
`,M=s.J1`
    mutation UpdatePaymentMethod($updatePaymentMethodInput: UpdatePaymentMethodInput!) {
        updatePaymentMethod(updatePaymentMethodInput: $updatePaymentMethodInput) {
            ok
            message

            paymentMethod {
                id
                active
                name
                useGateway
            }
        }
    }
`,$=s.J1`
    mutation RemovePaymentMethod($removePaymentMethodId: String!) {
        removePaymentMethod(id: $removePaymentMethodId) {
            ok
            message
        }
    }
`,D=s.J1`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updatePaymentMethodStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }
    }
`;var X=l(95416);let h=(()=>{class E{constructor(y){this._snackBar=y,this.apolloProvider=(0,I.WQX)(s.Ic),this.store=(0,I.WQX)(b.il),this._apollo=this.apolloProvider.use("BALANC")}createPaymentMethod(y){return this.store.select(k.xi).pipe((0,e.s)(1),(0,P.n)(p=>this._apollo.mutate({mutation:G,variables:{createPaymentMethodInput:y},errorPolicy:"all"}).pipe((0,d.M)(({errors:m,data:g})=>{if(m){let _="";m.forEach(C=>_+=`\n ${C.message}.`),this._snackBar.openFromComponent(R.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:_,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const F=structuredClone(p);F.push(g.createPaymentMethod.paymentMethod),this.store.dispatch((0,S.f)({paymentMethods:F}))}))))}getPaymentMethods(y=0,p=25,m="name",g="asc",F=""){return this._apollo.query({query:A,errorPolicy:"all",variables:{page:y,size:p,sort:m,order:g,search:F}}).pipe((0,d.M)(({errors:_,data:C})=>{if(_){let N="";_.forEach(se=>N+=`\n ${se.message}.`),this._snackBar.openFromComponent(R.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:N,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,S.f)({paymentMethods:C.findAllPaymentMethods.paymentMethods})),this.store.dispatch((0,x.Bp)({pagination:C.findAllPaymentMethods.pagination}))}))}getPaymentMethodById(y){return this._apollo.query({query:w,variables:{findPaymentMethodByIdId:y},errorPolicy:"all"}).pipe((0,d.M)(({errors:p,data:m})=>{if(p){let g="";p.forEach(F=>g+=`\n ${F.message}.`),this._snackBar.openFromComponent(R.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:g,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,S.Ye)({paymentMethod:m.findPaymentMethodById.paymentMethod}))}))}updatePaymentMethod(y){return this.store.select(k.xi).pipe((0,e.s)(1),(0,P.n)(p=>this._apollo.mutate({mutation:M,variables:{updatePaymentMethodInput:y},errorPolicy:"all"}).pipe((0,d.M)(({errors:m,data:g})=>{if(m){let C="";m.forEach(N=>C+=`\n ${N.message}.`),this._snackBar.openFromComponent(R.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:C,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const F=structuredClone(p);F[p.findIndex(C=>C.id===y.id)]=g.updatePaymentMethod.paymentMethod,this.store.dispatch((0,S.f)({paymentMethods:F}))}))))}updatePaymentMethodStatus(y){return this.store.select(k.xi).pipe((0,e.s)(1),(0,P.n)(p=>this._apollo.mutate({mutation:D,variables:{updateEntityStatusInput:y},errorPolicy:"all"}).pipe((0,d.M)(({errors:m})=>{if(m){let _="";m.forEach(C=>_+=`\n ${C.message}.`),this._snackBar.openFromComponent(R.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:_,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const g=structuredClone(p);g[p.findIndex(_=>_.id===y.id)].active=y.active,this.store.dispatch((0,S.f)({paymentMethods:g}))}))))}removePaymentMethod(y){return this.store.select(k.xi).pipe((0,e.s)(1),(0,P.n)(p=>this._apollo.mutate({mutation:$,variables:{removePaymentMethodId:y},errorPolicy:"all"}).pipe((0,d.M)(({errors:m})=>{if(m){let _="";m.forEach(C=>_+=`\n ${C.message}.`),this._snackBar.openFromComponent(R.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:_,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const g=structuredClone(p),F=p.findIndex(_=>_.id===y);g.splice(F,1),this.store.dispatch((0,S.f)({paymentMethods:g}))}))))}static#e=this.\u0275fac=function(p){return new(p||E)(I.KVO(X.UG))};static#t=this.\u0275prov=I.jDH({token:E,factory:E.\u0275fac,providedIn:"root"})}return E})()},3899:(W,j,l)=>{l.d(j,{o:()=>P});const P=(0,l(59640).Mz)(d=>d.rates,d=>d.rates)},25910:(W,j,l)=>{l.d(j,{f:()=>E});var I=l(54438),e=l(96697),P=l(25558),d=l(88141),s=l(96354),b=l(73512),x=l(59640),S=l(98216),k=l(28610),R=l(3899);const A=b.J1`
    mutation CreateRate($createRateInput: CreateRateInput!) {
        createRate(createRateInput: $createRateInput) {

            ok
            message

            rate {
                id
                active
                userId
                date
                name
                value

                currencyRefId
                currencyRef {
                    id
                    name
                    iso
                }

                currencyBaseId
                currencyBase {
                    id
                    name
                    iso
                }
            }

        }
    }
`,w=b.J1`
    mutation UpdateRate($updateRateInput: UpdateRateInput!) {
        updateRate(updateRateInput: $updateRateInput) {
            ok
            message

            rate {
                id
                active
                userId
                date
                name
                value

                currencyRefId
                currencyRef {
                    id
                    name
                    iso
                }

                currencyBaseId
                currencyBase {
                    id
                    name
                    iso
                }
            }
        }
    }
`,G=b.J1`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateRateStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }

    }
`,M=b.J1`
    mutation RemoveRate($removeRateId: String!) {
        removeRate(id: $removeRateId) {
            ok
            message
        }
    }
`,$=b.J1`
    query FindAllRates($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllRates(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length,
                size,
                page,
                lastPage,
                startIndex,
                endIndex
            }

            rates {
                id
                active
                userId
                date
                name
                value

                currencyRefId
                currencyRef {
                    id
                    name
                    iso
                }

                currencyBaseId
                currencyBase {
                    id
                    name
                    iso
                }
            }
        }
    }
`,D=b.J1`
    query FindActiveByBaseId($currencyBaseId: String!) {
        findActiveByBaseId(currencyBaseId: $currencyBaseId) {
            id
            active
            date
            name
            value
            currencyRefId

            currencyRef {
                id
                iso
            }

            currencyBaseId

            currencyBase {
                id
                iso
            }
        }
    }
`,X=b.J1`
    query FindActiveRateByBaseIdForAthendatPlatform($currencyBaseId: String!) {
        getActiveRateByBaseIdForAthendatPlatform(currencyBaseId: $currencyBaseId) {
            id
            active
            date
            name
            value
            currencyRefId

            currencyRef {
                id
                iso
            }

            currencyBaseId

            currencyBase {
                id
                iso
            }
        }
    }
`,h=b.J1`
    query FindRateById($findRateByIdId: String!) {
        findRateById(id: $findRateByIdId) {
            ok
            message

            rate {
                id
                active
                userId
                date
                name
                value

                currencyRefId
                currencyRef {
                    id
                    name
                    iso
                }

                currencyBaseId
                currencyBase {
                    id
                    name
                    iso
                }
            }
        }
    }
`;let E=(()=>{class T{constructor(){this.apolloProvider=(0,I.WQX)(b.Ic),this.store=(0,I.WQX)(x.il),this._apollo=this.apolloProvider.use("BALANC")}createRate(p){return this.store.select(R.o).pipe((0,e.s)(1),(0,P.n)(m=>this._apollo.mutate({mutation:A,variables:{createRateInput:p},errorPolicy:"all"}).pipe((0,d.M)(({data:g})=>{const F=structuredClone(m);F.push(g.createRate.rate),this.store.dispatch((0,k.CD)({rates:F}))}))))}getRates(p=0,m=10,g="name",F="asc",_=""){return this._apollo.query({query:$,errorPolicy:"all",variables:{page:p,size:m,sort:g,order:F,search:_}}).pipe((0,d.M)(({data:C})=>{this.store.dispatch((0,S.Bp)({pagination:C.findAllRates.pagination})),this.store.dispatch((0,k.CD)({rates:C.findAllRates.rates}))}))}findActiveByBaseId(p){return this._apollo.query({query:D,variables:{currencyBaseId:p},errorPolicy:"all"}).pipe((0,s.T)(({data:m})=>m?m.findActiveByBaseId:[]),(0,d.M)(m=>{m&&this.store.dispatch((0,k.CD)({rates:m}))}))}getActiveRateByBaseIdForAthendatPlatform(p){return this._apollo.query({query:X,variables:{currencyBaseId:p},errorPolicy:"all"}).pipe((0,s.T)(({data:m})=>m?m.getActiveRateByBaseIdForAthendatPlatform:null),(0,d.M)(m=>{m&&this.store.dispatch((0,k.r$)({rate:m}))}))}getRateById(p){return this._apollo.query({query:h,variables:{findRateByIdId:p},errorPolicy:"all"}).pipe((0,d.M)(({data:m})=>{this.store.dispatch((0,k.r$)({rate:m.findRateById.rate}))}))}updateRate(p){return this.store.select(R.o).pipe((0,e.s)(1),(0,P.n)(m=>this._apollo.mutate({mutation:w,variables:{updateRateInput:p},errorPolicy:"all"}).pipe((0,d.M)(({data:g})=>{const F=structuredClone(m);F[m.findIndex(C=>C.id===p.id)]=g.updateRate.rate,this.store.dispatch((0,k.CD)({rates:F}))}))))}updateRateStatus(p){return this.store.select(R.o).pipe((0,e.s)(1),(0,P.n)(m=>this._apollo.mutate({mutation:G,variables:{updateEntityStatusInput:p},errorPolicy:"all"}).pipe((0,d.M)(({})=>{const F=structuredClone(m);F[m.findIndex(C=>C.id===p.id)].active=p.active,this.store.dispatch((0,k.CD)({rates:F}))}))))}removeRate(p){return this.store.select(R.o).pipe((0,e.s)(1),(0,P.n)(m=>this._apollo.mutate({mutation:M,variables:{removeRateId:p},errorPolicy:"all"}).pipe((0,d.M)(({data:g})=>{if(g){const F=structuredClone(m),_=m.findIndex(C=>C.id===p);F.splice(_,1),this.store.dispatch((0,k.CD)({rates:F}))}}))))}static#e=this.\u0275fac=function(m){return new(m||T)};static#t=this.\u0275prov=I.jDH({token:T,factory:T.\u0275fac,providedIn:"root"})}return T})()},33697:(W,j,l)=>{l.r(j),l.d(j,{default:()=>Zr});var I=l(51188),e=l(54438);let P=(()=>{class r{static#e=this.\u0275fac=function(o){return new(o||r)};static#t=this.\u0275cmp=e.VBU({type:r,selectors:[["trade-purchases"]],standalone:!0,features:[e.aNF],decls:1,vars:0,template:function(o,i){1&o&&e.nrm(0,"router-outlet")},dependencies:[I.n3],encapsulation:2})}return r})();var d=l(60177),s=l(89417),b=l(88834),x=l(32102),S=l(99213),k=l(59042),R=l(96695),A=l(9183),w=l(30450),G=l(95416),M=l(2042),$=l(7673),D=l(21413),X=l(57786),h=l(56977),E=l(70152),T=l(99172),y=l(70980),p=l(31397),m=l(25558),g=l(96354),F=l(47413),_=l(21781),C=l(84713),N=l(70819),se=l(63729),Fe=l(35526),ve=l(56730),Z=l(33446),K=l(96697),Y=l(88141),Ce=l(98216),J=l(59640);const me=r=>r.suppliers,L=((0,J.Mz)(me,r=>r.supplier),(0,J.Mz)(me,r=>r.suppliers));var V=l(51451),B=l(73512);const ye=B.J1`
    mutation CreateSupplier($createSupplierInput: CreateSupplierInput!) {
        createSupplier(createSupplierInput: $createSupplierInput) {
            ok
            message

            supplier {
                id
                active
                code
                email
                name
                nit
                phone
            }
        }
    }
`,be=B.J1`
    mutation UpdateSupplier($updateSupplierInput: UpdateSupplierInput!) {
        updateSupplier(updateSupplierInput: $updateSupplierInput) {
            ok
            message

            supplier {
                id
                active
                code
                email
                name
                nit
                phone
            }
        }
    }
`,ke=B.J1`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateSupplierStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }
    }
`,xe=B.J1`
    mutation RemoveSupplier($removeSupplierId: String!) {
        removeSupplier(id: $removeSupplierId) {
            ok
            message
        }
    }
`,Ie=B.J1`
    query FindAllSuppliers($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllSuppliers(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length,
                size,
                page,
                lastPage,
                startIndex,
                endIndex
            }

            suppliers {
                id
                active
                code
                email
                name
                nit
                phone
            }
        }
    }
`,Re=B.J1`
    query FindActiveSuppliers($search: String!, $size: Int!) {
        findActiveSuppliers(search: $search, size: $size) {
            id
            active
            code
            email
            name
            nit
            phone
        }
    }
`,Ee=B.J1`
    query FindSupplierById($findSupplierById: String!) {
        findSupplierById(id: $findSupplierById) {
            ok
            message

            supplier {
                id
                active
                code
                email
                name
                nit
                phone
            }
        }
    }
`;let Q=(()=>{class r{constructor(t,o){this.apolloProvider=t,this.store=o,this._apollo=this.apolloProvider.use("BALANC")}createSupplier(t){return this.store.select(L).pipe((0,K.s)(1),(0,m.n)(o=>this._apollo.mutate({mutation:ye,variables:{createSupplierInput:t},errorPolicy:"all"}).pipe((0,Y.M)(({data:i})=>{if(i){const n=(0,Z.A)(o);n.push(i.createSupplier.supplier),this.store.dispatch((0,V.as)({suppliers:n}))}}))))}getSuppliers(t=0,o=25,i="name",n="asc",c=""){return this._apollo.query({query:Ie,errorPolicy:"all",variables:{page:t,size:o,sort:i,order:n,search:c}}).pipe((0,Y.M)(({data:u})=>{u&&(this.store.dispatch((0,V.as)({suppliers:u.findAllSuppliers.suppliers})),this.store.dispatch((0,Ce.Bp)({pagination:u.findAllSuppliers.pagination})))}))}findActiveSuppliers(t="",o=10){return this._apollo.query({query:Re,variables:{search:t,size:o},errorPolicy:"all"}).pipe((0,g.T)(({data:i})=>i?i.findActiveSuppliers:[]),(0,Y.M)(i=>{i&&this.store.dispatch((0,V.as)({suppliers:i}))}))}getSupplierById(t){return this._apollo.query({query:Ee,variables:{findSupplierByIdId:t},errorPolicy:"all"}).pipe((0,Y.M)(({data:o})=>{o&&this.store.dispatch((0,V.hP)({supplier:o.findSupplierById.supplier}))}))}updateSupplier(t){return this.store.select(L).pipe((0,K.s)(1),(0,m.n)(o=>this._apollo.mutate({mutation:be,variables:{updateSupplierInput:t},errorPolicy:"all"}).pipe((0,Y.M)(({data:i})=>{if(i){const n=(0,Z.A)(o);n[o.findIndex(u=>u.id===t.id)]=i.updateSupplier.supplier,this.store.dispatch((0,V.as)({suppliers:n}))}}))))}updatesSupplierStatus(t){return this.store.select(L).pipe((0,K.s)(1),(0,m.n)(o=>this._apollo.mutate({mutation:ke,variables:{updateEntityStatusInput:t},errorPolicy:"all"}).pipe((0,Y.M)(({data:i})=>{if(i){const n=(0,Z.A)(o);n[o.findIndex(u=>u.id===t.id)].active=t.active,this.store.dispatch((0,V.as)({suppliers:n}))}}))))}removeSupplier(t){return this.store.select(L).pipe((0,K.s)(1),(0,m.n)(o=>this._apollo.mutate({mutation:xe,variables:{removeSupplierId:t},errorPolicy:"all"}).pipe((0,Y.M)(({data:i})=>{if(i){const n=(0,Z.A)(o),c=o.findIndex(u=>u.id===t);n.splice(c,1),this.store.dispatch((0,V.as)({suppliers:n}))}}))))}static#e=this.\u0275fac=function(o){return new(o||r)(e.KVO(B.Ic),e.KVO(J.il))};static#t=this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var q=l(94794),Pe=l(78357),ne=l(82765),ee=l(59115),ae=l(64193),te=l(46601),pe=l(32488);const Se=["voucherFilter"],$e=["voucherDateFilter"],je=["supplierFilter"],Me=["paymentMethodFilter"],Te=["statusFilter"],Ge=["paymentStatusFilter"],De=()=>["nueva","recibida","cancelada","rechazada"],Ne=()=>["pendiente","pagada"],Be=r=>({"mr-0":r}),Ae=(r,a)=>({"pointer-events-none":r,hidden:a}),we=()=>[10,25,50,100],Ye=(r,a,t,o)=>({"bg-amber-50 text-amber-700":r,"text-blue-700 bg-blue-50":a,"text-red-700 bg-red-50":t,"text-orange-700 bg-orange-50":o}),Ve=(r,a)=>({"text-primary-700 bg-primary-50":r,"text-green-700 bg-green-50":a});function ze(r,a){if(1&r){const t=e.RV6();e.j41(0,"button",45),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.clearTableFilters())}),e.j41(1,"span",46),e.EFF(2," filter_list_off "),e.k0s()()}}function Ue(r,a){1&r&&e.nrm(0,"mat-icon",58),2&r&&e.Y8G("svgIcon","mat_solid:done")}function Xe(r,a){1&r&&e.nrm(0,"mat-icon",58),2&r&&e.Y8G("svgIcon","mat_solid:done")}function Je(r,a){1&r&&e.nrm(0,"mat-icon",58),2&r&&e.Y8G("svgIcon","mat_solid:done")}function Le(r,a){if(1&r){const t=e.RV6();e.j41(0,"div",47)(1,"div",48),e.EFF(2),e.k0s(),e.j41(3,"div",49),e.EFF(4),e.k0s(),e.j41(5,"div",49),e.EFF(6),e.k0s(),e.j41(7,"div",50),e.EFF(8),e.nI1(9,"date"),e.k0s(),e.j41(10,"div",51),e.EFF(11),e.k0s(),e.j41(12,"div",49),e.EFF(13),e.k0s(),e.j41(14,"div",52)(15,"span"),e.EFF(16),e.nI1(17,"number"),e.k0s(),e.j41(18,"span",53),e.EFF(19),e.k0s()(),e.j41(20,"div",54)(21,"span",55),e.EFF(22),e.nI1(23,"uppercase"),e.k0s()(),e.j41(24,"div",54)(25,"span",55),e.EFF(26),e.nI1(27,"uppercase"),e.k0s()(),e.j41(28,"div",56)(29,"button",57),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(3);return e.Njj(n.viewPurchaseReport(i))}),e.nrm(30,"mat-icon",58),e.k0s(),e.j41(31,"div")(32,"button",59),e.nrm(33,"mat-icon",58),e.k0s(),e.j41(34,"mat-menu",null,6)(36,"div",60),e.EFF(37," Actualizar Estado "),e.k0s(),e.j41(38,"button",61),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(3);return e.Njj(n.updatePurchaseStatus(i.id,null,"pagada"))}),e.j41(39,"div",62),e.DNE(40,Ue,1,1,"mat-icon",58),e.k0s(),e.j41(41,"span",63),e.EFF(42,"Pagada"),e.k0s()(),e.j41(43,"button",61),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(3);return e.Njj(n.updatePurchaseStatus(i.id,"cancelada"))}),e.j41(44,"div",62),e.DNE(45,Xe,1,1,"mat-icon",58),e.k0s(),e.j41(46,"span",63),e.EFF(47,"Cancelada"),e.k0s()(),e.j41(48,"button",61),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(3);return e.Njj(n.updatePurchaseStatus(i.id,"rechazada"))}),e.j41(49,"div",62),e.DNE(50,Je,1,1,"mat-icon",58),e.k0s(),e.j41(51,"span",63),e.EFF(52,"Rechazada"),e.k0s()()()()()()}if(2&r){const t=a.$implicit,o=e.sdS(35);e.R7$(2),e.SpI(" ",t.code," "),e.R7$(2),e.SpI(" ",t.voucher.name," "),e.R7$(2),e.SpI(" ",t.voucherNo," "),e.R7$(2),e.SpI(" ",e.i5U(9,22,t.voucherDate,"dd/MM/yyyy")," "),e.R7$(3),e.SpI(" ",t.supplier.name," "),e.R7$(2),e.SpI(" ",t.paymentMethod.name," "),e.R7$(3),e.JRh(e.i5U(17,25,t.total,"1.2-2")),e.R7$(3),e.JRh(t.currency.iso),e.R7$(),e.Y8G("ngClass",e.ziG(32,Ye,"nueva"===t.status,"recibida"===t.status,"cancelada"===t.status,"rechazada"===t.status)),e.R7$(2),e.SpI(" ",e.bMT(23,28,t.status)," "),e.R7$(2),e.Y8G("ngClass",e.l_i(37,Ve,"pendiente"===t.paymentStatus,"pagada"===t.paymentStatus)),e.R7$(2),e.SpI(" ",e.bMT(27,30,t.paymentStatus)," "),e.R7$(4),e.Y8G("svgIcon","mat_solid:print"),e.R7$(2),e.Y8G("matMenuTriggerFor",o)("disabled",t.status.includes("cancelada")||t.status.includes("rechazada")),e.R7$(),e.Y8G("svgIcon","mat_solid:update"),e.R7$(5),e.Y8G("disabled",t.paymentStatus.includes("pagada")||t.status.includes("cancelada")||t.status.includes("rechazada")),e.R7$(2),e.vxM(40,t.paymentStatus.includes("pagada")?40:-1),e.R7$(3),e.Y8G("disabled",t.paymentStatus.includes("pagada")||t.status.includes("rechazada")||t.status.includes("cancelada")),e.R7$(2),e.vxM(45,t.status.includes("cancelada")?45:-1),e.R7$(3),e.Y8G("disabled",t.paymentStatus.includes("pagada")||t.status.includes("cancelada")||t.status.includes("rechazada")),e.R7$(2),e.vxM(50,t.status.includes("rechazada")?50:-1)}}function Qe(r,a){if(1&r&&e.Z7z(0,Le,53,40,"div",47,e.BUC().trackByFn,!0),2&r){const t=e.XpG();e.Dyx(t)}}function qe(r,a){1&r&&(e.j41(0,"div",64),e.EFF(1," \xa1No se ha registrado ninguna compra! "),e.k0s())}function Oe(r,a){if(1&r){const t=e.RV6();e.j41(0,"div",26)(1,"div",27)(2,"div",28),e.EFF(3," N\xfamero "),e.k0s(),e.j41(4,"div",29)(5,"span",30),e.EFF(6,"T.Comprob..."),e.k0s(),e.j41(7,"table-filter",31,0),e.nI1(9,"async"),e.bIt("dataChange",function(i){e.eBV(t);const n=e.XpG();return e.Njj(n.addVoucher(i))}),e.k0s()(),e.j41(10,"div",32)(11,"span"),e.EFF(12,"No.Comprob..."),e.k0s()(),e.j41(13,"div",33)(14,"span",34),e.EFF(15,"F.Comprob..."),e.k0s(),e.j41(16,"table-filter",35,1),e.bIt("dataChange",function(i){e.eBV(t);const n=e.XpG();return e.Njj(n.addDate(i))}),e.k0s()(),e.j41(18,"div",36)(19,"span"),e.EFF(20,"Proveedor"),e.k0s(),e.j41(21,"table-filter",37,2),e.bIt("dataChange",function(i){e.eBV(t);const n=e.XpG();return e.Njj(n.addSupplier(i))}),e.k0s()(),e.j41(23,"div",29)(24,"span",38),e.EFF(25,"M.Pago"),e.k0s(),e.j41(26,"table-filter",31,3),e.nI1(28,"async"),e.bIt("dataChange",function(i){e.eBV(t);const n=e.XpG();return e.Njj(n.addPaymentMethod(i))}),e.k0s()(),e.j41(29,"div",39)(30,"span"),e.EFF(31,"Importe"),e.k0s()(),e.j41(32,"div",29)(33,"span",34),e.EFF(34,"Estado"),e.k0s(),e.j41(35,"table-filter",40,4),e.bIt("dataChange",function(i){e.eBV(t);const n=e.XpG();return e.Njj(n.addStatus(i))}),e.k0s()(),e.j41(37,"div",29)(38,"span",41),e.EFF(39,"E.Pago"),e.k0s(),e.j41(40,"table-filter",40,5),e.bIt("dataChange",function(i){e.eBV(t);const n=e.XpG();return e.Njj(n.addPaymentStatus(i))}),e.k0s()(),e.j41(42,"div",42)(43,"span"),e.EFF(44,"Acciones"),e.k0s(),e.DNE(45,ze,3,0,"button",43),e.k0s()(),e.DNE(46,Qe,2,0)(47,qe,2,0),e.nrm(48,"mat-paginator",44),e.k0s()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("mat-sort-header","code"),e.R7$(5),e.Y8G("filterType","multiSelectEntity")("entityPropertyName","name")("useUpperCase",!1)("data",e.bMT(9,31,t.vouchers$)),e.R7$(3),e.Y8G("mat-sort-header","voucherNo"),e.R7$(4),e.Y8G("mat-sort-header","voucherDate"),e.R7$(2),e.Y8G("filterType","date"),e.R7$(5),e.Y8G("filterType","filterEntity")("searchEntityControl",t.searchSuppliersControl)("entitiesFiltered",t.suppliersFiltered),e.R7$(5),e.Y8G("filterType","multiSelectEntity")("entityPropertyName","name")("useUpperCase",!1)("data",e.bMT(28,33,t.paymentMethods$)),e.R7$(3),e.Y8G("mat-sort-header","total"),e.R7$(4),e.Y8G("mat-sort-header","status"),e.R7$(2),e.Y8G("filterType","multiSelect")("data",e.lJ4(35,De)),e.R7$(3),e.Y8G("mat-sort-header","paymentStatus"),e.R7$(2),e.Y8G("filterType","multiSelect")("data",e.lJ4(36,Ne)),e.R7$(2),e.Y8G("ngClass",e.eq3(37,Be,t.existTableFilter())),e.R7$(3),e.vxM(45,t.existTableFilter()?45:-1),e.R7$(),e.vxM(46,a.length>0?46:47),e.R7$(2),e.Y8G("ngClass",e.l_i(39,Ae,t.isLoading,t.pagination.length<10&&t.pagination.page<1))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.lJ4(42,we))("showFirstLastButtons",!0)}}let We=(()=>{class r{constructor(t,o,i,n){this._changeDetectorRef=t,this._fuseConfirmationService=o,this._purchasesService=i,this.store=n,this.isLoading=!1,this.purchases$=(0,$.of)([]),this.searchInputControl=new s.MJ(null),this.selectedSupplier=null,this.searchSuppliersControl=new s.MJ(null),this.filterInputControl=new s.MJ,this.selectedVouchersId=[],this.selectedPaymentMethodsId=[],this.selectedDate=null,this.selectedStatus=[],this.selectedPaymentStatus=[],this.vouchers$=(0,$.of)([]),this.paymentMethods$=(0,$.of)([]),this.merchant=null,this.user=null,this._snackBar=(0,e.WQX)(G.UG),this._suppliersService=(0,e.WQX)(Q),this._unsubscribeAll=new D.B,this._documentsService=(0,e.WQX)(ve.Q)}ngOnInit(){this.store.select(se.SW).pipe((0,h.Q)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(N.Xb).pipe((0,h.Q)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(F.D).pipe((0,h.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.vouchers$=this.store.select(_.gQ),this.paymentMethods$=this.store.select(C.xi),this.purchases$=this.store.select(Fe.vY),this.suppliersFiltered=this.searchSuppliersControl.valueChanges.pipe((0,E.B)(200),(0,T.Z)(null),(0,y.j)(()=>{this.isLoading=!1}),(0,p.Z)(t=>null!==t&&"string"==typeof t&&(this.selectedSupplier&&t!==this.selectedSupplier.name||!this.selectedSupplier)?(this.isLoading=!0,this._suppliersService.findActiveSuppliers(t.trim())):(0,$.of)())),this.searchInputControl.valueChanges.pipe((0,h.Q)(this._unsubscribeAll),(0,y.j)(()=>{this.isLoading=!1}),(0,E.B)(300),(0,m.n)(t=>{if(null!==t)return this.isLoading=!0,this._purchasesService.getPurchases(0,25,"code","desc",t,this.selectedSupplier?this.selectedSupplier.id:null,this.selectedVouchersId,this.selectedPaymentMethodsId,this.selectedStatus,this.selectedPaymentStatus,this.selectedDate)}),(0,g.T)(()=>{this.isLoading=!1})).subscribe(),this.filterInputControl.valueChanges.pipe((0,h.Q)(this._unsubscribeAll),(0,E.B)(300),(0,m.n)(t=>(this.isLoading=!0,this._purchasesService.getPurchases(0,25,"code","desc",this.searchInputControl.value,this.selectedSupplier?this.selectedSupplier.id:null,this.selectedVouchersId,this.selectedPaymentMethodsId,this.selectedStatus,this.selectedPaymentStatus,this.selectedDate))),(0,g.T)(()=>{this.isLoading=!1})).subscribe(),this.suppliersFiltered=this.searchSuppliersControl.valueChanges.pipe((0,E.B)(200),(0,T.Z)(null),(0,y.j)(()=>{this.isLoading=!1}),(0,p.Z)(t=>null!==t&&"string"==typeof t&&(this.selectedSupplier&&t!==this.selectedSupplier.name||!this.selectedSupplier)?(this.isLoading=!0,this._suppliersService.findActiveSuppliers(t.trim())):(0,$.of)()))}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"code",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,h.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,X.h)(this._sort.sortChange,this._paginator.page).pipe((0,m.n)(()=>(this.isLoading=!0,this._purchasesService.getPurchases(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,g.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}resetSupplier(){this.selectedSupplier=null,this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addSupplier(t){this.selectedSupplier=t,this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addVoucher(t){this.selectedVouchersId=t.map(o=>o.id),this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addPaymentMethod(t){this.selectedPaymentMethodsId=t.map(o=>o.id),this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addDate(t){this.selectedDate=t,this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addStatus(t){this.selectedStatus=t,this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addPaymentStatus(t){this.selectedPaymentStatus=t,this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}updatePurchaseStatus(t,o,i){this._fuseConfirmationService.open({title:"Actualizar Estado de la Compra",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(c=>{"confirmed"===c&&this._purchasesService.updatePurchaseStatus(t,o,i).pipe((0,h.Q)(this._unsubscribeAll)).subscribe(({data:u})=>{this._snackBar.openFromComponent(q.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:u.updatePurchaseStatus.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}})}),this._changeDetectorRef.markForCheck()})}trackByFn(t,o){return o.id||t}viewPurchaseReport(t){this._documentsService.generatePurchaseDocument(t,this.merchant,this.user)}existTableFilter(){return this.voucherFilter?.hasFilter||this.voucherDateFilter?.hasFilter||this.supplierFilter?.hasFilter||this.paymentMethodDateFilter?.hasFilter||this.statusFilter?.hasFilter||this.paymentStatusFilter?.hasFilter}clearTableFilters(){this.voucherFilter?.hasFilter&&this.voucherFilter.clearFilter(),this.voucherDateFilter?.hasFilter&&this.voucherDateFilter.clearFilter(),this.supplierFilter?.hasFilter&&this.supplierFilter.clearFilter(),this.paymentMethodDateFilter?.hasFilter&&this.paymentMethodDateFilter.clearFilter(),this.statusFilter?.hasFilter&&this.statusFilter.clearFilter(),this.paymentStatusFilter?.hasFilter&&this.paymentStatusFilter.clearFilter()}static#e=this.\u0275fac=function(o){return new(o||r)(e.rXU(e.gRc),e.rXU(te.G),e.rXU(pe.W),e.rXU(J.il))};static#t=this.\u0275cmp=e.VBU({type:r,selectors:[["purchases-list"]],viewQuery:function(o,i){if(1&o&&(e.GBs(R.iy,5),e.GBs(M.B4,5),e.GBs(Se,5),e.GBs($e,5),e.GBs(je,5),e.GBs(Me,5),e.GBs(Te,5),e.GBs(Ge,5)),2&o){let n;e.mGM(n=e.lsd())&&(i._paginator=n.first),e.mGM(n=e.lsd())&&(i._sort=n.first),e.mGM(n=e.lsd())&&(i.voucherFilter=n.first),e.mGM(n=e.lsd())&&(i.voucherDateFilter=n.first),e.mGM(n=e.lsd())&&(i.supplierFilter=n.first),e.mGM(n=e.lsd())&&(i.paymentMethodDateFilter=n.first),e.mGM(n=e.lsd())&&(i.statusFilter=n.first),e.mGM(n=e.lsd())&&(i.paymentStatusFilter=n.first)}},standalone:!0,features:[e.aNF],decls:26,vars:10,consts:[["voucherFilter",""],["voucherDateFilter",""],["supplierFilter",""],["paymentMethodFilter",""],["statusFilter",""],["paymentStatusFilter",""],["listStatusMenu","matMenu"],["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","flex-wrap","items-center","w-full","gap-2","mt-6","md:fixed","right-8","shrink-0","lg:mt-0","lg:ml-4","lg:w-auto","sm:w-1/2"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","","routerLink","/modules/trade/purchases/form",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto"],[1,"z-10","flex","flex-col","flex-auto","bg-white","dark:bg-default"],[1,"relative","grid","border-t"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","purchase-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"",3,"mat-sort-header"],[1,"flex","items-center","justify-center"],["matTooltip","Tipo de Comprobante"],[3,"dataChange","filterType","entityPropertyName","useUpperCase","data"],["matTooltip","N\xfamero de Comprobante",1,"flex","justify-center",3,"mat-sort-header"],["matTooltip","Fecha de Comprobante",1,"flex","justify-center"],[3,"mat-sort-header"],[3,"dataChange","filterType"],[1,"flex","items-center","justify-start"],[3,"dataChange","filterType","searchEntityControl","entitiesFiltered"],["matTooltip","M\xe9todo de pago"],[1,"flex","justify-end",3,"mat-sort-header"],[3,"dataChange","filterType","data"],["matTooltip","Estado del pago",3,"mat-sort-header"],[1,"flex","items-center","justify-end","mr-6",3,"ngClass"],["color","warn","mat-icon-button","","matTooltip","Limpiar filtros",1,"w-6","h-6","min-h-6","min-w-6"],[1,"border-b","first-letter:z-10","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-gray-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],["color","warn","mat-icon-button","","matTooltip","Limpiar filtros",1,"w-6","h-6","min-h-6","min-w-6",3,"click"],[1,"material-icons","icon-size-4"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","border-b","purchase-grid","md:px-8"],[1,"font-mono"],[1,"text-center"],[1,"font-mono","text-center"],[1,"truncate"],[1,"flex","flex-row","justify-center","space-x-1","font-mono"],[1,"text-xs","text-secondary"],[1,"flex","items-center","justify-center","mr-4","text-center","truncate","delay-100","rounded-full","h-7","lock","dark:bg-white","dark:bg-opacity-5",3,"ngClass"],[1,"w-full","px-2","text-sm","font-medium","text-center"],[1,"flex","flex-row","justify-end","gap-2","mr-2"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","","matTooltip","Actualizar estado de la compra",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matMenuTriggerFor","disabled"],[1,"w-full","p-2","text-lg","font-semibold","text-center","text-secondary"],["mat-menu-item","",1,"grid","w-full","grid-cols-4",3,"click","disabled"],[1,"col-span-1"],[1,"col-span-3","text-center"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(o,i){if(1&o&&(e.j41(0,"div",7)(1,"div",8)(2,"div",9)(3,"div",10)(4,"div")(5,"a",11),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",12),e.nrm(8,"mat-icon",13),e.j41(9,"a",14),e.EFF(10,"Compras"),e.k0s()()(),e.j41(11,"div",15)(12,"h2",16),e.EFF(13," Facturas de Compras "),e.k0s()()(),e.j41(14,"div",17)(15,"mat-form-field",18),e.nrm(16,"mat-icon",19)(17,"input",20),e.k0s(),e.j41(18,"button",21),e.nrm(19,"mat-icon",22),e.j41(20,"span",23),e.EFF(21,"Registrar"),e.k0s()()()(),e.j41(22,"div",24)(23,"div",25),e.DNE(24,Oe,49,43,"div",26),e.nI1(25,"async"),e.k0s()()()),2&o){let n;e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Escriba para buscar"),e.R7$(2),e.Y8G("svgIcon","mat_solid:add"),e.R7$(5),e.vxM(24,(n=e.bMT(25,8,i.purchases$))?24:-1,n)}},dependencies:[d.Jj,d.vh,d.QX,ae.p,b.Hl,b.$z,b.iY,ne.g7,x.RG,x.rl,x.JW,S.m_,S.An,k.fS,k.fg,ee.Cn,ee.kk,ee.fb,ee.Cp,R.Ou,R.iy,A.D6,w.mV,M.NQ,M.B4,M.aE,d.YU,s.X1,s.me,s.BC,s.l_,I.Wk,Pe.i,d.Pc],styles:[".purchase-grid{grid-template-columns:130px 150px 110px 130px 150px 100px 130px 100px 100px auto}@media (min-width: 1280px){.purchase-grid{grid-template-columns:120px 150px 110px 130px 150px 100px 100px 100px 100px auto}}\n"],encapsulation:2,changeDetection:0})}return r})(),He=(()=>{class r{static#e=this.\u0275fac=function(o){return new(o||r)};static#t=this.\u0275cmp=e.VBU({type:r,selectors:[["app-purchase-details"]],standalone:!0,features:[e.aNF],decls:2,vars:0,template:function(o,i){1&o&&(e.j41(0,"p"),e.EFF(1,"purchase-details works!"),e.k0s())},encapsulation:2})}return r})();var le=l(82798),ce=l(60850),de=l(14823),re=l(25084),oe=l(75351),Ze=l(91401),he=l(13189),Ke=l(39928),et=l(17085),tt=l(99184),rt=l(25910),ot=l(36296),it=l(68824),st=l(77005),ue=l(55364),z=l(53328),nt=l(86600);const at=["stockTemplateFile"],lt=(r,a)=>a.id,ct=()=>({suppressScrollX:!0}),ut=()=>({suppressScrollY:!0}),mt=r=>({"cursor-pointer shadow":r}),pt=(r,a)=>({"bg-gray-50 dark:bg-primary dark:bg-opacity-5":r,"bg-white dark:bg-transparent":a}),dt=r=>({"text-warn":r}),ht=()=>["$"],ft=r=>({$implicit:r});function gt(r,a){if(1&r){const t=e.RV6();e.j41(0,"mat-option",60),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.selectSupplier(i))}),e.EFF(1),e.k0s()}if(2&r){const t=a.$implicit;e.Y8G("value",t),e.R7$(),e.SpI(" ",t.name," ")}}function _t(r,a){if(1&r&&(e.j41(0,"mat-option",28),e.EFF(1),e.k0s()),2&r){const t=a.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function Ft(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," El tipo de comprobante es obligatorio "),e.k0s())}function vt(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," El n\xfamero del comprobante es obligatorio "),e.k0s())}function Ct(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," La fecha del comprobante es obligatoria "),e.k0s())}function yt(r,a){if(1&r&&(e.j41(0,"mat-option",28),e.EFF(1),e.k0s()),2&r){const t=a.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function bt(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," El tipo de comprobante es obligatorio "),e.k0s())}function kt(r,a){if(1&r){const t=e.RV6();e.j41(0,"mat-option",60),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.selectedCurrencyIso=i.iso)}),e.EFF(1),e.k0s()}if(2&r){const t=a.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.iso," ")}}function xt(r,a){if(1&r&&(e.j41(0,"span",36),e.EFF(1),e.k0s()),2&r){let t;const o=e.XpG();e.R7$(),e.Lme(" (+ ",2===(null==(t=o.purchaseForm.get("rates").value)?null:t.length)?"otro":"otros"," ",o.purchaseForm.get("rates").value.length>2?o.purchaseForm.get("rates").value.length-1:"",") ")}}function It(r,a){if(1&r&&(e.j41(0,"mat-option",28)(1,"span",61),e.EFF(2),e.nI1(3,"number"),e.k0s(),e.j41(4,"span"),e.EFF(5),e.k0s()()),2&r){const t=a.$implicit;e.Y8G("value",t),e.R7$(2),e.JRh(e.i5U(3,3,t.value,"1.4-4")),e.R7$(3),e.SpI(" ",t.name,"")}}function Rt(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," Las tasas de cambio son requeridas "),e.k0s())}function Et(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," El costo de FOB es obligatorio "),e.k0s())}function Pt(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," El costo de FOB debe ser mayor que 0 "),e.k0s())}function St(r,a){if(1&r&&(e.j41(0,"div",39)(1,"mat-form-field",62)(2,"mat-label"),e.EFF(3,"Costos FOB"),e.k0s(),e.nrm(4,"input",63),e.DNE(5,Et,2,0,"mat-error")(6,Pt,2,0,"mat-error"),e.k0s()()),2&r){const t=e.XpG();e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","fobCosts"),e.R7$(),e.vxM(5,t.purchaseForm.get("indirectCost").get("fobCosts").hasError("required")?5:-1),e.R7$(),e.vxM(6,t.purchaseForm.get("indirectCost").get("fobCosts").hasError("min")?6:-1)}}function $t(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," El flete es obligatorio "),e.k0s())}function jt(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," El flete debe ser mayor que 0 "),e.k0s())}function Mt(r,a){if(1&r&&(e.j41(0,"div",39)(1,"mat-form-field",62)(2,"mat-label"),e.EFF(3,"Flete"),e.k0s(),e.nrm(4,"input",63),e.DNE(5,$t,2,0,"mat-error")(6,jt,2,0,"mat-error"),e.k0s()()),2&r){const t=e.XpG();e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","freight"),e.R7$(),e.vxM(5,t.purchaseForm.get("indirectCost").get("freight").hasError("required")?5:-1),e.R7$(),e.vxM(6,t.purchaseForm.get("indirectCost").get("freight").hasError("min")?6:-1)}}function Tt(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," Los aranceles son obligatorios "),e.k0s())}function Gt(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," Los aranceles deben ser mayores que 0 "),e.k0s())}function Dt(r,a){if(1&r&&(e.j41(0,"div",39)(1,"mat-form-field",62)(2,"mat-label"),e.EFF(3,"Aranceles"),e.k0s(),e.nrm(4,"input",63),e.DNE(5,Tt,2,0,"mat-error")(6,Gt,2,0,"mat-error"),e.k0s()()),2&r){const t=e.XpG();e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","customsDuties"),e.R7$(),e.vxM(5,t.purchaseForm.get("indirectCost").get("customsDuties").hasError("required")?5:-1),e.R7$(),e.vxM(6,t.purchaseForm.get("indirectCost").get("customsDuties").hasError("min")?6:-1)}}function Nt(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," Los servicios aduanales son obligatorios "),e.k0s())}function Bt(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," Los servicios aduanales deben ser mayores que 0 "),e.k0s())}function At(r,a){if(1&r&&(e.j41(0,"div",39)(1,"mat-form-field",62)(2,"mat-label"),e.EFF(3,"Servicios Aduanales"),e.k0s(),e.nrm(4,"input",63),e.DNE(5,Nt,2,0,"mat-error")(6,Bt,2,0,"mat-error"),e.k0s()()),2&r){const t=e.XpG();e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","customsServices"),e.R7$(),e.vxM(5,t.purchaseForm.get("indirectCost").get("customsServices").hasError("required")?5:-1),e.R7$(),e.vxM(6,t.purchaseForm.get("indirectCost").get("customsServices").hasError("min")?6:-1)}}function wt(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," El seguro es obligatorio "),e.k0s())}function Yt(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," El seguro debe ser mayor que 0 "),e.k0s())}function Vt(r,a){if(1&r&&(e.j41(0,"div",39)(1,"mat-form-field",62)(2,"mat-label"),e.EFF(3,"Seguro"),e.k0s(),e.nrm(4,"input",63),e.DNE(5,wt,2,0,"mat-error")(6,Yt,2,0,"mat-error"),e.k0s()()),2&r){const t=e.XpG();e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","insurance"),e.R7$(),e.vxM(5,t.purchaseForm.get("indirectCost").get("insurance").hasError("required")?5:-1),e.R7$(),e.vxM(6,t.purchaseForm.get("indirectCost").get("insurance").hasError("min")?6:-1)}}function zt(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," La transportaci\xf3n es obligatoria "),e.k0s())}function Ut(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," La transportaci\xf3n debe ser mayor que 0 "),e.k0s())}function Xt(r,a){if(1&r&&(e.j41(0,"div",39)(1,"mat-form-field",62)(2,"mat-label"),e.EFF(3,"Transportaci\xf3n"),e.k0s(),e.nrm(4,"input",63),e.DNE(5,zt,2,0,"mat-error")(6,Ut,2,0,"mat-error"),e.k0s()()),2&r){const t=e.XpG();e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","transportation"),e.R7$(),e.vxM(5,t.purchaseForm.get("indirectCost").get("transportation").hasError("required")?5:-1),e.R7$(),e.vxM(6,t.purchaseForm.get("indirectCost").get("transportation").hasError("min")?6:-1)}}function Jt(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," La descarga es obligatoria "),e.k0s())}function Lt(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," La descarga debe ser mayor que 0 "),e.k0s())}function Qt(r,a){if(1&r&&(e.j41(0,"div",39)(1,"mat-form-field",62)(2,"mat-label"),e.EFF(3,"Descarga"),e.k0s(),e.nrm(4,"input",63),e.DNE(5,Jt,2,0,"mat-error")(6,Lt,2,0,"mat-error"),e.k0s()()),2&r){const t=e.XpG();e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","unloading"),e.R7$(),e.vxM(5,t.purchaseForm.get("indirectCost").get("unloading").hasError("required")?5:-1),e.R7$(),e.vxM(6,t.purchaseForm.get("indirectCost").get("unloading").hasError("min")?6:-1)}}function qt(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," Otros Gastos son obligatorios "),e.k0s())}function Ot(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," Otros Gastos deben ser mayores que 0 "),e.k0s())}function Wt(r,a){if(1&r&&(e.j41(0,"div",39)(1,"mat-form-field",62)(2,"mat-label"),e.EFF(3,"Otros Gastos"),e.k0s(),e.nrm(4,"input",63),e.DNE(5,qt,2,0,"mat-error")(6,Ot,2,0,"mat-error"),e.k0s()()),2&r){const t=e.XpG();e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","otherCosts"),e.R7$(),e.vxM(5,t.purchaseForm.get("indirectCost").get("otherCosts").hasError("required")?5:-1),e.R7$(),e.vxM(6,t.purchaseForm.get("indirectCost").get("otherCosts").hasError("min")?6:-1)}}function Ht(r,a){if(1&r){const t=e.RV6();e.j41(0,"mat-option",64),e.bIt("click",function(i){const n=e.eBV(t).$implicit;return e.XpG().addProductToPurchase(n),e.Njj(i.stopPropagation())}),e.j41(1,"div",65),e.bIt("click",function(i){const n=e.eBV(t).$implicit;return e.XpG().addProductToPurchase(n),e.Njj(i.stopPropagation())}),e.j41(2,"span",66),e.nrm(3,"mat-checkbox",67),e.EFF(4),e.k0s(),e.j41(5,"span",68),e.EFF(6),e.k0s(),e.j41(7,"span",68),e.EFF(8),e.k0s()()()}if(2&r){const t=a.$implicit;e.Y8G("value",t),e.R7$(3),e.Y8G("checked",t.checked),e.R7$(),e.SpI(" ",t.name," "),e.R7$(2),e.JRh(t.currency.iso),e.R7$(2),e.JRh(t.uom.abbr)}}function Zt(r,a){1&r&&(e.j41(0,"span",78),e.EFF(1,"Sin nombre"),e.k0s())}function Kt(r,a){1&r&&(e.j41(0,"mat-error",85),e.EFF(1," Valor m\xednimo 0.1 "),e.k0s())}function er(r,a){1&r&&(e.j41(0,"mat-error",85),e.EFF(1," Valor requerido "),e.k0s())}function tr(r,a){1&r&&(e.j41(0,"mat-error",85),e.EFF(1," Patr\xf3n no v\xe1lido "),e.k0s())}function rr(r,a){1&r&&(e.j41(0,"mat-error",85),e.EFF(1," Valor m\xednimo 0 "),e.k0s())}function or(r,a){1&r&&(e.j41(0,"mat-error",85),e.EFF(1," Valor requerido "),e.k0s())}function ir(r,a){1&r&&(e.j41(0,"mat-error",85),e.EFF(1," Valor m\xednimo 0 "),e.k0s())}function sr(r,a){1&r&&(e.j41(0,"mat-error",85),e.EFF(1," Valor requerido "),e.k0s())}function nr(r,a){1&r&&e.eu8(0)}function ar(r,a){if(1&r&&e.DNE(0,nr,1,0,"ng-container",92),2&r){const t=e.XpG().$implicit;e.XpG(2);const o=e.sdS(128);e.Y8G("ngTemplateOutlet",o)("ngTemplateOutletContext",e.eq3(2,ft,t))}}function lr(r,a){if(1&r){const t=e.RV6();e.j41(0,"div",76)(1,"div"),e.EFF(2),e.k0s(),e.j41(3,"div",77),e.EFF(4),e.DNE(5,Zt,2,0,"span",78),e.k0s(),e.j41(6,"div",79),e.EFF(7),e.k0s(),e.j41(8,"div",71),e.EFF(9),e.k0s(),e.j41(10,"div",80)(11,"div",81)(12,"button",82),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(2);return e.Njj(n.decrementProductQty(i))}),e.nrm(13,"mat-icon",49),e.k0s(),e.j41(14,"mat-form-field",83),e.nrm(15,"input",84),e.k0s(),e.j41(16,"button",82),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(2);return e.Njj(n.incrementProductQty(i))}),e.nrm(17,"mat-icon",49),e.k0s()(),e.DNE(18,Kt,2,0,"mat-error",85)(19,er,2,0,"mat-error",85)(20,tr,2,0,"mat-error",85),e.k0s(),e.j41(21,"div",86)(22,"mat-form-field",83),e.nrm(23,"input",87),e.k0s(),e.DNE(24,rr,2,0,"mat-error",85)(25,or,2,0,"mat-error",85),e.k0s(),e.j41(26,"div",71),e.EFF(27),e.nI1(28,"number"),e.k0s(),e.j41(29,"div",88),e.EFF(30),e.nI1(31,"currency"),e.k0s(),e.j41(32,"div",86)(33,"mat-form-field",83),e.nrm(34,"input",87),e.k0s(),e.DNE(35,ir,2,0,"mat-error",85)(36,sr,2,0,"mat-error",85),e.k0s(),e.j41(37,"div",89)(38,"button",90),e.bIt("click",function(){const i=e.eBV(t),n=i.$implicit,c=i.$index,u=e.XpG(2);return e.Njj(u.toggleProductDetail(n,c))}),e.nrm(39,"mat-icon",49),e.k0s(),e.j41(40,"button",91),e.bIt("click",function(){const i=e.eBV(t).$index,n=e.XpG(2);return e.Njj(n.removeProductToPurchase(i))}),e.nrm(41,"mat-icon",49),e.k0s()()(),e.j41(42,"div",58),e.DNE(43,ar,1,4,"ng-container"),e.k0s()}if(2&r){const t=a.$implicit,o=a.$index,i=e.XpG(2);e.Y8G("ngClass",e.l_i(43,pt,i.selectedProductIndex===o,i.selectedProductIndex!==o)),e.R7$(2),e.SpI(" ",o+1," "),e.R7$(),e.Y8G("matTooltip",t.get("name").value),e.R7$(),e.SpI(" ",t.get("name").value," "),e.R7$(),e.vxM(5,t.get("name").value?-1:5),e.R7$(),e.Y8G("ngClass",e.eq3(46,dt,!t.get("rate").value)),e.R7$(),e.SpI(" ",t.get("rate").value?i.selectedCurrencyIso:t.get("currency").value," "),e.R7$(2),e.SpI(" ",t.get("uom").value," "),e.R7$(3),e.Y8G("disabled",t.get("quantity").value<=.1||t.get("quantity").hasError("pattern")),e.R7$(),e.Y8G("svgIcon","mat_solid:remove"),e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("min",.1)("formControl",t.get("quantity")),e.R7$(),e.Y8G("disabled",t.get("quantity").hasError("pattern")),e.R7$(),e.Y8G("svgIcon","mat_solid:add"),e.R7$(),e.vxM(18,t.get("quantity").hasError("min")?18:-1),e.R7$(),e.vxM(19,t.get("quantity").hasError("required")?19:-1),e.R7$(),e.vxM(20,t.get("quantity").hasError("pattern")&&!t.get("quantity").hasError("min")?20:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("min",0)("max",99999)("formControl",t.get("cost")),e.R7$(),e.vxM(24,t.get("cost").hasError("min")?24:-1),e.R7$(),e.vxM(25,t.get("cost").hasError("required")?25:-1),e.R7$(2),e.SpI(" ",e.i5U(28,37,t.get("cui").value,"1.2-2")," "),e.R7$(3),e.SpI(" ",e.i5U(31,40,t.get("ct").value,e.lJ4(48,ht))," "),e.R7$(3),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("min",0)("max",9999999)("formControl",t.get("price")),e.R7$(),e.vxM(35,t.get("price").hasError("min")?35:-1),e.R7$(),e.vxM(36,t.get("price").hasError("required")?36:-1),e.R7$(2),e.Y8G("color",t.invalid&&!t.get("productId").value?"warn":"")("disabled",t.get("productId").value),e.R7$(),e.Y8G("svgIcon",i.selectedProductIndex===o?"mat_solid:expand_more":"mat_solid:expand_less"),e.R7$(2),e.Y8G("svgIcon","mat_solid:close"),e.R7$(2),e.vxM(43,i.selectedProductIndex===o?43:-1)}}function cr(r,a){if(1&r&&(e.j41(0,"div",58)(1,"div",69),e.nrm(2,"div"),e.j41(3,"div",70),e.EFF(4," Producto "),e.k0s(),e.j41(5,"div",71),e.EFF(6," Moneda "),e.k0s(),e.j41(7,"div",71),e.EFF(8," UM "),e.k0s(),e.j41(9,"div",71),e.EFF(10," Cantidad "),e.k0s(),e.j41(11,"div",72),e.EFF(12," Costo "),e.k0s(),e.j41(13,"div",73),e.EFF(14," Costo Indirecto "),e.k0s(),e.j41(15,"div",74),e.EFF(16," Costo Total "),e.k0s(),e.j41(17,"div",71),e.EFF(18," Precio "),e.k0s(),e.j41(19,"div",75),e.EFF(20," Acciones "),e.k0s()(),e.Z7z(21,lr,44,49,null,null,lt),e.k0s()),2&r){const t=e.XpG();e.R7$(21),e.Dyx(t.purchaseForm.get("products").controls)}}function ur(r,a){1&r&&(e.j41(0,"div",93),e.EFF(1," \xa1No ha seleccionado ning\xfan producto a\xfan! "),e.k0s())}function mr(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," El c\xf3digo de barras es obligatorio "),e.k0s())}function pr(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," Valor entre 3 y 255 caracteres. "),e.k0s())}function dr(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," Valor entre 3 y 255 caracteres. "),e.k0s())}function hr(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," Valor entre 3 y 255 caracteres. "),e.k0s())}function fr(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," El nombre es obligatorio "),e.k0s())}function gr(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," Valor entre 3 y 255 caracteres. "),e.k0s())}function _r(r,a){if(1&r&&(e.j41(0,"mat-option",28),e.EFF(1),e.k0s()),2&r){const t=a.$implicit;e.Y8G("value",t.abbr),e.R7$(),e.SpI(" ",t.abbr," ")}}function Fr(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," El peso debe ser mayor que 0 "),e.k0s())}function vr(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," El ancho debe ser mayor que 0 "),e.k0s())}function Cr(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," El largo debe ser mayor que 0 "),e.k0s())}function yr(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," La altura debe ser mayor que 0 "),e.k0s())}function br(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1," El volumen debe ser mayor que 0 "),e.k0s())}function kr(r,a){if(1&r&&(e.j41(0,"div",94)(1,"form",95)(2,"div",96)(3,"mat-form-field",97)(4,"mat-label"),e.EFF(5,"UPC"),e.k0s(),e.nrm(6,"input",98),e.DNE(7,mr,2,0,"mat-error")(8,pr,2,0,"mat-error"),e.k0s()(),e.j41(9,"div",96)(10,"mat-form-field",62)(11,"mat-label"),e.EFF(12,"SKU"),e.k0s(),e.nrm(13,"input",99),e.DNE(14,dr,2,0,"mat-error"),e.k0s()(),e.j41(15,"div",96)(16,"mat-form-field",62)(17,"mat-label"),e.EFF(18,"C\xf3digo"),e.k0s(),e.nrm(19,"input",99),e.DNE(20,hr,2,0,"mat-error"),e.k0s()(),e.j41(21,"div",96)(22,"mat-form-field",62)(23,"mat-label"),e.EFF(24,"Nombre"),e.k0s(),e.nrm(25,"input",98),e.DNE(26,fr,2,0,"mat-error")(27,gr,2,0,"mat-error"),e.k0s()(),e.j41(28,"div"),e.qex(29),e.j41(30,"mat-form-field",62)(31,"mat-label"),e.EFF(32,"Unidad de Medida"),e.k0s(),e.j41(33,"mat-select",100),e.Z7z(34,_r,2,2,"mat-option",28,e.fX1),e.nI1(36,"async"),e.k0s()(),e.bVm(),e.k0s(),e.j41(37,"div",96)(38,"mat-form-field",62)(39,"mat-label"),e.EFF(40,"Marca"),e.k0s(),e.nrm(41,"input",101),e.k0s()(),e.j41(42,"div")(43,"mat-form-field",62)(44,"mat-label"),e.EFF(45,"Peso"),e.k0s(),e.nrm(46,"mat-icon",102)(47,"input",103),e.DNE(48,Fr,2,0,"mat-error"),e.k0s()(),e.j41(49,"div")(50,"mat-form-field",62)(51,"mat-label"),e.EFF(52,"Ancho"),e.k0s(),e.nrm(53,"mat-icon",104)(54,"input",103),e.DNE(55,vr,2,0,"mat-error"),e.k0s()(),e.j41(56,"div")(57,"mat-form-field",62)(58,"mat-label"),e.EFF(59,"Largo"),e.k0s(),e.nrm(60,"mat-icon",104)(61,"input",103),e.DNE(62,Cr,2,0,"mat-error"),e.k0s()(),e.j41(63,"div")(64,"mat-form-field",62)(65,"mat-label"),e.EFF(66,"Altura"),e.k0s(),e.nrm(67,"mat-icon",104)(68,"input",103),e.DNE(69,yr,2,0,"mat-error"),e.k0s()(),e.j41(70,"div")(71,"mat-form-field",62)(72,"mat-label"),e.EFF(73,"Volumen"),e.k0s(),e.nrm(74,"mat-icon",104)(75,"input",103),e.DNE(76,br,2,0,"mat-error"),e.k0s()(),e.j41(77,"div",105)(78,"mat-form-field",62)(79,"mat-label"),e.EFF(80,"Descripci\xf3n"),e.k0s(),e.nrm(81,"textarea",106,7),e.k0s(),e.j41(83,"span",107),e.EFF(84),e.k0s()()()()),2&r){const t=e.sdS(82),o=e.XpG();e.R7$(),e.Y8G("formGroup",o.selectedProductForm),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","upc"),e.R7$(),e.vxM(7,o.selectedProductForm.get("upc").hasError("required")?7:-1),e.R7$(),e.vxM(8,o.selectedProductForm.get("upc").hasError("minlength")||o.selectedProductForm.get("upc").hasError("maxlength")?8:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","sku"),e.R7$(),e.vxM(14,o.selectedProductForm.get("sku").hasError("minlength")||o.selectedProductForm.get("sku").hasError("maxlength")?14:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","bCode"),e.R7$(),e.vxM(20,o.selectedProductForm.get("bCode").hasError("minlength")||o.selectedProductForm.get("bCode").hasError("maxlength")?20:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","name"),e.R7$(),e.vxM(26,o.selectedProductForm.get("name").hasError("required")?26:-1),e.R7$(),e.vxM(27,o.selectedProductForm.get("name").hasError("minlength")||o.selectedProductForm.get("name").hasError("maxlength")?27:-1),e.R7$(3),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","uom"),e.R7$(),e.Dyx(e.bMT(36,38,o.uoms$)),e.R7$(4),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","brand"),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(4),e.Y8G("formControlName","weight"),e.R7$(),e.vxM(48,o.selectedProductForm.get("weight").hasError("min")?48:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(4),e.Y8G("formControlName","width"),e.R7$(),e.vxM(55,o.selectedProductForm.get("width").hasError("min")?55:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(4),e.Y8G("formControlName","length"),e.R7$(),e.vxM(62,o.selectedProductForm.get("length").hasError("min")?62:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(4),e.Y8G("formControlName","height"),e.R7$(),e.vxM(69,o.selectedProductForm.get("height").hasError("min")?69:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(4),e.Y8G("formControlName","volume"),e.R7$(),e.vxM(76,o.selectedProductForm.get("volume").hasError("min")?76:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","description")("rows",1),e.R7$(3),e.SpI("",t.value.length," / 10000")}}let xr=(()=>{class r{constructor(){this.currencies=[],this.currencies$=(0,$.of)([]),this.maxDate=new Date,this.merchant=null,this.paymentMethods$=(0,$.of)([]),this.previewsProductsFormData=[],this.rates=[],this.searchProductControl=new s.MJ(null),this.searchSupplierControl=new s.MJ(null),this.selectedCurrencyIso="",this.selectedProductForm=null,this.selectedProductIndex=-1,this.selectedSupplierName="",this.stayHere=!1,this.total=0,this.uoms$=(0,$.of)([]),this.vouchers=[],this.vouchers$=(0,$.of)([]),this._changeDetectorRef=(0,e.WQX)(e.gRc),this._dialog=(0,e.WQX)(oe.bZ),this._fileSaverService=(0,e.WQX)(it.f),this._formBuilder=(0,e.WQX)(s.ok),this._fuseConfirmationService=(0,e.WQX)(te.G),this._productsService=(0,e.WQX)(ot.g),this._purchasesService=(0,e.WQX)(pe.W),this._ratesService=(0,e.WQX)(rt.f),this._router=(0,e.WQX)(I.Ix),this._snackBar=(0,e.WQX)(G.UG),this._suppliersService=(0,e.WQX)(Q),this._unsubscribeAll=new D.B,this.store=(0,e.WQX)(J.il)}ngOnInit(){this.purchaseForm=this._formBuilder.group({currencyId:new s.MJ(null,[s.k0.required]),supplierId:new s.MJ(null,[s.k0.required]),voucherTypeId:new s.MJ(null,[s.k0.required]),voucherNo:new s.MJ(null,[s.k0.required]),voucherDate:new s.MJ(new Date,[s.k0.required]),paymentMethodId:new s.MJ(null,[s.k0.required]),rates:new s.MJ([],[s.k0.required]),products:new s.Yp([]),indirectCost:this._formBuilder.group({fobCosts:new s.MJ(0,[s.k0.required,s.k0.min(0)]),freight:new s.MJ(0,[s.k0.required,s.k0.min(0)]),insurance:new s.MJ(0,[s.k0.required,s.k0.min(0)]),customsDuties:new s.MJ(0,[s.k0.required,s.k0.min(0)]),customsServices:new s.MJ(0,[s.k0.required,s.k0.min(0)]),transportation:new s.MJ(0,[s.k0.required,s.k0.min(0)]),unloading:new s.MJ(0,[s.k0.required,s.k0.min(0)]),otherCosts:new s.MJ(0,[s.k0.required,s.k0.min(0)])})}),this.store.select(N.Xb).pipe((0,h.Q)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.purchaseForm.get("voucherTypeId").valueChanges.pipe((0,h.Q)(this._unsubscribeAll)).subscribe(t=>{const o=this.vouchers.find(i=>i.id===t);o&&"compra-sin-factura"===o.slug?this.purchaseForm.get("voucherNo").clearValidators():this.purchaseForm.get("voucherNo").addValidators([s.k0.required]),this.purchaseForm.get("voucherNo").reset()}),this.purchaseForm.get("indirectCost").valueChanges.pipe((0,h.Q)(this._unsubscribeAll)).subscribe(t=>{this.calcAllIndirectCost()}),this.purchaseForm.get("products").valueChanges.pipe((0,h.Q)(this._unsubscribeAll),(0,E.B)(100)).subscribe(t=>{const o=this.verifyUpcChanges(t,this.previewsProductsFormData);o&&o.upc&&this.findProductsByUpcSAndRefreshForm([o.upc.toString()]),this.verificarCambios(t,this.previewsProductsFormData)&&this.calcAllIndirectCost(),this.previewsProductsFormData=[...t],this._calculatePurchaseTotal(),this._changeDetectorRef.markForCheck()}),this.currencies$=this.store.select(Ze.y$),this.currencies$.pipe((0,h.Q)(this._unsubscribeAll)).subscribe(t=>{this.currencies=t,z.H.IsNullOrEmpty(t)||setTimeout(()=>{const o=t.find(i=>i.id===this.merchant.currencyId);this.purchaseForm.get("currencyId").setValue(o.id)},500),this._changeDetectorRef.markForCheck()}),this.store.select(he.MW).pipe((0,h.Q)(this._unsubscribeAll)).subscribe(t=>{if(t&&t.length>0&&this.currencies.length>0){this.closeFormDetail();const o=[],i=this.purchaseForm.get("products").getRawValue();for(const c of t)i.some(u=>u.upc===c.upc)||o.push(c);o.map(c=>this.createProductFormGroup(c)).forEach(c=>{this.purchaseForm.get("products").push(c)}),this._changeDetectorRef.markForCheck(),this.findProductsByUpcSAndRefreshForm(o.filter(c=>c.upc).map(c=>c.upc.toString()))}}),this.suppliers$=this.store.select(L),this.paymentMethods$=this.store.select(C.xi),this.paymentMethods$.pipe((0,h.Q)(this._unsubscribeAll)).subscribe(t=>{if(!z.H.IsNullOrEmpty(t)){const o=t.find(i=>"Efectivo"===i.name);this.purchaseForm.get("paymentMethodId").setValue(o?o.id:t[0].id)}this._changeDetectorRef.markForCheck()}),this.vouchers$=this.store.select(_.gQ),this.vouchers$.pipe((0,h.Q)(this._unsubscribeAll)).subscribe(t=>{if(this.vouchers=t,!z.H.IsNullOrEmpty(t)){const o=t.find(i=>"Factura"===i.name);this.purchaseForm.get("voucherTypeId").setValue(o?o.id:t[0].id)}this._changeDetectorRef.markForCheck()}),this.products$=this.store.select(he.VW),this.uoms$=this.store.select(et.Ns),this.ratesFiltered=this.purchaseForm.get("currencyId").valueChanges.pipe((0,T.Z)(null),(0,p.Z)(t=>{if(t){const o=this.currencies.find(i=>i.id===t);return this.selectedCurrencyIso=o.iso,this._ratesService.findActiveByBaseId(t)}return(0,$.of)([])})),this.ratesFiltered.pipe((0,h.Q)(this._unsubscribeAll)).subscribe(t=>{this.rates=t,this.resetSelectedProductsRates(),this.updateSelectedRates()}),this.purchaseForm.get("rates").valueChanges.pipe((0,h.Q)(this._unsubscribeAll),(0,E.B)(500)).subscribe(t=>{this.resetSelectedProductsRates()}),this.productsFiltered=this.searchProductControl.valueChanges.pipe((0,E.B)(200),(0,T.Z)(null),(0,p.Z)(t=>this._mapChecked(null!==t&&"string"==typeof t?this._productsService.findActiveProducts(t.trim(),10):this.products$))),this.suppliersFiltered=this.searchSupplierControl.valueChanges.pipe((0,E.B)(200),(0,T.Z)(null),(0,p.Z)(t=>null!==t&&"string"==typeof t&&t!==this.selectedSupplierName?this._suppliersService.findActiveSuppliers(t.trim()):this.suppliers$))}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this.store.dispatch((0,Ke.R4)())}voucherNoHasValidator(){return this.purchaseForm.get("voucherNo").hasValidator(s.k0.required)}displayFn(t){return t&&t.name?t.name:""}selectSupplier(t){this.purchaseForm.get("supplierId").setValue(t.id),this.selectedSupplierName=t.name}addPurchaseProduct(t){const o=this.getProductFrom(t);this.purchaseForm.get("products").push(o),this.updateSelectedRates(),this._changeDetectorRef.markForCheck()}removePurchaseProduct(t){this.purchaseForm.get("products").removeAt(t),t===this.selectedProductIndex&&this.closeFormDetail(),this.updateSelectedRates(),this._changeDetectorRef.markForCheck()}addProductToPurchase(t){const o=this.purchaseForm.get("products").getRawValue().findIndex(i=>i.productId===t.id);t.checked?(this.removePurchaseProduct(o),t.checked=!1):t.checked=!0,!(o>-1)&&this.addPurchaseProduct(t)}addNewProduct(){this.purchaseForm.get("products").push(this.createEmptyProductFormGroup())}incrementProductQty(t){const o=t.get("quantity").value;t.get("quantity").setValue(Number(o)+1)}decrementProductQty(t){const o=t.get("quantity").value;t.get("quantity").setValue(Number(o)-1)}removeProductToPurchase(t){this.removePurchaseProduct(t),this.searchProductControl.reset()}selectDepot(){this.openDialog().afterClosed().pipe((0,h.Q)(this._unsubscribeAll)).subscribe(o=>{o&&!z.H.IsNullOrEmpty(o.depot)&&this.createPurchase(o.depot.id)})}createPurchase(t=""){if(this.purchaseForm.invalid||0===this.purchaseForm.get("products").controls.length)return;const o=this.purchaseForm.getRawValue();o.ratesId=o.products.map(n=>n.rateId).filter((n,c,u)=>u.indexOf(n)===c),o.products=o.products.map(n=>new st.vf(n)),o.total=this._calculatePurchaseTotal(),delete o.rates,this._fuseConfirmationService.open({title:"Registrar compra",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,h.Q)(this._unsubscribeAll)).subscribe(n=>{"confirmed"===n&&this._purchasesService.createPurchase(o).pipe((0,h.Q)(this._unsubscribeAll)).subscribe(({data:c})=>{c&&(this._snackBar.openFromComponent(q.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:"Factura de compra creada correctamente",title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this.stayHere?this.restoreForm():this._router.navigateByUrl("/modules/trade/purchases/list")),this._changeDetectorRef.markForCheck()})})}toggleProductDetail(t,o){if(this.selectedProductIndex===o)return this.closeFormDetail(),void this._changeDetectorRef.markForCheck();this.selectedProductIndex=o,this.selectedProductForm=t,this._changeDetectorRef.markForCheck()}importStockFormTemplateFile(t){const o=t.target;this.isExcelFile=!!o.files[0].name.match(/(.xls|.xlsx)/),o.files.length>1&&(this.stockTemplateFile.nativeElement.value=""),this.isExcelFile?this._productsService.importStockFormTemplateFile(t):this.stockTemplateFile.nativeElement.value=""}exportProductsTemplate(t){const i=t.getRawValue().map(u=>({upc:u.upc,sku:u.sku,bCode:u.bCode,name:u.name,description:u.description,uom:u.uom,quantity:1,cost:u.cost,price:u.price,brand:u.brand,weight:u.weight,width:u.width,length:u.length,height:u.height,volume:u.volume}));this._fileSaverService.exportAsExcelFile(i,"Plantilla de productos",[["UPC","SKU","C\xf3digo","Nombre","Descripci\xf3n","Unidad de Medida","Cantidad","Costo","Precio","Marca","Peso","Ancho","Largo","Altura","Volumen"]],[{wch:20},{wch:20},{wch:20},{wch:30},{wch:70},{wch:16}])}restoreForm(){const t=this.purchaseForm.get("paymentMethodId").value,o=this.purchaseForm.get("voucherTypeId").value;if(this.purchaseForm.get("products").clear(),this.searchSupplierControl.reset(),this.purchaseForm.reset(),this.total=0,this.selectedSupplierName="",this.searchProductControl.setValue(""),this.purchaseForm.get("paymentMethodId").setValue(t),this.purchaseForm.get("voucherTypeId").setValue(o),this.purchaseForm.get("voucherDate").setValue(new Date),this.purchaseForm.get("indirectCost").get("fobCosts").setValue(0),this.purchaseForm.get("indirectCost").get("freight").setValue(0),this.purchaseForm.get("indirectCost").get("insurance").setValue(0),this.purchaseForm.get("indirectCost").get("customsDuties").setValue(0),this.purchaseForm.get("indirectCost").get("customsServices").setValue(0),this.purchaseForm.get("indirectCost").get("transportation").setValue(0),this.purchaseForm.get("indirectCost").get("unloading").setValue(0),this.purchaseForm.get("indirectCost").get("otherCosts").setValue(0),!z.H.IsNullOrEmpty(this.currencies)){const i=this.currencies.find(n=>n.id===this.merchant.currencyId);this.purchaseForm.get("currencyId").setValue(i.id)}}_calculatePurchaseTotal(){const t=this.total=this.purchaseForm.get("products").getRawValue().map(o=>o.ct).reduce((o,i)=>o+i,0);return this.total=Number(t.toFixed(2)),this.total}_mapChecked(t){return t.pipe((0,g.T)(o=>o.map(i=>this.purchaseForm.get("products").getRawValue().some(c=>c.productId===i.id)?{...structuredClone(i),checked:!0}:{...structuredClone(i),checked:!1})))}resetSelectedProductsRates(){const t=this.purchaseForm.get("currencyId").value,i=this.purchaseForm.get("products").getRawValue().reduce((n,c)=>n+Number(c.quantity)*c.cost,0);for(const n of this.purchaseForm.get("products").controls){const c=n.getRawValue(),u=structuredClone(this.purchaseForm.get("rates").value);let v=u.find(O=>O.currencyBaseId===t&&O.currencyRefId===c.currencyId);!v&&t!==c.currencyId&&(v=u.find(O=>O.currencyRefId===t&&O.currencyRefId!==O.currencyBaseId),v&&(v.value=1/v.value));let f=v?v.value:null;const U=n.get("cost").value,ie=n.get("price").value;let H=n.get("rate").value?n.get("rate").value:1;H&&f===H&&(H=1,f=1),n.patchValue({...c,cost:f?U*f:1*U/H,price:f?ie*f:1*ie/H,rate:v?v.value:null,rateId:v?v.id:null}),this.calcIndirectCost(n,i)}this._changeDetectorRef.markForCheck()}calcAllIndirectCost(){const t=this.purchaseForm.get("products").getRawValue();this.previewsProductsFormData=[...t];const o=t.reduce((i,n)=>i+Number(n.quantity)*n.cost,0);for(const i of this.purchaseForm.get("products").controls)this.calcIndirectCost(i,o)}calcIndirectCost(t,o){const i=this.purchaseForm.get("indirectCost").getRawValue(),n=i.fobCosts+i.freight+i.insurance+i.customsDuties+i.customsServices+i.transportation+i.unloading+i.otherCosts,c=t.getRawValue(),v=Number(c.quantity)*c.cost/o*n,f=Number((v/Number(c.quantity)).toFixed(2)),U=c.cost+f,ie=Number((c.quantity*U).toFixed(2));t.patchValue({...c,cui:f,cut:U,ct:ie})}createProductFormGroup(t){if(this.currencies.length>0){const o=this.currencies.find(u=>u.id===this.merchant.currencyId),i=this.purchaseForm.get("currencyId").value,c=structuredClone(this.purchaseForm.get("rates").value).find(u=>u.currencyBaseId===i&&u.currencyRefId===o.id);return this._formBuilder.group({upc:[t.upc,[s.k0.required]],sku:[t.sku],bCode:[t.bCode],name:[t.name,[s.k0.required]],description:[t.description,[s.k0.maxLength(1e4)]],uom:[t.uom?t.uom:"U",[s.k0.required]],quantity:[Number(t.quantity),[ue.t.onlyNumbersPattern(),s.k0.required,s.k0.min(.1)]],cost:new s.MJ((c?c.value:1)*t.cost,[s.k0.required,s.k0.min(0),s.k0.max(99999999)]),cui:new s.MJ(0),cut:new s.MJ(0),ct:new s.MJ(0),price:[t.price,[s.k0.required,s.k0.min(0),s.k0.max(9999999)]],brand:[t.brand],weight:[t.weight,[s.k0.min(0)]],width:[t.width,[s.k0.min(0)]],length:[t.length,[s.k0.min(0)]],height:[t.height,[s.k0.min(0)]],volume:[t.volume,[s.k0.min(0)]],currencyId:new s.MJ(o.id,[s.k0.required]),currency:new s.MJ(o.iso,[s.k0.required]),rate:new s.MJ(c?c.value:null,[s.k0.required]),rateId:new s.MJ(c?c.id:null),productId:[null]})}return null}createEmptyProductFormGroup(){if(this.currencies.length>0){const t=this.currencies.find(c=>c.id===this.merchant.currencyId),o=this.purchaseForm.get("currencyId").value,n=structuredClone(this.purchaseForm.get("rates").value).find(c=>c.currencyBaseId===o&&c.currencyRefId===t.id);return this._formBuilder.group({upc:[null,[s.k0.required]],sku:[null],bCode:[null],name:[null,[s.k0.required]],description:[null,[s.k0.maxLength(1e4)]],uom:["U",[s.k0.required]],quantity:[1,[ue.t.onlyNumbersPattern(),s.k0.required,s.k0.min(.1)]],cost:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(99999999)]),cui:new s.MJ(0),cut:new s.MJ(0),ct:new s.MJ(0),price:[0,[s.k0.required,s.k0.min(0),s.k0.max(9999999)]],brand:[""],weight:[0,[s.k0.min(0)]],width:[0,[s.k0.min(0)]],length:[0,[s.k0.min(0)]],height:[0,[s.k0.min(0)]],volume:[0,[s.k0.min(0)]],currencyId:new s.MJ(t.id,[s.k0.required]),currency:new s.MJ(t.iso,[s.k0.required]),rate:new s.MJ(n?n.value:null,[s.k0.required]),rateId:new s.MJ(n?n.id:null),productId:[null]})}return null}verificarCambios(t,o){for(let i=0;i<t.length;i++)if(t.length!==o.length||t[i].cost!==o[i].cost||Number(t[i].quantity)!==Number(o[i].quantity))return!0;return!1}verifyUpcChanges(t,o){for(let i=0;i<t.length;i++){const n=o[i]?structuredClone(o[i]):null;if(n&&t[i].upc!==n.upc&&z.H.IsNullOrEmpty(t[i].productId))return t[i];if(t.length!==o.length&&t.length>0&&z.H.IsNullOrEmpty(t[i].productId))return t[t.length-1]}return null}findProductsByUpcSAndRefreshForm(t){this._productsService.findProductsByUpcS(t).pipe((0,h.Q)(this._unsubscribeAll)).subscribe(o=>{const i=this.purchaseForm.get("products").getRawValue();for(const n of this.purchaseForm.get("products").controls){const c=n.getRawValue(),u=o.findIndex(v=>v.upc===c.upc);-1!==u&&(!c.productId&&i.some(v=>v.upc===c.upc&&v.productId===o[u].id)?n.get("upc").reset():(n.patchValue({...this.getProductFrom({...o[u]}).getRawValue(),quantity:Number(c.quantity),price:c.price,cost:c.cost}),this.closeFormDetail()))}this.updateSelectedRates()})}getProductFrom(t){const o=this.purchaseForm.get("currencyId").value,i=structuredClone(this.purchaseForm.get("rates").value);let n=i.find(u=>u.currencyBaseId===o&&u.currencyRefId===t.currencyId);return n||(n=i.find(u=>u.currencyRefId===o&&u.currencyRefId!==u.currencyBaseId),n&&(n.value=1/n.value)),this._formBuilder.group({productId:new s.MJ(t.id,[s.k0.required]),currencyId:new s.MJ(t.currencyId,[s.k0.required]),name:new s.MJ(t.name,[s.k0.required]),cost:new s.MJ((n?n.value:1)*t.cost,[s.k0.required,s.k0.min(0),s.k0.max(99999999)]),cui:new s.MJ(0),cut:new s.MJ(0),ct:new s.MJ(0),price:new s.MJ((n?n.value:1)*t.price,[s.k0.required,s.k0.min(0),s.k0.max(99999999)]),uom:new s.MJ(t.uom.abbr,[s.k0.required]),currency:new s.MJ(t.currency.iso,[s.k0.required]),rateId:new s.MJ(n?n.id:null,[s.k0.required]),rate:new s.MJ(n?n.value:null,[s.k0.required]),quantity:new s.MJ(1,[ue.t.onlyNumbersPattern(),s.k0.required,s.k0.min(.1)]),upc:[t.upc,[s.k0.required]],sku:[t.sku],bCode:[t.bCode],description:[t.description,[s.k0.maxLength(1e4)]],brand:[t.brand.name],weight:[t.weight,[s.k0.min(0)]],width:[t.width,[s.k0.min(0)]],length:[t.length,[s.k0.min(0)]],height:[t.height,[s.k0.min(0)]],volume:[t.volume,[s.k0.min(0)]]})}updateSelectedRates(){const t=this.purchaseForm.get("currencyId").value,o=this.purchaseForm.get("products").getRawValue();let i=[];for(const c of o)i=[...this.rates.filter(f=>f.currencyBaseId===t&&f.currencyRefId===c.currencyId),...this.rates.filter(f=>f.currencyBaseId===c.currencyId&&f.currencyRefId===t&&f.currencyRefId!==f.currencyBaseId),...i];const n=i.reduce((c,u)=>(c.find(f=>f.id===u.id&&f.name===u.name)||c.push(u),c),[]);this.purchaseForm.get("rates").setValue(n)}closeFormDetail(){this.selectedProductIndex=-1,this.selectedProductForm=null}openDialog(){return this._dialog.open(tt._,{data:{},panelClass:"ath-dialog-panel",disableClose:!0})}static#e=this.\u0275fac=function(o){return new(o||r)};static#t=this.\u0275cmp=e.VBU({type:r,selectors:[["purchase-form"]],viewQuery:function(o,i){if(1&o&&e.GBs(at,5),2&o){let n;e.mGM(n=e.lsd())&&(i.stockTemplateFile=n.first)}},standalone:!0,features:[e.aNF],decls:132,vars:77,consts:[["purchaseNgForm","ngForm"],["supplierAutocomplete","matAutocomplete"],["voucherDate",""],["indirectCost",""],["productsAutocomplete","matAutocomplete"],["templateFile",""],["rowDetailsTemplate",""],["descriptionLength",""],["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0",3,"fuseScrollbarOptions"],[1,"relative","flex","flex-col","px-6","py-8","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["color","primary",3,"ngModelChange","ngModel"],["mat-flat-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"click","disabled"],[1,"flex","flex-col","px-4","mt-4","mb-12","gap-y-8","sm:px-8"],[1,"col-span-2","shadow","rounded-2xl","bg-card"],[1,"grid","gap-4","p-10","sm:grid-cols-4","lg:grid-cols-5",3,"formGroup"],["appearance","fill",1,"w-full","md:col-span-2","fuse-mat-dense"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder","required"],[1,"ath-autocomplete",3,"displayWith"],[3,"value"],[1,"w-full","fuse-mat-dense"],[3,"formControlName","required"],["matInput","","maxlength","50",3,"type","formControlName","required"],["matInput","",3,"matDatepicker","formControlName","max","required"],["matIconSuffix","",3,"for"],[3,"formControlName","required","placeholder"],["multiple","",3,"formControlName","required","placeholder"],[1,"text-sm","opacity-75"],["value","importation"],["value","national"],["formGroupName","indirectCost"],[1,"col-span-4","shadow","rounded-2xl","bg-card"],[1,"p-6","pb-0"],[1,"flex","flex-col-reverse","justify-between","sm:flex-row"],["appearance","fill",1,"w-full","md:mr-8","fuse-mat-dense",3,"subscriptSizing"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete",3,"closed","displayWith"],[1,"w-full","bg-default",3,"click"],[1,"flex","items-center","justify-center","w-full",3,"click"],[1,"inline-flex","items-center","rounded","cursor-pointer"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2","font-medium","text-secondary","group-hover:underline"],[1,"w-full",3,"value"],[1,"flex","items-center","self-end","sm:w-20","sm:space-x-2","sm:justify-evenly"],["mat-icon-button","","matTooltip","Importar Plantilla",1,"rounded-full","cursor-pointer","hover:bg-hover"],["for","template-file-input",1,"flex","items-center","cursor-pointer","p-2.5"],["id","template-file-input","type","file","accept",".xls, .xlsx",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"change"],["mat-icon-button","","matTooltip","Descargar Plantilla",3,"click"],["fuseScrollbar","",1,"flex","flex-col","flex-auto","pb-3","mt-2","min-h-72",3,"fuseScrollbarOptions"],[1,"grid"],[1,"flex","items-center","justify-center","w-full","gap-2","p-2","font-mono","text-3xl","font-semibold","leading-7","text-white","rounded-b-2xl","bg-gradient-to-r","from-primary-500","to-primary-700",3,"click","ngClass"],[3,"click","value"],[1,"w-18"],[1,"w-full","fuse-mat-dense",3,"subscriptSizing"],["matInput","","type","number","min","0",3,"formControlName"],[1,"w-full",3,"click","value"],[1,"grid","w-full","grid-cols-6",3,"click"],[1,"flex","flex-row","items-center","col-span-5","truncate","md:col-span-3"],["color","primary",3,"checked"],[1,"flex","items-center","text-center"],[1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","purchase-products-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-primary","dark:bg-opacity-5"],[1,"text-left"],[1,"text-center"],["matTooltip","Costo Unitario Directo",1,"text-center"],["matTooltip","Costo Unitario Indirecto",1,"text-center"],["matTooltip","Costo Total = (Costo + CUI) x Cantidad",1,"text-right"],[1,"mr-2","text-right"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","purchase-products-grid","md:px-8",3,"ngClass"],[1,"truncate",3,"matTooltip"],[1,"text-warn"],[1,"text-center",3,"ngClass"],[1,"flex","flex-col","justify-center"],[1,"flex","flex-row","items-center","justify-center","gap-2"],["mat-stroked-button","",1,"p-2","leading-6","min-w-7","min-h-7","h-7",3,"click","disabled"],[1,"fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],["matInput","","type","text","name","quantity",1,"font-mono","font-semibold","text-center",3,"min","formControl"],[1,"w-full","text-sm","text-center"],[1,"flex","flex-col","items-center","justify-center"],["matInput","","type","number",1,"font-mono","font-semibold","text-center",3,"min","max","formControl"],[1,"font-mono","text-right"],[1,"flex","justify-end","gap-2"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click","color","disabled"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-30"],[1,"p-6","mb-4","overflow-hidden","shadow-lg"],[1,"grid","grid-cols-8","gap-4",3,"formGroup"],[1,"col-span-2"],["matTooltip","C\xf3digo de barras",1,"w-full","fuse-mat-dense",3,"subscriptSizing"],["matInput","","type","text","minlength","3","maxlength","255","required","",3,"formControlName"],["matInput","","type","text","minlength","3","maxlength","255",3,"formControlName"],["required","",3,"formControlName"],["matInput","","type","text","minlength","1","maxlength","255",3,"formControlName"],["matPrefix","","svgIcon","mat_solid:scale"],["matInput","","type","number","min","0","max","999999999","maxlength","9",3,"formControlName"],["matPrefix","","svgIcon","mat_solid:square_foot"],[1,"flex","flex-col","justify-end","col-span-5"],["matInput","","matInput","","matTextareaAutoSize","","maxlength","10000",3,"formControlName","rows"],["matSuffix","",1,"ml-2"]],template:function(o,i){if(1&o){const n=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div")(5,"a",12),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",13),e.nrm(8,"mat-icon",14),e.j41(9,"a",15),e.EFF(10,"Compras"),e.k0s()()(),e.j41(11,"div",16)(12,"h2",17),e.EFF(13," Registrar Factura de Compra "),e.k0s()()(),e.j41(14,"div",18)(15,"mat-checkbox",19),e.mxI("ngModelChange",function(u){return e.eBV(n),e.DH7(i.stayHere,u)||(i.stayHere=u),e.Njj(u)}),e.EFF(16,"Permanecer aqu\xed"),e.k0s(),e.j41(17,"button",20),e.bIt("click",function(){return e.eBV(n),e.Njj(i.createPurchase())}),e.EFF(18," Registrar "),e.k0s()()(),e.j41(19,"div",21)(20,"div",22)(21,"form",23,0)(23,"mat-form-field",24)(24,"mat-label"),e.EFF(25,"Proveedor"),e.k0s(),e.nrm(26,"mat-icon",25)(27,"input",26),e.j41(28,"mat-autocomplete",27,1),e.Z7z(30,gt,2,2,"mat-option",28,e.fX1),e.nI1(32,"async"),e.k0s()(),e.j41(33,"mat-form-field",29)(34,"mat-label"),e.EFF(35,"Tipo de comprobante"),e.k0s(),e.j41(36,"mat-select",30),e.Z7z(37,_t,2,2,"mat-option",28,e.fX1),e.nI1(39,"async"),e.k0s(),e.DNE(40,Ft,2,0,"mat-error"),e.k0s(),e.j41(41,"mat-form-field",29)(42,"mat-label"),e.EFF(43,"N\xfamero del comprobante"),e.k0s(),e.nrm(44,"input",31),e.DNE(45,vt,2,0,"mat-error"),e.k0s(),e.j41(46,"mat-form-field",29)(47,"mat-label"),e.EFF(48,"Fecha del comprobante"),e.k0s(),e.nrm(49,"input",32),e.j41(50,"mat-hint"),e.EFF(51,"DD/MM/YYYY"),e.k0s(),e.nrm(52,"mat-datepicker-toggle",33)(53,"mat-datepicker",null,2),e.DNE(55,Ct,2,0,"mat-error"),e.k0s(),e.j41(56,"mat-form-field",29)(57,"mat-label"),e.EFF(58,"M\xe9todo de pago"),e.k0s(),e.j41(59,"mat-select",30),e.Z7z(60,yt,2,2,"mat-option",28,e.fX1),e.nI1(62,"async"),e.k0s(),e.DNE(63,bt,2,0,"mat-error"),e.k0s(),e.j41(64,"mat-form-field",29)(65,"mat-label"),e.EFF(66,"Moneda"),e.k0s(),e.j41(67,"mat-select",34),e.Z7z(68,kt,2,2,"mat-option",28,e.fX1),e.nI1(70,"async"),e.k0s()(),e.j41(71,"mat-form-field",29)(72,"mat-label"),e.EFF(73,"Tasa de Cambio"),e.k0s(),e.j41(74,"mat-select",35)(75,"mat-select-trigger"),e.EFF(76),e.DNE(77,xt,2,2,"span",36),e.k0s(),e.Z7z(78,It,6,6,"mat-option",28,e.fX1),e.nI1(80,"async"),e.k0s(),e.DNE(81,Rt,2,0,"mat-error"),e.k0s(),e.j41(82,"mat-form-field",29)(83,"mat-label"),e.EFF(84,"Tipo de Compra"),e.k0s(),e.j41(85,"mat-select",null,3)(87,"mat-option",37),e.EFF(88,"Importaci\xf3n"),e.k0s(),e.j41(89,"mat-option",38),e.EFF(90,"En Plaza"),e.k0s()()(),e.DNE(91,St,7,4,"div",39)(92,Mt,7,4,"div",39)(93,Dt,7,4,"div",39)(94,At,7,4,"div",39)(95,Vt,7,4,"div",39)(96,Xt,7,4,"div",39)(97,Qt,7,4,"div",39)(98,Wt,7,4,"div",39),e.k0s()(),e.j41(99,"div",40)(100,"div",41)(101,"div",42)(102,"mat-form-field",43),e.nrm(103,"mat-icon",25)(104,"input",44),e.j41(105,"mat-autocomplete",45,4),e.bIt("closed",function(){return e.eBV(n),e.Njj(i.searchProductControl.reset())}),e.j41(107,"mat-option",46),e.bIt("click",function(u){return e.eBV(n),i.addNewProduct(),e.Njj(u.stopPropagation())}),e.j41(108,"div",47),e.bIt("click",function(u){return e.eBV(n),i.addNewProduct(),e.Njj(u.stopPropagation())}),e.j41(109,"div",48),e.nrm(110,"mat-icon",49),e.j41(111,"span",50),e.EFF(112," Agregar Producto "),e.k0s()()()(),e.Z7z(113,Ht,9,5,"mat-option",51,e.fX1),e.nI1(115,"async"),e.k0s()(),e.j41(116,"div",52)(117,"div",53)(118,"label",54),e.nrm(119,"mat-icon",49),e.k0s(),e.j41(120,"input",55,5),e.bIt("change",function(u){return e.eBV(n),e.Njj(i.importStockFormTemplateFile(u))}),e.k0s()(),e.j41(122,"button",56),e.bIt("click",function(){return e.eBV(n),e.Njj(i.exportProductsTemplate(i.purchaseForm.get("products")))}),e.nrm(123,"mat-icon",49),e.k0s()()(),e.j41(124,"div",57),e.DNE(125,cr,23,0,"div",58)(126,ur,2,0)(127,kr,85,40,"ng-template",null,6,e.C5r),e.k0s()(),e.j41(129,"div",59),e.bIt("click",function(){return e.eBV(n),e.Njj(i.createPurchase())}),e.EFF(130),e.nI1(131,"number"),e.k0s()()()()}if(2&o){let n,c;const u=e.sdS(29),v=e.sdS(54),f=e.sdS(86),U=e.sdS(106);e.Y8G("fuseScrollbarOptions",e.lJ4(73,ct)),e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.R50("ngModel",i.stayHere),e.R7$(2),e.Y8G("disabled",i.purchaseForm.invalid||0===i.purchaseForm.get("products").controls.length),e.R7$(4),e.Y8G("formGroup",i.purchaseForm),e.R7$(5),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",i.searchSupplierControl)("matAutocomplete",u)("placeholder","Buscar proveedor")("required",!0),e.R7$(),e.Y8G("displayWith",i.displayFn),e.R7$(2),e.Dyx(e.bMT(32,58,i.suppliersFiltered)),e.R7$(6),e.Y8G("formControlName","voucherTypeId")("required",!0),e.R7$(),e.Dyx(e.bMT(39,60,i.vouchers$)),e.R7$(3),e.vxM(40,i.purchaseForm.get("voucherTypeId").hasError("required")?40:-1),e.R7$(4),e.Y8G("type","text")("formControlName","voucherNo")("required",i.voucherNoHasValidator()),e.R7$(),e.vxM(45,i.purchaseForm.get("voucherNo").hasError("required")?45:-1),e.R7$(4),e.Y8G("matDatepicker",v)("formControlName","voucherDate")("max",i.maxDate)("required",!0),e.R7$(3),e.Y8G("for",v),e.R7$(3),e.vxM(55,i.purchaseForm.get("voucherDate").hasError("required")?55:-1),e.R7$(4),e.Y8G("formControlName","paymentMethodId")("required",!0),e.R7$(),e.Dyx(e.bMT(62,62,i.paymentMethods$)),e.R7$(3),e.vxM(63,i.purchaseForm.get("paymentMethodId").hasError("required")?63:-1),e.R7$(4),e.Y8G("formControlName","currencyId")("required",!0)("placeholder","Moneda"),e.R7$(),e.Dyx(e.bMT(70,64,i.currencies$)),e.R7$(6),e.Y8G("formControlName","rates")("required",!0)("placeholder","Tasa de cambio"),e.R7$(2),e.SpI(" ",(null==(n=i.purchaseForm.get("rates").value)||null==n[0]?null:n[0].name)||""," "),e.R7$(),e.vxM(77,((null==(c=i.purchaseForm.get("rates").value)?null:c.length)||0)>1?77:-1),e.R7$(),e.Dyx(e.bMT(80,66,i.ratesFiltered)),e.R7$(3),e.vxM(81,i.purchaseForm.get("rates").hasError("required")?81:-1),e.R7$(10),e.vxM(91,"importation"===f.value?91:-1),e.R7$(),e.vxM(92,"importation"===f.value?92:-1),e.R7$(),e.vxM(93,"importation"===f.value?93:-1),e.R7$(),e.vxM(94,"importation"===f.value?94:-1),e.R7$(),e.vxM(95,"importation"===f.value||"national"===f.value?95:-1),e.R7$(),e.vxM(96,"importation"===f.value||"national"===f.value?96:-1),e.R7$(),e.vxM(97,"importation"===f.value||"national"===f.value?97:-1),e.R7$(),e.vxM(98,"importation"===f.value||"national"===f.value?98:-1),e.R7$(4),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",i.searchProductControl)("matAutocomplete",U)("placeholder","Buscar productos"),e.R7$(),e.Y8G("displayWith",i.displayFn),e.R7$(5),e.Y8G("svgIcon","mat_solid:add_circle"),e.R7$(3),e.Dyx(e.bMT(115,68,i.productsFiltered)),e.R7$(6),e.Y8G("svgIcon","mat_solid:upload"),e.R7$(4),e.Y8G("svgIcon","mat_solid:download"),e.R7$(),e.Y8G("fuseScrollbarOptions",e.lJ4(74,ut)),e.R7$(),e.vxM(125,i.purchaseForm.get("products").controls.length>0?125:126),e.R7$(4),e.Y8G("ngClass",e.eq3(75,mt,i.purchaseForm.valid&&i.purchaseForm.get("products").controls.length>0)),e.R7$(),e.Lme(" ",e.i5U(131,70,i.total,"1.2-2")," ",i.selectedCurrencyIso," ")}},dependencies:[d.Jj,d.oe,d.QX,s.YN,s.qT,s.me,s.Q0,s.BC,s.cb,s.YS,s.xh,s.tU,s.VZ,s.zX,s.vS,ae.p,ce.jL,ce.$3,nt.wT,ce.pN,b.Hl,b.$z,b.iY,ne.g7,ne.So,re.X6,re.Vh,re.bZ,re.bU,x.RG,x.rl,x.nJ,x.MV,x.TL,x.JW,x.yw,S.m_,S.An,k.fS,k.fg,le.Ve,le.VO,le.$2,de.uc,de.oV,d.YU,s.X1,s.l_,s.j4,s.JD,s.$R],encapsulation:2,changeDetection:0})}return r})();var Ir=l(87122);class Rr{}var Er=l(67376);const fe=r=>({"cursor-not-allowed":r});function Pr(r,a){1&r&&(e.j41(0,"h2",2),e.EFF(1,"Agregar Proveedor"),e.k0s())}function Sr(r,a){1&r&&(e.j41(0,"h2",2),e.EFF(1,"Editar Proveedor"),e.k0s())}function $r(r,a){if(1&r&&(e.j41(0,"div",4)(1,"div",6)(2,"form",7)(3,"div",8)(4,"mat-form-field",9)(5,"mat-label"),e.EFF(6,"Nombre"),e.k0s(),e.nrm(7,"input",10),e.k0s(),e.j41(8,"mat-form-field",9)(9,"mat-label"),e.EFF(10,"N\xfamero de identificaci\xf3n tributaria"),e.k0s(),e.nrm(11,"input",10),e.k0s(),e.j41(12,"mat-form-field",9)(13,"mat-label"),e.EFF(14,"Correo electr\xf3nico"),e.k0s(),e.nrm(15,"input",11),e.k0s(),e.j41(16,"mat-form-field",9)(17,"mat-label"),e.EFF(18,"Tel\xe9fono"),e.k0s(),e.nrm(19,"input",12),e.j41(20,"mat-hint"),e.EFF(21,"Debe incluir +53 al inicio del tel\xe9fono"),e.k0s()()()()()()),2&r){const t=e.XpG();e.R7$(2),e.Y8G("formGroup",t.supplierForm)("autocomplete","off"),e.R7$(5),e.Y8G("formControlName","name"),e.R7$(4),e.Y8G("formControlName","nit"),e.R7$(4),e.Y8G("formControlName","email"),e.R7$(4),e.Y8G("formControlName","phone")}}function jr(r,a){if(1&r){const t=e.RV6();e.j41(0,"button",15),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.updateSupplier())}),e.EFF(1,"Actualizar"),e.k0s()}if(2&r){const t=e.XpG(2);e.Y8G("disabled",t.supplierForm.invalid)("ngClass",e.eq3(3,fe,t.supplierForm.invalid))("color","primary")}}function Mr(r,a){if(1&r){const t=e.RV6();e.j41(0,"button",15),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.createSupplier())}),e.EFF(1,"Agregar"),e.k0s()}if(2&r){const t=e.XpG(2);e.Y8G("disabled",t.supplierForm.invalid)("ngClass",e.eq3(3,fe,t.supplierForm.invalid))("color","primary")}}function Tr(r,a){if(1&r){const t=e.RV6();e.j41(0,"div",5)(1,"button",13),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeDialog())}),e.EFF(2,"Cancelar"),e.k0s(),e.DNE(3,jr,2,5,"button",14)(4,Mr,2,5,"button",14),e.k0s()}if(2&r){const t=e.XpG();e.R7$(),e.Y8G("color","warn"),e.R7$(2),e.vxM(3,"edit"===t.data.dialogMode?3:-1),e.R7$(),e.vxM(4,"add"===t.data.dialogMode?4:-1)}}let Gr=(()=>{class r{constructor(t,o,i,n,c,u,v){this.data=t,this._suppliersService=o,this._changeDetectorRef=i,this._dialogRef=n,this._formBuilder=c,this._fuseConfirmationService=u,this._snackBar=v,this._unsubscribeAll=new D.B,this.dialogMode=t.dialogMode,this.supplier=this.data.supplier}ngOnInit(){this.supplierForm=this._formBuilder.group({id:new s.MJ,name:new s.MJ(null,[s.k0.required,s.k0.minLength(3),s.k0.maxLength(150)]),nit:new s.MJ(null,[s.k0.maxLength(20)]),email:new s.MJ(null,[s.k0.email]),phone:new s.MJ(null,[s.k0.maxLength(15),s.k0.pattern("^((\\+53)?\\d{8})?$")])}),null!==this.supplier.name&&this.supplierForm.patchValue(this.supplier)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}createSupplier(){let t=this.supplierForm.getRawValue();t=(0,Er.omit)(t,["id"]),this._fuseConfirmationService.open({title:"Crear categor\xeda",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,h.Q)(this._unsubscribeAll)).subscribe(i=>{"confirmed"===i&&this._suppliersService.createSupplier(t).pipe((0,h.Q)(this._unsubscribeAll)).subscribe(({data:n})=>{this._snackBar.openFromComponent(q.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:n.createSupplier.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck(),this.closeDialog()})})}updateSupplier(){const t=this.supplierForm.getRawValue();this._fuseConfirmationService.open({title:"Categor\xeda",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,h.Q)(this._unsubscribeAll)).subscribe(i=>{"confirmed"===i&&this._suppliersService.updateSupplier(t).pipe((0,h.Q)(this._unsubscribeAll)).subscribe(({data:n})=>{this._snackBar.openFromComponent(q.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:n.updateSupplier.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.closeDialog(),this._changeDetectorRef.markForCheck()})})}static#e=this.\u0275fac=function(o){return new(o||r)(e.rXU(oe.Vh),e.rXU(Q),e.rXU(e.gRc),e.rXU(oe.CP),e.rXU(s.ok),e.rXU(te.G),e.rXU(G.UG))};static#t=this.\u0275cmp=e.VBU({type:r,selectors:[["supplier-dialog"]],standalone:!0,features:[e.aNF],decls:9,vars:4,consts:[[1,"relative","flex","flex-col","w-full","max-h-screen"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["mat-dialog-title",""],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6"],[1,"w-full","overflow-hidden"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],[1,"flex","border-t"],[1,"flex","flex-col","w-full","pt-8",3,"formGroup","autocomplete"],[1,"flex","flex-col","flex-auto","gap-4"],[1,"w-full","fuse-mat-dense"],["matInput","","type","text",3,"formControlName"],["matInput","","type","email",3,"formControlName"],["matInput","","type","tel",3,"formControlName"],["mat-button","",1,"-ml-4",3,"click","color"],["mat-flat-button","",3,"disabled","ngClass","color"],["mat-flat-button","",3,"click","disabled","ngClass","color"]],template:function(o,i){1&o&&(e.j41(0,"div",0),e.qex(1),e.j41(2,"div",1),e.DNE(3,Pr,2,0,"h2",2)(4,Sr,2,0,"h2",2),e.k0s(),e.bVm(),e.j41(5,"div",3),e.qex(6),e.DNE(7,$r,22,6,"div",4),e.bVm(),e.k0s(),e.DNE(8,Tr,5,3,"div",5),e.k0s()),2&o&&(e.R7$(3),e.vxM(3,i.data.supplier.id||"add"!==i.dialogMode?-1:3),e.R7$(),e.vxM(4,i.data.supplier.id&&"edit"===i.dialogMode?4:-1),e.R7$(3),e.vxM(7,"view"!==i.dialogMode?7:-1),e.R7$(),e.vxM(8,"view"!==i.data.dialogMode?8:-1))},dependencies:[b.Hl,b.$z,x.RG,x.rl,x.nJ,x.MV,k.fS,k.fg,d.YU,s.X1,s.qT,s.me,s.BC,s.cb,s.j4,s.JD],encapsulation:2})}return r})();const Dr=(r,a)=>({"pointer-events-none":r,hidden:a}),Nr=()=>[10,25,50,100];function Br(r,a){if(1&r){const t=e.RV6();e.j41(0,"mat-slide-toggle",34),e.bIt("change",function(i){e.eBV(t);const n=e.XpG(),c=n.$implicit,u=n.$index,v=e.XpG(4);return e.Njj(v.updateSupplierStatus(i,c,u))}),e.k0s()}if(2&r){const t=e.XpG().$implicit;e.Y8G("checked",t.active)("color","primary")}}function Ar(r,a){1&r&&e.nrm(0,"mat-spinner",30),2&r&&e.Y8G("diameter",20)("color","primary")}function wr(r,a){if(1&r){const t=e.RV6();e.j41(0,"div",26)(1,"div",27),e.EFF(2),e.k0s(),e.j41(3,"div",22),e.EFF(4),e.k0s(),e.j41(5,"div",22),e.EFF(6),e.k0s(),e.j41(7,"div",22),e.EFF(8),e.k0s(),e.j41(9,"div",28),e.DNE(10,Br,1,2,"mat-slide-toggle",29)(11,Ar,1,2,"mat-spinner",30),e.k0s(),e.j41(12,"div",31)(13,"button",32),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(4);return e.Njj(n.openDialog(i,"edit"))}),e.nrm(14,"mat-icon",33),e.k0s(),e.j41(15,"button",32),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(4);return e.Njj(n.deleteSupplier(i.id))}),e.nrm(16,"mat-icon",33),e.k0s()()()}if(2&r){const t=a.$implicit,o=a.$index,i=e.XpG(4);e.R7$(2),e.SpI(" ",t.name," "),e.R7$(2),e.SpI(" ",t.nit," "),e.R7$(2),e.SpI(" ",t.phone," "),e.R7$(2),e.SpI(" ",t.email," "),e.R7$(2),e.vxM(10,i.isSlideLoading&&i.selectedSlide===o?-1:10),e.R7$(),e.vxM(11,i.isSlideLoading&&i.selectedSlide===o?11:-1),e.R7$(3),e.Y8G("svgIcon","mat_solid:edit"),e.R7$(2),e.Y8G("svgIcon","mat_solid:delete")}}function Yr(r,a){1&r&&e.Z7z(0,wr,17,8,"div",26,e.BUC().trackByFn,!0),2&r&&e.Dyx(a)}function Vr(r,a){if(1&r&&(e.j41(0,"div",19)(1,"div",20)(2,"div",21),e.EFF(3," Nombre "),e.k0s(),e.j41(4,"div",22),e.EFF(5," NIT "),e.k0s(),e.j41(6,"div",22),e.EFF(7," Tel\xe9fono "),e.k0s(),e.j41(8,"div",22),e.EFF(9," Correo "),e.k0s(),e.j41(10,"div",23)(11,"span"),e.EFF(12,"Activo"),e.k0s()(),e.j41(13,"div",24),e.EFF(14,"Detalles"),e.k0s()(),e.DNE(15,Yr,2,0),e.nI1(16,"async"),e.nrm(17,"mat-paginator",25),e.k0s()),2&r){let t;const o=e.XpG(2);e.R7$(2),e.Y8G("mat-sort-header","name"),e.R7$(8),e.Y8G("mat-sort-header","active"),e.R7$(5),e.vxM(15,(t=e.bMT(16,9,o.suppliers$))?15:-1,t),e.R7$(2),e.Y8G("ngClass",e.l_i(11,Dr,o.isLoading,o.pagination.length<10&&o.pagination.page<1))("length",o.pagination.length)("pageIndex",o.pagination.page)("pageSize",o.pagination.size)("pageSizeOptions",e.lJ4(14,Nr))("showFirstLastButtons",!0)}}function zr(r,a){1&r&&(e.j41(0,"div",35),e.EFF(1," \xa1No se ha creado ning\xfan proveedor! "),e.k0s())}function Ur(r,a){1&r&&e.DNE(0,Vr,18,15,"div",19)(1,zr,2,0),2&r&&e.vxM(0,a.length>0?0:1)}let Xr=(()=>{class r{constructor(t,o,i,n,c,u){this._changeDetectorRef=t,this._dialog=o,this._fuseConfirmationService=i,this._snackBar=n,this._suppliersService=c,this.store=u,this.isLoading=!1,this.suppliers$=(0,$.of)([]),this.searchInputControl=new s.MJ(null),this.isSlideLoading=!1,this.selectedSlide=null,this.supplier=new Rr,this._unsubscribeAll=new D.B}ngOnInit(){this.store.select(F.D).pipe((0,h.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.suppliers$=this.store.select(L),this.searchInputControl.valueChanges.pipe((0,h.Q)(this._unsubscribeAll),(0,y.j)(()=>{this.isLoading=!1}),(0,E.B)(300),(0,m.n)(t=>{if(null!==t)return this.isLoading=!0,this._suppliersService.getSuppliers(0,25,"name","desc",t)})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,h.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,X.h)(this._sort.sortChange,this._paginator.page).pipe((0,m.n)(()=>(this.isLoading=!0,this._suppliersService.getSuppliers(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,g.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}updateSupplierStatus(t,o,i){this.isSlideLoading=!0,this.selectedSlide=i,this._suppliersService.updatesSupplierStatus({id:o.id,active:t.checked}).subscribe(({data:n})=>{this._snackBar.openFromComponent(q.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:n.updateSupplierStatus.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.isSlideLoading=!1,this.selectedSlide=null,this._changeDetectorRef.markForCheck()})}deleteSupplier(t){this._fuseConfirmationService.open({title:"Eliminar proveedor",message:"\xbfEsta seguro que desea eliminar el proveedor?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._suppliersService.removeSupplier(t).pipe((0,h.Q)(this._unsubscribeAll)).subscribe(({data:n})=>{this._snackBar.openFromComponent(q.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:n.removeSupplier.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}})}),this._changeDetectorRef.markForCheck()})}openDialog(t,o){this._dialog.open(Gr,{data:{supplier:t,dialogMode:o},panelClass:"ath-dialog-panel",disableClose:!0})}trackByFn(t,o){return o.id||t}static#e=this.\u0275fac=function(o){return new(o||r)(e.rXU(e.gRc),e.rXU(oe.bZ),e.rXU(te.G),e.rXU(G.UG),e.rXU(Q),e.rXU(J.il))};static#t=this.\u0275cmp=e.VBU({type:r,selectors:[["suppliers"]],viewQuery:function(o,i){if(1&o&&(e.GBs(R.iy,5),e.GBs(M.B4,5)),2&o){let n;e.mGM(n=e.lsd())&&(i._paginator=n.first),e.mGM(n=e.lsd())&&(i._sort=n.first)}},standalone:!0,features:[e.aNF],decls:26,vars:10,consts:[["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","flex-wrap","items-center","w-full","gap-2","mt-6","md:fixed","right-8","shrink-0","lg:mt-0","lg:ml-4","lg:w-auto","sm:w-1/2"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto"],[1,"z-10","flex","flex-col","flex-auto","bg-white","dark:bg-default"],[1,"relative","grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","supplier-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"flex","justify-start",3,"mat-sort-header"],[1,"text-center"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"mr-7","text-end"],[1,"border-b","first-letter:z-10","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-gray-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","border-b","supplier-grid","md:px-8"],[1,"truncate"],[1,"flex","justify-center"],[3,"checked","color"],[3,"diameter","color"],[1,"flex","flex-row","justify-end","gap-3","mr-2"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[3,"change","checked","color"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(o,i){if(1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",5),e.nrm(8,"mat-icon",6),e.j41(9,"a",7),e.EFF(10,"Proveedores"),e.k0s()()(),e.j41(11,"div",8)(12,"h2",9),e.EFF(13," Proveedores "),e.k0s()()(),e.j41(14,"div",10)(15,"mat-form-field",11),e.nrm(16,"mat-icon",12)(17,"input",13),e.k0s(),e.j41(18,"button",14),e.bIt("click",function(){return i.openDialog(i.supplier,"add")}),e.nrm(19,"mat-icon",15),e.j41(20,"span",16),e.EFF(21,"Agregar"),e.k0s()()()(),e.j41(22,"div",17)(23,"div",18),e.DNE(24,Ur,2,1),e.nI1(25,"async"),e.k0s()()()),2&o){let n;e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Buscar proveedores"),e.R7$(2),e.Y8G("svgIcon","mat_solid:add"),e.R7$(5),e.vxM(24,(n=e.bMT(25,8,i.suppliers$))?24:-1,n)}},dependencies:[d.Jj,s.YN,s.me,s.BC,b.Hl,b.$z,x.RG,x.rl,x.JW,S.m_,S.An,k.fS,k.fg,R.Ou,R.iy,A.D6,A.LG,w.mV,w.sG,M.NQ,M.B4,M.aE,d.YU,s.X1,s.l_,I.Wk,ae.p],encapsulation:2,data:{animation:Ir.X},changeDetection:0})}return r})();var Jr=l(43801),Lr=l(76856),Or=l(23301),ge=l(59013),_e=l(7561),Wr=l(63425),Hr=l(16551);const Zr=[{path:"suppliers",component:Xr,resolve:{suppliers:(r,a)=>(0,e.WQX)(Q).getSuppliers()}},{path:"purchases",component:P,children:[{path:"list",component:We,resolve:{vouchers:_e.Q,paymentMethods:ge.v,purchases:Lr.FS}},{path:"form",component:xr,resolve:{currencies:Or.I,paymentMethods:ge.v,products:Jr.bN,suppliers:(r,a)=>(0,e.WQX)(Q).findActiveSuppliers(),vouchers:_e.Q,uoms:Wr.B,depots:Hr.MQ}},{path:"details",component:He}]}]}}]);