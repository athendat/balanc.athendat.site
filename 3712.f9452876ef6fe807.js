"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[3712],{7604:(ve,$,d)=>{d.d($,{J:()=>L});var x=d(19212),e=d(47641);let L=(()=>{class s{constructor(C){this._brandsService=C}resolve(C,U){return this._brandsService.getBrands()}static#e=this.\u0275fac=function(U){return new(U||s)(x.LFG(e.G))};static#t=this.\u0275prov=x.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})()},83829:(ve,$,d)=>{d.d($,{gg:()=>s});var x=d(84221);const e=g=>g.brands,s=((0,x.P1)(e,g=>g.brand),(0,x.P1)(e,g=>g.brands))},47641:(ve,$,d)=>{d.d($,{G:()=>B});var x=d(19212),e=d(50967),L=d(48180),s=d(94664),g=d(99397),C=d(84221),U=d(44858),h=d(97214),v=d(83829);const m=e.Ps`
    mutation CreateBrand($createBrandInput: CreateBrandInput!) {
        createBrand(createBrandInput: $createBrandInput) {

            ok
            message

            brand {
                id
                active
                name
                slug
            }

        }
    }
`,y=e.Ps`
    mutation UpdateBrand($updateBrandInput: UpdateBrandInput!) {
        updateBrand(updateBrandInput: $updateBrandInput) {
            ok
            message

            brand {
                id
                active
                name
                slug
            }
        }
    }
`,Z=e.Ps`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateBrandStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }

    }
`,K=e.Ps`
    mutation RemoveBrand($removeBrandId: String!) {
        removeBrand(id: $removeBrandId) {
            ok
            message
        }
    }
`,S=e.Ps`
    query FindAllBrands($offset: Int, $limit: Int, $sort: String, $order: Order, $search: String) {
        findAllBrands(offset: $offset, limit: $limit, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            brands {
                id
                active
                name
                slug
            }
        }
    }
`,E=e.Ps`
    query FindBrandById($findBrandByIdId: String!) {
        findBrandById(id: $findBrandByIdId) {
            ok
            message

            brand {
                id
                active
                name
                slug
            }
        }
    }
`;let B=(()=>{class u{constructor(){this.apolloProvider=(0,x.f3M)(e._M),this.store=(0,x.f3M)(C.yh),this._apollo=this.apolloProvider.use("BALANC")}createBrand(k){return this.store.select(v.gg).pipe((0,L.q)(1),(0,s.w)(f=>this._apollo.mutate({mutation:m,variables:{createBrandInput:k},errorPolicy:"all"}).pipe((0,g.b)(({data:_})=>{const w=structuredClone(f);w.push(_.createBrand.brand),this.store.dispatch((0,U.dk)({brands:w}))}))))}getBrands(k=1,f=20,_="code",w="asc",P=""){return this._apollo.query({query:S,errorPolicy:"all",variables:{offset:f*(k-1),limit:f,sort:_,order:w,search:P}}).pipe((0,g.b)(({data:D})=>{this.store.dispatch((0,h.Jr)({pagination:D.findAllBrands.pagination})),this.store.dispatch((0,U.dk)({brands:D.findAllBrands.brands}))}))}getBrandById(k){return this._apollo.query({query:E,variables:{findBrandByIdId:k},errorPolicy:"all"}).pipe((0,g.b)(({data:f})=>{this.store.dispatch((0,U.HB)({brand:f.findBrandById.brand}))}))}updateBrand(k){return this.store.select(v.gg).pipe((0,L.q)(1),(0,s.w)(f=>this._apollo.mutate({mutation:y,variables:{updateBrandInput:k},errorPolicy:"all"}).pipe((0,g.b)(({data:_})=>{const w=structuredClone(f);w[f.findIndex(D=>D.id===k.id)]=_.updateBrand.brand,this.store.dispatch((0,U.dk)({brands:w}))}))))}updateBrandStatus(k){return this.store.select(v.gg).pipe((0,L.q)(1),(0,s.w)(f=>this._apollo.mutate({mutation:Z,variables:{updateEntityStatusInput:k},errorPolicy:"all"}).pipe((0,g.b)(()=>{const _=structuredClone(f);_[f.findIndex(P=>P.id===k.id)].active=k.active,this.store.dispatch((0,U.dk)({brands:_}))}))))}removeBrand(k){return this.store.select(v.gg).pipe((0,L.q)(1),(0,s.w)(f=>this._apollo.mutate({mutation:K,variables:{removeBrandId:k},errorPolicy:"all"}).pipe((0,g.b)(({})=>{const w=structuredClone(f),P=f.findIndex(D=>D.id===k);w.splice(P,1),this.store.dispatch((0,U.dk)({brands:w}))}))))}static#e=this.\u0275fac=function(f){return new(f||u)};static#t=this.\u0275prov=x.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()},9427:(ve,$,d)=>{d.d($,{Y:()=>L,g:()=>s});var x=d(19212),e=d(46482);let L=(()=>{class g{constructor(U){this._currenciesService=U}resolve(U,h){return this._currenciesService.getCurrencies()}static#e=this.\u0275fac=function(h){return new(h||g)(x.LFG(e.t))};static#t=this.\u0275prov=x.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"})}return g})(),s=(()=>{class g{constructor(U){this._currenciesService=U}resolve(U,h){return this._currenciesService.getActiveCurrency()}static#e=this.\u0275fac=function(h){return new(h||g)(x.LFG(e.t))};static#t=this.\u0275prov=x.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"})}return g})()},21510:(ve,$,d)=>{d.d($,{zd:()=>s});var x=d(84221);const e=g=>g.currencies,s=((0,x.P1)(e,g=>g.currency),(0,x.P1)(e,g=>g.currencies))},46482:(ve,$,d)=>{d.d($,{t:()=>u});var x=d(19212),e=d(48180),L=d(94664),s=d(99397),g=d(50967),C=d(84221),U=d(97214),h=d(20997),v=d(21510);const m=g.Ps`
    mutation CreateCurrency($createCurrencyInput: CreateCurrencyInput!) {
        createCurrency(createCurrencyInput: $createCurrencyInput) {

            ok
            message

            currency {
                id
                active
                name
                iso
                symbol
            }

        }
    }
`,y=g.Ps`
mutation UpdateCurrency($updateCurrencyInput: UpdateCurrencyInput!) {
    updateCurrency(updateCurrencyInput: $updateCurrencyInput) {
        ok
        message

        currency {
            id
            active
            name
            iso
            symbol
        }
    }
}
`,Z=g.Ps`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateCurrencyStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }
    }
`,K=g.Ps`
mutation RemoveCurrency($removeCurrencyId: String!) {
    removeCurrency(id: $removeCurrencyId) {
        ok,
        message
    }
}
`,S=g.Ps`
    query FindAllCurrencies($offset: Int, $limit: Int, $sort: String, $order: Order, $search: String) {
        findAllCurrencies(offset: $offset, limit: $limit, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            currencies {
                id
                active
                name
                iso
                symbol
            }
        }
    }
`,E=g.Ps`
    query FindAllActiveCurrencies {
        findAllActiveCurrencies {
            ok
            message

            currencies {
                id
                name
                iso
            }
        }
    }
`,B=g.Ps`
    query FindCurrencyById($findCurrencyByIdId: String!) {
        findCurrencyById(id: $findCurrencyByIdId) {
            ok
            message

            currency {
                id
                active
                name
                iso
                symbol
            }
        }
    }
`;let u=(()=>{class q{constructor(){this.apolloProvider=(0,x.f3M)(g._M),this.store=(0,x.f3M)(C.yh),this._apollo=this.apolloProvider.use("BALANC")}createCurrency(f){return this.store.select(v.zd).pipe((0,e.q)(1),(0,L.w)(_=>this._apollo.mutate({mutation:m,variables:{createCurrencyInput:f},errorPolicy:"all"}).pipe((0,s.b)(({data:w})=>{const P=structuredClone(_);P.push(w.createCurrency.currency),this.store.dispatch((0,h.HC)({currencies:P}))}))))}getCurrencies(f=1,_=20,w="name",P="asc",D=""){return this._apollo.query({query:S,variables:{offset:_*(f-1),limit:_,sort:w,order:P,search:D},errorPolicy:"all"}).pipe((0,s.b)(({data:W})=>{this.store.dispatch((0,U.Jr)({pagination:W.findAllCurrencies.pagination})),this.store.dispatch((0,h.HC)({currencies:W.findAllCurrencies.currencies}))}))}getActiveCurrency(){return this._apollo.query({query:E,errorPolicy:"all"}).pipe((0,s.b)(({data:f})=>{f&&this.store.dispatch((0,h.HC)({currencies:f.findAllActiveCurrencies.currencies}))}))}getCurrencyById(f){return this._apollo.query({query:B,variables:{findCurrencyByIdId:f},errorPolicy:"all"}).pipe((0,s.b)(({data:_})=>{this.store.dispatch((0,h.NW)({currency:_.findCurrencyById.currency}))}))}updateCurrency(f){return this.store.select(v.zd).pipe((0,e.q)(1),(0,L.w)(_=>this._apollo.mutate({mutation:y,variables:{updateCurrencyInput:f},errorPolicy:"all"}).pipe((0,s.b)(({data:w})=>{const P=structuredClone(_);P[_.findIndex(W=>W.id===f.id)]=w.updateCurrency.currency,this.store.dispatch((0,h.HC)({currencies:P}))}))))}updateCurrencyStatus(f){return this.store.select(v.zd).pipe((0,e.q)(1),(0,L.w)(_=>this._apollo.mutate({mutation:Z,variables:{updateEntityStatusInput:f},errorPolicy:"all"}).pipe((0,s.b)(({})=>{const P=structuredClone(_);P[_.findIndex(W=>W.id===f.id)].active=f.active,this.store.dispatch((0,h.HC)({currencies:P}))}))))}removeCurrency(f){return this.store.select(v.zd).pipe((0,e.q)(1),(0,L.w)(_=>this._apollo.mutate({mutation:K,variables:{removeCurrencyId:f},errorPolicy:"all"}).pipe((0,s.b)(({})=>{const P=structuredClone(_),D=_.findIndex(W=>W.id===f);P.splice(D,1),this.store.dispatch((0,h.HC)({currencies:P}))}))))}static#e=this.\u0275fac=function(_){return new(_||q)};static#t=this.\u0275prov=x.Yz7({token:q,factory:q.\u0275fac,providedIn:"root"})}return q})()},53712:(ve,$,d)=>{d.r($),d.d($,{default:()=>kd});var x=d(64190),e=d(19212);let L=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-warehouse"]],standalone:!0,features:[e.jDz],decls:1,vars:0,template:function(i,n){1&i&&e._UZ(0,"router-outlet")},dependencies:[x.lC],encapsulation:2})}return o})();var s=d(56223),g=d(21476),C=d(13566),U=d(82599),h=d(96814),v=d(32296),m=d(64170),y=d(30617),Z=d(24516),K=d(55940),S=d(22096),E=d(78645),B=d(63019),u=d(59773),q=d(83620),k=d(27921),f=d(94664),_=d(37398),w=d(16676),P=d(36236),D=d(57069),W=d(58695),ae=d(83604),se=d(53374),me=d(29643),M=d(42090),R=d(17700),G=d(22939),A=d(84221),so=d(57482),H=d(56278),he=d(39702),X=d(98525),ie=d(23680);function co(o,r){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Agregar Almac\xe9n "),e.qZA())}function lo(o,r){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Editar Almac\xe9n "),e.qZA())}function uo(o,r){if(1&o&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"h6",13),e._uU(6,"Nombre"),e.qZA(),e.TgZ(7,"span",14),e._uU(8),e.qZA()()()()()()),2&o){const t=e.oxw();e.xp6(8),e.Oqu(t.data.depot.name||"Sin nombre")}}function po(o,r){if(1&o&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(),e.hij(" ",t.fullname," ")}}function mo(o,r){if(1&o&&(e.TgZ(0,"div",15)(1,"div",16)(2,"form",17)(3,"mat-form-field",18)(4,"mat-label"),e._uU(5,"Nombre"),e.qZA(),e._UZ(6,"input",19),e.qZA(),e.TgZ(7,"mat-form-field",18)(8,"mat-label"),e._uU(9,"C\xf3digo en Versat"),e.qZA(),e._UZ(10,"input",20),e.TgZ(11,"mat-hint"),e._uU(12,"C\xf3digo del almac\xe9n en Sistema Contable Versat"),e.qZA()(),e.TgZ(13,"mat-form-field",18)(14,"mat-label"),e._uU(15,"Encargado"),e.qZA(),e.TgZ(16,"mat-select",21),e.SjG(17,po,2,2,"mat-option",22,e.x6l),e.qZA()()()()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.depotForm)("autocomplete","off"),e.xp6(4),e.Q6J("formControlName","name")("placeholder","Nombre del Almac\xe9n"),e.xp6(4),e.Q6J("formControlName","codev")("placeholder","Ejemplo: 0001"),e.xp6(6),e.Q6J("formControlName","managerId"),e.xp6(),e.wJu(t.employees)}}function ho(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.updateDepot())}),e._uU(1," Actualizar "),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("color","primary")("disabled",t.depotForm.invalid)}}function go(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.createDepot())}),e._uU(1," Agregar "),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("color","primary")("disabled",t.depotForm.invalid)}}function fo(o,r){if(1&o&&(e.TgZ(0,"div",23)(1,"button",24),e._uU(2," Cancelar "),e.qZA(),e.YNc(3,ho,2,2,"button",25)(4,go,2,2,"button",25),e.qZA()),2&o){const t=e.oxw();e.xp6(),e.Q6J("matDialogClose","cancelled"),e.xp6(2),e.um2(3,"edit"===t.data.dialogMode?3:-1),e.xp6(),e.um2(4,"add"===t.data.dialogMode?4:-1)}}let _o=(()=>{class o{#e;constructor(t){this.data=t,this.employees=[],this.dialogMode="view",this.imageChangedEvent="",this.croppedImage="",this._unsubscribeAll=new E.x,this._depotsService=(0,e.f3M)(he.Y),this._changeDetectorRef=(0,e.f3M)(e.sBO),this._formBuilder=(0,e.f3M)(s.qu),this._fuseConfirmationService=(0,e.f3M)(H.R),this._dialogRef=(0,e.f3M)(R.so),this._snackBar=(0,e.f3M)(G.ux),this.#e=(0,e.f3M)(A.yh),this.dialogMode=t.dialogMode,this.depot=t.depot}ngOnInit(){this.depotForm=this._formBuilder.group({id:[null],name:[null,[s.kI.required,s.kI.minLength(3),s.kI.maxLength(255)]],codev:[null],managerId:[null]}),"edit"===this.dialogMode&&this.depotForm.patchValue(this.depot),this.#e.select(so.ri).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.employees=t,this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}createDepot(){const t=this.depotForm.getRawValue();delete t.id,this._fuseConfirmationService.open({title:"Crear almac\xe9n",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,u.R)(this._unsubscribeAll)).subscribe(n=>{"confirmed"===n&&this._depotsService.createDepot(t).pipe((0,u.R)(this._unsubscribeAll)).subscribe(({data:a})=>{a&&(this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.createDepot.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._dialogRef.close())})})}updateDepot(){const t=this.depotForm.getRawValue();this._fuseConfirmationService.open({title:"Actualizar almac\xe9n",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._depotsService.updateDepot(t).pipe((0,u.R)(this._unsubscribeAll)).subscribe(({data:a})=>{a&&(this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.updateDepot.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._dialogRef.close())})})}static#t=this.\u0275fac=function(i){return new(i||o)(e.Y36(R.WI))};static#o=this.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-depot-dialog"]],standalone:!0,features:[e.jDz],decls:8,vars:5,consts:[[1,"relative","flex","flex-col","w-full","max-h-screenl"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["class","text-2xl text-gray-400"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","py-6","sm:flex-row","sm:items-start","sm:pb-8"],["class","flex-auto"],["class","w-full overflow-hidden"],["class","flex items-center justify-between px-6 py-4 space-x-3 sm:justify-end bg-gray-50 dark:bg-black dark:bg-opacity-10"],[1,"text-2xl","text-gray-400"],[1,"flex-auto"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"w-full","overflow-hidden"],[1,"flex","flex-col"],[1,"grid","grid-cols-2","w-full","my-1","gap-5",3,"formGroup","autocomplete"],[1,"w-full","fuse-mat-dense"],["matInput","","type","text","required","","maxlength","250",3,"formControlName","placeholder"],["matInput","","type","text","maxlength","250",3,"formControlName","placeholder"],["required","",3,"formControlName"],[3,"value"],[1,"flex","items-center","justify-between","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","disabled"],["mat-flat-button","",3,"color","disabled","click"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,co,2,0,"h2",2)(3,lo,2,0,"h2",2),e.qZA(),e.TgZ(4,"div",3),e.YNc(5,uo,9,1,"div",4)(6,mo,19,7,"div",5),e.qZA(),e.YNc(7,fo,5,3,"div",6),e.qZA()),2&i&&(e.xp6(2),e.um2(2,"add"===n.data.dialogMode?2:-1),e.xp6(),e.um2(3,"edit"===n.data.dialogMode?3:-1),e.xp6(2),e.um2(5,"view"===n.data.dialogMode?5:-1),e.xp6(),e.um2(6,6),e.xp6(),e.um2(7,"view"!==n.data.dialogMode?7:-1))},dependencies:[v.ot,v.lW,R.Is,R.ZT,m.lN,m.KE,m.hX,m.bx,y.Ps,Z.c,Z.Nt,X.LD,X.gD,ie.ey,s.UX,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.nD,s.sg,s.u],encapsulation:2,changeDetection:0})}return o})();class vo{}function xo(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-slide-toggle",34),e.NdJ("change",function(n){e.CHM(t);const a=e.oxw(),c=a.$implicit,l=a.$index,p=e.oxw(4);return e.KtG(p.updateDepotStatus(n,c,l))}),e.qZA()}if(2&o){const t=e.oxw().$implicit;e.Q6J("checked",t.active)("color","primary")}}function bo(o,r){1&o&&e._UZ(0,"mat-spinner",29),2&o&&e.Q6J("diameter",20)("color","primary")}function Co(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",25)(1,"div",26),e._uU(2),e.qZA(),e.TgZ(3,"div",26),e._uU(4),e.qZA(),e.TgZ(5,"div",27),e._uU(6),e.qZA(),e.TgZ(7,"div",26),e.YNc(8,xo,1,2,"mat-slide-toggle",28)(9,bo,1,2,"mat-spinner",29),e.qZA(),e.TgZ(10,"div",30)(11,"button",31),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.updateDepot(a))}),e._UZ(12,"mat-icon",32),e.qZA(),e.TgZ(13,"button",33),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deleteDepot(a.id))}),e._UZ(14,"mat-icon",32),e.qZA()()()}if(2&o){const t=r.$implicit,i=r.$index,n=e.oxw(4);e.xp6(2),e.hij(" ",t.code," "),e.xp6(2),e.hij(" ",t.codev," "),e.xp6(2),e.hij(" ",t.name," "),e.xp6(2),e.um2(8,n.isSlideLoading&&n.selectedSlide===i?-1:8),e.xp6(),e.um2(9,n.isSlideLoading&&n.selectedSlide===i?9:-1),e.xp6(3),e.Q6J("svgIcon","mat_solid:edit"),e.xp6(),e.Q6J("disabled",t.static),e.xp6(),e.Q6J("svgIcon","mat_solid:delete")}}function yo(o,r){1&o&&e.SjG(0,Co,15,8,"div",35,e.QCX().trackByFn),2&o&&e.wJu(r)}const Zo=o=>({"pointer-events-none":o}),To=()=>[25,50,100];function Ao(o,r){if(1&o&&e._UZ(0,"mat-paginator",36),2&o){const t=e.oxw(3);e.Q6J("ngClass",e.VKq(6,Zo,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(8,To))("showFirstLastButtons",!0)}}function Io(o,r){if(1&o&&(e.TgZ(0,"div",20)(1,"div",21)(2,"div",22),e._uU(3,"C\xf3digo"),e.qZA(),e.TgZ(4,"div",22),e._uU(5,"C\xf3digo en Versat"),e.qZA(),e.TgZ(6,"div",22),e._uU(7,"Nombre"),e.qZA(),e.TgZ(8,"div"),e._uU(9,"Activo"),e.qZA(),e.TgZ(10,"div",23),e._uU(11,"Acciones"),e.qZA()(),e.YNc(12,yo,2,0),e.ALo(13,"async"),e.YNc(14,Ao,1,9,"mat-paginator",24),e.qZA()),2&o){const t=e.oxw(2);let i;e.xp6(2),e.Q6J("mat-sort-header","code"),e.xp6(2),e.Q6J("mat-sort-header","codev"),e.xp6(2),e.Q6J("mat-sort-header","name"),e.xp6(6),e.um2(12,(i=e.lcZ(13,5,t.depots$))?12:-1,i),e.xp6(2),e.um2(14,t.pagination.length<10&&t.pagination.page<1?14:-1)}}function ko(o,r){1&o&&(e.TgZ(0,"div",37),e._uU(1," \xa1No se ha creado ninguna almac\xe9n! "),e.qZA())}function wo(o,r){1&o&&e.YNc(0,Io,15,7,"div",19)(1,ko,2,0),2&o&&e.um2(0,r.length>0?0:1)}D.vfs=P.I.vfs;let qo=(()=>{class o{constructor(t,i,n,a,c,l){this._depotsService=t,this._changeDetectorRef=i,this._fuseConfirmationService=n,this._dialog=a,this._snackBar=c,this.store=l,this.depots=[],this.depots$=(0,S.of)([]),this.isLoading=!1,this.isSlideLoading=!1,this.merchant=null,this.merchantInputControl=new s.NI,this.searchInputControl=new s.NI(null),this.selectedSlide=null,this.user=null,this._unsubscribeAll=new E.x}ngOnInit(){this.store.select(se.rk).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(me.Qs).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.depots$=this.store.select(W.$I),this.depots$.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.depots=t,this._changeDetectorRef.markForCheck()}),this.store.select(ae.B).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,q.b)(300),(0,k.O)(null),(0,f.w)(t=>null!==t?(this.isLoading=!0,this._depotsService.getDepots(this.pagination.page,this.pagination.size,"code","asc",t)):(0,S.of)()),(0,_.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,B.T)(this._sort.sortChange,this._paginator.page).pipe((0,f.w)(()=>(this.isLoading=!0,this._depotsService.getDepots(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,_.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createDepot(){this._openDialog(new vo,"add")}updateDepot(t){this._openDialog(t,"edit")}trackByFn(t,i){return t||i.id}updateDepotStatus(t,i,n){this.isSlideLoading=!0,this.selectedSlide=n,this._depotsService.updateDepotStatus({id:i.id,active:t.checked}).subscribe(({data:a})=>{this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.updateDepotStatus.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.isSlideLoading=!1,this.selectedSlide=null,this._changeDetectorRef.markForCheck()})}deleteDepot(t){this._fuseConfirmationService.open({title:"Eliminar almac\xe9n",message:"\xbfEsta seguro que desea eliminar el almac\xe9n?.",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._depotsService.removeDepot(t).pipe((0,u.R)(this._unsubscribeAll)).subscribe(({data:a})=>{a&&(this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.removeDepot.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck())}),this._changeDetectorRef.markForCheck()})}generatePDF(t="open"){const i={header:{text:"LISTADO DE MARCAS",style:"header",marginTop:5},content:[{lineHeight:1.3,table:{headerRows:1,widths:[30,"*",80],body:[[{text:"N\xba",style:"table_header"},{text:"Nombre de Marca",style:"table_header",alignment:"left"},{text:"Estado",style:"table_header"}],...this.depots.map(n=>[{text:this.depots.indexOf(n)+1,alignment:"center",style:"table_body"},{text:n.name,style:"table_body"},{text:!0===n.active?"ACTIVA":"INACTIVA",alignment:"center",style:"table_body"}])]},layout:"lightHorizontalLines",margin:[0,30,0,20]}],footer:(n,a)=>({table:{widths:["*","*"],body:[[{text:`Reporte generador por: ${this.user.fullname} | Esta informaci\xf3n es exclusiva de ${this.merchant.name}`,bold:!0,fontSize:8},{text:`P\xe1gina ${n.toString()}/${a} - Fecha de impresi\xf3n ${w().format("DD/MM/yyyy HH:mm:ss")}`,bold:!0,fontSize:8,alignment:"right"}]]},margin:[30,0,30,0],layout:"noBorders",italics:!0}),defaultStyle:{fontSize:12},styles:{header:{fontSize:18,bold:!0,marginBottom:5,alignment:"center",fontFeatures:["c2sc","smcp"]},table_header:{fontSize:11,bold:!0,alignment:"center",fontFeatures:["c2sc","smcp"]},table_body:{fontSize:10}},pageOrientation:"portrait",pageSize:"LETTER",watermark:{text:this.merchant.name,color:"#fff",opacity:.07,angle:-35,bold:!0,italics:!1},info:{title:"Listado de marcas",author:`${this.user.fullname}`,creationDate:w().toDate(),modDate:w().toDate(),producer:this.merchant.name}};switch(t){case t="download":D.createPdf(i).download();break;case t="open":D.createPdf(i).open();break;case t="print":D.createPdf(i).print()}}_openDialog(t,i){this._dialog.open(_o,{data:{depot:t,dialogMode:i},panelClass:"ath-dialog-panel",disableClose:!0})}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(he.Y),e.Y36(e.sBO),e.Y36(H.R),e.Y36(R.uw),e.Y36(G.ux),e.Y36(A.yh))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-depots"]],viewQuery:function(i,n){if(1&i&&(e.Gf(g.NW,5),e.Gf(C.YE,5)),2&i){let a;e.iGM(a=e.CRH())&&(n._paginator=a.first),e.iGM(a=e.CRH())&&(n._sort=a.first)}},standalone:!0,features:[e.jDz],decls:30,vars:11,consts:[["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","flex-wrap","items-center","gap-2","mt-6","md:fixed","right-8","shrink-0","lg:mt-0","lg:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto"],["class","relative grid"],[1,"relative","grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","depots-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[3,"mat-sort-header"],[1,"pr-4","text-right"],["class","border-b first-letter:z-10 sm:inset-x-0 sm:sticky sm:bottom-0 sm:border-t sm:border-b-0 bg-gray-50 dark:bg-gray-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","depots-grid","md:px-8"],[1,""],[1,"truncate"],[3,"checked","color"],[3,"diameter","color"],[1,"flex","flex-row","justify-end","gap-2"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"disabled","click"],[3,"checked","color","change"],["class","z-0 grid items-center gap-4 px-6 py-3 bg-white border-b dark:bg-default depots-grid md:px-8"],[1,"border-b","first-letter:z-10","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-gray-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(i,n){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Almac\xe9n"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",7),e._uU(14,"Almacenes"),e.qZA()()(),e.TgZ(15,"div",8)(16,"h2",9),e._uU(17," Listado de Almacenes "),e.qZA()()(),e.TgZ(18,"div",10)(19,"mat-form-field",11),e._UZ(20,"mat-icon",12)(21,"input",13),e.qZA(),e.TgZ(22,"button",14),e.NdJ("click",function(){return n.createDepot()}),e._UZ(23,"mat-icon",15),e.TgZ(24,"span",16),e._uU(25,"Agregar"),e.qZA()()()(),e.TgZ(26,"div",17)(27,"div",18),e.YNc(28,wo,2,1),e.ALo(29,"async"),e.qZA()()()),2&i){let a;e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(7),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),e.xp6(2),e.Q6J("svgIcon","mat_solid:add"),e.xp6(5),e.um2(28,(a=e.lcZ(29,9,n.depots$))?28:-1,a)}},dependencies:[h.Ov,s.u5,s.Fj,s.JJ,v.ot,v.lW,m.lN,m.KE,m.qo,y.Ps,y.Hw,Z.c,Z.Nt,g.TU,g.NW,K.Cq,K.Ou,U.rP,U.Rr,C.JX,C.YE,C.nU,h.mk,s.UX,s.oH,x.rH],encapsulation:2,changeDetection:0})}return o})();var Ze=d(15861),ne=d(77988),N=d(92596),re=d(64716),ee=d(21631);const gt=o=>o.movements,Fo=((0,A.P1)(gt,o=>o.movement),(0,A.P1)(gt,o=>o.movements));var Q=d(24630),F=d(99397),Te=d(97214),Le=d(37260),T=d(50967);const So=T.Ps`
    mutation CreatedMovement($createMovementInput: CreateMovementInput!) {
        createdMovement(createMovementInput: $createMovementInput) {
            id
            productId
            product {
                name
                brandId
                brand {
                    name
                }

                uom {
                    abbr
                }
            }

            createdAt

            depotInitId
            depotEndId

            depotInit {
                id
                name
                code
            }

            depotEnd {
                id
                name
                code
            }

            reason
            initQuantity
            quantity
            endQuantity
            type
        }
    }

`,Do=T.Ps`
    query FindAllMovements($page: Int, $size: Int, $sort: String, $order: Order, $search: String, $depotId: String, $productId: String,) {
        findAllMovements(page: $page, size: $size, sort: $sort, order: $order, search: $search, depotId: $depotId, productId: $productId) {
            ok
            message

            pagination {
                length,
                size,
                page,
                lastPage,
                startIndex,
                endIndex
            }

            movements {
                id
                productId
                product {
                    name
                    brandId
                    brand {
                        name
                    }

                    uom {
                        abbr
                    }
                }

                depotInitId
                depotEndId

                depotInit {
                    id
                    name
                    code
                }

                depotEnd {
                    id
                    name
                    code
                }

                observation


                reason
                initQuantity
                quantity
                endQuantity
                type
                createdAt
            }
        }
    }
`,Uo=T.Ps`
    query FindMovementById($findMovementById: String!) {
        movement(id: $findMovementById) {
            id
            productId
            product {
                name
                brandId
                brand {
                    name
                }
            }

            depotInitId
            depotEndId

            depotInit {
                id
                name
                code
            }

            depotEnd {
                id
                name
                code
            }

            reason
            initQuantity
            quantity
            endQuantity
            type
            createdAt
        }
    }
`;let We=(()=>{class o{constructor(t,i){this.apolloProvider=t,this.store=i,this._apollo=this.apolloProvider.use("BALANC")}createMovement(t){return this._apollo.mutate({mutation:So,variables:{createMovementInput:t},errorPolicy:"all"}).pipe((0,F.b)(({data:i})=>{this.store.dispatch((0,Le.mC)({movements:i.createdMovement}))}))}getMovements(t=0,i=50,n="createdAt",a="desc",c="",l=null,p=null){return this._apollo.query({query:Do,errorPolicy:"all",variables:{page:t,size:i,sort:n,order:a,search:c,depotId:l,productId:p}}).pipe((0,F.b)(({data:b})=>{this.store.dispatch((0,Le.jn)({movements:b.findAllMovements.movements})),this.store.dispatch((0,Te.Jr)({pagination:b.findAllMovements.pagination}))}))}getMovementById(t){return this._apollo.query({query:Uo,variables:{findMovementByIdId:t},errorPolicy:"all"}).pipe((0,F.b)(({data:i})=>{this.store.dispatch((0,Le.sw)({movement:i.movement}))}))}static#e=this.\u0275fac=function(i){return new(i||o)(e.LFG(T._M),e.LFG(A.yh))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var Pe=d(24234);class Po{}var J=function(o){return o.ajuste="ajuste",o.averia="averia",o.canje="canje",o.compra="compra",o.inicial="inicial",o.promocion="promoci\xf3n",o.servicio="servicio",o.venta="venta",o.between="between",o.reembolso="reembolso",o.cancelacion="cancelaci\xf3n",o.perdida="perdida",o}(J||{}),xe=function(o){return o.entrada="entrada",o.salida="salida",o}(xe||{});class Mo{constructor(r,t,i,n,a){this.code=r,this.description=t,this.uom=i,this.quantity=n,this.price=a}}var ge=d(12936),te=d(88458),Ae=d(88320);function Eo(o,r){1&o&&e.GkF(0)}function Jo(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-option",27),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.addProductIdToMovement(a))}),e.TgZ(1,"div",28)(2,"span",29),e._uU(3),e.qZA(),e.TgZ(4,"div",30)(5,"span",31),e._uU(6),e.qZA()()()()}if(2&o){const t=r.$implicit;e.Q6J("value",t.name),e.xp6(3),e.Oqu(t.name),e.xp6(3),e.AsE("",t.quantity," ",t.uom,"")}}function Ro(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El producto es obligatorio "),e.qZA())}function No(o,r){1&o&&(e.TgZ(0,"mat-option",18),e._uU(1," Inventario inicial "),e.qZA()),2&o&&e.Q6J("value","inicial")}function Qo(o,r){1&o&&(e.TgZ(0,"mat-option",18),e._uU(1," Por ajuste de inventario "),e.qZA()),2&o&&e.Q6J("value","ajuste")}function Lo(o,r){1&o&&(e.TgZ(0,"mat-option",18),e._uU(1," Por aver\xeda del producto "),e.qZA()),2&o&&e.Q6J("value","averia")}function Wo(o,r){1&o&&(e.TgZ(0,"mat-option",18),e._uU(1," Por promoci\xf3n del proveedor "),e.qZA()),2&o&&e.Q6J("value","promocion")}function zo(o,r){1&o&&(e.TgZ(0,"mat-option",18),e._uU(1," Por compra de mercanc\xedas "),e.qZA()),2&o&&e.Q6J("value","compra")}function $o(o,r){1&o&&(e.TgZ(0,"mat-option",18),e._uU(1," Por venta de mercanc\xedas "),e.qZA()),2&o&&e.Q6J("value","venta")}function Go(o,r){1&o&&(e.TgZ(0,"mat-option",18),e._uU(1," Movimiento entre almacenes "),e.qZA()),2&o&&e.Q6J("value","between")}function Oo(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El motivo es obligatorio "),e.qZA())}function jo(o,r){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(),e.hij(" La cantidad debe ser mayor que ",t.selectedProduct.inStock?0:.1," ")}}function Bo(o,r){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(),e.hij(" La cantidad debe ser menor que ","salida"===t.movementType?t.selectedProduct.quantity:999999," ")}}function Ho(o,r){if(1&o&&(e.TgZ(0,"mat-hint"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(),e.hij("Cantidades menores o iguales a ",t.selectedProduct.quantity,"")}}function Vo(o,r){1&o&&e.GkF(0)}function Yo(o,r){if(1&o&&(e.TgZ(0,"div",7),e.YNc(1,Vo,1,0,"ng-container",8),e.qZA()),2&o){e.oxw();const t=e.MAs(49);e.xp6(),e.Q6J("ngTemplateOutlet",t)}}function Ko(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-option",27),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.addDepot1(a))}),e._uU(1),e.qZA()}if(2&o){const t=r.$implicit;e.Q6J("value",t.name),e.xp6(),e.hij(" ",t.name," ")}}function Xo(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El almac\xe9n de origen es obligatorio "),e.qZA())}function ei(o,r){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(),e.hij(" Los almacenes ",t.movementForm.get("depotId1").getError("notMustMatch")," ")}}function ti(o,r){if(1&o&&(e.TgZ(0,"mat-form-field",32)(1,"mat-label"),e._uU(2,"Almac\xe9n de salida"),e.qZA(),e._UZ(3,"mat-icon",12)(4,"input",13),e.TgZ(5,"mat-autocomplete",14,33),e.SjG(7,Ko,2,2,"mat-option",18,e.x6l),e.ALo(9,"async"),e.qZA(),e.YNc(10,Xo,2,0,"mat-error")(11,ei,2,1,"mat-error"),e.qZA()),2&o){const t=e.MAs(6),i=e.oxw();e.xp6(3),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",i.searchDepots1Control)("matAutocomplete",t)("placeholder","Buscar almacenes"),e.xp6(3),e.wJu(e.lcZ(9,6,i.depotsInitFiltered)),e.xp6(3),e.um2(10,i.movementForm.get("depotId1").hasError("required")?10:-1),e.xp6(),e.um2(11,i.movementForm.get("depotId1").hasError("notMustMatch")?11:-1)}}function oi(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-option",27),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.addDepot2(a))}),e._uU(1),e.qZA()}if(2&o){const t=r.$implicit;e.Q6J("value",t.name),e.xp6(),e.hij(" ",t.name," ")}}function ii(o,r){1&o&&(e.TgZ(0,"mat-error",37),e._uU(1," El almac\xe9n de destino es obligatorio "),e.qZA())}function ni(o,r){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(),e.hij(" Los almacenes ",t.movementForm.get("depotId1").getError("notMustMatch")," ")}}function ri(o,r){if(1&o&&(e.TgZ(0,"mat-form-field",32)(1,"mat-label"),e._uU(2,"Almac\xe9n de entrada"),e.qZA(),e._UZ(3,"mat-icon",12)(4,"input",13),e.TgZ(5,"mat-autocomplete",34,35),e.SjG(7,oi,2,2,"mat-option",18,e.x6l),e.ALo(9,"async"),e.qZA(),e.YNc(10,ii,2,0,"mat-error",36)(11,ni,2,1,"mat-error"),e.qZA()),2&o){const t=e.MAs(6),i=e.oxw();e.xp6(3),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",i.searchDepots2Control)("matAutocomplete",t)("placeholder","Buscar almacenes"),e.xp6(),e.Q6J("displayWith",i.displayFn),e.xp6(2),e.wJu(e.lcZ(9,7,i.depotsEndFiltered)),e.xp6(3),e.um2(10,i.movementForm.get("depotId2").hasError("required")?10:-1),e.xp6(),e.um2(11,i.movementForm.get("depotId1").hasError("notMustMatch")?11:-1)}}let ft=(()=>{class o{constructor(t){this.data=t,this.searchDepots1Control=new s.NI(null,[s.kI.required]),this.searchDepots2Control=new s.NI(null),this.searchProductInStockControl=new s.NI(null,[s.kI.required]),this.selectedDepotEndName="",this.selectedDepotInitName="",this.selectedProduct={name:"",quantity:0,inStock:!0},this._changeDetectorRef=(0,e.f3M)(e.sBO),this._depotsService=(0,e.f3M)(he.Y),this._dialogRef=(0,e.f3M)(R.so),this._formBuilder=(0,e.f3M)(s.qu),this._fuseConfirmationService=(0,e.f3M)(H.R),this._movementsService=(0,e.f3M)(We),this._productService=(0,e.f3M)(Pe.s),this._snackBar=(0,e.f3M)(G.ux),this._stocksService=(0,e.f3M)(Ae.T),this._unsubscribeAll=new E.x,this.store=(0,e.f3M)(A.yh)}ngOnInit(){this.movementForm=this._formBuilder.group({id:new s.NI,productId:new s.NI(null,[s.kI.required]),reason:new s.NI(null,[s.kI.required]),quantity:new s.NI(0,[s.kI.min(0),s.kI.max(9999999)]),type:new s.NI(null),observation:new s.NI(""),depotId1:new s.NI(null,[s.kI.required]),depotId2:new s.NI(null)},{validators:te.L.notMustMatch("depotId2","depotId1")}),this.productsInStock$=this.store.select(ge.K2),this.depotsInitFiltered=this.searchDepots1Control.valueChanges.pipe((0,q.b)(200),(0,k.O)(null),(0,ee.z)(t=>null!==t&&"string"==typeof t&&t!==this.selectedDepotInitName?this._depotsService.findActiveDepots(t.trim()):this.depots1$||this.data.stock?this.depots1$:this._depotsService.findActiveDepots(""))),this.depotsEndFiltered=this.searchDepots2Control.valueChanges.pipe((0,q.b)(200),(0,k.O)(null),(0,ee.z)(t=>null!==t&&"string"==typeof t&&t!==this.selectedDepotEndName?this._depotsService.findActiveDepots(t.trim()):this.depots2$?this.depots2$:this._depotsService.findActiveDepots(""))),this.productsInStockFiltered=this.searchProductInStockControl.valueChanges.pipe((0,q.b)(200),(0,k.O)(null),(0,ee.z)(t=>{const i=this.movementForm.get("depotId1").value;return null!==t&&"string"==typeof t&&i&&this.selectedProduct.name!==t?this._stocksService.getProductsInStockByDepot(i,t.trim()):this.productsInStock$})),this.depotsInitFiltered.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.depots1$=(0,S.of)(t)}),this.depotsEndFiltered.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.depots2$=(0,S.of)(t)}),this.data.stock&&(this.movementForm.get("depotId1").setValue(this.data.stock.depotId),this.movementForm.get("productId").setValue(this.data.stock.productId),this.selectedDepotInitName=this.data.stock.depot.name,this.selectedProduct={name:this.data.stock.product.name,inStock:!0,quantity:this.data.stock.quantity},this.searchDepots1Control.setValue(this.data.stock.depot.name),this.searchProductInStockControl.setValue(this.data.stock.product.name),this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}reasonChange(t){const i=t.value;switch(i===J.between?(this.movementForm.get("depotId2").setValidators([s.kI.required]),this.movementForm.get("depotId2").reset()):(this.movementForm.get("depotId2").clearValidators(),this.movementForm.get("depotId2").reset()),i){case J.inicial:case J.ajuste:case J.compra:this.movementType=xe.entrada,this.movementForm.get("quantity").setValidators([s.kI.required,s.kI.min(this.selectedProduct.inStock?0:.1),s.kI.max(999999)]);break;case J.promocion:case J.averia:case J.venta:case J.between:this.movementType=xe.salida,this.movementForm.get("quantity").setValidators([s.kI.required,s.kI.min(.1),s.kI.max(this.selectedProduct.quantity)])}this._changeDetectorRef.markForCheck()}addDepot1(t){this.selectedDepotInitName=t.name,this.movementForm.get("depotId1").setValue(t.id),this._stocksService.getProductsInStockByDepot(t.id,"").pipe((0,u.R)(this._unsubscribeAll)).subscribe(),this.movementForm.get("depotId1").setValue(t.id),this.movementForm.get("productId").setValue(null),this.searchProductInStockControl.setValue(null),this._changeDetectorRef.markForCheck()}addDepot2(t){this.selectedDepotEndName=t.name,this.movementForm.get("depotId2").setValue(t.id),this._changeDetectorRef.markForCheck()}addProductIdToMovement(t){this.selectedProduct=t,this.movementForm.get("productId").setValue(t.productId),this.movementForm.get("reason").reset(),this._changeDetectorRef.markForCheck()}createMovement(){let t=this.movementForm.getRawValue();if(t.type=this.movementType,t.reason===J.ajuste){if(t.quantity===this.selectedProduct.quantity)return;t.quantity<this.selectedProduct.quantity?(t.type=xe.salida,t.quantity=this.selectedProduct.quantity-t.quantity):t.quantity=t.quantity-this.selectedProduct.quantity}let i=null,n=null;t.type===xe.entrada&&(i=t.depotId1),t.type===xe.salida&&(n=t.depotId1,t.reason===J.between&&(i=t.depotId2)),delete t.id,delete t.depotId1,delete t.depotId2,t={...t,depotEndId:i,depotInitId:n},this._fuseConfirmationService.open({title:`Registrar ${t.type}`,message:`\xbfEst\xe1 seguro desea realizar un movimiento por\n            ${t.quantity} ${this.selectedProduct.name.toLowerCase()}s?`,icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,u.R)(this._unsubscribeAll)).subscribe(c=>{"confirmed"===c&&this._movementsService.createMovement(t).pipe((0,u.R)(this._unsubscribeAll)).subscribe(({data:l})=>{l&&this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:"Movimiento registrado correctamente",type:"success",svgIcon:"mat_solid:done"}}),this.closeDialog()})})}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(R.WI))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["movement-dialog"]],standalone:!0,features:[e.jDz],decls:60,vars:34,consts:[[1,"relative","flex","flex-col","w-full","h-full","max-h-screen"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["mat-dialog-title","",1,"text-2xl","font-semibold","text-gray-400"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6"],[1,"w-full","overflow-hidden"],[1,"flex","border-t"],[1,"grid","w-full","gap-3","pt-8","sm:grid-cols-2","sm:gap-5",3,"formGroup","autocomplete"],[1,"sm:col-span-2","sm:px-4"],[4,"ngTemplateOutlet"],[1,"grid","w-full","gap-3","sm:grid-cols-2","sm:px-4","sm:col-span-2"],[1,"sm:col-span-2"],[1,"w-full"],["matPrefix","",3,"svgIcon"],["type","text","matInput","","required","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete"],["productsAutocomplete","matAutocomplete"],[3,"formControlName","required","selectionChange"],["reason",""],[3,"value"],["matInput","","type","number",3,"formControlName","min","max","required"],["class","sm:col-span-2 sm:px-4"],["depotId1Content",""],["depotId2Content",""],["matInput","",3,"formControlName","required","placeholder"],[1,"flex","items-center","justify-center","w-full","px-8","py-4","sm:justify-end","bg-gray-50"],["mat-button","",1,"-ml-4",3,"color","click"],["mat-flat-button","",3,"disabled","color","click"],[3,"value","click"],[1,"grid","grid-cols-6","w-52","sm:w-120","lg:w-128"],[1,"col-span-5","truncate"],[1,"flex","justify-end","col-span-1"],[1,""],["appearance","fill",1,"w-full"],["depotsInitAutocomplete","matAutocomplete"],[1,"ath-autocomplete",3,"displayWith"],["depotsEndAutocomplete","matAutocomplete"],["class","pb-5"],[1,"pb-5"]],template:function(i,n){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"span",2),e._uU(3,"Registrar movimiento"),e.qZA()(),e.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"form",6)(8,"div",7),e.YNc(9,Eo,1,0,"ng-container",8),e.qZA(),e.TgZ(10,"div",9)(11,"div",10)(12,"mat-form-field",11)(13,"mat-label"),e._uU(14,"Inventario"),e.qZA(),e._UZ(15,"mat-icon",12)(16,"input",13),e.TgZ(17,"mat-autocomplete",14,15),e.SjG(19,Jo,7,4,"mat-option",18,e.x6l),e.ALo(21,"async"),e.qZA(),e.YNc(22,Ro,2,0,"mat-error"),e.qZA()(),e.TgZ(23,"div")(24,"mat-form-field",11)(25,"mat-label"),e._uU(26,"Motivo"),e.qZA(),e.TgZ(27,"mat-select",16,17),e.NdJ("selectionChange",function(c){return n.reasonChange(c)}),e.YNc(29,No,2,1,"mat-option",18)(30,Qo,2,1,"mat-option",18)(31,Lo,2,1,"mat-option",18)(32,Wo,2,1,"mat-option",18)(33,zo,2,1,"mat-option",18)(34,$o,2,1,"mat-option",18)(35,Go,2,1,"mat-option",18),e.qZA(),e.YNc(36,Oo,2,0,"mat-error"),e.qZA()(),e.TgZ(37,"div")(38,"mat-form-field",11)(39,"mat-label"),e._uU(40,"Cantidad de movimiento"),e.qZA(),e._UZ(41,"input",19),e.YNc(42,jo,2,1,"mat-error")(43,Bo,2,1,"mat-error")(44,Ho,2,1,"mat-hint"),e.qZA()()(),e.YNc(45,Yo,2,1,"div",20)(46,ti,12,8,"ng-template",null,21,e.W1O)(48,ri,12,9,"ng-template",null,22,e.W1O),e.TgZ(50,"div",7)(51,"mat-form-field",11)(52,"mat-label"),e._uU(53,"Observaci\xf3n"),e.qZA(),e._UZ(54,"textarea",23),e.qZA()()()()()(),e.TgZ(55,"div",24)(56,"button",25),e.NdJ("click",function(){return n.closeDialog()}),e._uU(57,"Cancelar"),e.qZA(),e.TgZ(58,"button",26),e.NdJ("click",function(){return n.createMovement()}),e._uU(59,"Agregar"),e.qZA()()()),2&i){const a=e.MAs(18),c=e.MAs(28),l=e.MAs(47);e.xp6(7),e.Q6J("formGroup",n.movementForm)("autocomplete","off"),e.xp6(2),e.Q6J("ngTemplateOutlet",l),e.xp6(6),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",n.searchProductInStockControl)("matAutocomplete",a)("placeholder","Buscar productos"),e.xp6(3),e.wJu(e.lcZ(21,32,n.productsInStockFiltered)),e.xp6(3),e.um2(22,n.movementForm.get("productId").hasError("required")?22:-1),e.xp6(5),e.Q6J("formControlName","reason")("required",!0),e.xp6(2),e.um2(29,n.selectedProduct.inStock?-1:29),e.xp6(),e.um2(30,n.selectedProduct.inStock?30:-1),e.xp6(),e.um2(31,n.selectedProduct.inStock?31:-1),e.xp6(),e.um2(32,n.selectedProduct.inStock?32:-1),e.xp6(),e.um2(33,n.selectedProduct.inStock?33:-1),e.xp6(),e.um2(34,n.selectedProduct.inStock?34:-1),e.xp6(),e.um2(35,n.selectedProduct.inStock?35:-1),e.xp6(),e.um2(36,n.movementForm.get("reason").hasError("required")?36:-1),e.xp6(5),e.Q6J("formControlName","quantity")("min",n.selectedProduct.inStock?0:.1)("max","salida"===n.movementType?n.selectedProduct.quantity:999999)("required",!0),e.xp6(),e.um2(42,n.movementForm.get("quantity").hasError("min")?42:-1),e.xp6(),e.um2(43,n.movementForm.get("quantity").hasError("max")?43:-1),e.xp6(),e.um2(44,"salida"===n.movementType?44:-1),e.xp6(),e.um2(45,"between"===c.value?45:-1),e.xp6(9),e.Q6J("formControlName","observation")("required",!1)("placeholder","Observaci\xf3n"),e.xp6(2),e.Q6J("color","warn"),e.xp6(2),e.Q6J("disabled",n.movementForm.invalid)("color","primary")}},dependencies:[h.Ov,Q.Bb,Q.XC,ie.ey,Q.ZL,v.ot,v.lW,m.lN,m.KE,m.hX,m.bx,m.TO,m.qo,y.Ps,y.Hw,Z.c,Z.Nt,s.UX,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.Q7,s.qQ,s.Fd,s.oH,s.sg,s.u],encapsulation:2,changeDetection:0})}return o})(),ai=(()=>{class o{transform(t){if(t)switch(t){case J.inicial:return"Inventario inicial";case J.ajuste:return"Por ajuste de inventario";case J.averia:return"Por aver\xeda del producto";case J.promocion:return"Por promoci\xf3n del proveedor";case J.compra:return"Por compra de mercanc\xedas";case J.venta:return"Por venta de mercanc\xedas";case J.between:return"Movimiento entre almacenes";case J.reembolso:return"Por reembolso";case J.cancelacion:return"Por cancelaci\xf3n"}return""}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275pipe=e.Yjl({name:"movementReason",type:o,pure:!0,standalone:!0})}return o})();function si(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-option",24),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.addDepot(a))}),e._uU(1),e.qZA()}if(2&o){const t=r.$implicit;e.Q6J("value",t.name),e.xp6(),e.hij(" ",t.name," ")}}function ci(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-icon",25),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.resetDepot())}),e.qZA()}}function li(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-option",24),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.addProduct(a))}),e._uU(1),e.qZA()}if(2&o){const t=r.$implicit;e.Q6J("value",t.name),e.xp6(),e.hij(" ",t.name," ")}}function di(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-icon",25),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.resetProduct())}),e.qZA()}}function ui(o,r){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(),e.Oqu(t.depotInit.name)}}function pi(o,r){1&o&&e._UZ(0,"span")}function mi(o,r){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(),e.Oqu(t.depotEnd.name)}}function hi(o,r){1&o&&e._UZ(0,"span")}function gi(o,r){if(1&o&&(e.TgZ(0,"div",34)(1,"div",29),e._uU(2),e.qZA(),e.TgZ(3,"div",35),e._uU(4),e.ALo(5,"movementReason"),e.qZA(),e.TgZ(6,"div",36),e._uU(7),e.qZA(),e.TgZ(8,"div",37),e._uU(9),e.ALo(10,"uppercase"),e.qZA(),e.TgZ(11,"div",32),e.YNc(12,ui,2,1,"span")(13,pi,1,0,"span"),e.qZA(),e.TgZ(14,"div",32),e.YNc(15,mi,2,1,"span")(16,hi,1,0,"span"),e.qZA(),e.TgZ(17,"div",32),e._uU(18),e.qZA(),e.TgZ(19,"div",32),e._uU(20),e.ALo(21,"number"),e.qZA(),e.TgZ(22,"div",32),e._uU(23),e.ALo(24,"number"),e.qZA(),e.TgZ(25,"div",38),e._uU(26),e.ALo(27,"number"),e.qZA(),e.TgZ(28,"div",32),e._uU(29),e.ALo(30,"date"),e.qZA()()),2&o){const t=r.$implicit;e.xp6(2),e.hij(" ",t.product.name," "),e.xp6(2),e.hij(" ",e.lcZ(5,14,t.reason)," "),e.xp6(2),e.Q6J("matTooltip",t.observation),e.xp6(),e.hij(" ",t.observation," "),e.xp6(2),e.hij(" ",e.lcZ(10,16,t.type)," "),e.xp6(3),e.um2(12,t.depotInit?12:-1),e.xp6(),e.um2(13,t.depotInit?-1:13),e.xp6(2),e.um2(15,t.depotEnd?15:-1),e.xp6(),e.um2(16,t.depotEnd?-1:16),e.xp6(2),e.hij(" ",t.product.uom.abbr," "),e.xp6(2),e.hij(" ",e.xi3(21,18,t.initQuantity,"1.2-2")," "),e.xp6(3),e.hij(" ",e.xi3(24,21,t.quantity,"1.2-2")," "),e.xp6(3),e.hij(" ",e.xi3(27,24,t.endQuantity,"1.2-2")," "),e.xp6(3),e.hij(" ",e.xi3(30,27,t.createdAt,"dd/MM/yyyy HH:mm:ss")," ")}}function fi(o,r){1&o&&e.SjG(0,gi,31,30,"div",39,e.QCX().trackByFn),2&o&&e.wJu(r)}const _i=(o,r)=>({"pointer-events-none":o,hidden:r}),vi=()=>[25,50,100];function xi(o,r){if(1&o&&(e.TgZ(0,"div",27)(1,"div",28)(2,"div",29),e._uU(3," Producto "),e.qZA(),e.TgZ(4,"div",30),e._uU(5," Motivo "),e.qZA(),e.TgZ(6,"div",31),e._uU(7," Observaciones "),e.qZA(),e.TgZ(8,"div",30),e._uU(9," Tipo "),e.qZA(),e.TgZ(10,"div",32),e._uU(11," Almac\xe9n Origen "),e.qZA(),e.TgZ(12,"div",32),e._uU(13," Almac\xe9n Destino "),e.qZA(),e.TgZ(14,"div",32),e._uU(15," U.Medida "),e.qZA(),e.TgZ(16,"div",30),e._uU(17," Cantidad Inicial "),e.qZA(),e.TgZ(18,"div",30),e._uU(19," Cantidad "),e.qZA(),e.TgZ(20,"div",30),e._uU(21," Cantidad Final "),e.qZA(),e.TgZ(22,"div",30),e._uU(23," Fecha "),e.qZA()(),e.YNc(24,fi,2,0),e.ALo(25,"async"),e._UZ(26,"mat-paginator",33),e.qZA()),2&o){const t=e.oxw(2);let i;e.xp6(4),e.Q6J("mat-sort-header","reason"),e.xp6(4),e.Q6J("mat-sort-header","type"),e.xp6(8),e.Q6J("mat-sort-header","initQuantity"),e.xp6(2),e.Q6J("mat-sort-header","quantity"),e.xp6(2),e.Q6J("mat-sort-header","endQuantity"),e.xp6(2),e.Q6J("mat-sort-header","createdAt"),e.xp6(2),e.um2(24,(i=e.lcZ(25,13,t.movements$))?24:-1,i),e.xp6(2),e.Q6J("ngClass",e.WLB(15,_i,t.isLoading,t.pagination.length<10&&t.pagination.page<1))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(18,vi))("showFirstLastButtons",!0)}}function bi(o,r){1&o&&(e.TgZ(0,"div",40),e._uU(1," \xa1No se ha registrado ning\xfan movimiento! "),e.qZA())}function Ci(o,r){1&o&&e.YNc(0,xi,27,19,"div",26)(1,bi,2,0),2&o&&e.um2(0,r.length>0?0:1)}let yi=(()=>{class o{constructor(){this.availability=null,this.isLoading=!1,this.movement=new Po,this.movements$=(0,S.of)([]),this.searchDepotsControl=new s.NI(null),this.searchInputControl=new s.NI(null),this.searchProductsControl=new s.NI(null),this.selectedDepot=null,this.selectedProduct=null,this._changeDetectorRef=(0,e.f3M)(e.sBO),this._depotsService=(0,e.f3M)(he.Y),this._dialog=(0,e.f3M)(R.uw),this._movementsService=(0,e.f3M)(We),this._stocksService=(0,e.f3M)(Ae.T),this._unsubscribeAll=new E.x,this.store=(0,e.f3M)(A.yh)}ngOnInit(){this.store.select(ae.B).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.movements$=this.store.select(Fo),this.searchInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,q.b)(300),(0,f.w)(t=>null!==t?(this.isLoading=!0,this._movementsService.getMovements(0,25,"createdAt","desc",t,this.selectedDepot?this.selectedDepot.id:null,this.selectedProduct?this.selectedProduct.id:null)):(0,S.of)()),(0,_.U)(()=>{this.isLoading=!1})).subscribe(),this.depotsFiltered=this.searchDepotsControl.valueChanges.pipe((0,q.b)(200),(0,k.O)(null),(0,re.x)(()=>{this.isLoading=!1}),(0,ee.z)(t=>null!==t&&"string"==typeof t&&(this.selectedDepot&&t!==this.selectedDepot.name||!this.selectedDepot)?(this.isLoading=!0,this._depotsService.findActiveDepots(t.trim())):(0,S.of)())),this.productsFiltered=this.searchProductsControl.valueChanges.pipe((0,q.b)(200),(0,k.O)(null),(0,re.x)(()=>{this.isLoading=!1}),(0,ee.z)(t=>{if(null!==t&&"string"==typeof t&&(this.selectedProduct&&t!==this.selectedProduct.name||!this.selectedProduct)){this.isLoading=!0;const i=this.selectedDepot?this.selectedDepot.id:null;return this._stocksService.findStockProducts(t.trim(),10,i,this.availability)}return(0,S.of)()}))}ngAfterViewInit(){this.waitForPaginatorLoad().then(()=>{this._sort&&this._paginator&&(this._sort.sort({id:"createdAt",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,B.T)(this._sort.sortChange,this._paginator.page).pipe((0,f.w)(()=>(this.isLoading=!0,this._movementsService.getMovements(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.selectedDepot?this.selectedDepot.id:null,this.selectedProduct?this.selectedProduct.id:null))),(0,_.U)(()=>{this.isLoading=!1})).subscribe())})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}addDepot(t){this.selectedDepot=t,this.selectedProduct=null,this.searchProductsControl.setValue(""),this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}resetDepot(){this.selectedDepot=null,this.searchDepotsControl.setValue(""),this.selectedProduct=null,this.searchProductsControl.setValue("",{emitEvent:!1}),this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addProduct(t){this.selectedProduct=t,this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}resetProduct(){this.selectedProduct=null,this.searchProductsControl.setValue(""),this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}openDialog(){this._dialog.open(ft,{data:{stock:null},panelClass:"ath-dialog-panel",disableClose:!0})}trackByFn(t,i){return i.id||t}waitForPaginatorLoad(){var t=this;return(0,Ze.Z)(function*(){for(;!t._paginator||void 0===t._paginator;)yield new Promise(i=>{setTimeout(i,200)});return t._paginator})()}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["movements"]],viewQuery:function(i,n){if(1&i&&(e.Gf(g.NW,5),e.Gf(C.YE,5)),2&i){let a;e.iGM(a=e.CRH())&&(n._paginator=a.first),e.iGM(a=e.CRH())&&(n._sort=a.first)}},standalone:!0,features:[e.jDz],decls:45,vars:22,consts:[["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","flex-wrap","items-center","gap-2","mt-6","md:fixed","right-8","shrink-0","lg:mt-0","lg:ml-4"],["appearance","fill",1,"w-full","mt-4","sm:w-auto","sm:mr-4","sm:mt-0","fuse-mat-dense","mat-fuse-de","fuse-mat-rounded","sm:min-w-72",3,"subscriptSizing"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete"],["depotsDepotsAutocomplete","matAutocomplete"],["class","cursor-pointer","svgIcon","mat_solid:cancel","matSuffix",""],["appearance","fill",1,"w-full","mt-4","sm:w-auto","sm:mr-4","sm:mt-0","fuse-mat-dense","mat-fuse-de","fuse-mat-rounded","sm:min-w-60",3,"subscriptSizing"],["depotsProductsAutocomplete","matAutocomplete"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-col","justify-between","flex-auto"],[3,"value","click"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer",3,"click"],["class","relative grid"],[1,"relative","grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-gray-900","movement-grid"],[1,"truncate"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"flex","justify-center"],[1,"text-center"],[1,"border-b","first-letter:z-10","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-gray-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","md:px-8","movement-grid"],[1,""],[1,"truncate",3,"matTooltip"],[1,"text-center","truncate"],[1,"text-center","uppercase"],["class","z-0 grid items-center gap-4 px-6 py-3 bg-white border-b dark:bg-default md:px-8 movement-grid"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"],[3,"value"]],template:function(i,n){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Almac\xe9n"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",7),e._uU(14,"Movimientos de inventario"),e.qZA()()(),e.TgZ(15,"div",8)(16,"h2",9),e._uU(17," Movimientos de inventario "),e.qZA()()(),e.TgZ(18,"div",10)(19,"mat-form-field",11),e._UZ(20,"mat-icon",12)(21,"input",13),e.TgZ(22,"mat-autocomplete",14,15),e.SjG(24,si,2,2,"mat-option",41,e.x6l),e.ALo(26,"async"),e.qZA(),e.YNc(27,ci,1,0,"mat-icon",16),e.qZA(),e.TgZ(28,"mat-form-field",17),e._UZ(29,"mat-icon",12)(30,"input",13),e.TgZ(31,"mat-autocomplete",14,18),e.SjG(33,li,2,2,"mat-option",41,e.x6l),e.ALo(35,"async"),e.qZA(),e.YNc(36,di,1,0,"mat-icon",16),e.qZA(),e.TgZ(37,"button",19),e.NdJ("click",function(){return n.openDialog()}),e._UZ(38,"mat-icon",20),e.TgZ(39,"span",21),e._uU(40,"Registrar"),e.qZA()()()(),e.TgZ(41,"div",22)(42,"div",23),e.YNc(43,Ci,2,1),e.ALo(44,"async"),e.qZA()()()),2&i){const a=e.MAs(23),c=e.MAs(32);let l;e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(7),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",n.searchDepotsControl)("matAutocomplete",a)("placeholder","Filtre por Almac\xe9n"),e.xp6(3),e.wJu(e.lcZ(26,16,n.depotsFiltered)),e.xp6(3),e.um2(27,n.selectedDepot?27:-1),e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",n.searchProductsControl)("matAutocomplete",c)("placeholder","Filtre por Productos"),e.xp6(3),e.wJu(e.lcZ(35,18,n.productsFiltered)),e.xp6(3),e.um2(36,n.selectedProduct?36:-1),e.xp6(2),e.Q6J("svgIcon","mat_solid:swap_horiz"),e.xp6(5),e.um2(43,(l=e.lcZ(44,20,n.movements$))?43:-1,l)}},dependencies:[h.Ov,h.JJ,h.uU,Q.Bb,Q.XC,ie.ey,Q.ZL,v.ot,v.lW,m.lN,m.KE,m.qo,m.R9,y.Ps,y.Hw,Z.c,Z.Nt,ne.Tx,g.TU,g.NW,C.JX,C.YE,C.nU,N.AV,N.gM,ai,h.mk,s.UX,s.Fj,s.JJ,s.oH,x.rH,h.gd],encapsulation:2,changeDetection:0})}return o})();var de=d(16780);const _t=o=>o.periods,Zi=((0,A.P1)(_t,o=>o.period),(0,A.P1)(_t,o=>o.periods)),Ti=T.Ps`
    mutation OpenPeriodByDepotId($depotId: String!) {
        openPeriodByDepotId(depotId: $depotId) {
            ok
            message

            period {
                id
                userId
                merchantId
                depotId
                open
                close
                state
                stock {
                    productId
                    name
                    quantity
                    upc
                    uom
                    price
                }
            }
        }
    }
`,Ai=T.Ps`
    mutation ClosePeriodByDepotId($closePeriodInput: ClosePeriodInput!) {
        closePeriodByDepotId(closePeriodInput: $closePeriodInput) {
            ok
            message

            period {
                id
                userId
                merchantId
                depotId
                open
                close
                state
                stock {
                    productId
                    name
                    quantity
                    upc
                    uom
                    price
                }
            }
        }
    }
`,Ii=T.Ps`
   query findAllPeriodsByDepotId($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
    findAllPeriodsByDepotId(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length,
                size,
                page,
                lastPage,
                startIndex,
                endIndex
            }

            periods {
                id
                userId
                merchantId
                depotId
                open
                close
                state

                stock {
                    productId
                    name
                    quantity
                    upc
                    uom
                    price
                }

                depot {
                    name
                }

                user {
                    fullname
                }

                shrinkages {
                    id
                    periodId
                    userId
                    products {
                        productId
                        quantity
                        type
                        observation
                    }
                }
            }
        }
    }
`,ki=T.Ps`
   query FindCurrentPeriodByDepotId($depotId: String!) {
    findCurrentPeriodByDepotId(depotId: $depotId) {
            ok
            message

            period {
                id
                userId
                merchantId
                depotId
                open
                close
                state

                stock {
                    productId
                    quantity
                }

                currentStock{
                    productId
                    name
                    price
                    upc
                    uom
                    quantity
                    thumbnail
                }
            }
        }
    }
`,wi=T.Ps`
    query Period {
        period {
            close
            id
            open
            state
        }
    }
`,qi=T.Ps`
    mutation ChangePeriodStatus($updatePeriodStatusInput: UpdatePeriodStatusInput!) {
        period(updatePeriodStatusInput: $updatePeriodStatusInput) {
            id
            open
            close
            state
        }
    }
`,Fi=T.Ps`
    query GetIpvByPeriodId($periodId: String!) {
        getIpvByPeriodId(periodId: $periodId) {
            ok
            message

            ipv {
                locationName
                openedAt
                closedAT

                shrinkageProducts {
                    productId
                    quantity
                    type
                    observation
                }

                lossProducts {
                    productId
                    quantity
                    observation
                }

                returnSaleProducts {
                    productId
                    quantity
                    price
                }

                ipvProductsData {
                    price
                    productId
                    productName
                    uomAbbr
                    initialInventory
                    entries
                    shrinkages
                    losses
                    availableForSale
                    sold
                    returned
                    finalInventory
                    totalSales
                }

                stockMovements {
                    id
                    productId
                    reason
                    initQuantity
                    quantity
                    endQuantity
                    type
                    observation
                    createdAt
                }
            }
        }
    }
`,Si=T.Ps`
    query GetIpvByDepotId($depotId: String!) {
        getIpvByDepotId(depotId: $depotId) {
            ok
            message

            ipv {
                locationName
                openedAt
                closedAT

                shrinkageProducts {
                    productId
                    quantity
                    type
                    observation
                }

                lossProducts {
                    productId
                    quantity
                    observation
                }

                returnSaleProducts {
                    productId
                    quantity
                    price
                }

                ipvProductsData {
                    price
                    productId
                    productName
                    uomAbbr
                    initialInventory
                    entries
                    shrinkages
                    losses
                    availableForSale
                    sold
                    returned
                    finalInventory
                    totalSales
                }

                stockMovements {
                    id
                    productId
                    reason
                    initQuantity
                    quantity
                    endQuantity
                    type
                    observation
                    createdAt
                }
            }
        }
    }
`,Di=T.Ps`
    mutation RegisterShrinkage($shrinkageInput: ShrinkageInput!) {
        registerShrinkage(shrinkageInput: $shrinkageInput) {
            ok
            message

            period {
                id
                userId
                merchantId
                depotId
                open
                close
                state
                stock {
                    productId
                    name
                    quantity
                    upc
                    uom
                    price
                }

                depot {
                    name
                }

                user {
                    fullname
                }

                shrinkages {
                    id
                    periodId
                    userId
                    products {
                        productId
                        quantity
                        type
                        observation
                    }
                }
            }
        }
    }
`,Ui=T.Ps`
    mutation RegisterLosses($lossesInput: LossesInput!) {
        registerLosses(lossesInput: $lossesInput) {
            ok
            message

            period {
                id
                userId
                merchantId
                depotId
                open
                close
                state
                stock {
                    productId
                    name
                    quantity
                    upc
                    uom
                    price
                }

                depot {
                    name
                }

                user {
                    fullname
                }

                losses {
                    id
                    periodId
                    userId
                    products {
                        productId
                        quantity
                        observation
                    }
                }
            }
        }
    }
`;let Me=(()=>{class o{constructor(t,i){this.apolloProvider=t,this.store=i,this._apollo=this.apolloProvider.use("BALANC")}openPeriodByDepotId(t){return this._apollo.mutate({mutation:Ti,variables:{depotId:t},errorPolicy:"all"}).pipe((0,F.b)(({data:i})=>{this.store.dispatch((0,de._y)({period:i.openPeriodByDepotId.period}))}))}closePeriodByDepotId(t){return this._apollo.mutate({mutation:Ai,variables:{closePeriodInput:t},errorPolicy:"all"})}findAllPeriodsByDepotId(t=0,i=10,n="createdAt",a="desc",c="",l=""){return this._apollo.query({query:Ii,errorPolicy:"all",variables:{page:t,size:i,sort:n,order:a,search:c,depotId:l}}).pipe((0,F.b)(({data:p})=>{this.store.dispatch((0,de.CU)({periods:p.findAllPeriodsByDepotId.periods})),this.store.dispatch((0,Te.Jr)({pagination:p.findAllPeriodsByDepotId.pagination}))}))}findCurrentPeriodByDepotId(t){return this._apollo.mutate({mutation:ki,variables:{depotId:t},errorPolicy:"all"}).pipe((0,F.b)(({data:i})=>{this.store.dispatch((0,de._y)({period:i.findCurrentPeriodByDepotId.period}))}))}changePeriodStatus(t){return this._apollo.mutate({mutation:qi,variables:{updatePeriodStatusInput:{state:t}},errorPolicy:"all"}).pipe((0,F.b)(({data:i})=>{this.store.dispatch((0,de._y)({period:i.period}))}))}getCurrentPeriod(){return this._apollo.query({query:wi,errorPolicy:"all"}).pipe((0,F.b)(({data:t})=>{this.store.dispatch((0,de._y)({period:t.period}))}))}getIpvByPeriodId(t){return this._apollo.query({query:Fi,variables:{periodId:t},errorPolicy:"all"}).pipe((0,_.U)(({data:i})=>i?i.getIpvByPeriodId.ipv:null))}getIpvByDepotId(t){return this._apollo.query({query:Si,variables:{depotId:t},errorPolicy:"all"}).pipe((0,_.U)(({data:i})=>i?i.getIpvByDepotId.ipv:null))}registerShrinkage(t){return this._apollo.mutate({mutation:Di,variables:{shrinkageInput:t},errorPolicy:"all"}).pipe((0,_.U)(({data:i})=>i?i.registerShrinkage:null),(0,F.b)(i=>{i&&this.store.dispatch((0,de.mE)({period:i.period}))}))}registerLosses(t){return this._apollo.mutate({mutation:Ui,variables:{lossesInput:t},errorPolicy:"all"}).pipe((0,_.U)(({data:i})=>i?i.registerLosses:null),(0,F.b)(i=>{i&&this.store.dispatch((0,de.mE)({period:i.period}))}))}static#e=this.\u0275fac=function(i){return new(i||o)(e.LFG(T._M),e.LFG(A.yh))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var vt=function(o){return o.open="open",o.close="close",o}(vt||{}),Ie=d(48420),Mi=d(70456),Ei=d(15704);const Ji=["search"];function Ri(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",18)(1,"div",19)(2,"button",20),e._UZ(3,"mat-icon",21),e.qZA()(),e.TgZ(4,"div",22)(5,"div",23),e._UZ(6,"mat-icon",24),e.TgZ(7,"span",25),e._uU(8,"Seleccione un tipo de operaci\xf3n"),e.qZA(),e.TgZ(9,"button",26),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.selectedType="Merma")}),e._UZ(10,"mat-icon",21),e.TgZ(11,"span",27),e._uU(12,"Registrar Merma"),e.qZA()(),e.TgZ(13,"button",26),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.selectedType="P\xe9rdida")}),e._UZ(14,"mat-icon",21),e.TgZ(15,"span",27),e._uU(16,"Registrar P\xe9rdida"),e.qZA()()()()()}2&o&&(e.xp6(2),e.Q6J("matDialogClose",!0),e.xp6(),e.Q6J("svgIcon","mat_solid:close"),e.xp6(3),e.Q6J("svgIcon","mat_solid:warning"),e.xp6(3),e.Q6J("color","primary"),e.xp6(),e.Q6J("svgIcon","mat_solid:remove"),e.xp6(3),e.Q6J("color","warn"),e.xp6(),e.Q6J("svgIcon","mat_solid:remove"))}function Ni(o,r){if(1&o&&(e.TgZ(0,"div",28)(1,"span",29),e._uU(2),e.qZA()()),2&o){const t=e.oxw();e.xp6(2),e.hij("Registrar ",t.selectedType,"")}}function Qi(o,r){1&o&&(e.TgZ(0,"mat-error",44),e._uU(1," Valor m\xednimo 0 "),e.qZA())}function Li(o,r){if(1&o&&(e.TgZ(0,"mat-error",44),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(),e.hij(" Valor m\xe1ximo ",t.quantityPreviews," ")}}function Wi(o,r){1&o&&(e.TgZ(0,"mat-error",44),e._uU(1," Patr\xf3n no v\xe1lido "),e.qZA())}function zi(o,r){if(1&o&&(e.TgZ(0,"div",45)(1,"mat-form-field",46)(2,"mat-label"),e._uU(3,"Clasificaci\xf3n"),e.qZA(),e.TgZ(4,"mat-select",47)(5,"mat-option",48),e._uU(6,"Averiado"),e.qZA(),e.TgZ(7,"mat-option",49),e._uU(8,"Vencido"),e.qZA(),e.TgZ(9,"mat-option",50),e._uU(10,"Deterioro"),e.qZA()()()()),2&o){const t=e.oxw().$implicit;e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControl",t.get("type"))("required",t.get("quantity").value>0)}}const ze=o=>({hidden:o});function $i(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",30)(1,"div",31),e._uU(2),e.qZA(),e.TgZ(3,"div",32)(4,"div",33)(5,"button",34),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.decrementProductQty(a))}),e._UZ(6,"mat-icon",21),e.qZA(),e.TgZ(7,"mat-form-field",35)(8,"span",36),e._uU(9),e.qZA(),e._UZ(10,"input",37),e.qZA(),e.TgZ(11,"button",34),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.incrementProductQty(a))}),e._UZ(12,"mat-icon",21),e.qZA()(),e.YNc(13,Qi,2,0,"mat-error",38)(14,Li,2,1,"mat-error",38)(15,Wi,2,0,"mat-error",38),e.qZA()(),e.TgZ(16,"div",39)(17,"div",40),e.YNc(18,zi,11,3,"div",41),e.TgZ(19,"mat-form-field",42)(20,"mat-label"),e._uU(21,"Observaciones"),e.qZA(),e._UZ(22,"textarea",43),e.qZA()()()}if(2&o){const t=r.$implicit,i=r.$index,n=e.oxw();e.Q6J("ngClass",e.VKq(21,ze,!n.periodStock[i])),e.xp6(),e.Q6J("matTooltip",t.get("name").value),e.xp6(),e.hij(" ",t.get("name").value," "),e.xp6(3),e.Q6J("disabled",t.get("quantity").value<=0||t.get("quantity").hasError("pattern")),e.xp6(),e.Q6J("svgIcon","mat_solid:remove"),e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(2),e.Oqu(t.get("uom").value),e.xp6(),e.Q6J("min",0)("max",t.get("quantityPreviews").value)("formControl",t.get("quantity")),e.xp6(),e.Q6J("disabled",t.get("quantity").value>=t.get("quantityPreviews").value||t.get("quantity").hasError("pattern")),e.xp6(),e.Q6J("svgIcon","mat_solid:add"),e.xp6(),e.um2(13,t.get("quantity").hasError("min")?13:-1),e.xp6(),e.um2(14,t.get("quantity").hasError("max")?14:-1),e.xp6(),e.um2(15,t.get("quantity").hasError("pattern")&&!t.get("quantity").hasError("min")?15:-1),e.xp6(),e.Q6J("ngClass",e.VKq(23,ze,!n.periodStock[i])),e.xp6(),e.Q6J("ngClass",e.VKq(25,ze,t.get("quantity").value<1)),e.xp6(),e.um2(18,"Merma"===n.selectedType?18:-1),e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControl",t.get("observation"))("required",t.get("quantity").value>0)}}function Gi(o,r){1&o&&(e.TgZ(0,"span"),e._uU(1," Aceptar "),e.qZA())}function Oi(o,r){1&o&&e._UZ(0,"mat-progress-spinner",17),2&o&&e.Q6J("diameter",24)("mode","indeterminate")}const ji=o=>({"cursor-not-allowed":o});let Bi=(()=>{class o{constructor(t){this.data=t,this.isLoading=!1,this.periodStock=[],this.selectedType=null,this._formBuilder=(0,e.f3M)(s.qu),this._fuseConfirmationService=(0,e.f3M)(H.R),this._changeDetectorRef=(0,e.f3M)(e.sBO),this._dialogRef=(0,e.f3M)(R.so),this._snackBar=(0,e.f3M)(G.ux),this._periodsService=(0,e.f3M)(Me),this._unsubscribeAll=new E.x,this.periodStock=t.currentStock}ngOnInit(){const t=this.data.currentStock.map(i=>this.createProductFormGroup(i));this.shrinkageForm=this._formBuilder.group({periodId:[this.data.id,s.kI.required],products:this._formBuilder.array(t)}),this.shrinkageForm.get("products").valueChanges.pipe((0,u.R)(this._unsubscribeAll)).subscribe(i=>{i.forEach(n=>{n.quantity>0?(this.shrinkageForm.get("products").get("observation").setValidators([s.kI.required]),"Merma"===this.selectedType&&this.shrinkageForm.get("products").get("type").setValidators([s.kI.required])):(this.shrinkageForm.get("products").get("observation").clearValidators(),this.shrinkageForm.get("products").get("type").clearValidators())}),this.shrinkageForm.get("products").get("observation").updateValueAndValidity({emitEvent:!1}),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}filterProducts(t){this.periodStock=this.data.currentStock.filter(i=>i.name.toLowerCase().includes(t.toLowerCase()))}registerShrinkageLosses(t){if("Enter"===t.key&&t.target instanceof HTMLTextAreaElement||this.shrinkageForm.invalid)return;const i=this.shrinkageForm.getRawValue();i.products.some(c=>c.quantity>0)&&(i.products=i.products.map(c=>({productId:c.productId,quantity:Number(c.quantity),type:c.type,observation:c.observation})).filter(c=>c.quantity>0),"P\xe9rdida"===this.selectedType&&(i.products=i.products.map(c=>({productId:c.productId,quantity:Number(c.quantity),observation:c.observation}))),this._fuseConfirmationService.open({title:"\xbfEst\xe1s seguro?",message:`\xbfEst\xe1s seguro que deseas registrar las ${"P\xe9rdida"===this.selectedType?"p\xe9rdidas":"mermas"} para este per\xedodo?`,icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"S\xed",color:"primary"},cancel:{label:"No"}}}).afterClosed().subscribe(c=>{if("confirmed"===c){this.isLoading=!0;let l=(0,S.of)();l="Merma"===this.selectedType?this._periodsService.registerShrinkage(i):this._periodsService.registerLosses(i),l.pipe((0,u.R)(this._unsubscribeAll),(0,re.x)(()=>{this.isLoading=!1})).subscribe(p=>{p.period&&(this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:p.message,type:"success",svgIcon:"mat_solid:done"}}),this.closeDialog())})}}))}incrementProductQty(t){const i=t.get("quantity").value;t.get("quantity").setValue(+i+1)}decrementProductQty(t){const i=t.get("quantity").value;t.get("quantity").setValue(+i-1)}closeDialog(){this._dialogRef.close()}resetData(){this.selectedType=null,this.periodStock=this.data.currentStock;const t=this.data.currentStock.map(i=>this.createProductFormGroup(i));this.shrinkageForm=this._formBuilder.group({periodId:[this.data.id,s.kI.required],products:this._formBuilder.array(t)}),this.search.close(),this._changeDetectorRef.markForCheck()}trackByFn(t,i){return i.productId||t}createProductFormGroup(t){return this._formBuilder.group({productId:[t.productId,[s.kI.required]],name:[t.name],type:[""],quantityPreviews:[t.quantity],quantity:[0,[te.L.onlyNumbersPattern(),s.kI.required,s.kI.min(0),s.kI.max(t.quantity)]],uom:[t.uom],observation:[""]})}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(R.WI))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-shrinkages-losses-dialog"]],viewQuery:function(i,n){if(1&i&&e.Gf(Ji,7),2&i){let a;e.iGM(a=e.CRH())&&(n.search=a.first)}},standalone:!0,features:[e.jDz],decls:27,vars:13,consts:[["class","absolute h-full w-full  z-20 bg-white dark:bg-card "],[1,"relative","flex","flex-col","w-full","h-full","max-h-screen","min-h-140",3,"keydown.enter"],["class","flex flex-col items-center px-8 pt-4 space-y-1 text-center sm:items-start sm:mt-0 sm:pr-8 sm:text-left"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6"],[1,"w-full","overflow-hidden"],[1,"flex","border-t"],[1,"w-full",3,"formGroup","autocomplete"],[1,"flex","flex-col"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","grid-cols-2","gap-4","pl-2","pr-3","py-2","font-semibold","shadow","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],[1,"flex","gap-2","flex-row","relative","items-center","min-h-10"],[3,"appearance","search"],["search",""],[1,"text-end","mr-16","flex","h-full","items-center","justify-end"],[1,"overflow-auto","border-b","px-2",2,"max-height","40vh"],[1,"flex","items-center","justify-center","w-full","px-8","py-4","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-button","",3,"color","click"],["mat-flat-button","","mat-button","",3,"color","ngClass","disabled","click"],[3,"diameter","mode"],[1,"absolute","h-full","w-full","z-20","bg-white","dark:bg-card"],[1,"flex","items-center","absolute","top-0","right-0","p-4"],["mat-icon-button","",3,"matDialogClose"],[1,"icon-size-5",3,"svgIcon"],[1,"flex","flex-col","items-center","justify-center","w-full","h-full","px-8","space-y-4"],[1,"flex","flex-col","items-center","space-y-2"],[1,"icon-size-10",3,"svgIcon"],[1,"text-2xl","font-semibold","text-gray-400"],["mat-stroked-button","",1,"flex","items-center","justify-center","w-full","max-w-64",3,"color","click"],[1,"ml-2"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["mat-dialog-title","",1,"text-2xl","font-semibold","text-gray-400"],[1,"flex","items-center","justify-between","border-t","py-2","pr-2",3,"ngClass"],[1,"truncate",3,"matTooltip"],[1,"flex","flex-col","justify-center"],[1,"flex","flex-row","items-center","justify-center","gap-2"],["mat-stroked-button","",1,"p-2","leading-6","min-w-7","min-h-7","h-7",3,"disabled","click"],[1,"fuse-mat-dense","fuse-mat-rounded","max-w-22",3,"subscriptSizing"],["matSuffix",""],["matInput","","type","text","name","quantity",1,"font-mono","font-semibold","text-center",3,"min","max","formControl"],["class","w-full text-sm text-center"],[3,"ngClass"],[1,"p-6","mb-4","overflow-hidden","shadow-lg","flex","flex-row","gap-4",3,"ngClass"],["class","flex flex-col justify-center max-w-40"],["appearance","outline",1,"w-full",3,"subscriptSizing"],["matInput","","matAutosizeMinRows","1","matAutosizeMaxRows","5",3,"formControl","required"],[1,"w-full","text-sm","text-center"],[1,"flex","flex-col","justify-center","max-w-40"],["appearance","outline",3,"subscriptSizing"],[3,"formControl","required"],["value","averiado"],["value","vencido"],["value","deterioro"]],template:function(i,n){1&i&&(e.YNc(0,Ri,17,7,"div",0),e.TgZ(1,"div",1),e.NdJ("keydown.enter",function(c){return n.registerShrinkageLosses(c)}),e.YNc(2,Ni,3,1,"div",2),e.TgZ(3,"div",3),e.ynx(4),e.TgZ(5,"div",4)(6,"div",5)(7,"form",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"span"),e._uU(12,"Productos"),e.qZA(),e.TgZ(13,"search",10,11),e.NdJ("search",function(c){return n.filterProducts(c)}),e.qZA()(),e.TgZ(15,"div",12),e._uU(16,"Cantidades"),e.qZA()(),e.TgZ(17,"div",13),e.SjG(18,$i,23,27,null,null,n.trackByFn),e.qZA()()()()(),e.BQk(),e.qZA(),e.ynx(20),e.TgZ(21,"div",14)(22,"button",15),e.NdJ("click",function(){return n.resetData()}),e._uU(23,"Cancelar"),e.qZA(),e.TgZ(24,"button",16),e.NdJ("click",function(c){return n.registerShrinkageLosses(c)}),e.YNc(25,Gi,2,0,"span")(26,Oi,1,2,"mat-progress-spinner",17),e.qZA()(),e.BQk(),e.qZA()),2&i&&(e.um2(0,n.selectedType?-1:0),e.xp6(2),e.um2(2,n.selectedType?2:-1),e.xp6(5),e.Q6J("formGroup",n.shrinkageForm)("autocomplete","off"),e.xp6(6),e.Q6J("appearance","bar"),e.xp6(5),e.wJu(n.shrinkageForm.get("products").controls),e.xp6(4),e.Q6J("color","warn"),e.xp6(2),e.Q6J("color","primary")("ngClass",e.VKq(11,ji,n.shrinkageForm.invalid||n.isLoading))("disabled",n.shrinkageForm.invalid||n.isLoading),e.xp6(),e.um2(25,n.isLoading?-1:25),e.xp6(),e.um2(26,n.isLoading?26:-1))},dependencies:[v.ot,v.lW,v.RK,R.Is,R.ZT,R.uh,m.lN,m.KE,m.hX,m.TO,m.R9,y.Ps,y.Hw,Z.c,Z.Nt,K.Cq,K.Ou,X.LD,X.gD,ie.ey,N.AV,N.gM,h.mk,s.UX,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.oH,s.sg,Ei.g],encapsulation:2})}return o})();const xt=o=>["/warehouse/inventory-admin",o];function Hi(o,r){if(1&o&&(e.TgZ(0,"button",15)(1,"span",16),e._uU(2,"Abrir Inventario"),e.qZA()()),2&o){const t=e.oxw();e.Q6J("routerLink",e.VKq(1,xt,null==t.depot?null:t.depot.id))}}const Vi=(o,r)=>r.id;function Yi(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",32),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,a=e.oxw(2);return e.KtG(a.viewPeriodReport(n))}),e._UZ(1,"mat-icon",28),e.qZA()}2&o&&(e.xp6(),e.Q6J("svgIcon","mat_solid:inventory"))}function Ki(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",32),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,a=e.oxw(2);return e.KtG(a.viewOpenedPeriodReport(n))}),e._UZ(1,"mat-icon",28),e.qZA()}2&o&&(e.xp6(),e.Q6J("svgIcon","mat_solid:inventory"))}const Xi=(o,r)=>({"bg-green-500":o,"bg-red-500":r});function en(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",21)(1,"div",22),e._uU(2),e.qZA(),e.TgZ(3,"div",23),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"div",23),e._uU(7),e.ALo(8,"date"),e.qZA(),e.TgZ(9,"div",24)(10,"span",25),e._uU(11),e.qZA()(),e.TgZ(12,"div",26)(13,"button",27),e._UZ(14,"mat-icon",28),e.qZA(),e.YNc(15,Yi,2,1,"button",29)(16,Ki,2,1,"button",29),e.TgZ(17,"button",30),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.getIpvByPeriodId(a.id))}),e._UZ(18,"mat-icon",28),e.qZA(),e.TgZ(19,"button",31),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.openShrinkagesLosesDialog(a))}),e._UZ(20,"mat-icon",28),e.qZA()()()}if(2&o){const t=r.$implicit;e.xp6(2),e.hij(" ",t.depot.name," "),e.xp6(2),e.hij(" ",e.xi3(5,14,t.open,"dd/MM/yyyy hh:mm a")," "),e.xp6(3),e.hij(" ",e.xi3(8,17,t.close,"dd/MM/yyyy hh:mm a")," "),e.xp6(3),e.Q6J("ngClass",e.WLB(20,Xi,"open"===t.state,"close"===t.state)),e.xp6(),e.hij(" ","open"===t.state?"ABIERTO":"CERRADO"," "),e.xp6(2),e.Q6J("routerLink",e.VKq(23,xt,t.depotId))("disabled","close"===t.state),e.xp6(),e.Q6J("svgIcon","mat_solid:lock"),e.xp6(),e.um2(15,"close"===t.state?15:-1),e.xp6(),e.um2(16,"open"===t.state?16:-1),e.xp6(),e.Q6J("disabled","open"===t.state),e.xp6(),e.Q6J("svgIcon","mat_solid:print"),e.xp6(),e.Q6J("disabled","close"===t.state),e.xp6(),e.Q6J("svgIcon","mat_solid:dangerous")}}const tn=o=>({"pointer-events-none":o}),on=()=>[10,25,50,100];function nn(o,r){if(1&o&&(e.TgZ(0,"div",17)(1,"div",18)(2,"div"),e._uU(3,"Almac\xe9n"),e.qZA(),e.TgZ(4,"div",19),e._uU(5,"Fecha de apertura"),e.qZA(),e.TgZ(6,"div",19),e._uU(7,"Fecha de cierre"),e.qZA(),e.TgZ(8,"div",19),e._uU(9,"Estado"),e.qZA(),e.TgZ(10,"div",19),e._uU(11,"Acciones"),e.qZA()(),e.SjG(12,en,21,25,"div",33,Vi),e._UZ(14,"mat-paginator",20),e.qZA()),2&o){const t=e.oxw();e.xp6(12),e.wJu(t.periods),e.xp6(2),e.Q6J("ngClass",e.VKq(6,tn,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(8,on))("showFirstLastButtons",!0)}}function rn(o,r){1&o&&(e.TgZ(0,"div",34),e._uU(1," \xa1No se ha creado ninguna per\xedodo de almac\xe9n! "),e.qZA())}const an=o=>({"cursor-progress":o});let sn=(()=>{class o{constructor(){this.isLoading=!1,this.merchant=null,this.depot=null,this.periods=[],this.user=null,this.showOpenStock=!1,this._changeDetectorRef=(0,e.f3M)(e.sBO),this._periodsService=(0,e.f3M)(Me),this._documentsService=(0,e.f3M)(Ie.S),this._unsubscribeAll=new E.x,this._printerService=(0,e.f3M)(Mi.v),this._matDialog=(0,e.f3M)(R.uw),this.store=(0,e.f3M)(A.yh)}ngOnInit(){this.store.select(se.rk).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(me.Qs).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(W.ae).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.depot=t,this._changeDetectorRef.markForCheck()}),this.store.select(Zi).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.periods=t,this.showOpenStock=!t.some(i=>i.state===vt.open),this._changeDetectorRef.markForCheck()}),this.store.select(ae.B).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()})}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"createdAt",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,B.T)(this._sort.sortChange,this._paginator.page).pipe((0,f.w)(()=>(this.isLoading=!0,this._periodsService.findAllPeriodsByDepotId(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,""))),(0,_.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this.store.dispatch((0,de.Bg)())}getIpvByPeriodId(t){this._periodsService.getIpvByPeriodId(t).pipe((0,u.R)(this._unsubscribeAll)).subscribe(i=>{i&&this._printerService.printIpvTicket(i).pipe((0,u.R)(this._unsubscribeAll)).subscribe()})}viewPeriodReport(t){this._periodsService.getIpvByPeriodId(t.id).pipe((0,u.R)(this._unsubscribeAll)).subscribe(i=>{this._documentsService.generatePeriodCloseDocument(t,i,this.merchant,this.user)})}viewOpenedPeriodReport(t){this._periodsService.getIpvByDepotId(t.depotId).pipe((0,u.R)(this._unsubscribeAll)).subscribe(i=>{this._documentsService.generatePeriodCloseDocument(t,i,this.merchant,this.user)})}openShrinkagesLosesDialog(t){this._periodsService.findCurrentPeriodByDepotId(t.depotId).pipe((0,u.R)(this._unsubscribeAll)).subscribe(({data:i})=>{i&&this._matDialog.open(Bi,{data:{...i.findCurrentPeriodByDepotId.period,id:t.id},panelClass:"ath-dialog-panel",disableClose:!0})})}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-periods"]],viewQuery:function(i,n){if(1&i&&(e.Gf(g.NW,5),e.Gf(C.YE,5)),2&i){let a;e.iGM(a=e.CRH())&&(n._paginator=a.first),e.iGM(a=e.CRH())&&(n._sort=a.first)}},standalone:!0,features:[e.jDz],decls:24,vars:7,consts:[["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent",3,"ngClass"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","flex-wrap","items-center","gap-2","mt-6","md:fixed","right-8","shrink-0","lg:mt-0","lg:ml-4"],["class","ml-4","mat-raised-button","","class","text-white bg-gradient-to-r from-primary-500 to-primary-700",3,"routerLink"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto"],["class","relative grid"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"routerLink"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"relative","grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","periods-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"text-center"],[1,"border-b","first-letter:z-10","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-gray-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","periods-grid","md:px-8"],[1,""],[1,"text-center","truncate"],[1,"flex","items-center","justify-center"],[1,"px-2","py-0.5","rounded-full","text-sm",3,"ngClass"],[1,"flex","flex-row","justify-center","gap-2"],["mat-stroked-button","","routerLinkActive","router-link-active","matTooltip","Cerrar inventario",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink","disabled"],[1,"icon-size-5",3,"svgIcon"],["class","px-2 leading-6 min-w-10 min-h-7 h-7","mat-stroked-button","","matTooltip","Ver reporte de cierre"],["matTooltip","Imprimir reporte de cierre (ipv)","mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"disabled","click"],["matTooltip","Registrar mermas o p\xe9rdidas","mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"disabled","click"],["mat-stroked-button","","matTooltip","Ver reporte de cierre",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],["class","z-0 grid items-center gap-4 px-6 py-3 bg-white border-b dark:bg-default periods-grid md:px-8"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Almac\xe9n"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",7),e._uU(14,"Per\xedodos"),e.qZA()()(),e.TgZ(15,"div",8)(16,"h2",9),e._uU(17," Registro de cierres de almac\xe9n "),e.qZA()()(),e.TgZ(18,"div",10),e.YNc(19,Hi,3,3,"button",11),e.qZA()(),e.TgZ(20,"div",12)(21,"div",13),e.YNc(22,nn,15,9,"div",14)(23,rn,2,0),e.qZA()()()),2&i&&(e.Q6J("ngClass",e.VKq(5,an,n.isLoading)),e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(7),e.um2(19,n.showOpenStock?19:-1),e.xp6(3),e.um2(22,n.periods.length>0?22:23))},dependencies:[h.uU,v.ot,v.lW,m.lN,y.Ps,y.Hw,Z.c,ne.Tx,g.TU,g.NW,C.JX,C.YE,N.AV,N.gM,h.mk,s.UX,x.rH],encapsulation:2,changeDetection:0})}return o})();var bt=d(36028),ue=d(75986),ke=d(22557),Ee=d(87466),O=d(61545),$e=d(6990);const Ge={toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]]},Oe=new e.OlP("config",{providedIn:"root",factory:()=>({modules:Ge})});var je=d(6593),cn=d(74911),ln=d(2664),dn=d(24036),Be=d(47394),He=d(92438),un=d(67081);function pn(o,r){1&o&&e._UZ(0,"pre",0)}function mn(o,r){1&o&&e._UZ(0,"div",0)}function hn(o,r){if(1&o&&e.YNc(0,pn,1,0,"pre",0)(1,mn,1,0),2&o){const t=e.oxw();e.um2(0,t.preserve?0:1)}}function gn(o,r){1&o&&e._UZ(0,"pre",0)}function fn(o,r){1&o&&e._UZ(0,"div",0)}function _n(o,r){if(1&o&&e.YNc(0,gn,1,0,"pre",0)(1,fn,1,0),2&o){const t=e.oxw();e.um2(0,t.preserve?0:1)}}const vn=[[["","above-quill-editor-toolbar",""]],[["","quill-editor-toolbar",""]],[["","below-quill-editor-toolbar",""]]],xn=["[above-quill-editor-toolbar]","[quill-editor-toolbar]","[below-quill-editor-toolbar]"];function bn(o,r){1&o&&e._UZ(0,"pre",0)}function Cn(o,r){1&o&&e._UZ(0,"div",0)}const we=(o,r)=>o||r||"html";let Ve=(()=>{class o{constructor(t,i){var n=this;this.config=i,this.quill$=(0,cn.P)((0,Ze.Z)(function*(){if(!n.Quill){const a=n.document.addEventListener;n.document.addEventListener=n.document.__zone_symbol__addEventListener||n.document.addEventListener;const c=yield d.e(6125).then(d.t.bind(d,87536,19));n.document.addEventListener=a,n.Quill=c.default?c.default:c}return n.config.customOptions?.forEach(a=>{const c=n.Quill.import(a.import);c.whitelist=a.whitelist,n.Quill.register(c,!0,n.config.suppressGlobalRegisterWarning)}),yield n.registerCustomModules(n.Quill,n.config.customModules,n.config.suppressGlobalRegisterWarning)})).pipe((0,un.d)({bufferSize:1,refCount:!0})),this.document=t.get(h.K0),this.config||(this.config={modules:Ge})}getQuill(){return this.quill$}registerCustomModules(t,i,n){return(0,Ze.Z)(function*(){if(Array.isArray(i))for(let{implementation:a,path:c}of i)(0,ln.b)(a)&&(a=yield(0,dn.z)(a)),t.register(c,a,n);return t})()}static#e=this.\u0275fac=function(i){return new(i||o)(e.LFG(e.zs3),e.LFG(Oe,8))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),yn=(()=>{class o{constructor(){this.required=!1,this.customToolbarPosition="top",this.styles=null,this.strict=!0,this.customOptions=[],this.customModules=[],this.preserveWhitespace=!1,this.trimOnValidation=!1,this.compareValues=!1,this.filterNull=!1,this.defaultEmptyValue=null,this.onEditorCreated=new e.vpe,this.onEditorChanged=new e.vpe,this.onContentChanged=new e.vpe,this.onSelectionChanged=new e.vpe,this.onFocus=new e.vpe,this.onBlur=new e.vpe,this.onNativeFocus=new e.vpe,this.onNativeBlur=new e.vpe,this.disabled=!1,this.preserve=!1,this.toolbarPosition="top",this.subscription=null,this.quillSubscription=null,this.elementRef=(0,e.f3M)(e.SBq),this.document=(0,e.f3M)(h.K0),this.cd=(0,e.f3M)(e.sBO),this.domSanitizer=(0,e.f3M)(je.H7),this.platformId=(0,e.f3M)(e.Lbi),this.renderer=(0,e.f3M)(e.Qsj),this.zone=(0,e.f3M)(e.R0b),this.service=(0,e.f3M)(Ve),this.valueGetter=(t,i)=>{let n=i.querySelector(".ql-editor").innerHTML;("<p><br></p>"===n||"<div><br></div>"===n)&&(n=this.defaultEmptyValue);let a=n;const c=we(this.format,this.service.config.format);if("text"===c)a=t.getText();else if("object"===c)a=t.getContents();else if("json"===c)try{a=JSON.stringify(t.getContents())}catch{a=t.getText()}return a},this.valueSetter=(t,i)=>{const n=we(this.format,this.service.config.format);if("html"===n)return([!0,!1].includes(this.sanitize)?this.sanitize:this.service.config.sanitize||!1)&&(i=this.domSanitizer.sanitize(e.q3G.HTML,i)),t.clipboard.convert(i);if("json"===n)try{return JSON.parse(i)}catch{return[{insert:i}]}return i},this.selectionChangeHandler=(t,i,n)=>{const a=this.trackChanges||this.service.config.trackChanges,c=!t&&!!this.onModelTouched&&("user"===n||a&&"all"===a);!this.onBlur.observed&&!this.onFocus.observed&&!this.onSelectionChanged.observed&&!c||this.zone.run(()=>{null===t?this.onBlur.emit({editor:this.quillEditor,source:n}):null===i&&this.onFocus.emit({editor:this.quillEditor,source:n}),this.onSelectionChanged.emit({editor:this.quillEditor,oldRange:i,range:t,source:n}),c&&this.onModelTouched(),this.cd.markForCheck()})},this.textChangeHandler=(t,i,n)=>{const a=this.quillEditor.getText(),c=this.quillEditor.getContents();let l=this.editorElem.querySelector(".ql-editor").innerHTML;("<p><br></p>"===l||"<div><br></div>"===l)&&(l=this.defaultEmptyValue);const p=this.trackChanges||this.service.config.trackChanges,b=("user"===n||p&&"all"===p)&&!!this.onModelChange;!this.onContentChanged.observed&&!b||this.zone.run(()=>{b&&this.onModelChange(this.valueGetter(this.quillEditor,this.editorElem)),this.onContentChanged.emit({content:c,delta:t,editor:this.quillEditor,html:l,oldDelta:i,source:n,text:a}),this.cd.markForCheck()})},this.editorChangeHandler=(t,i,n,a)=>{if(this.onEditorChanged.observed)if("text-change"===t){const c=this.quillEditor.getText(),l=this.quillEditor.getContents();let p=this.editorElem.querySelector(".ql-editor").innerHTML;("<p><br></p>"===p||"<div><br></div>"===p)&&(p=this.defaultEmptyValue),this.zone.run(()=>{this.onEditorChanged.emit({content:l,delta:i,editor:this.quillEditor,event:t,html:p,oldDelta:n,source:a,text:c}),this.cd.markForCheck()})}else this.zone.run(()=>{this.onEditorChanged.emit({editor:this.quillEditor,event:t,oldRange:n,range:i,source:a}),this.cd.markForCheck()})}}static normalizeClassNames(t){return t.trim().split(" ").reduce((n,a)=>{const c=a.trim();return c&&n.push(c),n},[])}ngOnInit(){this.preserve=this.preserveWhitespace,this.toolbarPosition=this.customToolbarPosition}ngAfterViewInit(){(0,h.PM)(this.platformId)||(this.quillSubscription=this.service.getQuill().pipe((0,ee.z)(t=>{const i=[this.service.registerCustomModules(t,this.customModules)],n=this.beforeRender??this.service.config.beforeRender;return n&&i.push(n()),Promise.all(i).then(()=>t)})).subscribe(t=>{this.editorElem=this.elementRef.nativeElement.querySelector("[quill-editor-element]");const i=this.elementRef.nativeElement.querySelector("[quill-editor-toolbar]"),n=Object.assign({},this.modules||this.service.config.modules);i?n.toolbar=i:void 0===n.toolbar&&(n.toolbar=Ge.toolbar);let a=void 0!==this.placeholder?this.placeholder:this.service.config.placeholder;void 0===a&&(a="Insert text here ..."),this.styles&&Object.keys(this.styles).forEach(Y=>{this.renderer.setStyle(this.editorElem,Y,this.styles[Y])}),this.classes&&this.addClasses(this.classes),this.customOptions.forEach(Y=>{const le=t.import(Y.import);le.whitelist=Y.whitelist,t.register(le,!0)});let c=this.bounds&&"self"===this.bounds?this.editorElem:this.bounds;c||(c=this.service.config.bounds?this.service.config.bounds:this.document.body);let l=this.debug;!l&&!1!==l&&this.service.config.debug&&(l=this.service.config.debug);let p=this.readOnly;!p&&!1!==this.readOnly&&(p=void 0!==this.service.config.readOnly&&this.service.config.readOnly);let b=this.defaultEmptyValue;this.service.config.hasOwnProperty("defaultEmptyValue")&&(b=this.service.config.defaultEmptyValue);let I=this.scrollingContainer;!I&&null!==this.scrollingContainer&&(I=null===this.service.config.scrollingContainer||this.service.config.scrollingContainer?this.service.config.scrollingContainer:null);let j=this.formats;if(!j&&void 0===j&&(j=this.service.config.formats?[...this.service.config.formats]:null===this.service.config.formats?null:void 0),this.zone.runOutsideAngular(()=>{if(this.quillEditor=new t(this.editorElem,{bounds:c,debug:l,formats:j,modules:n,placeholder:a,readOnly:p,defaultEmptyValue:b,scrollingContainer:I,strict:this.strict,theme:this.theme||(this.service.config.theme?this.service.config.theme:"snow")}),this.onNativeBlur.observed&&(this.quillEditor.scroll.domNode.addEventListener("blur",()=>this.onNativeBlur.next({editor:this.quillEditor,source:"dom"})),this.quillEditor.getModule("toolbar").container.addEventListener("mousedown",Y=>Y.preventDefault())),this.onNativeFocus.observed&&this.quillEditor.scroll.domNode.addEventListener("focus",()=>this.onNativeFocus.next({editor:this.quillEditor,source:"dom"})),this.linkPlaceholder){const le=this.quillEditor?.theme?.tooltip?.root?.querySelector("input[data-link]");le?.dataset&&(le.dataset.link=this.linkPlaceholder)}}),this.content){if("text"===we(this.format,this.service.config.format))this.quillEditor.setText(this.content,"silent");else{const le=this.valueSetter(this.quillEditor,this.content);this.quillEditor.setContents(le,"silent")}this.quillEditor.getModule("history").clear()}this.setDisabledState(),this.addQuillEventListeners(),(this.onEditorCreated.observed||this.onValidatorChanged)&&requestAnimationFrame(()=>{this.onValidatorChanged&&this.onValidatorChanged(),this.onEditorCreated.emit(this.quillEditor),this.onEditorCreated.complete()})}))}ngOnDestroy(){this.dispose(),this.quillSubscription?.unsubscribe(),this.quillSubscription=null}ngOnChanges(t){if(this.quillEditor){if(t.readOnly&&this.quillEditor.enable(!t.readOnly.currentValue),t.placeholder&&(this.quillEditor.root.dataset.placeholder=t.placeholder.currentValue),t.defaultEmptyValue&&(this.quillEditor.root.dataset.defaultEmptyValue=t.defaultEmptyValue.currentValue),t.styles){const i=t.styles.currentValue,n=t.styles.previousValue;n&&Object.keys(n).forEach(a=>{this.renderer.removeStyle(this.editorElem,a)}),i&&Object.keys(i).forEach(a=>{this.renderer.setStyle(this.editorElem,a,this.styles[a])})}if(t.classes){const i=t.classes.currentValue,n=t.classes.previousValue;n&&this.removeClasses(n),i&&this.addClasses(i)}t.debounceTime&&this.addQuillEventListeners()}}addClasses(t){o.normalizeClassNames(t).forEach(i=>{this.renderer.addClass(this.editorElem,i)})}removeClasses(t){o.normalizeClassNames(t).forEach(i=>{this.renderer.removeClass(this.editorElem,i)})}writeValue(t){if(this.filterNull&&null===t||(this.content=t,!this.quillEditor))return;const i=we(this.format,this.service.config.format),n=this.valueSetter(this.quillEditor,t);if(this.compareValues){const a=this.quillEditor.getContents();if(JSON.stringify(a)===JSON.stringify(n))return}t?"text"===i?this.quillEditor.setText(t):this.quillEditor.setContents(n):this.quillEditor.setText("")}setDisabledState(t=this.disabled){this.disabled=t,this.quillEditor&&(t?(this.quillEditor.disable(),this.renderer.setAttribute(this.elementRef.nativeElement,"disabled","disabled")):(this.readOnly||this.quillEditor.enable(),this.renderer.removeAttribute(this.elementRef.nativeElement,"disabled")))}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}registerOnValidatorChange(t){this.onValidatorChanged=t}validate(){if(!this.quillEditor)return null;const t={};let i=!0;const n=this.quillEditor.getText(),a=this.trimOnValidation?n.trim().length:1===n.length&&0===n.trim().length?0:n.length-1,c=this.quillEditor.getContents().ops,l=c&&1===c.length&&["\n",""].includes(c[0].insert);return this.minLength&&a&&a<this.minLength&&(t.minLengthError={given:a,minLength:this.minLength},i=!1),this.maxLength&&a>this.maxLength&&(t.maxLengthError={given:a,maxLength:this.maxLength},i=!1),this.required&&!a&&l&&(t.requiredError={empty:!0},i=!1),i?null:t}addQuillEventListeners(){this.dispose(),this.zone.runOutsideAngular(()=>{this.subscription=new Be.w0,this.subscription.add((0,He.R)(this.quillEditor,"selection-change").subscribe(([n,a,c])=>{this.selectionChangeHandler(n,a,c)}));let t=(0,He.R)(this.quillEditor,"text-change"),i=(0,He.R)(this.quillEditor,"editor-change");"number"==typeof this.debounceTime&&(t=t.pipe((0,q.b)(this.debounceTime)),i=i.pipe((0,q.b)(this.debounceTime))),this.subscription.add(t.subscribe(([n,a,c])=>{this.textChangeHandler(n,a,c)})),this.subscription.add(i.subscribe(([n,a,c,l])=>{this.editorChangeHandler(n,a,c,l)}))})}dispose(){null!==this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275dir=e.lG2({type:o,inputs:{format:"format",theme:"theme",modules:"modules",debug:"debug",readOnly:"readOnly",placeholder:"placeholder",maxLength:"maxLength",minLength:"minLength",required:"required",formats:"formats",customToolbarPosition:"customToolbarPosition",sanitize:"sanitize",beforeRender:"beforeRender",styles:"styles",strict:"strict",scrollingContainer:"scrollingContainer",bounds:"bounds",customOptions:"customOptions",customModules:"customModules",trackChanges:"trackChanges",preserveWhitespace:"preserveWhitespace",classes:"classes",trimOnValidation:"trimOnValidation",linkPlaceholder:"linkPlaceholder",compareValues:"compareValues",filterNull:"filterNull",debounceTime:"debounceTime",defaultEmptyValue:"defaultEmptyValue",valueGetter:"valueGetter",valueSetter:"valueSetter"},outputs:{onEditorCreated:"onEditorCreated",onEditorChanged:"onEditorChanged",onContentChanged:"onContentChanged",onSelectionChanged:"onSelectionChanged",onFocus:"onFocus",onBlur:"onBlur",onNativeFocus:"onNativeFocus",onNativeBlur:"onNativeBlur"},features:[e.TTD]})}return o})(),Ct=(()=>{class o extends yn{static#e=this.\u0275fac=(()=>{let t;return function(n){return(t||(t=e.n5z(o)))(n||o)}})();static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["quill-editor"]],standalone:!0,features:[e._Bn([{multi:!0,provide:s.JU,useExisting:(0,e.Gpc)(()=>o)},{multi:!0,provide:s.Cf,useExisting:(0,e.Gpc)(()=>o)}]),e.qOj,e.jDz],ngContentSelectors:xn,decls:5,vars:2,consts:[["quill-editor-element",""]],template:function(i,n){1&i&&(e.F$t(vn),e.YNc(0,hn,2,1),e.Hsn(1),e.Hsn(2,1),e.Hsn(3,2),e.YNc(4,_n,2,1)),2&i&&(e.um2(0,"top"!==n.toolbarPosition?0:-1),e.xp6(4),e.um2(4,"top"===n.toolbarPosition?4:-1))},dependencies:[h.ez],styles:["[_nghost-%COMP%]{display:inline-block}"]})}return o})(),Zn=(()=>{class o{constructor(t,i){this.sanitizer=t,this.service=i,this.content="",this.innerHTML="",this.themeClass="ql-snow"}ngOnChanges(t){if(t.theme?this.themeClass=`ql-${t.theme.currentValue||(this.service.config.theme?this.service.config.theme:"snow")} ngx-quill-view-html`:this.theme||(this.themeClass=`ql-${this.service.config.theme?this.service.config.theme:"snow"} ngx-quill-view-html`),t.content){const i=t.content.currentValue,n=[!0,!1].includes(this.sanitize)?this.sanitize:this.service.config.sanitize||!1;this.innerHTML=n?i:this.sanitizer.bypassSecurityTrustHtml(i)}}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(je.H7),e.Y36(Ve))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["quill-view-html"]],inputs:{content:"content",theme:"theme",sanitize:"sanitize"},standalone:!0,features:[e.TTD,e.jDz],decls:2,vars:2,consts:[[1,"ql-container",3,"ngClass"],[1,"ql-editor",3,"innerHTML"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.qZA()),2&i&&(e.Q6J("ngClass",n.themeClass),e.xp6(),e.Q6J("innerHTML",n.innerHTML,e.oJD))},dependencies:[h.ez,h.mk],styles:[".ql-container.ngx-quill-view-html{border:0}\n"],encapsulation:2})}return o})(),Tn=(()=>{class o{constructor(t,i,n,a,c,l){this.elementRef=t,this.renderer=i,this.zone=n,this.service=a,this.domSanitizer=c,this.platformId=l,this.strict=!0,this.customModules=[],this.customOptions=[],this.preserveWhitespace=!1,this.onEditorCreated=new e.vpe,this.preserve=!1,this.quillSubscription=null,this.valueSetter=(p,b)=>{const I=we(this.format,this.service.config.format);let j=b;if("text"===I)p.setText(j);else{if("html"===I)([!0,!1].includes(this.sanitize)?this.sanitize:this.service.config.sanitize||!1)&&(b=this.domSanitizer.sanitize(e.q3G.HTML,b)),j=p.clipboard.convert(b);else if("json"===I)try{j=JSON.parse(b)}catch{j=[{insert:b}]}p.setContents(j)}}}ngOnInit(){this.preserve=this.preserveWhitespace}ngOnChanges(t){this.quillEditor&&t.content&&this.valueSetter(this.quillEditor,t.content.currentValue)}ngAfterViewInit(){(0,h.PM)(this.platformId)||(this.quillSubscription=this.service.getQuill().pipe((0,ee.z)(t=>{const i=[this.service.registerCustomModules(t,this.customModules)],n=this.beforeRender??this.service.config.beforeRender;return n&&i.push(n()),Promise.all(i).then(()=>t)})).subscribe(t=>{const i=Object.assign({},this.modules||this.service.config.modules);i.toolbar=!1,this.customOptions.forEach(l=>{const p=t.import(l.import);p.whitelist=l.whitelist,t.register(p,!0)});let n=this.debug;!n&&!1!==n&&this.service.config.debug&&(n=this.service.config.debug);let a=this.formats;!a&&void 0===a&&(a=this.service.config.formats?Object.assign({},this.service.config.formats):null===this.service.config.formats?null:void 0);const c=this.theme||(this.service.config.theme?this.service.config.theme:"snow");this.editorElem=this.elementRef.nativeElement.querySelector("[quill-view-element]"),this.zone.runOutsideAngular(()=>{this.quillEditor=new t(this.editorElem,{debug:n,formats:a,modules:i,readOnly:!0,strict:this.strict,theme:c})}),this.renderer.addClass(this.editorElem,"ngx-quill-view"),this.content&&this.valueSetter(this.quillEditor,this.content),this.onEditorCreated.observers.length&&requestAnimationFrame(()=>{this.onEditorCreated.emit(this.quillEditor),this.onEditorCreated.complete()})}))}ngOnDestroy(){this.quillSubscription?.unsubscribe(),this.quillSubscription=null}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(e.SBq),e.Y36(e.Qsj),e.Y36(e.R0b),e.Y36(Ve),e.Y36(je.H7),e.Y36(e.Lbi))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["quill-view"]],inputs:{format:"format",theme:"theme",modules:"modules",debug:"debug",formats:"formats",sanitize:"sanitize",beforeRender:"beforeRender",strict:"strict",content:"content",customModules:"customModules",customOptions:"customOptions",preserveWhitespace:"preserveWhitespace"},outputs:{onEditorCreated:"onEditorCreated"},standalone:!0,features:[e.TTD,e.jDz],decls:2,vars:1,consts:[["quill-view-element",""]],template:function(i,n){1&i&&e.YNc(0,bn,1,0,"pre",0)(1,Cn,1,0),2&i&&e.um2(0,n.preserve?0:1)},dependencies:[h.ez],styles:[".ql-container.ngx-quill-view{border:0}\n"],encapsulation:2})}return o})(),An=(()=>{class o{static forRoot(t){return{ngModule:o,providers:[{provide:Oe,useValue:t}]}}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275mod=e.oAB({type:o});static#o=this.\u0275inj=e.cJS({imports:[Ct,Tn,Zn]})}return o})();function z(o,r){(function In(o){return"string"==typeof o&&-1!==o.indexOf(".")&&1===parseFloat(o)})(o)&&(o="100%");var t=function kn(o){return"string"==typeof o&&-1!==o.indexOf("%")}(o);return o=360===r?o:Math.min(r,Math.max(0,parseFloat(o))),t&&(o=parseInt(String(o*r),10)/100),Math.abs(o-r)<1e-6?1:o=360===r?(o<0?o%r+r:o%r)/parseFloat(String(r)):o%r/parseFloat(String(r))}function Je(o){return Math.min(1,Math.max(0,o))}function yt(o){return o=parseFloat(o),(isNaN(o)||o<0||o>1)&&(o=1),o}function Re(o){return o<=1?"".concat(100*Number(o),"%"):o}function fe(o){return 1===o.length?"0"+o:String(o)}function Zt(o,r,t){o=z(o,255),r=z(r,255),t=z(t,255);var i=Math.max(o,r,t),n=Math.min(o,r,t),a=0,c=0,l=(i+n)/2;if(i===n)c=0,a=0;else{var p=i-n;switch(c=l>.5?p/(2-i-n):p/(i+n),i){case o:a=(r-t)/p+(r<t?6:0);break;case r:a=(t-o)/p+2;break;case t:a=(o-r)/p+4}a/=6}return{h:a,s:c,l}}function Ye(o,r,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?o+6*t*(r-o):t<.5?r:t<2/3?o+(r-o)*(2/3-t)*6:o}function Tt(o,r,t){o=z(o,255),r=z(r,255),t=z(t,255);var i=Math.max(o,r,t),n=Math.min(o,r,t),a=0,c=i,l=i-n,p=0===i?0:l/i;if(i===n)a=0;else{switch(i){case o:a=(r-t)/l+(r<t?6:0);break;case r:a=(t-o)/l+2;break;case t:a=(o-r)/l+4}a/=6}return{h:a,s:p,v:c}}function At(o,r,t,i){var n=[fe(Math.round(o).toString(16)),fe(Math.round(r).toString(16)),fe(Math.round(t).toString(16))];return i&&n[0].startsWith(n[0].charAt(1))&&n[1].startsWith(n[1].charAt(1))&&n[2].startsWith(n[2].charAt(1))?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0):n.join("")}function It(o){return Math.round(255*parseFloat(o)).toString(16)}function kt(o){return V(o)/255}function V(o){return parseInt(o,16)}var Ke={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};var pe="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),Xe="[\\s|\\(]+(".concat(pe,")[,|\\s]+(").concat(pe,")[,|\\s]+(").concat(pe,")\\s*\\)?"),et="[\\s|\\(]+(".concat(pe,")[,|\\s]+(").concat(pe,")[,|\\s]+(").concat(pe,")[,|\\s]+(").concat(pe,")\\s*\\)?"),oe={CSS_UNIT:new RegExp(pe),rgb:new RegExp("rgb"+Xe),rgba:new RegExp("rgba"+et),hsl:new RegExp("hsl"+Xe),hsla:new RegExp("hsla"+et),hsv:new RegExp("hsv"+Xe),hsva:new RegExp("hsva"+et),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function ce(o){return!!oe.CSS_UNIT.exec(String(o))}var qe=function(){function o(r,t){var i;if(void 0===r&&(r=""),void 0===t&&(t={}),r instanceof o)return r;"number"==typeof r&&(r=function Dn(o){return{r:o>>16,g:(65280&o)>>8,b:255&o}}(r)),this.originalInput=r;var n=function Un(o){var r={r:0,g:0,b:0},t=1,i=null,n=null,a=null,c=!1,l=!1;return"string"==typeof o&&(o=function En(o){if(0===(o=o.trim().toLowerCase()).length)return!1;var r=!1;if(Ke[o])o=Ke[o],r=!0;else if("transparent"===o)return{r:0,g:0,b:0,a:0,format:"name"};var t=oe.rgb.exec(o);return t?{r:t[1],g:t[2],b:t[3]}:(t=oe.rgba.exec(o))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=oe.hsl.exec(o))?{h:t[1],s:t[2],l:t[3]}:(t=oe.hsla.exec(o))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=oe.hsv.exec(o))?{h:t[1],s:t[2],v:t[3]}:(t=oe.hsva.exec(o))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=oe.hex8.exec(o))?{r:V(t[1]),g:V(t[2]),b:V(t[3]),a:kt(t[4]),format:r?"name":"hex8"}:(t=oe.hex6.exec(o))?{r:V(t[1]),g:V(t[2]),b:V(t[3]),format:r?"name":"hex"}:(t=oe.hex4.exec(o))?{r:V(t[1]+t[1]),g:V(t[2]+t[2]),b:V(t[3]+t[3]),a:kt(t[4]+t[4]),format:r?"name":"hex8"}:!!(t=oe.hex3.exec(o))&&{r:V(t[1]+t[1]),g:V(t[2]+t[2]),b:V(t[3]+t[3]),format:r?"name":"hex"}}(o)),"object"==typeof o&&(ce(o.r)&&ce(o.g)&&ce(o.b)?(r=function wn(o,r,t){return{r:255*z(o,255),g:255*z(r,255),b:255*z(t,255)}}(o.r,o.g,o.b),c=!0,l="%"===String(o.r).substr(-1)?"prgb":"rgb"):ce(o.h)&&ce(o.s)&&ce(o.v)?(i=Re(o.s),n=Re(o.v),r=function Fn(o,r,t){o=6*z(o,360),r=z(r,100),t=z(t,100);var i=Math.floor(o),n=o-i,a=t*(1-r),c=t*(1-n*r),l=t*(1-(1-n)*r),p=i%6;return{r:255*[t,c,a,a,l,t][p],g:255*[l,t,t,c,a,a][p],b:255*[a,a,l,t,t,c][p]}}(o.h,i,n),c=!0,l="hsv"):ce(o.h)&&ce(o.s)&&ce(o.l)&&(i=Re(o.s),a=Re(o.l),r=function qn(o,r,t){var i,n,a;if(o=z(o,360),r=z(r,100),t=z(t,100),0===r)n=t,a=t,i=t;else{var c=t<.5?t*(1+r):t+r-t*r,l=2*t-c;i=Ye(l,c,o+1/3),n=Ye(l,c,o),a=Ye(l,c,o-1/3)}return{r:255*i,g:255*n,b:255*a}}(o.h,i,a),c=!0,l="hsl"),Object.prototype.hasOwnProperty.call(o,"a")&&(t=o.a)),t=yt(t),{ok:c,format:o.format||l,r:Math.min(255,Math.max(r.r,0)),g:Math.min(255,Math.max(r.g,0)),b:Math.min(255,Math.max(r.b,0)),a:t}}(r);this.originalInput=r,this.r=n.r,this.g=n.g,this.b=n.b,this.a=n.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(i=t.format)&&void 0!==i?i:n.format,this.gradientType=t.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=n.ok}return o.prototype.isDark=function(){return this.getBrightness()<128},o.prototype.isLight=function(){return!this.isDark()},o.prototype.getBrightness=function(){var r=this.toRgb();return(299*r.r+587*r.g+114*r.b)/1e3},o.prototype.getLuminance=function(){var r=this.toRgb(),a=r.r/255,c=r.g/255,l=r.b/255;return.2126*(a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4))+.7152*(c<=.03928?c/12.92:Math.pow((c+.055)/1.055,2.4))+.0722*(l<=.03928?l/12.92:Math.pow((l+.055)/1.055,2.4))},o.prototype.getAlpha=function(){return this.a},o.prototype.setAlpha=function(r){return this.a=yt(r),this.roundA=Math.round(100*this.a)/100,this},o.prototype.isMonochrome=function(){return 0===this.toHsl().s},o.prototype.toHsv=function(){var r=Tt(this.r,this.g,this.b);return{h:360*r.h,s:r.s,v:r.v,a:this.a}},o.prototype.toHsvString=function(){var r=Tt(this.r,this.g,this.b),t=Math.round(360*r.h),i=Math.round(100*r.s),n=Math.round(100*r.v);return 1===this.a?"hsv(".concat(t,", ").concat(i,"%, ").concat(n,"%)"):"hsva(".concat(t,", ").concat(i,"%, ").concat(n,"%, ").concat(this.roundA,")")},o.prototype.toHsl=function(){var r=Zt(this.r,this.g,this.b);return{h:360*r.h,s:r.s,l:r.l,a:this.a}},o.prototype.toHslString=function(){var r=Zt(this.r,this.g,this.b),t=Math.round(360*r.h),i=Math.round(100*r.s),n=Math.round(100*r.l);return 1===this.a?"hsl(".concat(t,", ").concat(i,"%, ").concat(n,"%)"):"hsla(".concat(t,", ").concat(i,"%, ").concat(n,"%, ").concat(this.roundA,")")},o.prototype.toHex=function(r){return void 0===r&&(r=!1),At(this.r,this.g,this.b,r)},o.prototype.toHexString=function(r){return void 0===r&&(r=!1),"#"+this.toHex(r)},o.prototype.toHex8=function(r){return void 0===r&&(r=!1),function Sn(o,r,t,i,n){var a=[fe(Math.round(o).toString(16)),fe(Math.round(r).toString(16)),fe(Math.round(t).toString(16)),fe(It(i))];return n&&a[0].startsWith(a[0].charAt(1))&&a[1].startsWith(a[1].charAt(1))&&a[2].startsWith(a[2].charAt(1))&&a[3].startsWith(a[3].charAt(1))?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}(this.r,this.g,this.b,this.a,r)},o.prototype.toHex8String=function(r){return void 0===r&&(r=!1),"#"+this.toHex8(r)},o.prototype.toHexShortString=function(r){return void 0===r&&(r=!1),1===this.a?this.toHexString(r):this.toHex8String(r)},o.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},o.prototype.toRgbString=function(){var r=Math.round(this.r),t=Math.round(this.g),i=Math.round(this.b);return 1===this.a?"rgb(".concat(r,", ").concat(t,", ").concat(i,")"):"rgba(".concat(r,", ").concat(t,", ").concat(i,", ").concat(this.roundA,")")},o.prototype.toPercentageRgb=function(){var r=function(t){return"".concat(Math.round(100*z(t,255)),"%")};return{r:r(this.r),g:r(this.g),b:r(this.b),a:this.a}},o.prototype.toPercentageRgbString=function(){var r=function(t){return Math.round(100*z(t,255))};return 1===this.a?"rgb(".concat(r(this.r),"%, ").concat(r(this.g),"%, ").concat(r(this.b),"%)"):"rgba(".concat(r(this.r),"%, ").concat(r(this.g),"%, ").concat(r(this.b),"%, ").concat(this.roundA,")")},o.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var r="#"+At(this.r,this.g,this.b,!1),t=0,i=Object.entries(Ke);t<i.length;t++){var n=i[t];if(r===n[1])return n[0]}return!1},o.prototype.toString=function(r){var t=!!r;r=r??this.format;var i=!1;return!t&&this.a<1&&this.a>=0&&(r.startsWith("hex")||"name"===r)?"name"===r&&0===this.a?this.toName():this.toRgbString():("rgb"===r&&(i=this.toRgbString()),"prgb"===r&&(i=this.toPercentageRgbString()),("hex"===r||"hex6"===r)&&(i=this.toHexString()),"hex3"===r&&(i=this.toHexString(!0)),"hex4"===r&&(i=this.toHex8String(!0)),"hex8"===r&&(i=this.toHex8String()),"name"===r&&(i=this.toName()),"hsl"===r&&(i=this.toHslString()),"hsv"===r&&(i=this.toHsvString()),i||this.toHexString())},o.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},o.prototype.clone=function(){return new o(this.toString())},o.prototype.lighten=function(r){void 0===r&&(r=10);var t=this.toHsl();return t.l+=r/100,t.l=Je(t.l),new o(t)},o.prototype.brighten=function(r){void 0===r&&(r=10);var t=this.toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(-r/100*255))),t.g=Math.max(0,Math.min(255,t.g-Math.round(-r/100*255))),t.b=Math.max(0,Math.min(255,t.b-Math.round(-r/100*255))),new o(t)},o.prototype.darken=function(r){void 0===r&&(r=10);var t=this.toHsl();return t.l-=r/100,t.l=Je(t.l),new o(t)},o.prototype.tint=function(r){return void 0===r&&(r=10),this.mix("white",r)},o.prototype.shade=function(r){return void 0===r&&(r=10),this.mix("black",r)},o.prototype.desaturate=function(r){void 0===r&&(r=10);var t=this.toHsl();return t.s-=r/100,t.s=Je(t.s),new o(t)},o.prototype.saturate=function(r){void 0===r&&(r=10);var t=this.toHsl();return t.s+=r/100,t.s=Je(t.s),new o(t)},o.prototype.greyscale=function(){return this.desaturate(100)},o.prototype.spin=function(r){var t=this.toHsl(),i=(t.h+r)%360;return t.h=i<0?360+i:i,new o(t)},o.prototype.mix=function(r,t){void 0===t&&(t=50);var i=this.toRgb(),n=new o(r).toRgb(),a=t/100;return new o({r:(n.r-i.r)*a+i.r,g:(n.g-i.g)*a+i.g,b:(n.b-i.b)*a+i.b,a:(n.a-i.a)*a+i.a})},o.prototype.analogous=function(r,t){void 0===r&&(r=6),void 0===t&&(t=30);var i=this.toHsl(),n=360/t,a=[this];for(i.h=(i.h-(n*r>>1)+720)%360;--r;)i.h=(i.h+n)%360,a.push(new o(i));return a},o.prototype.complement=function(){var r=this.toHsl();return r.h=(r.h+180)%360,new o(r)},o.prototype.monochromatic=function(r){void 0===r&&(r=6);for(var t=this.toHsv(),i=t.h,n=t.s,a=t.v,c=[],l=1/r;r--;)c.push(new o({h:i,s:n,v:a})),a=(a+l)%1;return c},o.prototype.splitcomplement=function(){var r=this.toHsl(),t=r.h;return[this,new o({h:(t+72)%360,s:r.s,l:r.l}),new o({h:(t+216)%360,s:r.s,l:r.l})]},o.prototype.onBackground=function(r){var t=this.toRgb(),i=new o(r).toRgb(),n=t.a+i.a*(1-t.a);return new o({r:(t.r*t.a+i.r*i.a*(1-t.a))/n,g:(t.g*t.a+i.g*i.a*(1-t.a))/n,b:(t.b*t.a+i.b*i.a*(1-t.a))/n,a:n})},o.prototype.triad=function(){return this.polyad(3)},o.prototype.tetrad=function(){return this.polyad(4)},o.prototype.polyad=function(r){for(var t=this.toHsl(),i=t.h,n=[this],a=360/r,c=1;c<r;c++)n.push(new o({h:(i+c*a)%360,s:t.s,l:t.l}));return n},o.prototype.equals=function(r){return this.toRgbString()===new o(r).toRgbString()},o}();const Jn=["*"];function Rn(o,r){1&o&&e._UZ(0,"color-checkboard",2)}const tt={};let Ln=(()=>{class o{white="transparent";size=8;grey="rgba(0,0,0,.08)";boxShadow;borderRadius;gridStyles;ngOnInit(){const t=function Qn(o,r,t){const i=`${o}-${r}-${t}`;if(tt[i])return tt[i];const n=function Nn(o,r,t){if(typeof document>"u")return null;const i=document.createElement("canvas");i.width=2*t,i.height=2*t;const n=i.getContext("2d");return n?(n.fillStyle=o,n.fillRect(0,0,i.width,i.height),n.fillStyle=r,n.fillRect(0,0,t,t),n.translate(t,t),n.fillRect(0,0,t,t),i.toDataURL()):null}(o,r,t);return n?(tt[i]=n,n):null}(this.white,this.grey,this.size);this.gridStyles={borderRadius:this.borderRadius,boxShadow:this.boxShadow,background:`url(${t}) center left`}}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=e.Xpm({type:o,selectors:[["color-checkboard"]],inputs:{white:"white",size:"size",grey:"grey",boxShadow:"boxShadow",borderRadius:"borderRadius"},decls:1,vars:1,consts:[[1,"grid",3,"ngStyle"]],template:function(i,n){1&i&&e._UZ(0,"div",0),2&i&&e.Q6J("ngStyle",n.gridStyles)},dependencies:[h.PC],styles:[".grid[_ngcontent-%COMP%]{inset:0;position:absolute}"],changeDetection:0})}return o})(),Wn=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=e.oAB({type:o});static \u0275inj=e.cJS({imports:[h.ez]})}return o})();function wt(o){let t=0,i=0;return["r","g","b","a","h","s","l","v"].forEach(n=>{o[n]&&(t+=1,isNaN(o[n])||(i+=1),("s"===n||"l"===n)&&/^\d+%$/.test(o[n])&&(i+=1))}),t===i&&o}function Fe(o,r,t){const i=new qe(o.hex?o.hex:o);t&&i.setAlpha(1);const n=i.toHsl(),a=i.toHsv(),c=i.toRgb(),l=i.toHex();return 0===n.s&&(n.h=r||0,a.h=r||0),{hsl:n,hex:"000000"===l&&0===c.a?"transparent":i.toHexString(),rgb:c,hsv:a,oldHue:o.h||r||n.h,source:o.source}}var be=function(o){return o.HEX="hex",o.HSL="hsl",o.HSV="hsv",o.RGB="rgb",o}(be||{});let qt=(()=>{class o{className;mode=be.HEX;color={h:250,s:.5,l:.2,a:1};colorChange=new e.vpe;onChange=new e.vpe;onChangeComplete=new e.vpe;onSwatchHover=new e.vpe;oldHue;hsl;hsv;rgb;hex;source;currentColor;changes;disableAlpha;_onChangeCompleteSubscription=new Be.w0;_onSwatchHoverSubscription=new Be.w0;ngOnInit(){this.changes=this.onChange.pipe((0,q.b)(100),(0,F.b)(t=>{switch(this.onChangeComplete.emit(t),this.mode){case be.HEX:this.colorChange.emit(t.color.hex);break;case be.HSL:this.colorChange.emit(t.color.hsl);break;case be.HSV:this.colorChange.emit(t.color.hsv);break;case be.RGB:this.colorChange.emit(t.color.rgb);break;default:const i=`The mode '${this.mode}' is not supported`;if((0,e.X6Q)())throw new Error(i);console.warn(i)}})).subscribe(),this.setState(Fe(this.color,0)),this.currentColor=this.hex}ngOnChanges(){this.setState(Fe(this.color,this.oldHue))}ngOnDestroy(){this.changes?.unsubscribe(),this._onChangeCompleteSubscription?.unsubscribe(),this._onSwatchHoverSubscription?.unsubscribe()}setState(t){this.oldHue=t.oldHue,this.hsl=t.hsl,this.hsv=t.hsv,this.rgb=t.rgb,this.hex=t.hex,this.source=t.source,this.afterValidChange()}handleChange(t,i){if(wt(t)){const a=Fe(t,t.h||this.oldHue,this.disableAlpha);this.setState(a),this.onChange.emit({color:a,$event:i}),this.afterValidChange()}}afterValidChange(){}handleSwatchHover(t,i){if(wt(t)){const a=Fe(t,t.h||this.oldHue);this.setState(a),this.onSwatchHover.emit({color:a,$event:i})}}registerOnChange(t){this._onChangeCompleteSubscription.add(this.onChangeComplete.pipe((0,F.b)(i=>t(i.color.hex))).subscribe())}registerOnTouched(t){this._onSwatchHoverSubscription.add(this.onSwatchHover.pipe((0,F.b)(()=>t())).subscribe())}setDisabledState(t){}writeValue(t){this.color=t}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=e.Xpm({type:o,selectors:[["color-wrap"]],inputs:{className:"className",mode:"mode",color:"color"},outputs:{colorChange:"colorChange",onChange:"onChange",onChangeComplete:"onChangeComplete",onSwatchHover:"onSwatchHover"},features:[e._Bn([{provide:s.JU,useExisting:(0,e.Gpc)(()=>o),multi:!0}]),e.TTD],decls:0,vars:0,template:function(i,n){},encapsulation:2})}return o})(),$n=(()=>{class o{color;style={};focusStyle={};focus;onClick=new e.vpe;onHover=new e.vpe;divStyles={};focusStyles={};inFocus=!1;ngOnInit(){this.divStyles={background:this.color,...this.style}}currentStyles(){return this.focusStyles={...this.divStyles,...this.focusStyle},this.focus||this.inFocus?this.focusStyles:this.divStyles}handleFocusOut(){this.inFocus=!1}handleFocus(){this.inFocus=!0}handleHover(t,i){this.onHover.emit({hex:t,$event:i})}handleClick(t,i){this.onClick.emit({hex:t,$event:i})}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=e.Xpm({type:o,selectors:[["color-swatch"]],inputs:{color:"color",style:"style",focusStyle:"focusStyle",focus:"focus"},outputs:{onClick:"onClick",onHover:"onHover"},ngContentSelectors:Jn,decls:3,vars:3,consts:[["tabindex","0",1,"swatch",3,"ngStyle","click","keydown.enter","focus","blur","mouseover"],["boxShadow","inset 0 0 0 1px rgba(0,0,0,0.1)",4,"ngIf"],["boxShadow","inset 0 0 0 1px rgba(0,0,0,0.1)"]],template:function(i,n){1&i&&(e.F$t(),e.TgZ(0,"div",0),e.NdJ("click",function(c){return n.handleClick(n.color,c)})("keydown.enter",function(c){return n.handleClick(n.color,c)})("focus",function(){return n.handleFocus()})("blur",function(){return n.handleFocusOut()})("mouseover",function(c){return n.handleHover(n.color,c)}),e.Hsn(1),e.YNc(2,Rn,1,0,"color-checkboard",1),e.qZA()),2&i&&(e.Q6J("ngStyle",n.currentStyles()),e.uIk("title",n.color),e.xp6(2),e.Q6J("ngIf","transparent"===n.color))},dependencies:[h.O5,h.PC,Ln],styles:[".swatch[_ngcontent-%COMP%]{outline:none;height:100%;width:100%;cursor:pointer;position:relative}"],changeDetection:0})}return o})(),Gn=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=e.oAB({type:o});static \u0275inj=e.cJS({imports:[h.ez,Wn]})}return o})();var Ft_500="#f44336",St_500="#e91e63",Dt_500="#9c27b0",Ut_500="#673ab7",Pt_500="#3f51b5",Mt_500="#2196f3",Et_500="#03a9f4",Jt_500="#00bcd4",Rt_500="#009688",Nt_500="#4caf50",Qt_500="#8bc34a",Lt_500="#cddc39",Wt_500="#ffeb3b",zt_500="#ffc107",$t_500="#ff9800",Gt_500="#ff5722",Ot_500="#795548",jt_500="#607d8b";function Xn(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"color-circle-swatch",1),e.NdJ("onClick",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.handleBlockChange(n))})("onSwatchHover",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.onSwatchHover.emit(n))}),e.qZA()}if(2&o){const t=r.$implicit,i=e.oxw();e.Q6J("circleSize",i.circleSize)("circleSpacing",i.circleSpacing)("color",t)("focus",i.isActive(t))}}let er=(()=>{class o{color;circleSize=28;circleSpacing=14;focus=!1;onClick=new e.vpe;onSwatchHover=new e.vpe;focusStyle={};swatchStyle={borderRadius:"50%",background:"transparent",transition:"100ms box-shadow ease 0s"};ngOnChanges(){this.swatchStyle.boxShadow=`inset 0 0 0 ${this.circleSize/2}px ${this.color}`,this.focusStyle.boxShadow=`inset 0 0 0 ${this.circleSize/2}px ${this.color}, 0 0 5px ${this.color}`,this.focus&&(this.focusStyle.boxShadow=`inset 0 0 0 3px ${this.color}, 0 0 5px ${this.color}`)}handleClick({hex:t,$event:i}){this.onClick.emit({hex:t,$event:i})}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=e.Xpm({type:o,selectors:[["color-circle-swatch"]],inputs:{color:"color",circleSize:"circleSize",circleSpacing:"circleSpacing",focus:"focus"},outputs:{onClick:"onClick",onSwatchHover:"onSwatchHover"},features:[e.TTD],decls:3,vars:13,consts:[[1,"circle-swatch"],[3,"color","focus","focusStyle","onClick","onHover"],[1,"clear"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"color-swatch",1),e.NdJ("onClick",function(c){return n.handleClick(c)})("onHover",function(c){return n.onSwatchHover.emit(c)}),e.qZA(),e._UZ(2,"div",2),e.qZA()),2&i&&(e.Udp("width",n.circleSize,"px")("height",n.circleSize,"px")("margin-right",n.circleSpacing,"px")("margin-bottom",n.circleSpacing,"px"),e.xp6(),e.Akn(n.swatchStyle),e.Q6J("color",n.color)("focus",n.focus)("focusStyle",n.focusStyle))},dependencies:[$n],styles:[".circle-swatch[_ngcontent-%COMP%]{transform:scale(1);transition:transform .1s ease}.circle-swatch[_ngcontent-%COMP%]:hover{transform:scale(1.2)}"],changeDetection:0})}return o})(),tr=(()=>{class o extends qt{width=252;colors=[Ft_500,St_500,Dt_500,Ut_500,Pt_500,Mt_500,Et_500,Jt_500,Rt_500,Nt_500,Qt_500,Lt_500,Wt_500,zt_500,$t_500,Gt_500,Ot_500,jt_500];circleSize=28;circleSpacing=14;constructor(){super()}isActive(t){return new qe(this.hex).equals(t)}handleBlockChange({hex:t,$event:i}){(function zn(o){return new qe(o).isValid})(t)&&this.handleChange({hex:t,source:"hex"},i)}handleValueChange({data:t,$event:i}){this.handleChange(t,i)}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=e.Xpm({type:o,selectors:[["color-circle"]],inputs:{width:"width",colors:"colors",circleSize:"circleSize",circleSpacing:"circleSpacing"},features:[e._Bn([{provide:s.JU,useExisting:(0,e.Gpc)(()=>o),multi:!0},{provide:qt,useExisting:(0,e.Gpc)(()=>o)}]),e.qOj],decls:2,vars:10,consts:[[3,"circleSize","circleSpacing","color","focus","onClick","onSwatchHover",4,"ngFor","ngForOf"],[3,"circleSize","circleSpacing","color","focus","onClick","onSwatchHover"]],template:function(i,n){1&i&&(e.TgZ(0,"div"),e.YNc(1,Xn,1,4,"color-circle-swatch",0),e.qZA()),2&i&&(e.Gre("circle-picker ",n.className,""),e.Udp("width",n.width,"px")("margin-right",-n.circleSpacing,"px")("margin-bottom",-n.circleSpacing,"px"),e.xp6(),e.Q6J("ngForOf",n.colors))},dependencies:()=>[h.sg,er],styles:[".circle-picker[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}"],changeDetection:0})}return o})(),or=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=e.oAB({type:o});static \u0275inj=e.cJS({imports:[h.ez,Gn]})}return o})();var ir=d(21510),Bt=d(33355),ot=d(40242),nr=d(83829),Ht=d(59298),rr=d(57222),Ne=d(55568),ar=d(95407);const it=o=>({"cursor-not-allowed":o});function sr(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",58),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.createProduct())}),e._UZ(1,"mat-icon",59),e.TgZ(2,"span",60),e._uU(3,"Guardar"),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.productForm.invalid||"standard"!==t.productForm.get("type").value&&0===t.variants.length)("ngClass",e.VKq(3,it,t.productForm.invalid||"standard"!==t.productForm.get("type").value&&0===t.variants.length)),e.xp6(),e.Q6J("svgIcon","mat_solid:save")}}function cr(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",58),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.updateProduct())}),e._UZ(1,"mat-icon",59),e.TgZ(2,"span",60),e._uU(3,"Actualizar"),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.productForm.invalid)("ngClass",e.VKq(3,it,t.productForm.invalid)),e.xp6(),e.Q6J("svgIcon","mat_solid:refresh")}}function lr(o,r){1&o&&e._UZ(0,"mat-icon",66),2&o&&e.Q6J("svgIcon","mat_solid:check_circle")}const dr=(o,r,t)=>({"ring ring-inset ring-primary":o,"cursor-not-allowed bg-slate-300 bg-opacity-50":r,"cursor-pointer":t});function ur(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",61),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.selectType(a))}),e.YNc(1,lr,1,1,"mat-icon",62),e.TgZ(2,"div",63),e._uU(3),e.qZA(),e.TgZ(4,"div",64),e._uU(5),e.qZA(),e._UZ(6,"div",65),e.qZA()}if(2&o){const t=r.$implicit,i=e.oxw();e.Q6J("ngClass",e.kEZ(5,dr,i.productForm.get("type").value===t.value,!t.active,t.active))("matTooltip",t.tooltip),e.xp6(),e.um2(1,i.productForm.get("type").value===t.value?1:-1),e.xp6(2),e.Oqu(t.label),e.xp6(2),e.Oqu(t.details)}}function pr(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del producto es obligatorio. "),e.qZA())}function mr(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del producto debe contener entre 3 y 255 caracteres. "),e.qZA())}function hr(o,r){if(1&o&&(e.TgZ(0,"mat-option",68),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(),e.hij(" ",t.name," ")}}function gr(o,r){if(1&o&&(e.TgZ(0,"mat-optgroup",67),e.SjG(1,hr,2,2,"mat-option",68,e.x6l),e.qZA()),2&o){const t=e.oxw().$implicit;e.Q6J("label",t.name)("disabled",!t.active),e.xp6(),e.wJu(t.children)}}function fr(o,r){if(1&o&&(e.TgZ(0,"mat-option",68),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.Q6J("value",t.id),e.xp6(),e.hij(" ",t.name," ")}}function _r(o,r){if(1&o&&e.YNc(0,gr,3,2,"mat-optgroup",67)(1,fr,2,2,"mat-option",68),2&o){const t=r.$implicit;e.um2(0,t.children.length>0?0:-1),e.xp6(),e.um2(1,0===t.children.length?1:-1)}}function vr(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-icon",69),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.resetCategoryField())}),e.qZA()}}function xr(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe seleccionar una categor\xeda. "),e.qZA())}function br(o,r){1&o&&(e.TgZ(0,"mat-form-field",28)(1,"mat-label"),e._uU(2,"SKU"),e.qZA(),e._UZ(3,"input",70),e.qZA()),2&o&&(e.xp6(3),e.Q6J("formControlName","sku"))}function Cr(o,r){1&o&&(e.TgZ(0,"mat-form-field",71)(1,"mat-label"),e._uU(2,"UPC"),e.qZA(),e._UZ(3,"input",19),e.qZA()),2&o&&(e.xp6(3),e.Q6J("formControlName","upc"))}function yr(o,r){1&o&&(e.TgZ(0,"mat-form-field",72)(1,"mat-label"),e._uU(2,"C\xf3digo"),e.qZA(),e._UZ(3,"input",70),e.qZA()),2&o&&(e.xp6(3),e.Q6J("formControlName","bCode"))}function Zr(o,r){if(1&o&&(e.TgZ(0,"mat-option",68),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(),e.hij(" ",t.name," ")}}function Tr(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe seleccionar la marca. "),e.qZA())}function Ar(o,r){if(1&o&&(e.TgZ(0,"mat-option",68),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(),e.hij(" ",t.iso," ")}}function Ir(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe seleccionar una Moneda. "),e.qZA())}function kr(o,r){if(1&o&&(e.TgZ(0,"mat-option",68),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(),e.hij(" ",t.abbr," ")}}function wr(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El la unidad de medida es obligatoria. "),e.qZA())}function qr(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio "),e.qZA())}function Fr(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio "),e.qZA())}function Sr(o,r){if(1&o&&(e.TgZ(0,"mat-form-field",28)(1,"mat-label"),e._uU(2,"Cantidad M\xedn"),e.qZA(),e._UZ(3,"input",73),e.YNc(4,Fr,2,0,"mat-error"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("formControlName","stockMin"),e.xp6(),e.um2(4,t.productForm.get("stock").hasError("required")?4:-1)}}function Dr(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El precio del producto es obligatorio "),e.qZA())}function Ur(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-option",83),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.addDepotIdToMovement(a))}),e._uU(1),e.qZA()}if(2&o){const t=r.$implicit;e.Q6J("value",t.name),e.xp6(),e.hij(" ",t.name," ")}}function Pr(o,r){1&o&&(e.TgZ(0,"mat-error",84),e._uU(1," El almac\xe9n es obligatorio "),e.qZA())}function Mr(o,r){if(1&o&&(e.TgZ(0,"mat-form-field",75)(1,"mat-label"),e._uU(2,"Almac\xe9n"),e.qZA(),e._UZ(3,"mat-icon",79)(4,"input",80),e.TgZ(5,"mat-autocomplete",null,81),e.SjG(7,Ur,2,2,"mat-option",68,e.x6l),e.ALo(9,"async"),e.qZA(),e.YNc(10,Pr,2,0,"mat-error",82),e.qZA()),2&o){const t=e.MAs(6);e.oxw();const i=e.MAs(4),n=e.oxw();e.xp6(3),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",n.searchDepotsControl)("required",i.value>0)("matAutocomplete",t)("placeholder","Buscar almacenes"),e.xp6(3),e.wJu(e.lcZ(9,6,n.depotsFiltered)),e.xp6(3),e.um2(10,n.productForm.get("depotId").hasError("required")?10:-1)}}function Er(o,r){if(1&o&&(e.TgZ(0,"mat-form-field",28)(1,"mat-label"),e._uU(2,"Cantidad"),e.qZA(),e._UZ(3,"input",73,74),e.YNc(5,qr,2,0,"mat-error"),e.qZA(),e.YNc(6,Sr,5,2,"mat-form-field",25),e.TgZ(7,"mat-form-field",75)(8,"mat-label"),e._uU(9,"Precio"),e.qZA(),e._UZ(10,"mat-icon",76)(11,"input",77),e.YNc(12,Dr,2,0,"mat-error"),e.qZA(),e.YNc(13,Mr,11,8,"mat-form-field",78)),2&o){const t=e.oxw();e.xp6(3),e.Q6J("formControlName","stock"),e.xp6(2),e.um2(5,t.productForm.get("stock").hasError("required")?5:-1),e.xp6(),e.um2(6,t.productForm.get("isDigital").value?-1:6),e.xp6(5),e.Q6J("formControlName","price"),e.xp6(),e.um2(12,t.productForm.get("price").hasError("required")?12:-1),e.xp6(),e.um2(13,t.editMode||t.productForm.get("isDigital").value?-1:13)}}function Jr(o,r){1&o&&(e.TgZ(0,"mat-form-field",28)(1,"mat-label"),e._uU(2,"Largo"),e.qZA(),e._UZ(3,"mat-icon",85)(4,"mat-icon",76)(5,"input",86),e.qZA(),e.TgZ(6,"mat-form-field",28)(7,"mat-label"),e._uU(8,"Ancho"),e.qZA(),e._UZ(9,"mat-icon",85)(10,"input",86),e.qZA(),e.TgZ(11,"mat-form-field",28)(12,"mat-label"),e._uU(13,"Altura"),e.qZA(),e._UZ(14,"mat-icon",85)(15,"input",86),e.qZA(),e.TgZ(16,"mat-form-field",28)(17,"mat-label"),e._uU(18,"Peso"),e.qZA(),e._UZ(19,"mat-icon",87)(20,"input",86),e.qZA()),2&o&&(e.xp6(5),e.Q6J("formControlName","length"),e.xp6(5),e.Q6J("formControlName","width"),e.xp6(5),e.Q6J("formControlName","height"),e.xp6(5),e.Q6J("formControlName","weight"))}const Vt=()=>({height:"270px"});function Rr(o,r){if(1&o&&(e.TgZ(0,"div",88)(1,"mat-label"),e._uU(2,"Especificaciones"),e.qZA(),e._UZ(3,"quill-editor",89),e.qZA()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("formControlName","specifications")("styles",e.DdM(3,Vt))("modules",t.quillModules)}}function Nr(o,r){if(1&o&&(e.TgZ(0,"div",88)(1,"mat-label"),e._uU(2,"Garant\xeda"),e.qZA(),e._UZ(3,"quill-editor",89),e.qZA()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("formControlName","guaranty")("styles",e.DdM(3,Vt))("modules",t.quillModules)}}function Qr(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"input",90,91),e.NdJ("change",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.selectFiles(n,"thumbnail"))}),e.qZA(),e.TgZ(3,"label",92),e._UZ(4,"mat-icon",93),e.qZA()()}2&o&&(e.xp6(),e.Q6J("multiple",!1)("accept","image/png, image/webp, image/jpeg, image/png"),e.xp6(3),e.Q6J("svgIcon","mat_solid:photo_camera"))}function Lr(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"button",94),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.removeImage("thumbnail"))}),e._UZ(2,"mat-icon",93),e.qZA()()}2&o&&(e.xp6(2),e.Q6J("svgIcon","mat_solid:delete"))}function Wr(o,r){if(1&o&&e._UZ(0,"img",95),2&o){const t=e.oxw();e.Q6J("src",t.productForm.get("thumbnail").value,e.LSH)}}function zr(o,r){1&o&&(e.TgZ(0,"mat-slide-toggle",42),e._uU(1,"\xbfEs perecedero? "),e.qZA()),2&o&&e.Q6J("color","primary")("formControlName","isDigital")}function $r(o,r){1&o&&(e.TgZ(0,"mat-slide-toggle",42),e._uU(1,"\xbfEs digital? "),e.qZA()),2&o&&e.Q6J("color","primary")("formControlName","isDigital")}function Gr(o,r){1&o&&e._UZ(0,"mat-icon",49),2&o&&e.Q6J("svgIcon","mat_solid:edit")}function Or(o,r){1&o&&e._UZ(0,"mat-icon",49),2&o&&e.Q6J("svgIcon","mat_solid:done")}function jr(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-checkbox",96),e.NdJ("change",function(n){const c=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.toggleProductTag(c,n))}),e._uU(1),e.qZA()}if(2&o){const t=r.$implicit,i=e.oxw(2);e.Q6J("color","primary")("checked",i.selectedProduct.tags.includes(t.id)),e.xp6(),e.hij(" ",t.name," ")}}function Br(o,r){if(1&o&&e.SjG(0,jr,2,3,"mat-checkbox",97,e.QCX().trackByFn),2&o){const t=e.oxw();e.wJu(t.filteredTags)}}function Hr(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-form-field",28)(1,"input",99),e.NdJ("input",function(n){const c=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.updateTagName(c,n))}),e.qZA(),e.TgZ(2,"button",100),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.deleteTag(a))}),e._UZ(3,"mat-icon",49),e.qZA()()}if(2&o){const t=r.$implicit;e.xp6(),e.Q6J("value",t.name),e.xp6(2),e.Q6J("svgIcon","mat_solid:delete")}}function Vr(o,r){if(1&o&&(e.TgZ(0,"div",98),e.SjG(1,Hr,4,2,"mat-form-field",25,e.QCX().trackByFn),e.qZA()),2&o){const t=e.oxw();e.xp6(),e.wJu(t.filteredTags)}}function Yr(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",101),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(),a=e.MAs(113);return n.createTag(a.value),e.KtG(a.value="")}),e._UZ(1,"mat-icon",102),e.TgZ(2,"div",103),e._uU(3,'Crear "'),e.TgZ(4,"b"),e._uU(5),e.qZA(),e._uU(6,'"'),e.qZA()()}if(2&o){e.oxw();const t=e.MAs(113);e.xp6(),e.Q6J("svgIcon","mat_solid:add_circle"),e.xp6(4),e.Oqu(t.value)}}function Kr(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-chip",115),e.NdJ("removed",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.removeSize(a))}),e._uU(1),e.TgZ(2,"button",116),e._UZ(3,"mat-icon",49),e.qZA()()}if(2&o){const t=r.$implicit;e.xp6(),e.hij(" ",t," "),e.xp6(),e.uIk("aria-label","Eliminar "+t),e.xp6(),e.Q6J("svgIcon","mat_solid:cancel")}}function Xr(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",110)(1,"mat-form-field",111)(2,"mat-label"),e._uU(3,"Variantes de tallas"),e.qZA(),e.TgZ(4,"input",112),e.NdJ("matChipInputTokenEnd",function(n){e.CHM(t);const a=e.oxw(2);return e.KtG(a.addSize(n))}),e.qZA(),e.TgZ(5,"mat-chip-list",113,114),e.SjG(7,Kr,4,3,"mat-chip",null,e.x6l),e.qZA()()()}if(2&o){const t=e.MAs(6),i=e.oxw(2);e.xp6(4),e.Q6J("matChipInputFor",t)("matChipInputSeparatorKeyCodes",i.separatorKeysCodes)("matChipInputAddOnBlur",i.addOnBlur),e.xp6(),e.Q6J("formControl",i.sizesCtrl),e.xp6(2),e.wJu(i.sizes)}}function ea(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-chip",115),e.NdJ("removed",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.removeColor(a))}),e._UZ(1,"div",121),e.TgZ(2,"button",116),e._UZ(3,"mat-icon",49),e.qZA()()}if(2&o){const t=r.$implicit;e.xp6(),e.Udp("background",t),e.xp6(),e.uIk("aria-label","Eliminar "+t),e.xp6(),e.Q6J("svgIcon","mat_solid:cancel")}}function ta(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",117)(1,"span"),e._uU(2,"Variantes de colores"),e.qZA(),e.TgZ(3,"div",118)(4,"color-circle",119),e.NdJ("onChange",function(n){e.CHM(t);const a=e.oxw(2);return e.KtG(a.addColor(n))}),e.qZA(),e.TgZ(5,"mat-chip-grid",120),e.SjG(6,ea,4,4,"mat-chip",null,e.x6l),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(4),e.Q6J("colors",t.defaultColors),e.xp6(2),e.wJu(t.colors)}}function oa(o,r){if(1&o&&(e.TgZ(0,"mat-option",68),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t),e.xp6(),e.Oqu(t)}}function ia(o,r){if(1&o&&(e.TgZ(0,"mat-form-field",28)(1,"mat-label",124),e._uU(2,"Talla"),e.qZA(),e.TgZ(3,"mat-select",129)(4,"mat-option",130),e._uU(5,"Seleccione una talla"),e.qZA(),e.SjG(6,oa,2,2,"mat-option",68,e.x6l),e.qZA()()),2&o){const t=e.oxw(3);e.xp6(3),e.Q6J("formControlName","size")("required",t.showSize),e.xp6(3),e.wJu(t.sizes)}}function na(o,r){if(1&o&&(e.TgZ(0,"mat-option",68)(1,"div",131),e._UZ(2,"div",132),e._uU(3),e.qZA()()),2&o){const t=r.$implicit;e.Q6J("value",t),e.xp6(2),e.Udp("background",t),e.xp6(),e.hij(" ",t," ")}}function ra(o,r){if(1&o&&(e.TgZ(0,"mat-form-field",28)(1,"mat-label",124),e._uU(2,"Color"),e.qZA(),e.TgZ(3,"mat-select",129)(4,"mat-option",130),e._uU(5,"Seleccione un color"),e.qZA(),e.SjG(6,na,4,4,"mat-option",68,e.x6l),e.qZA()()),2&o){const t=e.oxw(3);e.xp6(3),e.Q6J("formControlName","color")("required",t.showColor),e.xp6(3),e.wJu(t.colors)}}function aa(o,r){if(1&o&&(e.TgZ(0,"div",135),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(),e.hij(" ",t.size," ")}}function sa(o,r){if(1&o&&(e.TgZ(0,"div",139),e._UZ(1,"div",132),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(),e.Udp("background",t.color)}}function ca(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",133)(1,"div",134),e._uU(2),e.qZA(),e.TgZ(3,"div",135),e._uU(4),e.qZA(),e.YNc(5,aa,2,1,"div",136)(6,sa,2,2,"div",137),e.TgZ(7,"div",135),e._uU(8),e.ALo(9,"currency"),e.qZA(),e.TgZ(10,"div",135),e._uU(11),e.qZA(),e.TgZ(12,"button",138),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.removeVariant(a))}),e._UZ(13,"mat-icon",59),e.qZA()()}if(2&o){const t=r.$implicit,i=e.oxw(4);e.xp6(2),e.hij(" ",i.productForm.get("name").value," "),e.xp6(2),e.hij(" ",t.sku," "),e.xp6(),e.um2(5,i.showSize?5:-1),e.xp6(),e.um2(6,i.showColor?6:-1),e.xp6(2),e.hij(" ",e.xi3(9,7,t.price,"$ ")," "),e.xp6(3),e.hij(" ",t.stock," "),e.xp6(2),e.Q6J("svgIcon","mat_solid:remove")}}function la(o,r){if(1&o&&e.SjG(0,ca,14,10,"div",140,e.x6l),2&o){const t=e.oxw(3);e.wJu(t.variants)}}function da(o,r){1&o&&(e.TgZ(0,"div",141),e._uU(1," \xa1No se ha creado ninguna variante! "),e.qZA())}function ua(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",122)(1,"span",15),e._uU(2,"Listado de variantes del producto"),e.qZA(),e.TgZ(3,"form",123)(4,"div"),e._uU(5),e.qZA(),e.TgZ(6,"mat-form-field",28)(7,"mat-label",124),e._uU(8,"SKU"),e.qZA(),e._UZ(9,"input",125),e.qZA(),e.YNc(10,ia,8,2,"mat-form-field",25)(11,ra,8,2,"mat-form-field",25),e.TgZ(12,"mat-form-field",28)(13,"mat-label",126),e._uU(14,"Precio"),e.qZA(),e._UZ(15,"input",127),e.qZA(),e.TgZ(16,"mat-form-field",28)(17,"mat-label",126),e._uU(18,"Cantidad"),e.qZA(),e._UZ(19,"input",127),e.qZA(),e.TgZ(20,"button",128),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.addVariant())}),e._UZ(21,"mat-icon",59),e.qZA()(),e.YNc(22,la,2,0)(23,da,2,0),e.qZA()}if(2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("formGroup",t.variantForm),e.xp6(2),e.hij(" ",t.productForm.get("name").value," "),e.xp6(4),e.Q6J("formControlName","sku"),e.xp6(),e.um2(10,t.sizes.length>0?10:-1),e.xp6(),e.um2(11,t.colors.length>0?11:-1),e.xp6(4),e.Q6J("formControlName","price"),e.xp6(4),e.Q6J("formControlName","stock"),e.xp6(),e.Q6J("disabled",t.variantForm.invalid)("ngClass",e.VKq(11,it,t.variantForm.invalid)),e.xp6(),e.Q6J("svgIcon","mat_solid:add"),e.xp6(),e.um2(22,t.variants.length>0?22:23)}}function pa(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",104)(1,"div",44)(2,"span",15),e._uU(3,"Tipo de Variante"),e.qZA(),e.TgZ(4,"span"),e._uU(5,"Selecciona el tipo de variante"),e.qZA(),e.TgZ(6,"div",105)(7,"mat-checkbox",106),e.NdJ("change",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.selectShowSize(n))}),e._uU(8," Talla "),e.qZA(),e.TgZ(9,"mat-checkbox",106),e.NdJ("change",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.selectShowColor(n))}),e._uU(10," Color "),e.qZA()(),e.YNc(11,Xr,9,4,"div",107)(12,ta,8,1,"div",108)(13,ua,24,13,"div",109),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(7),e.Q6J("formControl",t.haveSizeCtrl),e.xp6(2),e.Q6J("formControl",t.haveColorCtrl),e.xp6(2),e.um2(11,t.showSize?11:-1),e.xp6(),e.um2(12,t.showColor?12:-1),e.xp6(),e.um2(13,(t.colors.length>0||t.sizes.length>0)&&(t.showSize||t.showColor)?13:-1)}}let ma=(()=>{class o{constructor(){this.addOnBlur=!0,this.categoriesFiltered$=(0,S.of)([]),this.categories=[],this.currencies=[],this.editMode=!1,this.flashMessage=null,this.images=[],this.isLoading=!1,this.haveSizeCtrl=new s.NI(!1),this.haveColorCtrl=new s.NI(!1),this.haveSpecificationsCtrl=new s.NI(!1),this.haveGuarantyCtrl=new s.NI(!1),this.productId=null,this.products$=(0,S.of)([]),this.searchInputControl=new s.NI,this.separatorKeysCodes=[bt.K5,bt.OC],this.selectedProduct=new rr.xs,this.searchDepotsControl=new s.NI({value:null,disabled:!0}),this.selectedDepotName="",this.tagsEditMode=!1,this.thumbnail="",this.uoms=[],this.uoms$=(0,S.of)(null),this.quillModules={toolbar:[[{font:[]}],[{color:[]}],[{align:[]}],["bold","italic","underline"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{size:["small",!1,"large","huge"]}]]},this.showSize=!1,this.sizes=["S","M","L","XL"],this.sizesCtrl=new s.NI(["M"]),this.showColor=!1,this.colors=[],this.defaultColors=["#e9182d","#f78da7","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#607d8b"],this.variants=[],this.types=[{value:"standard",label:"Est\xe1ndar",details:"Producto que no tiene variantes.",active:!0,tooltip:"Seleccionar"},{value:"generic",label:"Gen\xe9rico",details:"Producto que re\xfane variantes.",active:!1,tooltip:"Pr\xf3ximamente"},{value:"group",label:"Combo",details:"Agrupaci\xf3n de productos.",active:!1,tooltip:"Pr\xf3ximamente"}],this._unsubscribeAll=new E.x,this._activatedRoute=(0,e.f3M)(x.gz),this._changeDetectorRef=(0,e.f3M)(e.sBO),this._formBuilder=(0,e.f3M)(s.qu),this._fuseConfirmationService=(0,e.f3M)(H.R),this._imagesService=(0,e.f3M)(Ht.C),this._productsService=(0,e.f3M)(Pe.s),this._depotsService=(0,e.f3M)(he.Y),this._snackBar=(0,e.f3M)(G.ux),this._router=(0,e.f3M)(x.F0),this.store=(0,e.f3M)(A.yh),this._filter=(t,i)=>{const n=i.toLowerCase();return t?t.filter(a=>a.name.toLowerCase().trim().includes(n)):[]}}ngOnInit(){this.categoriesFiltered$=this.store.select(ot.u),this.store.select(ot.u).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.categories=t,this._changeDetectorRef.markForCheck()}),this.productForm=this._formBuilder.group({id:[""],type:["standard",[s.kI.required]],categoryId:["",[s.kI.required]],name:["",[s.kI.required,s.kI.minLength(3),s.kI.maxLength(255)]],description:["",[s.kI.maxLength(1e4)]],brandId:["",[s.kI.required]],currencyId:["",[s.kI.required]],uomId:["",[s.kI.required]],thumbnail:[""],sku:[null],upc:["",[s.kI.required]],bCode:[null],tags:[[]],cost:[0,[s.kI.min(0),s.kI.max(999999999),s.kI.maxLength(9)]],discount:[0,[s.kI.min(0),s.kI.max(999999999),s.kI.maxLength(9)]],tax:[0,[s.kI.min(0),s.kI.max(999999999),s.kI.maxLength(9)]],price:[0,[s.kI.required,s.kI.min(0),s.kI.max(999999999),s.kI.maxLength(9)]],depotId:[null],stock:[0,[s.kI.required,s.kI.min(0),s.kI.max(999999999),s.kI.maxLength(9)]],stockMin:[0,[s.kI.required,s.kI.min(0),s.kI.max(999999999),s.kI.maxLength(9)]],length:[0,[s.kI.min(0),s.kI.max(999999999),s.kI.maxLength(9)]],width:[0,[s.kI.min(0),s.kI.max(999999999),s.kI.maxLength(9)]],height:[0,[s.kI.min(0),s.kI.max(999999999),s.kI.maxLength(9)]],weight:[0,[s.kI.min(0),s.kI.max(999999999),s.kI.maxLength(9)]],specifications:[""],guaranty:[""],active:[!0],isPerishable:[!1],isService:[!1],isDigital:[!1],isIngredient:[!1]}),this.variantForm=this._formBuilder.group({sku:new s.NI(""),size:new s.NI,color:new s.NI,price:new s.NI,stock:new s.NI}),this._activatedRoute.params.pipe((0,u.R)(this._unsubscribeAll)).subscribe(({productId:t})=>{this.productId=t,"new"!==this.productId&&(this.editMode=!0,this.store.select(ge.Fn).pipe((0,u.R)(this._unsubscribeAll)).subscribe(i=>{this.productForm.patchValue(i),this.selectedProduct=i,this.variants=i.variants,i.variants&&i.variants.length>0&&(null!==i.variants[0].color&&(this.showColor=!0,this.haveColorCtrl.setValue(!0)),null!==i.variants[0].size&&(this.showSize=!0,this.haveSizeCtrl.setValue(!0))),Ne.W.IsNullOrEmpty(i.specifications)||this.haveSpecificationsCtrl.setValue(!0),Ne.W.IsNullOrEmpty(i.guaranty)||this.haveGuarantyCtrl.setValue(!0),this.productForm.patchValue(i),i.variants&&(this.variants=i.variants.map(n=>{const a={...n};return delete a.__typename,a})),Ne.W.IsNullOrEmpty(i.isDigital)&&this.productForm.get("stock").disable(),this.images=this.selectedProduct.images,this.productForm.get("type").setValue("standard")})),this._changeDetectorRef.markForCheck()}),this.store.select(ir.zd).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.currencies=t,this._changeDetectorRef.markForCheck()}),this.uoms$=this.store.select(Bt.av),this.uoms$.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.uoms=t,this._changeDetectorRef.markForCheck()}),this.store.select(nr.gg).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.brands=t,this._changeDetectorRef.markForCheck()}),this.store.select(ge.a0).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.tags=(0,$e.cloneDeep)(t),this.filteredTags=(0,$e.cloneDeep)(t),this._changeDetectorRef.markForCheck()}),this.depots$=this.store.select(W.$I),this.productForm.get("isDigital").valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,_.U)(t=>{t?(this.productForm.get("stockMin").setValidators([s.kI.required,s.kI.min(0),s.kI.max(999999999),s.kI.maxLength(9)]),this.productForm.patchValue({sku:null,bCode:null,depotId:null,stock:0,stockMin:0,length:0,width:0,height:0,weight:0,isPerishable:!1},{emitEvent:!1}),this.searchDepotsControl.reset()):this.productForm.get("stockMin").clearValidators(),this.productForm.get("stockMin").updateValueAndValidity()})).subscribe(),this.productForm.get("stock").valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,_.U)(t=>{t&&t>0&&!this.productForm.get("isDigital").value?(this.productForm.get("depotId").setValidators([s.kI.required]),this.searchDepotsControl.enable(),this.productForm.get("depotId").reset()):(this.productForm.get("depotId").clearValidators(),this.searchDepotsControl.disable(),this.searchDepotsControl.setValue(null),this.productForm.get("depotId").reset())})).subscribe(),this.depotsFiltered=this.searchDepotsControl.valueChanges.pipe((0,q.b)(100),(0,k.O)(null),(0,ee.z)(t=>null!==t&&"string"==typeof t&&t!==this.selectedDepotName?this._depotsService.findActiveDepots(t.trim()):this.depots$)),this.categoriesFiltered$=this.productForm.get("categoryId").valueChanges.pipe((0,k.O)(""),(0,_.U)(t=>this._filterCategories(t||"")))}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}addDepotIdToMovement(t){this.selectedDepotName=t.name,this.productForm.get("depotId").setValue(t.id)}selectType(t){t.active&&this.productForm.get("type").setValue(t.value)}resetCategoryField(){this.productForm.get("categoryId").reset(),this.categoriesFiltered$=this.store.select(ot.u)}selectShowSize(t){this.showSize=t.checked,this._changeDetectorRef.markForCheck()}addSize(t){const i=(t.value||"").trim();this.sizes.indexOf(i.toUpperCase())>=0?t.chipInput.clear():(i&&this.sizes.push(i),t.chipInput.clear(),this._changeDetectorRef.markForCheck())}removeSize(t){const i=this.sizes.indexOf(t);i>=0&&this.sizes.splice(i,1)}selectShowColor(t){this.showColor=t.checked,this._changeDetectorRef.markForCheck()}addColor({color:t}){this.colors.indexOf(t.hex)>=0||(t.hex&&this.colors.push(t.hex),this._changeDetectorRef.markForCheck())}removeColor(t){const i=this.colors.indexOf(t);i>=0&&this.colors.splice(i,1)}addVariant(){const t=this.variantForm.getRawValue();this.variants.indexOf(t)>=0||(t&&this.variants.push(t),this.variantForm.reset(),this._changeDetectorRef.markForCheck())}removeVariant(t){const i=this.variants.indexOf(t);i>=0&&this.variants.splice(i,1),this._changeDetectorRef.markForCheck()}toggleTagsEditMode(){this.tagsEditMode=!this.tagsEditMode}filterTags(t){const i=t.target.value.toLowerCase();this.filteredTags=this.tags.filter(n=>n.name.toLowerCase().includes(i))}filterTagsInputKeyDown(t){if("Enter"!==t.key)return;if(0===this.filteredTags.length)return this.createTag(t.target.value),void(t.target.value="");const i=this.filteredTags[0];this.selectedProduct.tags.find(a=>a===i.id)?this.removeTagFromProduct(i):this.addTagToProduct(i)}createTag(t){this._productsService.createTag({active:!0,name:t}).subscribe(({data:n})=>{this.addTagToProduct(n.createTag.tag),this._changeDetectorRef.markForCheck()})}updateTagName(t,i){t.name=i.target.value,delete t.__typename,setTimeout(()=>{this._productsService.updateTag(t).pipe((0,q.b)(300)).subscribe(()=>{this._changeDetectorRef.markForCheck()})},1e3)}deleteTag(t){this._productsService.deleteTag(t.id).subscribe(),this._changeDetectorRef.markForCheck()}addTagToProduct(t){const i=(0,$e.cloneDeep)(this.selectedProduct);i.tags.unshift(t.id),this.productForm.get("tags").patchValue(i.tags),this._changeDetectorRef.markForCheck()}removeTagFromProduct(t){const i=this.productForm.getRawValue();i.tags.splice(i.tags.findIndex(n=>n===t.id),1),this.productForm.get("tags").patchValue(i.tags),this._changeDetectorRef.markForCheck()}toggleProductTag(t,i){i.checked?this.addTagToProduct(t):this.removeTagFromProduct(t)}shouldShowCreateTagButton(t){return!(""===t||this.tags.findIndex(i=>i.name.toLowerCase()===t.toLowerCase())>-1)}createProduct(){const t=this.productForm.getRawValue();delete t.id,delete t.guaranty,"generic"===t.type&&(delete t.stock,delete t.price),t.haveColor=this.showColor,t.haveSize=this.showSize,t.variants=this.variants,this._fuseConfirmationService.open({title:"Crear familia de productos",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._productsService.createProduct(t).pipe((0,u.R)(this._unsubscribeAll)).subscribe(({data:a})=>{this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:a.createProduct.message,type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/warehouse/products")}),this._changeDetectorRef.markForCheck()})}updateProduct(){const t=this.productForm.getRawValue();t.variants=this.variants,"generic"===t.type&&(delete t.stock,delete t.price),this._fuseConfirmationService.open({title:"Actualizar Producto",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._productsService.updateProduct(t).pipe((0,u.R)(this._unsubscribeAll)).subscribe(({data:a})=>{this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:a.updateProduct.message,type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/warehouse/products")}),this._changeDetectorRef.markForCheck()})}showFlashMessage(t){this.flashMessage=t,this._changeDetectorRef.markForCheck(),setTimeout(()=>{this.flashMessage=null,this._changeDetectorRef.markForCheck()},3e3)}trackByFn(t,i){return i.id||t}displayFnCategory(t){if(""===t)return;let i="";const n=this.categories.find(a=>a.id===t&&0===a.children.length);if(n)return n.name;for(const a of this.categories){const c=a.children.find(l=>l.id===t);if(c){i=c.name;break}}return i}selectFiles(t,i){if(0===t.target.files.length)return;const n=t.target.files[0];!this._imagesService.validMaxMBSize(n,2)||!["image/jpeg","image/jpg","image/webp","image/png"].includes(n.type)||this._uploadFile(t,i)}removeImage(t){this._fuseConfirmationService.open({title:"Cuidado",message:"\xbfEst\xe1 seguro que desea eliminar esta imagen?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,u.R)(this._unsubscribeAll)).subscribe(n=>{if("confirmed"===n){const a=this.productForm.get(t).value;switch(t){case"images":this.productForm.get(t).setValue([]);break;case"thumbnail":this.productForm.get(t).setValue(null)}const c=this.productForm.getRawValue();this.editMode&&this._productsService.updateProductImages(c.id,c.thumbnail,c.images).subscribe(l=>{this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:l.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}})},l=>{this.productForm.get(t).setValue(a)}),this._changeDetectorRef.markForCheck()}})}_checkOnSaleQty(t,i){return n=>{const a=n.get(t),c=n.get(i);if(!a||!c||(c.hasError("invalid")&&(delete c.errors.invalid,c.updateValueAndValidity()),a.value>=c.value))return null;const l={invalid:"La cantidad en venta no debe ser mayor a la disponible"};return c.setErrors(l),l}}_filterCategories(t){return t?this.categories.map(i=>({id:i.id,active:i.active,name:i.name,children:this._filter(i.children,t)})).filter(i=>i.children.length>0||i.name.toLowerCase().trim().includes(t.toLocaleLowerCase())):this.categories}_uploadFile(t,i){this._imagesService.openCropperDialog(t,!0).pipe((0,u.R)(this._unsubscribeAll)).subscribe(n=>{if(!n)return;this.productForm.get(i).setValue(n);const a=this.productForm.getRawValue();this.editMode&&this._productsService.updateProductImages(a.id,a.thumbnail,a.images).subscribe(c=>{this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()},c=>{this.productForm.get(i).setValue(null)})})}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["stock-product-detail"]],standalone:!0,features:[e.jDz],decls:122,vars:57,consts:[["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","gap-5","p-3","overflow-y-auto","bg-cover","sm:absolute","sm:inset-0","dark:bg-transparent"],[1,"z-20","flex","flex-col","bg-transparent","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:px-5"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/warehouse/products",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","items-center","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["class","ml-4","mat-raised-button","","class","text-white bg-gradient-to-r from-primary-500 to-primary-600",3,"disabled","ngClass"],[1,"flex","flex-auto"],[1,"w-full",3,"formGroup","autocomplete"],[1,"grid","grid-cols-1","gap-3","sm:grid-cols-4"],[1,"flex","flex-col","gap-3","p-3","rounded-md","shadow-md","sm:col-span-3","bg-card"],[1,"text-xl","font-semibold"],[1,"grid","w-full","gap-6","sm:grid-cols-3"],[1,"grid","grid-cols-1","gap-3","mt-5","sm:grid-cols-2","lg:grid-cols-4"],[1,"w-full","col-span-2","fuse-mat-dense"],["matInput","","type","text","minlength","3","maxlength","255","required","",3,"formControlName"],["svgIcon","mat_solid:search","matPrefix",""],["type","text","matInput","","required","",3,"formControlName","matAutocomplete"],[3,"displayWith"],["categoriesGroup","matAutocomplete"],["class","cursor-pointer","svgIcon","mat_solid:cancel","matSuffix",""],["class","w-full fuse-mat-dense"],["class","w-full fuse-mat-dense","matTooltip","C\xf3digo de barras"],["class","w-full fuse-mat-dense","matTooltip","C\xf3digo"],[1,"w-full","fuse-mat-dense"],[3,"formControlName"],[3,"formControlName","required","placeholder"],[1,"w-full","col-span-2","sm:col-span-4"],["matInput","","matTextareaAutoSize","","maxlength","10000",3,"formControlName","rows"],["descriptionLength",""],[1,"text-right"],["class","flex flex-col w-full gap-5 sm:col-span-4"],[1,"flex","flex-col","gap-3","p-3","rounded-md","shadow-md","bg-card"],[1,"flex","items-center","justify-center","flex-auto","max-h-40"],[1,"relative","flex","items-center","justify-center","w-32","h-32","overflow-hidden","rounded-md","ring-4","ring-bg-card"],[1,"absolute","inset-0","z-10","bg-opacity-50","bg-slate-300"],[1,"absolute","inset-0","z-20","flex","items-center","justify-center"],["class","object-cover w-full h-full",3,"src"],[3,"color","formControlName"],[3,"color","formControl"],[1,"flex","flex-col"],[1,"mb-px","text-xl","font-semibold","leading-tight"],[1,"mt-1.5","rounded-md","border","border-gray-300","dark:border-gray-500","shadow-sm","overflow-hidden"],[1,"flex","items-center","px-3","py-2","-my-px"],[1,"flex","items-center","flex-auto","min-w-0"],[1,"icon-size-5",3,"svgIcon"],["type","text","placeholder","Buscar",1,"min-w-0","py-1","ml-2","border-0",3,"minLength","maxLength","input","keydown"],["newTagInput",""],["mat-icon-button","",1,"w-8","h-8","ml-3","min-h-8",3,"click"],["class","icon-size-5",3,"svgIcon"],[1,"h-32","overflow-y-auto","leading-none","border-t","border-gray-300","dark:border-gray-500"],["class","p-4 space-y-2"],["class","flex items-center h-10 min-h-8 -ml-0.5 pl-4 pr-3 leading-none cursor-pointer border-t hover:bg-gray-50 dark:hover:bg-hover","matRipple",""],["class","flex flex-col w-full gap-3 p-3 rounded-md shadow-md sm:col-span-4 bg-card"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-600",3,"disabled","ngClass","click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"relative","flex","flex-col","items-start","justify-start","p-3","border","rounded-md",3,"ngClass","matTooltip","click"],["class","absolute top-0 right-0 mt-3 mr-3 icon-size-7 text-primary",3,"svgIcon"],[1,"font-semibold"],[1,"mt-1","whitespace-normal","text-secondary"],[1,"flex-auto"],[1,"absolute","top-0","right-0","mt-3","mr-3","icon-size-7","text-primary",3,"svgIcon"],[3,"label","disabled"],[3,"value"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer",3,"click"],["matInput","","type","text","minlength","3","maxlength","255",3,"formControlName"],["matTooltip","C\xf3digo de barras",1,"w-full","fuse-mat-dense"],["matTooltip","C\xf3digo",1,"w-full","fuse-mat-dense"],["matInput","","type","number","min","0","max","999999999","maxlength","50","required","",3,"formControlName"],["stock",""],[1,"w-full","sm:col-span-2","fuse-mat-dense"],["matPrefix","","svgIcon","mat_solid:attach_money"],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName"],["class","w-full sm:col-span-2 fuse-mat-dense"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","required","matAutocomplete","placeholder"],["depotsAutocomplete","matAutocomplete"],["class","pb-5"],[3,"value","click"],[1,"pb-5"],["matPrefix","","svgIcon","mat_solid:square_foot"],["matInput","","type","number","min","0","max","999999999","maxlength","9",3,"formControlName"],["matPrefix","","svgIcon","mat_solid:scale"],[1,"flex","flex-col","w-full","gap-5","sm:col-span-4"],[1,"h-full",3,"formControlName","styles","modules"],["id","thumbnail-file-input","type","file",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"multiple","accept","change"],["thumbnailFileInput",""],["for","thumbnail-file-input","matRipple","",1,"flex","items-center","justify-center","w-10","h-10","rounded-full","cursor-pointer","hover:bg-hover"],[1,"text-white",3,"svgIcon"],["mat-icon-button","",3,"click"],[1,"object-cover","w-full","h-full",3,"src"],[1,"flex","items-center","h-10","px-4","min-h-8",3,"color","checked","change"],["class","flex items-center h-10 px-4 min-h-8",3,"color","checked"],[1,"p-4","space-y-2"],["matInput","",3,"value","input"],["mat-icon-button","","matSuffix","",3,"click"],["matRipple","",1,"flex","items-center","h-10","min-h-8","-ml-0.5","pl-4","pr-3","leading-none","cursor-pointer","border-t","hover:bg-gray-50","dark:hover:bg-hover",3,"click"],[1,"mr-2","icon-size-5",3,"svgIcon"],[1,"break-all"],[1,"flex","flex-col","w-full","gap-3","p-3","rounded-md","shadow-md","sm:col-span-4","bg-card"],[1,"flex","flex-row","flex-wrap","gap-2","mt-2"],[3,"formControl","change"],["class","flex flex-row mt-5"],["class","flex flex-col gap-5 mt-5"],["class","flex flex-col pt-5 mt-5 border-t"],[1,"flex","flex-row","mt-5"],["appearance","fill",1,"flex","flex-col","w-full"],["placeholder","Agregar talla...",1,"w-full",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["aria-label","Agregar talla",3,"formControl"],["sizesChipGrid",""],[3,"removed"],["matChipRemove","",1,"w-5","h-5"],[1,"flex","flex-col","gap-5","mt-5"],[1,"flex","flex-row","gap-5"],[3,"colors","onChange"],["aria-label","Colores"],[1,"w-5","h-5","rounded-full"],[1,"flex","flex-col","pt-5","mt-5","border-t"],["autocomplete","off",1,"grid","items-center","gap-4","px-6","py-3","border-b","variant-form-grid","md:px-8",3,"formGroup"],[1,"w-full","text-center"],["matInput","","type","text","maxlength","255",3,"formControlName"],[1,"w-full","text-right"],["matInput","","type","number","min","0","max","999999999","required","",3,"formControlName"],["mat-icon-button","","color","primary","matTooltip","Agregar Variante",3,"disabled","ngClass","click"],[3,"formControlName","required"],["value",""],[1,"inline-flex","items-center","gap-5"],[1,"rounded-full","h-7","w-7"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","variants-grid","md:px-8"],[1,"truncate"],[1,"text-center","truncate"],["class","text-center truncate"],["class","flex justify-center w-full"],["mat-icon-button","","color","warn","matTooltip","Quitar Variante",3,"click"],[1,"flex","justify-center","w-full"],["class","grid items-center gap-4 px-6 py-3 border-b variants-grid md:px-8"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"],["class","relative flex flex-col items-start justify-start p-3 border rounded-md",3,"ngClass","matTooltip"]],template:function(i,n){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div")(6,"a",4),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Productos"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15),e.qZA()()()()(),e.TgZ(16,"div",9),e.YNc(17,sr,4,5,"button",10)(18,cr,4,5,"button",10),e.qZA()(),e.TgZ(19,"div",11)(20,"form",12)(21,"div",13)(22,"div",14)(23,"div",15),e._uU(24," Informaci\xf3n General "),e.qZA(),e.TgZ(25,"div",16),e.SjG(26,ur,7,9,"div",142,n.trackByFn),e.qZA(),e.TgZ(28,"div",17)(29,"mat-form-field",18)(30,"mat-label"),e._uU(31,"Nombre"),e.qZA(),e._UZ(32,"input",19),e.YNc(33,pr,2,0,"mat-error")(34,mr,2,0,"mat-error"),e.qZA(),e.TgZ(35,"mat-form-field",18)(36,"mat-label"),e._uU(37,"Categor\xeda"),e.qZA(),e._UZ(38,"mat-icon",20)(39,"input",21),e.TgZ(40,"mat-autocomplete",22,23),e.SjG(42,_r,2,2,null,null,e.x6l),e.ALo(44,"async"),e.qZA(),e.YNc(45,vr,1,0,"mat-icon",24)(46,xr,2,0,"mat-error"),e.qZA(),e.YNc(47,br,4,1,"mat-form-field",25)(48,Cr,4,1,"mat-form-field",26)(49,yr,4,1,"mat-form-field",27),e.TgZ(50,"mat-form-field",28)(51,"mat-label"),e._uU(52,"Marca"),e.qZA(),e.TgZ(53,"mat-select",29),e.SjG(54,Zr,2,2,"mat-option",68,e.x6l),e.qZA(),e.YNc(56,Tr,2,0,"mat-error"),e.qZA(),e.TgZ(57,"mat-form-field",28)(58,"mat-label"),e._uU(59,"Moneda"),e.qZA(),e.TgZ(60,"mat-select",30),e.SjG(61,Ar,2,2,"mat-option",68,e.x6l),e.qZA(),e.YNc(63,Ir,2,0,"mat-error"),e.qZA(),e.TgZ(64,"mat-form-field",28)(65,"mat-label"),e._uU(66,"Unidad de Medida"),e.qZA(),e.TgZ(67,"mat-select",29),e.SjG(68,kr,2,2,"mat-option",68,e.x6l),e.qZA(),e.YNc(70,wr,2,0,"mat-error"),e.qZA(),e.YNc(71,Er,14,6)(72,Jr,21,4),e.TgZ(73,"mat-form-field",31)(74,"mat-label"),e._uU(75,"Descripci\xf3n"),e.qZA(),e._UZ(76,"textarea",32,33),e.TgZ(78,"mat-hint",34),e._uU(79),e.qZA()(),e.YNc(80,Rr,4,4,"div",35)(81,Nr,4,4,"div",35),e.qZA()(),e.TgZ(82,"div",36),e.ynx(83),e.TgZ(84,"div",15),e._uU(85," Imagen "),e.qZA(),e.TgZ(86,"div",37)(87,"div",38),e._UZ(88,"div",39),e.TgZ(89,"div",40),e.YNc(90,Qr,5,3,"div")(91,Lr,3,1,"div"),e.qZA(),e.YNc(92,Wr,1,1,"img",41),e.qZA()(),e.BQk(),e.TgZ(93,"div",15),e._uU(94," Opciones "),e.qZA(),e.TgZ(95,"mat-slide-toggle",42),e._uU(96,"\xbfEst\xe1 activo?"),e.qZA(),e.TgZ(97,"mat-slide-toggle",42),e._uU(98,"\xbfEs un ingrediente?"),e.qZA(),e.YNc(99,zr,2,2,"mat-slide-toggle",42)(100,$r,2,2,"mat-slide-toggle",42),e.TgZ(101,"mat-slide-toggle",43),e._uU(102,"\xbfTiene garant\xeda? "),e.qZA(),e.TgZ(103,"mat-slide-toggle",43),e._uU(104,"\xbfTiene especificaciones? "),e.qZA(),e.TgZ(105,"div",44)(106,"span",45),e._uU(107,"Etiquetas"),e.qZA(),e.TgZ(108,"div",46)(109,"div",47)(110,"div",48),e._UZ(111,"mat-icon",49),e.TgZ(112,"input",50,51),e.NdJ("input",function(c){return n.filterTags(c)})("keydown",function(c){return n.filterTagsInputKeyDown(c)}),e.qZA()(),e.TgZ(114,"button",52),e.NdJ("click",function(){return n.toggleTagsEditMode()}),e.YNc(115,Gr,1,1,"mat-icon",53)(116,Or,1,1,"mat-icon",53),e.qZA()(),e.TgZ(117,"div",54),e.YNc(118,Br,2,0)(119,Vr,3,0,"div",55)(120,Yr,7,2,"div",56),e.qZA()()()(),e.YNc(121,pa,14,5,"div",57),e.qZA()()()()),2&i){const a=e.MAs(41),c=e.MAs(77),l=e.MAs(113);e.xp6(9),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(2),e.Oqu("new"===n.productId?"Crear Producto":n.selectedProduct.name),e.xp6(2),e.um2(17,n.editMode?-1:17),e.xp6(),e.um2(18,n.editMode?18:-1),e.xp6(2),e.Q6J("formGroup",n.productForm)("autocomplete","off"),e.xp6(6),e.wJu(n.types),e.xp6(6),e.Q6J("formControlName","name"),e.xp6(),e.um2(33,n.productForm.get("name").hasError("required")?33:-1),e.xp6(),e.um2(34,n.productForm.get("name").hasError("minlength")||n.productForm.get("name").hasError("maxlength")?34:-1),e.xp6(5),e.Q6J("formControlName","categoryId")("matAutocomplete",a),e.xp6(),e.Q6J("displayWith",n.displayFnCategory.bind(n)),e.xp6(2),e.wJu(e.lcZ(44,55,n.categoriesFiltered$)),e.xp6(3),e.um2(45,n.productForm.get("categoryId").value?45:-1),e.xp6(),e.um2(46,n.productForm.get("categoryId").hasError("required")?46:-1),e.xp6(),e.um2(47,"standard"!==n.productForm.get("type").value||n.productForm.get("isDigital").value?-1:47),e.xp6(),e.um2(48,"standard"===n.productForm.get("type").value?48:-1),e.xp6(),e.um2(49,n.productForm.get("isDigital").value?-1:49),e.xp6(4),e.Q6J("formControlName","brandId"),e.xp6(),e.wJu(n.brands),e.xp6(2),e.um2(56,n.productForm.get("brandId").hasError("required")?56:-1),e.xp6(4),e.Q6J("formControlName","currencyId")("required",!0)("placeholder","Moneda"),e.xp6(),e.wJu(n.currencies),e.xp6(2),e.um2(63,n.productForm.get("currencyId").hasError("required")?63:-1),e.xp6(4),e.Q6J("formControlName","uomId"),e.xp6(),e.wJu(n.uoms),e.xp6(2),e.um2(70,n.productForm.get("uomId").hasError("required")?70:-1),e.xp6(),e.um2(71,"generic"!==n.productForm.get("type").value?71:-1),e.xp6(),e.um2(72,"generic"===n.productForm.get("type").value||n.productForm.get("isDigital").value?-1:72),e.xp6(4),e.Q6J("formControlName","description")("rows",1),e.xp6(3),e.hij("Total de caracteres ",c.value.length," / 10000 "),e.xp6(),e.um2(80,n.haveSpecificationsCtrl.value?80:-1),e.xp6(),e.um2(81,n.haveGuarantyCtrl.value?81:-1),e.xp6(9),e.um2(90,n.productForm.get("thumbnail").value?-1:90),e.xp6(),e.um2(91,n.productForm.get("thumbnail").value?91:-1),e.xp6(),e.um2(92,n.productForm.get("thumbnail").value?92:-1),e.xp6(3),e.Q6J("color","primary")("formControlName","active"),e.xp6(2),e.Q6J("color","primary")("formControlName","isIngredient"),e.xp6(2),e.um2(99,n.productForm.get("isDigital").value?-1:99),e.xp6(),e.um2(100,n.editMode?-1:100),e.xp6(),e.Q6J("color","primary")("formControl",n.haveGuarantyCtrl),e.xp6(2),e.Q6J("color","primary")("formControl",n.haveSpecificationsCtrl),e.xp6(8),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("minLength",3)("maxLength",50),e.xp6(3),e.um2(115,n.tagsEditMode?-1:115),e.xp6(),e.um2(116,n.tagsEditMode?116:-1),e.xp6(2),e.um2(118,n.tagsEditMode?-1:118),e.xp6(),e.um2(119,n.tagsEditMode?119:-1),e.xp6(),e.um2(120,n.shouldShowCreateTagButton(l.value)?120:-1),e.xp6(),e.um2(121,"generic"===n.productForm.get("type").value?121:-1)}},dependencies:[h.Ov,or,tr,h.H9,Q.Bb,ar.PQ,Q.XC,ie.ey,ie.Nv,Q.ZL,v.ot,v.lW,v.RK,ue.p9,ue.oG,ke.Hi,ke.HS,ke.RA,ke.oH,ke.qH,m.lN,m.KE,m.hX,m.bx,m.TO,m.qo,m.R9,y.Ps,y.Hw,Z.c,Z.Nt,g.TU,Ee.Fk,X.LD,X.gD,U.rP,U.Rr,C.JX,O.T5,N.AV,N.gM,h.mk,An,Ct,s.UX,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.Q7,s.wO,s.nD,s.qQ,s.Fd,s.oH,s.sg,s.u],encapsulation:2,changeDetection:0})}return o})(),ha=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-products"]],standalone:!0,features:[e.jDz],decls:1,vars:0,template:function(i,n){1&i&&e._UZ(0,"router-outlet")},dependencies:[x.lC],encapsulation:2})}return o})();var ga=d(94748),fa=d(27627),Yt=d(78501);const _a=["stockFile"],va=["stockTemplateFile"];function xa(o,r){if(1&o&&e._UZ(0,"img",67),2&o){const t=e.oxw().$implicit;e.Q6J("alt","Product thumbnail image")("src",t.thumbnail,e.LSH)}}function ba(o,r){1&o&&(e.TgZ(0,"div",68),e._uU(1," SIN IMAGEN "),e.qZA())}function Ca(o,r){1&o&&(e.TgZ(0,"div",69),e._UZ(1,"div",70),e.qZA())}function ya(o,r){1&o&&(e.TgZ(0,"div",71),e._UZ(1,"div",72),e.qZA())}function Za(o,r){1&o&&(e.TgZ(0,"div",73),e._UZ(1,"div",74),e.qZA())}function Ta(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-slide-toggle",75),e.NdJ("change",function(n){e.CHM(t);const a=e.oxw(),c=a.$implicit,l=a.$index,p=e.oxw(4);return e.KtG(p.updateProductStatus(n,c,l))}),e.qZA()}if(2&o){const t=e.oxw().$implicit;e.Q6J("checked",t.active)("color","primary")}}function Aa(o,r){1&o&&e._UZ(0,"mat-spinner",62),2&o&&e.Q6J("diameter",20)("color","primary")}const Ia=o=>["/warehouse/products/product",o];function ka(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",42)(1,"div",36)(2,"div",43)(3,"input",44),e.NdJ("change",function(n){const c=e.CHM(t).$implicit,l=e.oxw(4);return e.KtG(l.selectFiles(n,c))}),e.qZA(),e._UZ(4,"label",45),e.YNc(5,xa,1,2,"img",46)(6,ba,2,0,"div",47),e.qZA()(),e.TgZ(7,"div",48),e._uU(8),e.qZA(),e.TgZ(9,"div",49),e._uU(10),e.qZA(),e.TgZ(11,"div",50)(12,"span",51),e._uU(13),e.ALo(14,"number"),e.qZA(),e.TgZ(15,"span",52),e._uU(16),e.qZA()(),e.TgZ(17,"div",53)(18,"div",54),e._uU(19),e.ALo(20,"number"),e.qZA(),e.YNc(21,Ca,2,0,"div",55)(22,ya,2,0,"div",56)(23,Za,2,0,"div",57),e.TgZ(24,"span",58),e._uU(25),e.qZA()(),e.TgZ(26,"div",59),e._uU(27),e.qZA(),e.TgZ(28,"div",60),e.YNc(29,Ta,1,2,"mat-slide-toggle",61)(30,Aa,1,2,"mat-spinner",62),e.qZA(),e.TgZ(31,"div",63)(32,"button",64),e._UZ(33,"mat-icon",65),e.qZA(),e.TgZ(34,"button",66),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deleteProduct(a.id))}),e._UZ(35,"mat-icon",65),e.qZA()()()}if(2&o){const t=r.$implicit,i=r.$index,n=e.oxw(4);e.xp6(3),e.Q6J("id",t.id)("multiple",!1)("accept","image/png, image/webp, image/jpeg, image/png"),e.xp6(),e.Q6J("for",t.id),e.xp6(),e.um2(5,t.thumbnail?5:-1),e.xp6(),e.um2(6,t.thumbnail?-1:6),e.xp6(2),e.hij(" ",t.upc," "),e.xp6(2),e.hij(" ",t.name," "),e.xp6(3),e.Oqu(e.xi3(14,21,t.price,"1.2-2")),e.xp6(3),e.Oqu(t.currency.iso),e.xp6(3),e.Oqu(e.xi3(20,24,t.stock,"1.2-2")),e.xp6(2),e.um2(21,t.stock<20?21:-1),e.xp6(),e.um2(22,t.stock>=20&&t.stock<30?22:-1),e.xp6(),e.um2(23,t.stock>=30?23:-1),e.xp6(2),e.Oqu(t.uom.abbr),e.xp6(2),e.hij(" ",t.salesQuantity," "),e.xp6(2),e.um2(29,n.isLoading&&n.selectedSlide===i?-1:29),e.xp6(),e.um2(30,n.isLoading&&n.selectedSlide===i?30:-1),e.xp6(2),e.Q6J("routerLink",e.VKq(27,Ia,t.id)),e.xp6(),e.Q6J("svgIcon","mat_solid:edit"),e.xp6(2),e.Q6J("svgIcon","mat_solid:delete")}}function wa(o,r){1&o&&e.SjG(0,ka,36,29,"div",76,e.QCX().trackByFn),2&o&&e.wJu(r)}const qa=(o,r)=>({"pointer-events-none":o,hidden:r}),Fa=()=>[25,50,100];function Sa(o,r){if(1&o&&(e.TgZ(0,"div",34)(1,"div",35),e._UZ(2,"div"),e.TgZ(3,"div",36),e._uU(4," UPC "),e.qZA(),e.TgZ(5,"div",37),e._uU(6," Nombre "),e.qZA(),e.TgZ(7,"div",38),e._uU(8," Precio "),e.qZA(),e.TgZ(9,"div",38),e._uU(10," Stock "),e.qZA(),e.TgZ(11,"div",39),e._uU(12," U.Vendidas "),e.qZA(),e.TgZ(13,"div",38),e._uU(14," Activo "),e.qZA(),e.TgZ(15,"div",40),e._uU(16,"Acciones"),e.qZA()(),e.YNc(17,wa,2,0),e.ALo(18,"async"),e._UZ(19,"mat-paginator",41),e.qZA()),2&o){const t=e.oxw(2);let i;e.xp6(5),e.Q6J("mat-sort-header","name"),e.xp6(2),e.Q6J("mat-sort-header","price"),e.xp6(2),e.Q6J("mat-sort-header","stock"),e.xp6(2),e.Q6J("mat-sort-header","salesQuantity"),e.xp6(2),e.Q6J("mat-sort-header","active"),e.xp6(4),e.um2(17,(i=e.lcZ(18,12,t.products$))?17:-1,i),e.xp6(2),e.Q6J("ngClass",e.WLB(14,qa,t.isLoading,t.pagination.length<10&&t.pagination.page<1))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(17,Fa))("showFirstLastButtons",!0)}}function Da(o,r){1&o&&(e.TgZ(0,"div",77),e._uU(1,"\xa1No se ha creado ning\xfan producto!"),e.qZA())}function Ua(o,r){1&o&&e.YNc(0,Sa,20,18,"div",33)(1,Da,2,0),2&o&&e.um2(0,r.length>0?0:1)}const Pa=o=>({"cursor-progress":o});D.vfs=P.I.vfs;let Ma=(()=>{class o{constructor(){this.flashMessage=null,this.isLoading=!1,this.merchant=null,this.products=[],this.products$=(0,S.of)([]),this.searchInputControl=new s.NI(null),this.selectedProduct=null,this.selectedSlide=null,this.uoms$=(0,S.of)(null),this.user=null,this._changeDetectorRef=(0,e.f3M)(e.sBO),this._fileSaverService=(0,e.f3M)(fa.m),this._fuseConfirmationService=(0,e.f3M)(H.R),this._productsService=(0,e.f3M)(Pe.s),this._snackBar=(0,e.f3M)(G.ux),this._unsubscribeAll=new E.x,this.store=(0,e.f3M)(A.yh),this._router=(0,e.f3M)(x.F0),this._imagesService=(0,e.f3M)(Ht.C)}ngOnInit(){this.store.select(se.rk).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(me.Qs).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(ae.B).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.products$=this.store.select(ge.nR),this.products$.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.products=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,q.b)(300),(0,k.O)(null),(0,f.w)(t=>null!==t?(this.isLoading=!0,this._productsService.getProducts(0,25,"name","asc",t)):(0,S.of)()),(0,_.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this.waitForPaginatorLoad().then(t=>{this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,B.T)(this._sort.sortChange,this._paginator.page).pipe((0,f.w)(()=>(this.isLoading=!0,this._productsService.getProducts(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,_.U)(()=>{this.isLoading=!1})).subscribe())})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this.store.dispatch((0,Yt.kH)())}updateProductStatus(t,i,n){this.isLoading=!0,this.selectedSlide=n,this._productsService.updateProductStatus({id:i.id,active:t.checked}).pipe((0,u.R)(this._unsubscribeAll),(0,re.x)(()=>{this.isLoading=!1,this.selectedSlide=-1,this._changeDetectorRef.markForCheck()})).subscribe(({data:a})=>{a&&this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.updateProductStatus,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}})})}exportProductsStockTemplate(){this._fileSaverService.exportAsExcelFile([{upc:"",sku:"",bCode:"",name:"",description:"",uom:"U",quantity:1,price:0,brand:"",weight:0,width:0,length:0,height:0,volume:0}],"Plantilla para stock de productos",[["UPC","SKU","C\xf3digo","Nombre","Descripci\xf3n","Unidad de Medida","Cantidad","Precio","Marca","Peso","Ancho","Largo","Altura","Volumen"]],[{wch:20},{wch:20},{wch:20},{wch:30},{wch:70},{wch:16}])}generateReport(t){switch(t){case t="Productos Activos":this._productsService.getProductsActive().subscribe(({data:i})=>{this.generatePDF("open",t,i.productsActive)});break;case t="Productos Inactivos":this._productsService.getProductsInactive().subscribe(({data:i})=>{this.generatePDF("open",t,i.productsInactive)});break;case t="Productos Agotados":this._productsService.getProductsExhausted().subscribe(({data:i})=>{this.generatePDF("open",t,i.productsExhausted.map(n=>({...n,stock:n.quantity})))});break;case t="Productos en Stock":this._productsService.getProductsAvailable().subscribe(({data:i})=>{this.generatePDF("open",t,i.productsAvailable.map(n=>({...n,stock:n.quantity})))})}}generatePDF(t="open",i,n){const a={header:{text:i.toLocaleUpperCase(),style:"header",marginTop:5},content:[{lineHeight:1.3,table:{headerRows:1,widths:[75,75,"*",60,40,50,50,50],body:[[{text:"C\xf3d.",style:"table_header"},{text:"UPC",style:"table_header"},{text:"Producto",style:"table_header"},{text:"Marca",style:"table_header"},{text:"Unidad",style:"table_header"},{text:"Costo",style:"table_header"},{text:"P.Venta",style:"table_header"},{text:"Stock",style:"table_header"}],...n.map(c=>[{style:"table_body",text:c.code,alignment:"center"},{style:"table_body",text:c.upc,alignment:"center"},{style:"table_body",text:c.name},{style:"table_body",text:"string"==typeof c.brand?c.brand:c.brand.name,alignment:"center"},{style:"table_body",text:"string"==typeof c.uom?c.uom:c.uom.abbr,alignment:"center"},{style:"table_body",text:c.cost.toFixed(2),alignment:"center"},{style:"table_body",text:c.price.toFixed(2),alignment:"center"},{style:"table_body",text:c.stock,alignment:"center"}])]},layout:"lightHorizontalLines"}],footer:(c,l)=>({table:{widths:["*","*"],body:[[{text:`Reporte generador por: ${this.user.fullname} | Esta informaci\xf3n es exclusiva de ${this.merchant.name}`,bold:!0,fontSize:8},{text:`P\xe1gina ${c.toString()}/${l} - Fecha de impresi\xf3n ${w().format("DD/MM/yyyy HH:mm:ss")}`,bold:!0,fontSize:8,alignment:"right"}]]},margin:[30,0,30,0],layout:"noBorders",italics:!0}),defaultStyle:{fontSize:12},styles:{header:{fontSize:18,bold:!0,marginBottom:5,alignment:"center",fontFeatures:["c2sc","smcp"]},table_header:{fontSize:11,bold:!0,alignment:"center",fontFeatures:["c2sc","smcp"]},table_body:{fontSize:10}},pageOrientation:"landscape",pageSize:"LETTER",watermark:{text:this.merchant.name,color:"#fff",opacity:.07,angle:-35,bold:!0,italics:!1},info:{title:i,author:`${this.user.fullname}`,creationDate:w().toDate(),modDate:w().toDate(),producer:this.merchant.name}};switch(t){case t="download":D.createPdf(a).download();break;case t="open":D.createPdf(a).open();break;case t="print":D.createPdf(a).print()}}deleteProduct(t){this._fuseConfirmationService.open({title:"Eliminar Producto",message:"\xbfEsta seguro que desea eliminar el producto?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._productsService.removeProduct(t).pipe((0,u.R)(this._unsubscribeAll)).subscribe(({data:a})=>{this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:a.removeProduct.message,type:"success",svgIcon:"mat_solid:done"}})}),this._changeDetectorRef.markForCheck()})}trackByFn(t,i){return i.id||t}importStockFormTemplateFile(t){const i=t.target;this.isExcelFile=!!i.files[0].name.match(/(.xls|.xlsx)/),i.files.length>1&&(this.stockTemplateFile.nativeElement.value=""),this.isExcelFile?(this._productsService.importStockFormTemplateFile(t),this._router.navigateByUrl("/warehouse/products/from-template")):this.stockTemplateFile.nativeElement.value=""}selectFiles(t,i){if(0===t.target.files.length)return;const n=t.target.files[0];!this._imagesService.validMaxMBSize(n,2)||!["image/jpeg","image/jpg","image/webp","image/png"].includes(n.type)||this._uploadFile(t,i)}_mapVersatStock(t){const i=[];for(const n of t)i.push(new Mo(n.C\u00f3digo,n.Descripci\u00f3n,n.UMO,n.cantidad,Number(n.Precio.toFixed(2))));return i}_uploadFile(t,i){this._imagesService.openCropperDialog(t,!0).pipe((0,u.R)(this._unsubscribeAll)).subscribe(n=>{n&&this._productsService.updateProductImages(i.id,n,i.images).subscribe(a=>{this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()})})}waitForPaginatorLoad(){var t=this;return(0,Ze.Z)(function*(){for(;!t._paginator||void 0===t._paginator;)yield new Promise(i=>{setTimeout(i,200)});return t._paginator})()}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-products-list"]],viewQuery:function(i,n){if(1&i&&(e.Gf(g.NW,5),e.Gf(C.YE,5),e.Gf(_a,5),e.Gf(va,5)),2&i){let a;e.iGM(a=e.CRH())&&(n._paginator=a.first),e.iGM(a=e.CRH())&&(n._sort=a.first),e.iGM(a=e.CRH())&&(n.stockFile=a.first),e.iGM(a=e.CRH())&&(n.stockTemplateFile=a.first)}},standalone:!0,features:[e.jDz],decls:65,vars:25,consts:[["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent",3,"ngClass"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","flex-wrap","items-center","gap-2","mt-6","md:fixed","right-8","shrink-0","lg:mt-0","lg:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,""],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"matMenuTriggerFor"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],["productMenu","matMenu"],["mat-menu-item","","matRipple","","routerLink","/warehouse/products/product/new"],[1,"hidden","ml-2","mr-1","sm:block"],["mat-menu-item","","matRipple",""],["for","stock-template-file-input",1,"flex","items-center"],["id","stock-template-file-input","type","file","accept",".xls, .xlsx",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"change"],["stockTemplateFile",""],["mat-menu-item","","matRipple","",3,"click"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-yellow-500","to-yellow-600",3,"matMenuTriggerFor"],[1,"sm:hidden",3,"svgIcon"],[3,"xPosition"],["itemMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-col","justify-between","flex-auto"],["class","relative grid"],[1,"relative","grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","products-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"flex","items-center"],[1,"flex","items-center","justify-start",3,"mat-sort-header"],[1,"flex","items-center","justify-center",3,"mat-sort-header"],["matTooltip","Unidades Vendidas",1,"flex","items-center","justify-center",3,"mat-sort-header"],[1,"pr-4","text-right"],[1,"z-10","border-b","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-gray-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","products-grid","md:px-8"],[1,"relative","flex","items-center","justify-center","w-12","h-12","mr-6","overflow-hidden","border","rounded","flex-0"],["type","file",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"id","multiple","accept","change"],[1,"absolute","w-full","h-full","cursor-pointer",3,"for"],["for","thumbnail-file-input","class","w-11/12 rounded",3,"alt","src"],["class","flex items-center justify-center w-full h-full text-xs font-semibold leading-none text-center uppercase"],[1,"block","truncate"],[1,"truncate"],[1,"flex","flex-row","justify-end","space-x-1"],[1,"font-mono"],[1,"text-xs","text-secondary"],[1,"flex","items-center","justify-end"],[1,"min-w-4"],["class","flex items-end w-1 h-4 ml-2 overflow-hidden bg-red-200 rounded"],["class","flex items-end w-1 h-4 ml-2 overflow-hidden bg-orange-200 rounded"],["class","flex items-end w-1 h-4 ml-2 overflow-hidden bg-green-100 rounded"],[1,"self-start","ml-1","text-xs","text-secondary"],[1,"block","text-center"],[1,"flex","justify-center","mr-3","text-center"],[3,"checked","color"],[3,"diameter","color"],[1,"flex","flex-row","justify-end","gap-2"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],["for","thumbnail-file-input",1,"w-11/12","rounded",3,"alt","src"],[1,"flex","items-center","justify-center","w-full","h-full","text-xs","font-semibold","leading-none","text-center","uppercase"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-red-200","rounded"],[1,"flex","w-full","bg-red-600","h-1/3"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-orange-200","rounded"],[1,"flex","w-full","bg-orange-400","h-2/4"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-green-100","rounded"],[1,"flex","w-full","h-full","bg-green-400"],[3,"checked","color","change"],["class","z-0 grid items-center gap-4 px-6 py-3 bg-white border-b dark:bg-default products-grid md:px-8"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(i,n){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Almac\xe9n"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",7),e._uU(14,"Productos"),e.qZA()()(),e.TgZ(15,"div",8)(16,"h2",9),e._uU(17," Productos "),e.qZA()()(),e.TgZ(18,"div",10)(19,"mat-form-field",11),e._UZ(20,"mat-icon",12)(21,"input",13),e.qZA(),e.TgZ(22,"div",14)(23,"button",15),e._UZ(24,"mat-icon",16),e.TgZ(25,"span",17),e._uU(26,"Agregar"),e.qZA()(),e.TgZ(27,"mat-menu",null,18)(29,"button",19),e._UZ(30,"mat-icon",16),e.TgZ(31,"span",20),e._uU(32,"Crear Producto"),e.qZA()(),e.TgZ(33,"button",21)(34,"label",22),e._UZ(35,"mat-icon",16),e._uU(36," Importar Plantilla de Existencia "),e.qZA(),e.TgZ(37,"input",23,24),e.NdJ("change",function(c){return n.importStockFormTemplateFile(c)}),e.qZA()(),e.TgZ(39,"button",25),e.NdJ("click",function(){return n.exportProductsStockTemplate()}),e._UZ(40,"mat-icon",16),e._uU(41," Descargar Plantilla de Existencia "),e.qZA()()(),e.TgZ(42,"div",14)(43,"button",26),e._UZ(44,"mat-icon",27),e.TgZ(45,"span",17),e._uU(46,"Reportes"),e.qZA()(),e.TgZ(47,"mat-menu",28,29)(49,"button",30),e.NdJ("click",function(){return n.generateReport("Productos Activos")}),e._UZ(50,"mat-icon",16),e._uU(51," Productos Activos "),e.qZA(),e.TgZ(52,"button",30),e.NdJ("click",function(){return n.generateReport("Productos Inactivos")}),e._UZ(53,"mat-icon",16),e._uU(54," Productos Inactivos "),e.qZA(),e.TgZ(55,"button",30),e.NdJ("click",function(){return n.generateReport("Productos Agotados")}),e._UZ(56,"mat-icon",16),e._uU(57," Productos Agotados "),e.qZA(),e.TgZ(58,"button",30),e.NdJ("click",function(){return n.generateReport("Productos en Stock")}),e._UZ(59,"mat-icon",16),e._uU(60," Productos en Stock "),e.qZA()()()()(),e.TgZ(61,"div",31)(62,"div",32),e.YNc(63,Ua,2,1),e.ALo(64,"async"),e.qZA()()()),2&i){const a=e.MAs(28),c=e.MAs(48);let l;e.Q6J("ngClass",e.VKq(23,Pa,n.isLoading)),e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(7),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),e.xp6(2),e.Q6J("matMenuTriggerFor",a),e.xp6(),e.Q6J("svgIcon","mat_solid:expand_more"),e.xp6(6),e.Q6J("svgIcon","mat_solid:add"),e.xp6(5),e.Q6J("svgIcon","mat_solid:upload"),e.xp6(5),e.Q6J("svgIcon","mat_solid:edit_document"),e.xp6(3),e.Q6J("matMenuTriggerFor",c),e.xp6(),e.Q6J("svgIcon","mat_solid:description"),e.xp6(3),e.Q6J("xPosition","before"),e.xp6(3),e.Q6J("svgIcon","mat_solid:description"),e.xp6(3),e.Q6J("svgIcon","mat_solid:description"),e.xp6(3),e.Q6J("svgIcon","mat_solid:description"),e.xp6(3),e.Q6J("svgIcon","mat_solid:description"),e.xp6(4),e.um2(63,(l=e.lcZ(64,21,n.products$))?63:-1,l)}},dependencies:[h.Ov,h.JJ,v.ot,v.lW,m.lN,m.KE,m.qo,y.Ps,y.Hw,Z.c,Z.Nt,ne.Tx,ne.VK,ne.OP,ne.p6,g.TU,g.NW,K.Cq,K.Ou,U.rP,U.Rr,C.JX,C.YE,C.nU,h.mk,s.UX,s.Fj,s.JJ,s.oH,x.rH],encapsulation:2,data:{animation:ga.L},changeDetection:0})}return o})();var Ea=d(58578),Ja=d(98246),nt=d(74595),Ra=d(62660),_e=d(48180);const Kt=o=>o.receptions,rt=((0,A.P1)(Kt,o=>o.reception),(0,A.P1)(Kt,o=>o.receptions));var Ce=d(70445);const Na=T.Ps`
   query FindAllReceptions($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllReceptions(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length,
                size,
                page,
                lastPage,
                startIndex,
                endIndex
            }

            receptions {
                id
                no
                createdAt
                purchaseId
                userId
                obs
                obsSpare
                obsMissing
                obsDamaged

                user {
                    id
                    name
                    fullname
                }

                depotId
                depot {
                    id
                    name
                }


                products {
                    productId
                    quantity
                    quantitySpare
                    quantityMissing
                    quantityDamaged

                    product {
                        id,
                        name
                        uomId
                        uom {
                           id
                           abbr
                        }
                    }
                }

                purchase {
                    id
                    code
                    products {
                        productId
                        cud
                        cui
                        quantity
                    }
                    voucherNo
                    total
                }
            }
        }
    }
`,Qa=T.Ps`
    query FindReceptionById($findReceptionById: String!) {
        findReceptionById(id: $findReceptionById) {
            ok
            message

            reception {
                id
                concept
                warehouse
                no
                nov
                noCtrl
                date
                obs
                entity
                invoice
                currency
                tax
                discount
                services
                rate
                products {
                    upc
                    name
                    price
                    quantity
                    uom
                }
            }
        }
    }
`,La=T.Ps`
    mutation CreateReception($createReceptionInput: CreateReceptionInput!) {
        createReception(createReceptionInput: $createReceptionInput) {
            ok
            message

            reception {
                id
	            no

	            userId
	            purchaseId
	            inspectorId

	            products {
                    productId
	                quantity
	                quantitySpare
	                quantityMissing
	                quantityDamaged
                }

                createdAt

	            obs

	            haveSpare
	            obsSpare

	            haveMissing
	            obsMissing

	            haveDamaged
	            obsDamaged

	            courier {
                    name
	                idNumber
                    company
                    lastname1
                    lastname2
                    licensePlate
                    cargoDocument
                }
            }
        }
    }
`,Wa=T.Ps`
    mutation UpdateReception($updateReceptionInput: UpdateReceptionInput!) {
        updatedReception(updateReceptionInput: $updateReceptionInput) {
            ok
            message

            reception {
                id
                concept
                warehouse
                no
                nov
                noCtrl
                date
                obs
                entity
                invoice
                currency
                tax
                discount
                services
                rate
                products {
                    upc
                    name
                    price
                    quantity
                    uom
                }
            }
        }
    }
`,za=T.Ps`
    mutation RemoveReception($removeReceptionId: String!) {
        removeReception(id: $removeReceptionId) {
            ok
            message
        }
    }
`;let at=(()=>{class o{constructor(t,i,n){this.apolloProvider=t,this._snackBar=i,this.store=n,this._apollo=this.apolloProvider.use("BALANC")}createReception(t){return this._apollo.mutate({mutation:La,variables:{createReceptionInput:t},errorPolicy:"all"}).pipe((0,_.U)(({data:i})=>i?i.createReception:null),(0,F.b)(i=>{i&&(this.store.dispatch((0,Ce.aT)({reception:i.reception})),this.store.dispatch((0,Ce.su)({reception:i.reception})))}))}getReceptions(t=0,i=50,n="no",a="desc",c=""){return this._apollo.query({query:Na,errorPolicy:"all",variables:{page:t,size:i,sort:n,order:a,search:c}}).pipe((0,F.b)(({data:l})=>{l&&(this.store.dispatch((0,Ce.y$)({receptions:l.findAllReceptions.receptions})),this.store.dispatch((0,Te.Jr)({pagination:l.findAllReceptions.pagination})))}))}getReceptionById(t){return this._apollo.query({query:Qa,variables:{findReceptionByIdId:t},errorPolicy:"all"}).pipe((0,F.b)(({data:i})=>{i&&this.store.dispatch((0,Ce.su)({reception:i.findReceptionById.reception}))}))}updateReception(t){return this.store.select(rt).pipe((0,_e.q)(1),(0,f.w)(i=>this._apollo.mutate({mutation:Wa,variables:{updateReceptionInput:t},errorPolicy:"all"}).pipe((0,F.b)(({data:n})=>{this.store.dispatch((0,Ce.jm)({reception:n.updateReception.reception}))}))))}removeReception(t){return this.store.select(rt).pipe((0,_e.q)(1),(0,f.w)(i=>this._apollo.mutate({mutation:za,variables:{removeReceptionId:t},errorPolicy:"all"}).pipe((0,F.b)(({errors:n})=>{if(n){let l="";n.forEach(p=>l+=`\n ${p.message}.`),this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:l,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const a=(0,Ra.Z)(i),c=i.findIndex(l=>l.id===t);a.splice(c,1),this.store.dispatch((0,Ce.y$)({receptions:a}))}))))}static#e=this.\u0275fac=function(i){return new(i||o)(e.LFG(T._M),e.LFG(G.ux),e.LFG(A.yh))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var $a=d(15608),Xt=d(71088);function Ga(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"mat-checkbox",89),e.NdJ("change",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.selectPurchase(a))}),e._uU(2),e.qZA()()}if(2&o){const t=r.$implicit,i=e.oxw(2);e.xp6(),e.Q6J("checked",(null==i.purchaseFormGroup.get("purchase").value?null:i.purchaseFormGroup.get("purchase").value.id)===t.id),e.xp6(),e.hij(" ",t.code," ")}}function Oa(o,r){if(1&o&&e.SjG(0,Ga,3,2,"div",null,e.x6l),2&o){const t=e.oxw();e.wJu(t.purchases)}}function ja(o,r){1&o&&(e.TgZ(0,"div",90),e._uU(1," No se encontraron nuevas facturas de compras "),e.qZA())}const Ba=(o,r)=>({"w-52":o,"w-64":r});function Ha(o,r){if(1&o&&(e.TgZ(0,"div")(1,"mat-radio-button",92),e._uU(2),e.qZA()()),2&o){const t=r.$implicit;e.oxw(2);const i=e.MAs(22);e.xp6(),e.Q6J("value",t)("ngClass",e.WLB(3,Ba,i.offsetWidth>1500,i.offsetWidth<1500)),e.xp6(),e.hij(" ",t.name," ")}}function Va(o,r){if(1&o&&(e.TgZ(0,"mat-radio-group",91),e.SjG(1,Ha,3,6,"div",null,e.x6l),e.qZA()),2&o){const t=e.oxw();e.xp6(),e.wJu(t.depots)}}function Ya(o,r){1&o&&(e.TgZ(0,"div",90),e._uU(1," No se encontraron almacenes "),e.qZA())}function Ka(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"El nombre del transportista es obligatorio "),e.qZA())}function Xa(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"El nombre del transportista no debe pasar los 255 caracteres "),e.qZA())}function es(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"El nombre del transportista no debe contener n\xfameros ni caracteres no alfab\xe9ticos, excepto acentos. "),e.qZA())}function ts(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"El primer apellido del transportista es obligatorio"),e.qZA())}function os(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"El primer apellido del transportista no debe pasar los 255 caracteres"),e.qZA())}function is(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"El primer apellido del transportista no debe contener n\xfameros ni caracteres no alfab\xe9ticos, excepto acentos."),e.qZA())}function ns(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"El segundo apellido del transportista no debe pasar los 255 caracteres"),e.qZA())}function rs(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"El nombre de la empresa es obligatorio"),e.qZA())}function as(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"El nombre de la empresa no debe pasar los 255 caracteres"),e.qZA())}function ss(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"El nombre de la empresa no debe contener n\xfameros ni caracteres no alfab\xe9ticos, excepto acentos."),e.qZA())}function cs(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"El n\xfamero de identificaci\xf3n del transportista debe tener 11 d\xedgitos."),e.qZA())}function ls(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"La chapa del veh\xedculo no debe pasar los 255 caracteres"),e.qZA())}function ds(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"La chapa del veh\xedculo no debe contener caracteres no alfanum\xe9ricos."),e.qZA())}function us(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"El n\xfamero de Carta Porte o Documento no debe pasar los 255 caracteres"),e.qZA())}const eo=(o,r)=>r.id;function ps(o,r){1&o&&(e.TgZ(0,"mat-error",105),e._uU(1," Valor m\xednimo 0 "),e.qZA())}function ms(o,r){1&o&&(e.TgZ(0,"mat-error",105),e._uU(1," Valor requerido "),e.qZA())}function hs(o,r){1&o&&(e.TgZ(0,"mat-error",105),e._uU(1," Valor m\xednimo 0 "),e.qZA())}function gs(o,r){1&o&&(e.TgZ(0,"mat-error",105),e._uU(1," Valor requerido "),e.qZA())}function fs(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Cantidad excedida "),e.qZA())}function _s(o,r){1&o&&(e.TgZ(0,"mat-error",105),e._uU(1," Valor m\xednimo 0 "),e.qZA())}function vs(o,r){1&o&&(e.TgZ(0,"mat-error",105),e._uU(1," Valor requerido "),e.qZA())}function xs(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Cantidad excedida "),e.qZA())}function bs(o,r){if(1&o&&(e.TgZ(0,"div",98)(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"div",99),e._uU(4),e.qZA(),e.TgZ(5,"div",100),e._uU(6),e.qZA(),e.TgZ(7,"div",96),e._uU(8),e.ALo(9,"number"),e.qZA(),e.TgZ(10,"div",101)(11,"mat-form-field",102),e._UZ(12,"input",103),e.qZA(),e.YNc(13,ps,2,0,"mat-error",104)(14,ms,2,0,"mat-error",104),e.qZA(),e.TgZ(15,"div",101)(16,"mat-form-field",102),e._UZ(17,"input",103),e.qZA(),e.YNc(18,hs,2,0,"mat-error",104)(19,gs,2,0,"mat-error",104)(20,fs,2,0,"mat-error"),e.qZA(),e.TgZ(21,"div",101)(22,"mat-form-field",102),e._UZ(23,"input",103),e.qZA(),e.YNc(24,_s,2,0,"mat-error",104)(25,vs,2,0,"mat-error",104)(26,xs,2,0,"mat-error"),e.qZA()()),2&o){const t=r.$implicit,i=r.$index;e.xp6(2),e.hij(" ",i+1," "),e.xp6(),e.Q6J("matTooltip",t.get("name").value),e.xp6(),e.hij(" ",t.get("name").value," "),e.xp6(2),e.hij(" ",t.get("uom").value," "),e.xp6(2),e.hij(" ",e.xi3(9,25,t.get("quantity").value,"1.0-4")," "),e.xp6(3),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("min",0)("max",9999999)("formControl",t.get("quantitySpare")),e.xp6(),e.um2(13,t.get("quantitySpare").hasError("min")?13:-1),e.xp6(),e.um2(14,t.get("quantitySpare").hasError("required")?14:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("min",0)("max",t.get("quantity").value)("formControl",t.get("quantityMissing")),e.xp6(),e.um2(18,t.get("quantityMissing").hasError("min")?18:-1),e.xp6(),e.um2(19,t.get("quantityMissing").hasError("required")?19:-1),e.xp6(),e.um2(20,t.hasError("totalQuantityExceeded")||t.get("quantityMissing").hasError("max")?20:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("min",0)("max",t.get("quantity").value)("formControl",t.get("quantityDamaged")),e.xp6(),e.um2(24,t.get("quantityDamaged").hasError("min")?24:-1),e.xp6(),e.um2(25,t.get("quantityDamaged").hasError("required")?25:-1),e.xp6(),e.um2(26,t.hasError("totalQuantityExceeded")||t.get("quantityDamaged").hasError("max")?26:-1)}}function Cs(o,r){if(1&o&&(e.TgZ(0,"div",93)(1,"div",94),e._UZ(2,"div"),e.TgZ(3,"div",95),e._uU(4," Producto "),e.qZA(),e.TgZ(5,"div",95),e._uU(6," UM "),e.qZA(),e.TgZ(7,"div",96),e._uU(8," Cantidad "),e.qZA(),e.TgZ(9,"div",96),e._uU(10," Sobrante "),e.qZA(),e.TgZ(11,"div",96),e._uU(12," Faltante "),e.qZA(),e.TgZ(13,"div",96),e._uU(14," Averiada "),e.qZA()(),e.SjG(15,bs,27,28,"div",106,eo),e.TgZ(17,"div",97),e._UZ(18,"div"),e.TgZ(19,"div"),e._uU(20),e.qZA(),e._UZ(21,"div"),e.TgZ(22,"div",96),e._uU(23),e.ALo(24,"currency"),e.qZA(),e.TgZ(25,"div",96),e._uU(26),e.ALo(27,"currency"),e.qZA(),e.TgZ(28,"div",96),e._uU(29),e.ALo(30,"currency"),e.qZA(),e.TgZ(31,"div",96),e._uU(32),e.ALo(33,"currency"),e.qZA()()()),2&o){const t=e.oxw();e.xp6(15),e.wJu(t.productsFormGroup.get("products").controls),e.xp6(5),e.hij("Costos Totales ",null==t.purchaseFormGroup.get("purchase").value?null:t.purchaseFormGroup.get("purchase").value.currency.iso,""),e.xp6(3),e.hij(" ",e.xi3(24,5,t.productsFormGroup.get("totals").get("ct").value,"$ ")," "),e.xp6(3),e.hij(" ",e.xi3(27,8,t.productsFormGroup.get("totals").get("ctSpare").value,"$ ")," "),e.xp6(3),e.hij(" ",e.xi3(30,11,t.productsFormGroup.get("totals").get("ctMissing").value,"$ ")," "),e.xp6(3),e.hij(" ",e.xi3(33,14,t.productsFormGroup.get("totals").get("ctDamaged").value,"$ ")," ")}}function ys(o,r){1&o&&(e.TgZ(0,"div",107),e._uU(1," \xa1No ha seleccionado ning\xfan producto a\xfan! "),e.qZA())}function Zs(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Las observaciones no deben pasar los 5000 caracteres "),e.qZA())}function Ts(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Las observaciones sobre sobrante son obligatorias si tienes repuestos. "),e.qZA())}function As(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Las observaciones sobre sobrante no deben pasar los 5000 caracteres "),e.qZA())}function Is(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Las observaciones sobre faltantes son obligatorias si tienes faltantes. "),e.qZA())}function ks(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Las observaciones sobre faltantes no deben pasar los 5000 caracteres "),e.qZA())}function ws(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Las observaciones sobre aver\xedas son obligatorias si tienes da\xf1os. "),e.qZA())}function qs(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Las observaciones sobre aver\xedas no deben pasar los 5000 caracteres "),e.qZA())}function Fs(o,r){if(1&o&&(e.TgZ(0,"div",74)(1,"span"),e._uU(2,", "),e.qZA(),e.TgZ(3,"span",76),e._uU(4),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(4),e.Oqu(t.carrierForm.get("idNumber").value)}}function Ss(o,r){if(1&o&&(e.TgZ(0,"div",74)(1,"span",109),e._uU(2," Carta Porte:"),e.qZA(),e.TgZ(3,"span",76),e._uU(4),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(4),e.hij("",t.carrierForm.get("cargoDocument").value," ")}}function Ds(o,r){if(1&o&&(e.TgZ(0,"div",108)(1,"div",74)(2,"span",109),e._uU(3,"Empresa Transportista:"),e.qZA(),e.TgZ(4,"span",76),e._uU(5),e.qZA()(),e.TgZ(6,"div",74)(7,"div",74)(8,"span",109),e._uU(9,"Chofer:"),e.qZA(),e.TgZ(10,"span",76),e._uU(11),e.qZA()(),e.YNc(12,Fs,5,1,"div",110),e.qZA(),e.YNc(13,Ss,5,1,"div",110),e.qZA()),2&o){const t=e.oxw();e.xp6(5),e.hij("",t.carrierForm.get("company").value," "),e.xp6(6),e.lnq("",t.carrierForm.get("name").value," ",t.carrierForm.get("lastname1").value," ",t.carrierForm.get("lastname2").value," "),e.xp6(),e.um2(12,t.carrierForm.get("idNumber").value?12:-1),e.xp6(),e.um2(13,t.carrierForm.get("cargoDocument").value?13:-1)}}function Us(o,r){if(1&o&&(e.TgZ(0,"div",98)(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"div",100),e._uU(4),e.qZA(),e.TgZ(5,"div",100),e._uU(6),e.qZA(),e.TgZ(7,"div",96),e._uU(8),e.ALo(9,"number"),e.qZA(),e.TgZ(10,"div",96),e._uU(11),e.ALo(12,"number"),e.qZA(),e.TgZ(13,"div",96),e._uU(14),e.ALo(15,"number"),e.qZA(),e.TgZ(16,"div",96),e._uU(17),e.ALo(18,"number"),e.qZA()()),2&o){const t=r.$implicit,i=r.$index;e.xp6(2),e.hij(" ",i+1," "),e.xp6(2),e.hij(" ",t.get("name").value," "),e.xp6(2),e.hij(" ",t.get("uom").value," "),e.xp6(2),e.hij(" ",e.xi3(9,7,t.get("quantity").value,"1.0-4")," "),e.xp6(3),e.hij(" ",e.xi3(12,10,t.get("quantitySpare").value,"1.0-4")," "),e.xp6(3),e.hij(" ",e.xi3(15,13,t.get("quantityMissing").value,"1.0-4")," "),e.xp6(3),e.hij(" ",e.xi3(18,16,t.get("quantityDamaged").value,"1.0-4")," ")}}function Ps(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",81)(1,"span",75),e._uU(2,"Cantidades"),e.qZA(),e.TgZ(3,"button",78),e.NdJ("click",function(){e.CHM(t),e.oxw();const n=e.MAs(18);return e.KtG(n.selectedIndex=1)}),e._UZ(4,"mat-icon",79),e.qZA()(),e.TgZ(5,"div",111)(6,"div",112),e._UZ(7,"div"),e.TgZ(8,"div",95),e._uU(9," Producto "),e.qZA(),e.TgZ(10,"div",95),e._uU(11," UM "),e.qZA(),e.TgZ(12,"div",96),e._uU(13," Cantidad "),e.qZA(),e.TgZ(14,"div",96),e._uU(15," Sobrante "),e.qZA(),e.TgZ(16,"div",96),e._uU(17," Faltante "),e.qZA(),e.TgZ(18,"div",96),e._uU(19," Averiada "),e.qZA()(),e.SjG(20,Us,19,19,"div",106,eo),e.TgZ(22,"div",112),e._UZ(23,"div"),e.TgZ(24,"div"),e._uU(25),e.qZA(),e._UZ(26,"div"),e.TgZ(27,"div",96),e._uU(28),e.ALo(29,"currency"),e.qZA(),e.TgZ(30,"div",96),e._uU(31),e.ALo(32,"currency"),e.qZA(),e.TgZ(33,"div",96),e._uU(34),e.ALo(35,"currency"),e.qZA(),e.TgZ(36,"div",96),e._uU(37),e.ALo(38,"currency"),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("svgIcon","mat_solid:edit"),e.xp6(16),e.wJu(t.productsFormGroup.get("products").controls),e.xp6(5),e.hij("Costos Totales ",null==t.purchaseFormGroup.get("purchase").value?null:t.purchaseFormGroup.get("purchase").value.currency.iso,""),e.xp6(3),e.hij(" ",e.xi3(29,6,t.productsFormGroup.get("totals").get("ct").value,"$ ")," "),e.xp6(3),e.hij(" ",e.xi3(32,9,t.productsFormGroup.get("totals").get("ctSpare").value,"$ ")," "),e.xp6(3),e.hij(" ",e.xi3(35,12,t.productsFormGroup.get("totals").get("ctMissing").value,"$ ")," "),e.xp6(3),e.hij(" ",e.xi3(38,15,t.productsFormGroup.get("totals").get("ctDamaged").value,"$ ")," ")}}function Ms(o,r){1&o&&(e.TgZ(0,"div",107),e._uU(1," \xa1No ha seleccionado ning\xfan producto a\xfan! "),e.qZA())}function Es(o,r){1&o&&(e.TgZ(0,"span",113),e._uU(1," Sin observaciones "),e.qZA())}function Js(o,r){if(1&o&&(e.TgZ(0,"div",114)(1,"span",109),e._uU(2,"Observaciones generales"),e.qZA(),e.TgZ(3,"div",113),e._uU(4),e.qZA()()),2&o){const t=e.oxw();e.xp6(4),e.hij(" ",t.observationFormGroup.get("obs").value," ")}}function Rs(o,r){if(1&o&&(e.TgZ(0,"div",114)(1,"span",109),e._uU(2,"Observaciones sobre sobrantes"),e.qZA(),e.TgZ(3,"div",113),e._uU(4),e.qZA()()),2&o){const t=e.oxw();e.xp6(4),e.hij(" ",t.observationFormGroup.get("obsSpare").value," ")}}function Ns(o,r){if(1&o&&(e.TgZ(0,"div",114)(1,"span",109),e._uU(2,"Observaciones sobre faltantes"),e.qZA(),e.TgZ(3,"div",113),e._uU(4),e.qZA()()),2&o){const t=e.oxw();e.xp6(4),e.hij(" ",t.observationFormGroup.get("obsMissing").value," ")}}function Qs(o,r){if(1&o&&(e.TgZ(0,"div",114)(1,"span",109),e._uU(2,"Observaciones sobre aver\xedas"),e.qZA(),e.TgZ(3,"div",113),e._uU(4),e.qZA()()),2&o){const t=e.oxw();e.xp6(4),e.hij(" ",t.observationFormGroup.get("obsDamaged").value," ")}}const Ls=o=>({"grid stepper-reception-general-data-grid grid-cols-3":o}),st=()=>({suppressScrollX:!0}),Ws=(o,r)=>({"pointer-events-none":o,hidden:r}),zs=()=>[10,25,50,100],ct=o=>({"stepper-reception-form-grid":o});let $s=(()=>{class o{constructor(t,i,n,a,c,l,p,b,I,j,Y){this._changeDetectorRef=t,this._fuseConfirmationService=i,this._snackBar=n,this._receptionsService=a,this._router=c,this.store=l,this._purchasesService=p,this._depotsService=b,this._formBuilder=I,this.stepperIntl=Y,this.isLoading=!1,this.purchaseSearchInputControl=new s.NI(null),this.depotSearchInputControl=new s.NI(null),this._unsubscribeAll=new E.x,this.stepperIntl.optionalLabel="Opcional",this.stepperOrientation=j.observe("(min-width: 800px)").pipe((0,_.U)(({matches:le})=>le?"horizontal":"vertical"))}ngOnInit(){this.depotFormGroup=this._formBuilder.group({depot:[null,s.kI.required]}),this.purchaseFormGroup=this._formBuilder.group({checked:[!1],purchase:[null,s.kI.required]});const t=/^[a-zA-Z\xc0-\xd6\xd8-\xf6\xf8-\xff\s']+$/u;this.carrierForm=this._formBuilder.group({name:["",[s.kI.required,s.kI.pattern(t),s.kI.maxLength(255)]],company:["",[s.kI.required,s.kI.pattern(t),s.kI.maxLength(255)]],lastname1:["",[s.kI.required,s.kI.maxLength(255),te.L.onlyAlphabetsWithAccentPattern()]],lastname2:["",[s.kI.maxLength(255),te.L.onlyAlphabetsWithAccentPattern()]],idNumber:["",[s.kI.minLength(11),s.kI.maxLength(11)]],licensePlate:["",[s.kI.maxLength(255),s.kI.pattern(/^[a-zA-Z0-9]+$/)]],cargoDocument:["",[s.kI.maxLength(255)]]}),this.carrierForm.disable(),this.generalDataFormGroup=this._formBuilder.group({isThirdCompany:[!1],depot:this.depotFormGroup,purchase:this.purchaseFormGroup,courier:this.carrierForm}),this.productsFormGroup=this._formBuilder.group({totals:this._formBuilder.group({ct:[0],ctSpare:[0],ctMissing:[0],ctDamaged:[0]}),products:new s.Oe([])}),this.observationFormGroup=this._formBuilder.group({obs:["",[s.kI.maxLength(5e3)]],haveSpare:[!1],obsSpare:["",[s.kI.maxLength(5e3)]],haveMissing:[!1],obsMissing:["",[s.kI.maxLength(5e3)]],haveDamaged:[!1],obsDamaged:["",[s.kI.maxLength(5e3)]]}),this.store.select(se.rk).pipe((0,u.R)(this._unsubscribeAll)).subscribe(n=>{this.employee=n.employee}),this.store.select(Ea.pk).pipe((0,u.R)(this._unsubscribeAll)).subscribe(n=>{this.purchases=n,this._changeDetectorRef.markForCheck()}),this.store.select(W.$I).pipe((0,u.R)(this._unsubscribeAll)).subscribe(n=>{this.depots=n,this._changeDetectorRef.markForCheck()}),this.store.select(ae.B).pipe((0,u.R)(this._unsubscribeAll)).subscribe(n=>{this.pagination=n,this._changeDetectorRef.markForCheck()}),this.purchaseSearchInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,q.b)(300),(0,f.w)(n=>this._purchasesService.findPurchases(n.trim(),Ja.L0.nueva))).subscribe(),this.depotSearchInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,q.b)(300),(0,f.w)(n=>this._depotsService.findActiveDepots(n.trim()))).subscribe(),this.purchaseFormGroup.get("purchase").valueChanges.pipe((0,u.R)(this._unsubscribeAll)).subscribe(n=>{this.productsFormGroup.get("products").clear(),n&&n.products.map(c=>this.createProductFormGroup(c)).forEach(c=>{this.productsFormGroup.get("products").push(c)})}),this.productsFormGroup.get("products").valueChanges.pipe((0,u.R)(this._unsubscribeAll)).subscribe(n=>{const a=n.reduce((b,I)=>b+I.quantitySpare,0),c=n.reduce((b,I)=>b+I.quantityMissing,0),l=n.reduce((b,I)=>b+I.quantityDamaged,0);a>0?this.observationFormGroup.get("haveSpare").setValue(!0):this.observationFormGroup.get("haveSpare").setValue(!1),c>0?this.observationFormGroup.get("haveMissing").setValue(!0):this.observationFormGroup.get("haveMissing").setValue(!1),l>0?this.observationFormGroup.get("haveDamaged").setValue(!0):this.observationFormGroup.get("haveDamaged").setValue(!1);const p={ct:n.reduce((b,I)=>b+(I.cud+I.cui)*I.quantity,0),ctSpare:n.reduce((b,I)=>b+(I.cud+I.cui)*I.quantitySpare,0),ctMissing:n.reduce((b,I)=>b+(I.cud+I.cui)*I.quantityMissing,0),ctDamaged:n.reduce((b,I)=>b+(I.cud+I.cui)*I.quantityDamaged,0)};this.productsFormGroup.get("totals").patchValue(p,{emitEvent:!1})}),this.generalDataFormGroup.get("isThirdCompany").valueChanges.pipe((0,u.R)(this._unsubscribeAll)).subscribe(n=>{const a=this.carrierForm.get("name"),c=this.carrierForm.get("company"),l=this.carrierForm.get("lastname1");n?(a.setValidators([s.kI.required,s.kI.pattern(t),s.kI.maxLength(255)]),c.setValidators([s.kI.required,s.kI.pattern(t),s.kI.maxLength(255)]),l.setValidators([s.kI.required,s.kI.maxLength(255),te.L.onlyAlphabetsWithAccentPattern()]),this.carrierForm.enable()):(this.carrierForm.disable(),a.setValidators(null),c.setValidators(null),l.setValidators(null),this.carrierForm.reset()),this.carrierForm.updateValueAndValidity()}),this.observationFormGroup.get("haveSpare").valueChanges.pipe((0,u.R)(this._unsubscribeAll)).subscribe(n=>{const a=this.observationFormGroup.get("obsSpare");n?(a.enable(),a.setValidators([s.kI.required,s.kI.maxLength(5e3)])):(a.disable(),a.setValue(""),a.setValidators(null)),a.updateValueAndValidity()}),this.observationFormGroup.get("haveMissing").valueChanges.pipe((0,u.R)(this._unsubscribeAll)).subscribe(n=>{const a=this.observationFormGroup.get("obsMissing");n?(a.enable(),a.setValidators([s.kI.required,s.kI.maxLength(5e3)])):(a.disable(),a.setValue(""),a.setValidators(null)),a.updateValueAndValidity()}),this.observationFormGroup.get("haveDamaged").valueChanges.pipe((0,u.R)(this._unsubscribeAll)).subscribe(n=>{const a=this.observationFormGroup.get("obsDamaged");n?(a.enable(),a.setValidators([s.kI.required,s.kI.maxLength(5e3)])):(a.disable(),a.setValue(""),a.setValidators(null)),a.updateValueAndValidity(),this._changeDetectorRef.markForCheck()})}ngAfterViewInit(){this._paginator&&(this._changeDetectorRef.markForCheck(),(0,B.T)(this._paginator.page).pipe((0,f.w)(()=>(this.isLoading=!0,this._purchasesService.getPurchases(this._paginator.pageIndex,this._paginator.pageSize,"code","asc",this.purchaseSearchInputControl.value))),(0,_.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}selectPurchase(t){this.purchaseFormGroup.get("checked").value?this.purchaseFormGroup.get("purchase").setValue(t):this.purchaseFormGroup.get("purchase").setValue(null)}saveReception(){const t=this.productsFormGroup.getRawValue().products;t.forEach(l=>{delete l.name,delete l.uom,delete l.cud,delete l.cui});const i=this.purchaseFormGroup.getRawValue().purchase,n=this.observationFormGroup.getRawValue(),a=this.depotFormGroup.getRawValue().depot;n.products=t,n.purchaseId=i.id,n.depotId=a.id,n.courier=this.carrierForm.getRawValue(),this._fuseConfirmationService.open({title:"Registrar Recepci\xf3n",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,u.R)(this._unsubscribeAll)).subscribe(l=>{"confirmed"===l&&(this.isLoading=!0,this._receptionsService.createReception(n).pipe((0,u.R)(this._unsubscribeAll),(0,re.x)(()=>{this.isLoading=!1,this._changeDetectorRef.markForCheck()})).subscribe(p=>{p&&(this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:p.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.purchaseSearchInputControl.setValue(""),this.stepper.reset())}))})}printPage(){window.print()}createProductFormGroup(t){return this._formBuilder.group({productId:[t.productId,[s.kI.required]],name:[t.product.name],uom:[t.product.uom.abbr],cud:[t.cud],cui:[t.cui],quantity:[t.quantity,[s.kI.required]],quantitySpare:[0,[s.kI.required,s.kI.min(0),s.kI.max(9999999)]],quantityMissing:[0,[s.kI.required,s.kI.min(0),s.kI.max(t.quantity)]],quantityDamaged:[0,[s.kI.required,s.kI.min(0),s.kI.max(t.quantity)]]},{validators:this.totalQuantityValidator()})}totalQuantityValidator(){return t=>{const i=t.get("quantity")?.value,n=t.get("quantityMissing")?.value,a=t.get("quantityDamaged")?.value;return n+a>i?{totalQuantityExceeded:!0}:null}}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(e.sBO),e.Y36(H.R),e.Y36(G.ux),e.Y36(at),e.Y36(x.F0),e.Y36(A.yh),e.Y36($a.F),e.Y36(he.Y),e.Y36(s.qu),e.Y36(Xt.Yg),e.Y36(O.$c))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-reception"]],viewQuery:function(i,n){if(1&i&&(e.Gf(O.Vq,5),e.Gf(g.NW,5)),2&i){let a;e.iGM(a=e.CRH())&&(n.stepper=a.first),e.iGM(a=e.CRH())&&(n._paginator=a.first)}},standalone:!0,features:[e.jDz],decls:212,vars:147,consts:[[1,"flex","flex-col","flex-auto","min-w-0","overflow-auto","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","pb-3","print:hidden","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-7"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["linear","",1,"h-full","sm:overflow-auto",3,"orientation"],["stepper",""],["label","Datos Generales",3,"stepControl"],[1,"flex","flex-col","h-full","sm:px-4",3,"ngClass"],["gContent",""],[1,"flex","flex-col","col-start-1","row-start-1","justify-evenly"],[1,"py-6","text-2xl","font-semibold","text-center","truncate","sm:py-0"],[1,"flex","items-center","justify-center","w-full"],["appearance","fill",1,"fuse-mat-dense","fuse-mat-rounded","min-w-52",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["fuseScrollbar","",1,"grid","h-full","col-start-1","row-start-2","reception-purchase-grid",3,"fuseScrollbarOptions"],[1,"h-full","px-6",3,"formGroup"],[1,"flex","flex-wrap","justify-center","gap-6","py-4"],[1,"border-b","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-gray-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"flex","flex-col","col-start-2","row-start-1","justify-evenly"],[1,"sticky","top-0","z-10","flex","items-center","justify-center","w-full"],["appearance","fill",1,"fuse-mat-dense","min-w-52","fuse-mat-rounded",3,"subscriptSizing"],["fuseScrollbar","",1,"h-full","col-start-2","row-start-2","px-6","border-x",3,"formGroup","fuseScrollbarOptions"],["class","flex flex-wrap justify-center w-full gap-6 py-4","formControlName","depot"],[1,"flex","flex-col","justify-between","col-start-3","row-start-1"],[1,"py-6","mt-3","text-2xl","font-semibold","text-center","truncate","sm:py-0"],["color","primary",1,"self-center",3,"formControl"],["fuseScrollbar","",1,"grid","h-full","col-start-3","row-start-2","gap-3","p-6","sm:grid-cols-2",3,"formGroup","fuseScrollbarOptions"],["appearance","fill",1,"w-full","fuse-mat-dense",3,"subscriptSizing"],["for","name"],["matInput","","type","text","id","name","formControlName","name",3,"maxlength","required"],["for","lastname1"],["matInput","","type","text","id","lastname1","formControlName","lastname1",3,"maxlength","required"],["for","lastname2"],["matInput","","type","text","id","lastname2","formControlName","lastname2",3,"maxLength"],["for","company"],["matInput","","type","text","id","company","formControlName","company",3,"required","maxlength"],["for","idNumber"],["matInput","","type","text","id","idNumber","formControlName","idNumber",3,"minlength","maxlength"],["for","licensePlate"],["matInput","","type","text","id","licensePlate","formControlName","licensePlate",3,"maxlength"],["for","cargoDocument"],["matInput","","type","text","id","cargoDocument","formControlName","cargoDocument",3,"maxlength"],[1,"flex","items-center","justify-end","col-span-3","row-start-3","gap-x-4"],["color","primary","mat-flat-button","","matStepperNext","",3,"disabled"],["label","Cantidades Recibidas",3,"stepControl"],[1,"grid","h-full","grid-cols-1","pt-4","sm:px-4",3,"ngClass"],["fuseScrollbar","",1,"h-full","pb-6"],["class","grid ","fuseScrollbar",""],[1,"flex","items-center","justify-end","gap-x-4"],["mat-button","","matStepperPrevious",""],["label","Observaciones",3,"stepControl","optional"],["fuseScrollbar","",1,"grid","w-full","gap-4","px-4","pb-6","lg:grid-cols-4","sm:gap-6",3,"formGroup"],[1,"lg:col-span-2"],[1,"w-full","fuse-mat-textarea",3,"subscriptSizing"],["matInput","","matTextareaAutosize","",3,"formControlName","maxlength","rows","spellcheck"],["obs",""],[1,"w-full","text-right"],["matInput","","matTextareaAutosize","",3,"formControlName","rows","spellcheck","maxlength","required","disabled"],["obsSpare",""],["matInput","","matTextareaAutosize","",3,"formControlName","rows","spellcheck","maxlength","required"],["obsMissing",""],["obsDamaged",""],["label","Resumen",3,"stepControl"],["fuseScrollbar","",1,"flex","flex-col","justify-between","p-10","pt-8","print:row-span-2","bg-gray-50","dark:bg-primary","dark:bg-opacity-5"],[1,"flex","flex-col","w-full","gap-2"],[1,"flex","flex-row","items-center"],[1,"flex","flex-col","gap-x-6"],[1,"flex","flex-row","gap-10"],[1,"flex","flex-row"],[1,"font-bold"],[1,"ml-2"],["class","mt-2"],["mat-icon-button","",1,"print:hidden",3,"click"],[1,"icon-size-4",3,"svgIcon"],[1,""],[1,"flex","flex-row","items-center","gap-1"],["class","text-secondary"],[1,"flex","flex-col","gap-2"],["class","flex flex-col text-md"],[1,"mt-10","font-serif"],[1,"flex","items-center","justify-end","print:hidden","gap-x-4"],["mat-button","",3,"click"],["color","primary","mat-flat-button","",3,"disabled","click"],["color","primary","formControlName","checked",1,"w-52",3,"checked","change"],[1,"w-full","p-10","text-2xl","font-medium","text-center","sm:col-span-2"],["formControlName","depot",1,"flex","flex-wrap","justify-center","w-full","gap-6","py-4"],["color","primary",1,"line-clamp-2",3,"value","ngClass"],["fuseScrollbar","",1,"grid"],[1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","reception-form-products-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-primary","dark:bg-opacity-5"],[1,"text-left"],[1,"text-center"],[1,"sticky","bottom-0","z-10","grid","gap-4","px-6","py-4","font-semibold","reception-form-products-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-primary","dark:bg-opacity-5"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","reception-form-products-grid","md:px-8"],[1,"truncate",3,"matTooltip"],[1,"truncate"],[1,"flex","flex-col","items-center","justify-center"],[1,"fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],["matInput","","type","number",1,"font-mono","font-semibold","text-center",3,"min","max","formControl"],["class","w-full text-sm text-center"],[1,"w-full","text-sm","text-center"],["class","grid items-center gap-4 px-6 py-3 border-b reception-form-products-grid md:px-8"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-30"],[1,"mt-2"],[1,"font-semibold"],["class","flex flex-row"],[1,"grid"],[1,"grid","gap-4","px-6","py-4","font-semibold","bg-gray-100","reception-form-products-grid","md:px-8","text-md","text-secondary","dark:bg-primary","dark:bg-opacity-5"],[1,"text-secondary"],[1,"flex","flex-col","text-md"]],template:function(i,n){if(1&i){const a=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",3)(5,"div")(6,"a",4),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Almac\xe9n"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",7),e._uU(15,"Recepci\xf3n"),e.qZA()()()()(),e._UZ(16,"div",8),e.qZA(),e.TgZ(17,"mat-stepper",9,10),e.ALo(19,"async"),e.TgZ(20,"mat-step",11)(21,"div",12,13),e.ALo(23,"async"),e.TgZ(24,"div",14)(25,"span",15),e._uU(26,"Seleccionar Factura"),e.qZA(),e.TgZ(27,"div",16)(28,"mat-form-field",17),e._UZ(29,"mat-icon",18)(30,"input",19),e.qZA()()(),e.TgZ(31,"div",20)(32,"form",21)(33,"div",22),e.YNc(34,Oa,2,0)(35,ja,2,0),e.qZA()(),e._UZ(36,"mat-paginator",23),e.qZA(),e.TgZ(37,"div",24)(38,"span",15),e._uU(39,"Seleccionar Almac\xe9n"),e.qZA(),e.TgZ(40,"div",25)(41,"mat-form-field",26),e._UZ(42,"mat-icon",18)(43,"input",19),e.qZA()()(),e.TgZ(44,"form",27),e.YNc(45,Va,3,0,"mat-radio-group",28)(46,Ya,2,0),e.qZA(),e.TgZ(47,"div",29)(48,"span",30),e._uU(49,"Transportista"),e.qZA(),e.TgZ(50,"mat-checkbox",31),e._uU(51," \xbfHa transportado esta compra un tercero? "),e.qZA()(),e.TgZ(52,"form",32)(53,"div")(54,"mat-form-field",33)(55,"mat-label",34),e._uU(56,"Nombre"),e.qZA(),e._UZ(57,"input",35),e.YNc(58,Ka,2,0,"mat-error")(59,Xa,2,0,"mat-error")(60,es,2,0,"mat-error"),e.qZA()(),e.TgZ(61,"div")(62,"mat-form-field",33)(63,"mat-label",36),e._uU(64," Primer Apellido"),e.qZA(),e._UZ(65,"input",37),e.YNc(66,ts,2,0,"mat-error")(67,os,2,0,"mat-error")(68,is,2,0,"mat-error"),e.qZA()(),e.TgZ(69,"div")(70,"mat-form-field",33)(71,"mat-label",38),e._uU(72,"Segundo Apellido"),e.qZA(),e._UZ(73,"input",39),e.YNc(74,ns,2,0,"mat-error"),e.qZA()(),e.TgZ(75,"div")(76,"mat-form-field",33)(77,"mat-label",40),e._uU(78,"Empresa"),e.qZA(),e._UZ(79,"input",41),e.YNc(80,rs,2,0,"mat-error")(81,as,2,0,"mat-error")(82,ss,2,0,"mat-error"),e.TgZ(83,"mat-hint"),e._uU(84," Nombre de la Empresa Transportista"),e.qZA()()(),e.TgZ(85,"div")(86,"mat-form-field",33)(87,"mat-label",42),e._uU(88,"N\xfamero de Identificaci\xf3n"),e.qZA(),e._UZ(89,"input",43),e.YNc(90,cs,2,0,"mat-error"),e.qZA()(),e.TgZ(91,"div")(92,"mat-form-field",33)(93,"mat-label",44),e._uU(94,"Chapa del Veh\xedculo"),e.qZA(),e._UZ(95,"input",45),e.YNc(96,ls,2,0,"mat-error")(97,ds,2,0,"mat-error"),e.qZA()(),e.TgZ(98,"div")(99,"mat-form-field",33)(100,"mat-label",46),e._uU(101,"N\xfamero de Carta Porte"),e.qZA(),e._UZ(102,"input",47),e.YNc(103,us,2,0,"mat-error"),e.TgZ(104,"mat-hint"),e._uU(105,"N\xfamero de Carta Porte o Documento"),e.qZA()()()(),e.TgZ(106,"div",48)(107,"button",49),e._uU(108,"Siguiente"),e.qZA()()()(),e.TgZ(109,"mat-step",50)(110,"div",51),e.ALo(111,"async"),e.TgZ(112,"div",52),e.YNc(113,Cs,34,17,"div",53)(114,ys,2,0),e.qZA(),e.TgZ(115,"div",54)(116,"button",55),e._uU(117,"Atr\xe1s"),e.qZA(),e.TgZ(118,"button",49),e._uU(119,"Siguiente"),e.qZA()()()(),e.TgZ(120,"mat-step",56)(121,"div",51),e.ALo(122,"async"),e.TgZ(123,"form",57)(124,"div",58)(125,"mat-form-field",59)(126,"mat-label"),e._uU(127,"Observaci\xf3n General"),e.qZA(),e._UZ(128,"textarea",60,61),e.YNc(130,Zs,2,0,"mat-error"),e.TgZ(131,"mat-hint",62),e._uU(132),e.qZA()()(),e.TgZ(133,"div",58)(134,"mat-form-field",59)(135,"mat-label"),e._uU(136,"Observaciones sobre Sobrantes"),e.qZA(),e._UZ(137,"textarea",63,64),e.YNc(139,Ts,2,0,"mat-error")(140,As,2,0,"mat-error"),e.TgZ(141,"mat-hint",62),e._uU(142),e.qZA()()(),e.TgZ(143,"div",58)(144,"mat-form-field",59)(145,"mat-label"),e._uU(146,"Observaciones sobre Faltantes"),e.qZA(),e._UZ(147,"textarea",65,66),e.YNc(149,Is,2,0,"mat-error")(150,ks,2,0,"mat-error"),e.TgZ(151,"mat-hint",62),e._uU(152),e.qZA()()(),e.TgZ(153,"div",58)(154,"mat-form-field",59)(155,"mat-label"),e._uU(156,"Observaciones de Aver\xedas"),e.qZA(),e._UZ(157,"textarea",65,67),e.YNc(159,ws,2,0,"mat-error")(160,qs,2,0,"mat-error"),e.TgZ(161,"mat-hint",62),e._uU(162),e.qZA()()()(),e.TgZ(163,"div",54)(164,"button",55),e._uU(165,"Atr\xe1s"),e.qZA(),e.TgZ(166,"button",49),e._uU(167,"Siguiente"),e.qZA()()()(),e.TgZ(168,"mat-step",68)(169,"div",51),e.ALo(170,"async"),e.TgZ(171,"div",69)(172,"div",70)(173,"div",71)(174,"div",72)(175,"div",73)(176,"div",74)(177,"span",75),e._uU(178,"Factura:"),e.qZA(),e.TgZ(179,"span",76),e._uU(180),e.qZA()(),e.TgZ(181,"div",74)(182,"span",75),e._uU(183,"Almac\xe9n:"),e.qZA(),e.TgZ(184,"span",76),e._uU(185),e.qZA()()(),e.YNc(186,Ds,14,6,"div",77),e.qZA(),e.TgZ(187,"button",78),e.NdJ("click",function(){e.CHM(a);const l=e.MAs(18);return e.KtG(l.selectedIndex=0)}),e._UZ(188,"mat-icon",79),e.qZA()(),e.YNc(189,Ps,39,18)(190,Ms,2,0),e.TgZ(191,"div",80)(192,"div",81)(193,"span",75),e._uU(194,"Observaciones"),e.qZA(),e.TgZ(195,"button",78),e.NdJ("click",function(){e.CHM(a);const l=e.MAs(18);return e.KtG(l.selectedIndex=2)}),e._UZ(196,"mat-icon",79),e.qZA()(),e.YNc(197,Es,2,0,"span",82),e.TgZ(198,"div",83),e.YNc(199,Js,5,1,"div",84)(200,Rs,5,1,"div",84)(201,Ns,5,1,"div",84)(202,Qs,5,1,"div",84),e.qZA()()(),e.TgZ(203,"span",85),e._uU(204),e.qZA()(),e.TgZ(205,"div",86)(206,"button",55),e._uU(207,"Atr\xe1s"),e.qZA(),e.TgZ(208,"button",87),e.NdJ("click",function(){return n.printPage()}),e._uU(209,"Imprimir"),e.qZA(),e.TgZ(210,"button",88),e.NdJ("click",function(){return n.saveReception()}),e._uU(211,"Registrar Recepci\xf3n"),e.qZA()()()()()()}if(2&i){const a=e.MAs(129),c=e.MAs(138),l=e.MAs(148),p=e.MAs(158);e.xp6(9),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("orientation",e.lcZ(19,122,n.stepperOrientation)),e.xp6(3),e.Q6J("stepControl",n.generalDataFormGroup),e.xp6(),e.Q6J("ngClass",e.VKq(132,Ls,"horizontal"===e.lcZ(23,124,n.stepperOrientation))),e.xp6(7),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",n.purchaseSearchInputControl)("autocomplete","off")("placeholder","Buscar Compra..."),e.xp6(),e.Q6J("fuseScrollbarOptions",e.DdM(134,st)),e.xp6(),e.Q6J("formGroup",n.purchaseFormGroup),e.xp6(2),e.um2(34,n.purchases.length>0?34:35),e.xp6(2),e.Q6J("ngClass",e.WLB(135,Ws,n.isLoading,n.pagination.length<25&&n.pagination.page<1))("length",n.pagination.length)("pageIndex",n.pagination.page)("pageSize",n.pagination.size)("pageSizeOptions",e.DdM(138,zs))("showFirstLastButtons",!1),e.xp6(5),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",n.depotSearchInputControl)("autocomplete","off")("placeholder","Buscar Almac\xe9n..."),e.xp6(),e.Q6J("formGroup",n.depotFormGroup)("fuseScrollbarOptions",e.DdM(139,st)),e.xp6(),e.um2(45,n.depots.length>0?45:46),e.xp6(5),e.Q6J("formControl",n.generalDataFormGroup.get("isThirdCompany")),e.xp6(2),e.Q6J("formGroup",n.carrierForm)("fuseScrollbarOptions",e.DdM(140,st)),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("maxlength",255)("required",n.generalDataFormGroup.get("isThirdCompany").value),e.xp6(),e.um2(58,n.carrierForm.get("name").hasError("required")?58:-1),e.xp6(),e.um2(59,n.carrierForm.get("name").hasError("maxlength")?59:-1),e.xp6(),e.um2(60,n.carrierForm.get("name").hasError("pattern")?60:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("maxlength",255)("required",n.generalDataFormGroup.get("isThirdCompany").value),e.xp6(),e.um2(66,n.carrierForm.get("lastname1").hasError("required")?66:-1),e.xp6(),e.um2(67,n.carrierForm.get("lastname1").hasError("maxlength")?67:-1),e.xp6(),e.um2(68,n.carrierForm.get("lastname1").hasError("pattern")?68:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("maxLength",255),e.xp6(),e.um2(74,n.carrierForm.get("lastname2").hasError("maxlength")?74:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("required",n.generalDataFormGroup.get("isThirdCompany").value)("maxlength",255),e.xp6(),e.um2(80,n.carrierForm.get("company").hasError("required")?80:-1),e.xp6(),e.um2(81,n.carrierForm.get("company").hasError("maxlength")?81:-1),e.xp6(),e.um2(82,n.carrierForm.get("company").hasError("pattern")?82:-1),e.xp6(4),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("minlength",11)("maxlength",11),e.xp6(),e.um2(90,n.carrierForm.get("idNumber").hasError("minlength")||n.carrierForm.get("idNumber").hasError("maxlength")?90:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("maxlength",255),e.xp6(),e.um2(96,n.carrierForm.get("licensePlate").hasError("maxlength")?96:-1),e.xp6(),e.um2(97,n.carrierForm.get("licensePlate").hasError("pattern")?97:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("maxlength",255),e.xp6(),e.um2(103,n.carrierForm.get("cargoDocument").hasError("maxlength")?103:-1),e.xp6(4),e.Q6J("disabled",n.generalDataFormGroup.invalid),e.xp6(2),e.Q6J("stepControl",n.productsFormGroup),e.xp6(),e.Q6J("ngClass",e.VKq(141,ct,"horizontal"===e.lcZ(111,126,n.stepperOrientation))),e.xp6(3),e.um2(113,n.productsFormGroup.get("products").controls.length>0?113:114),e.xp6(5),e.Q6J("disabled",n.productsFormGroup.invalid),e.xp6(2),e.Q6J("stepControl",n.observationFormGroup)("optional",n.observationFormGroup.valid),e.xp6(),e.Q6J("ngClass",e.VKq(143,ct,"horizontal"===e.lcZ(122,128,n.stepperOrientation))),e.xp6(2),e.Q6J("formGroup",n.observationFormGroup),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","obs")("maxlength",5e3)("rows",2)("spellcheck",!1),e.xp6(2),e.um2(130,n.observationFormGroup.get("obs").hasError("maxlength")?130:-1),e.xp6(2),e.hij("",a.value.length||0,"/5000"),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","obsSpare")("rows",2)("spellcheck",!1)("maxlength",5e3)("required",n.observationFormGroup.get("haveSpare").value)("disabled",!n.observationFormGroup.get("haveSpare").value),e.xp6(2),e.um2(139,n.observationFormGroup.get("obsSpare").hasError("required")?139:-1),e.xp6(),e.um2(140,n.observationFormGroup.get("obsSpare").hasError("maxlength")?140:-1),e.xp6(2),e.hij("",c.value.length||0,"/5000"),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","obsMissing")("rows",2)("spellcheck",!1)("maxlength",5e3)("required",n.observationFormGroup.get("haveMissing").value),e.xp6(2),e.um2(149,n.observationFormGroup.get("obsMissing").hasError("required")?149:-1),e.xp6(),e.um2(150,n.observationFormGroup.get("obsMissing").hasError("maxlength")?150:-1),e.xp6(2),e.hij("",l.value.length||0,"/5000"),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","obsDamaged")("rows",2)("spellcheck",!1)("maxlength",5e3)("required",n.observationFormGroup.get("haveDamaged").value),e.xp6(2),e.um2(159,n.observationFormGroup.get("obsDamaged").hasError("required")?159:-1),e.xp6(),e.um2(160,n.observationFormGroup.get("obsDamaged").hasError("maxlength")?160:-1),e.xp6(2),e.hij("",p.value.length||0,"/5000"),e.xp6(4),e.Q6J("disabled",n.observationFormGroup.invalid),e.xp6(2),e.Q6J("stepControl",n.depotFormGroup),e.xp6(),e.Q6J("ngClass",e.VKq(145,ct,"horizontal"===e.lcZ(170,130,n.stepperOrientation))),e.xp6(11),e.hij("",null==n.purchaseFormGroup.get("purchase").value?null:n.purchaseFormGroup.get("purchase").value.code," "),e.xp6(5),e.hij("",null==n.depotFormGroup.get("depot").value?null:n.depotFormGroup.get("depot").value.name," "),e.xp6(),e.um2(186,n.generalDataFormGroup.get("isThirdCompany").value?186:-1),e.xp6(2),e.Q6J("svgIcon","mat_solid:edit"),e.xp6(),e.um2(189,n.productsFormGroup.get("products").controls.length>0?189:190),e.xp6(7),e.Q6J("svgIcon","mat_solid:edit"),e.xp6(),e.um2(197,n.observationFormGroup.get("obs").value||n.observationFormGroup.get("obsSpare").value||n.observationFormGroup.get("obsMissing").value||n.observationFormGroup.get("obsDamaged").value?-1:197),e.xp6(2),e.um2(199,n.observationFormGroup.get("obs").value?199:-1),e.xp6(),e.um2(200,n.observationFormGroup.get("obsSpare").value?200:-1),e.xp6(),e.um2(201,n.observationFormGroup.get("obsMissing").value?201:-1),e.xp6(),e.um2(202,n.observationFormGroup.get("obsDamaged").value?202:-1),e.xp6(2),e.hij("Recibido por: ",n.employee.fullname," "),e.xp6(6),e.Q6J("disabled",n.generalDataFormGroup.invalid||n.productsFormGroup.invalid||n.observationFormGroup.invalid)}},dependencies:[h.Ov,h.H9,h.JJ,nt.H,v.ot,v.lW,v.RK,ue.p9,ue.oG,m.lN,m.KE,m.hX,m.bx,m.TO,m.qo,y.Ps,y.Hw,Z.c,Z.Nt,g.TU,g.NW,Ee.Fk,Ee.VQ,Ee.U0,C.JX,O.T5,O.C0,O.Vq,O.Ic,O.fd,N.AV,N.gM,h.mk,s.UX,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.Q7,s.wO,s.nD,s.qQ,s.Fd,s.oH,s.sg,s.u],encapsulation:2,changeDetection:0})}return o})();class Gs{}function Os(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",25)(1,"div",21),e._uU(2),e.qZA(),e.TgZ(3,"div",26),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"div",21),e._uU(7),e.qZA(),e.TgZ(8,"div",27),e._uU(9),e.ALo(10,"currency"),e.qZA(),e.TgZ(11,"div",27),e._uU(12),e.ALo(13,"currency"),e.qZA(),e.TgZ(14,"div",27),e._uU(15),e.ALo(16,"currency"),e.qZA(),e.TgZ(17,"div",27),e._uU(18),e.ALo(19,"currency"),e.qZA(),e.TgZ(20,"div",28)(21,"button",29),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,a=e.oxw(4);return e.KtG(a.viewReceptionReport(n))}),e._UZ(22,"mat-icon",30),e.qZA()()()}if(2&o){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.no," "),e.xp6(2),e.hij(" ",e.xi3(5,8,t.createdAt,"dd/MM/yyyy")," "),e.xp6(3),e.hij(" ",t.purchase.code," "),e.xp6(2),e.hij(" ",e.xi3(10,11,r.ctQuantity,"$ ")," "),e.xp6(3),e.hij(" ",e.xi3(13,14,r.ctQuantitySpare,"$ ")," "),e.xp6(3),e.hij(" ",e.xi3(16,17,r.ctQuantityMissing,"$ ")," "),e.xp6(3),e.hij(" ",e.xi3(19,20,r.ctQuantityDamaged,"$ ")," "),e.xp6(4),e.Q6J("svgIcon","mat_solid:assignment")}}function js(o,r){if(1&o&&e.YNc(0,Os,23,23,"div",24),2&o){const t=r.$implicit,i=e.oxw(4);let n;e.um2(0,(n=i.calcTotalsCost(t))?0:-1,n)}}function Bs(o,r){1&o&&e.SjG(0,js,1,1,null,null,e.QCX().trackByFn),2&o&&e.wJu(r)}const Hs=o=>({"pointer-events-none":o}),Vs=()=>[5,10,25,100];function Ys(o,r){if(1&o&&(e.TgZ(0,"div",19)(1,"div",20)(2,"div",21),e._uU(3," N\xfamero "),e.qZA(),e.TgZ(4,"div",21),e._uU(5," Fecha "),e.qZA(),e.TgZ(6,"div",21),e._uU(7," Factura "),e.qZA(),e.TgZ(8,"div",22),e._uU(9," Costo total "),e.qZA(),e.TgZ(10,"div",22),e._uU(11," CT.Sobrante "),e.qZA(),e.TgZ(12,"div",22),e._uU(13," CT.Faltante "),e.qZA(),e.TgZ(14,"div",22),e._uU(15," CT.Averiada "),e.qZA(),e.TgZ(16,"div",21),e._uU(17," Acciones "),e.qZA()(),e.YNc(18,Bs,2,0),e.ALo(19,"async"),e.qZA(),e._UZ(20,"mat-paginator",23)),2&o){const t=e.oxw(2);let i;e.xp6(18),e.um2(18,(i=e.lcZ(19,7,t.receptions$))?18:-1,i),e.xp6(2),e.Q6J("ngClass",e.VKq(9,Hs,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(11,Vs))("showFirstLastButtons",!0)}}function Ks(o,r){1&o&&(e.TgZ(0,"div",31),e._uU(1," \xa1No se ha registrado ninguna recepci\xf3n hasta el momento! "),e.qZA())}function Xs(o,r){1&o&&e.YNc(0,Ys,21,12)(1,Ks,2,0),2&o&&e.um2(0,r.length>0?0:1)}let ec=(()=>{class o{constructor(t,i,n,a,c){this._changeDetectorRef=t,this._dialog=i,this._fuseConfirmationService=n,this._receptionsService=a,this.store=c,this.isLoading=!1,this.reception=new Gs,this.receptions$=(0,S.of)([]),this.searchInputControl=new s.NI(null),this.user=null,this.merchant=null,this._unsubscribeAll=new E.x,this._documentsService=(0,e.f3M)(Ie.S)}ngOnInit(){this.store.select(se.rk).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(me.Qs).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(ae.B).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.receptions$=this.store.select(rt),this.searchInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,q.b)(300),(0,f.w)(t=>{if(null!==t)return this.isLoading=!0,this._receptionsService.getReceptions(0,25,"no","desc",t)}),(0,_.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"no",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,B.T)(this._sort.sortChange,this._paginator.page).pipe((0,f.w)(()=>(this.isLoading=!0,this._receptionsService.getReceptions(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,_.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}viewReceptionReport(t){this._documentsService.generateReceptionDocument(t,this.merchant,this.user)}trackByFn(t,i){return i.id||t}calcTotalsCost(t){const n=t.purchase.products,a=t.products.map(l=>{const p=n.find(b=>b.productId===l.productId);return{...l,...p}});return{ctQuantity:a.reduce((l,p)=>l+(p.cud+p.cui)*p.quantity,0),ctQuantitySpare:a.reduce((l,p)=>l+(p.cud+p.cui)*p.quantitySpare,0),ctQuantityMissing:a.reduce((l,p)=>l+(p.cud+p.cui)*p.quantityMissing,0),ctQuantityDamaged:a.reduce((l,p)=>l+(p.cud+p.cui)*p.quantityDamaged,0)}}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(e.sBO),e.Y36(R.uw),e.Y36(H.R),e.Y36(at),e.Y36(A.yh))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-reception-list"]],viewQuery:function(i,n){if(1&i&&(e.Gf(g.NW,5),e.Gf(C.YE,5)),2&i){let a;e.iGM(a=e.CRH())&&(n._paginator=a.first),e.iGM(a=e.CRH())&&(n._sort=a.first)}},standalone:!0,features:[e.jDz],decls:30,vars:11,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","","routerLink","/warehouse/receptions/new",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","receptions-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"text-center"],[1,"text-end"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],["class","grid items-center gap-4 px-6 py-3 border-b receptions-grid md:px-8"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","receptions-grid","md:px-8"],[1,"font-mono","text-center"],[1,"font-mono","text-end"],[1,"flex","flex-row","flex-wrap","justify-center","gap-3"],["mat-stroked-button","","matTooltip","Informe de Recepci\xf3n",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(i,n){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Almac\xe9n"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",7),e._uU(14,"Recepciones"),e.qZA()()(),e.TgZ(15,"div",8)(16,"h2",9),e._uU(17," Registro de Recepciones "),e.qZA()()(),e.TgZ(18,"div",10)(19,"mat-form-field",11),e._UZ(20,"mat-icon",12)(21,"input",13),e.qZA(),e.TgZ(22,"button",14),e._UZ(23,"mat-icon",15),e.TgZ(24,"span",16),e._uU(25,"Agregar"),e.qZA()()()(),e.TgZ(26,"div",17)(27,"div",18),e.YNc(28,Xs,2,1),e.ALo(29,"async"),e.qZA()()()),2&i){let a;e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(7),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),e.xp6(2),e.Q6J("svgIcon","mat_solid:add"),e.xp6(5),e.um2(28,(a=e.lcZ(29,9,n.receptions$))?28:-1,a)}},dependencies:[h.Ov,h.H9,h.uU,v.ot,v.lW,m.lN,m.KE,m.qo,y.Ps,y.Hw,Z.c,Z.Nt,g.TU,g.NW,C.JX,C.YE,h.mk,s.UX,s.Fj,s.JJ,s.oH,x.rH],encapsulation:2,changeDetection:0})}return o})(),tc=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-receptions"]],standalone:!0,features:[e.jDz],decls:1,vars:0,template:function(i,n){1&i&&e._UZ(0,"router-outlet")},dependencies:[x.lC],encapsulation:2})}return o})();const to=o=>o.stocks,oc=((0,A.P1)(to,o=>o.stock),(0,A.P1)(to,o=>o.stocks));var lt=d(49488);function ic(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-option",36),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.addDepot(a))}),e._uU(1),e.qZA()}if(2&o){const t=r.$implicit;e.Q6J("value",t.name),e.xp6(),e.hij(" ",t.name," ")}}function nc(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-icon",37),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.resetDepot())}),e.qZA()}}function rc(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-option",36),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.addProduct(a))}),e._uU(1),e.qZA()}if(2&o){const t=r.$implicit;e.Q6J("value",t.name),e.xp6(),e.hij(" ",t.name," ")}}function ac(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-icon",37),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.resetProduct())}),e.qZA()}}function sc(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",46)(1,"div",47),e._uU(2),e.qZA(),e.TgZ(3,"div",41),e._uU(4),e.qZA(),e.TgZ(5,"div",47),e._uU(6),e.qZA(),e.TgZ(7,"div",48),e._uU(8),e.qZA(),e.TgZ(9,"div",41),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"div",49)(13,"button",50),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.viewStowageCard(a))}),e._UZ(14,"mat-icon",51),e.qZA(),e.TgZ(15,"button",50),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.openDialog(a))}),e._UZ(16,"mat-icon",51),e.qZA()()()}if(2&o){const t=r.$implicit;e.xp6(2),e.hij(" ",t.product.name," "),e.xp6(2),e.hij(" ",t.product.brand?t.product.brand.name:""," "),e.xp6(2),e.hij(" ",t.depot.name," "),e.xp6(2),e.AsE(" ",t.quantity," ",t.product.uom?t.product.uom.abbr:""," "),e.xp6(2),e.hij(" ",e.xi3(11,8,t.updatedAt,"dd/MM/yyyy HH:mm")," "),e.xp6(4),e.Q6J("svgIcon","mat_solid:inventory"),e.xp6(2),e.Q6J("svgIcon","mat_solid:swap_horiz")}}function cc(o,r){1&o&&e.SjG(0,sc,17,11,"div",52,e.QCX().trackByFn),2&o&&e.wJu(r)}const lc=(o,r)=>({"pointer-events-none":o,hidden:r}),dc=()=>[25,50,100];function uc(o,r){if(1&o&&(e.TgZ(0,"div",39)(1,"div",40)(2,"div"),e._uU(3,"Nombre"),e.qZA(),e.TgZ(4,"div",41),e._uU(5,"Marca"),e.qZA(),e.TgZ(6,"div",41),e._uU(7,"Almac\xe9n"),e.qZA(),e.TgZ(8,"div",42),e._uU(9,"Cantidad"),e.qZA(),e.TgZ(10,"div",43),e._uU(11,"Fecha de Actualizaci\xf3n "),e.qZA(),e.TgZ(12,"div",44),e._uU(13,"Movimientos"),e.qZA()(),e.YNc(14,cc,2,0),e.ALo(15,"async"),e._UZ(16,"mat-paginator",45),e.qZA()),2&o){const t=e.oxw(2);let i;e.xp6(8),e.Q6J("mat-sort-header","quantity"),e.xp6(2),e.Q6J("mat-sort-header","updatedAt"),e.xp6(4),e.um2(14,(i=e.lcZ(15,9,t.stocks$))?14:-1,i),e.xp6(2),e.Q6J("ngClass",e.WLB(11,lc,t.isLoading,t.pagination.length<10&&t.pagination.page<1))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(14,dc))("showFirstLastButtons",!0)}}function pc(o,r){1&o&&(e.TgZ(0,"div",53),e._uU(1,"\xa1No se han encontrado productos en el inventario!"),e.qZA())}function mc(o,r){1&o&&e.YNc(0,uc,17,15,"div",38)(1,pc,2,0),2&o&&e.um2(0,r.length>0?0:1)}D.vfs=P.I.vfs;let hc=(()=>{class o{constructor(){this.availability=null,this.isLoading=!1,this.merchant=null,this.searchDepotsControl=new s.NI(null),this.searchInputControl=new s.NI(null),this.searchProductsControl=new s.NI(null),this.selectedDepot=null,this.selectedProduct=null,this.stocks=[],this.stocks$=(0,S.of)([]),this.user=null,this._changeDetectorRef=(0,e.f3M)(e.sBO),this._depotsService=(0,e.f3M)(he.Y),this._documentsService=(0,e.f3M)(Ie.S),this._dialog=(0,e.f3M)(R.uw),this._stocksService=(0,e.f3M)(Ae.T),this._unsubscribeAll=new E.x,this.store=(0,e.f3M)(A.yh)}ngOnInit(){this.store.select(se.rk).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(me.Qs).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.stocks$=this.store.select(oc),this.stocks$.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.stocks=t,this._changeDetectorRef.markForCheck()}),this.store.select(ae.B).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,q.b)(300),(0,k.O)(null),(0,f.w)(t=>null!==t?(this.isLoading=!0,this._stocksService.getStocks(this.pagination.page,this.pagination.size,"updatedAt","asc",t,this.selectedDepot?this.selectedDepot.id:null,this.selectedProduct?this.selectedProduct.id:null,this.availability)):(0,S.of)()),(0,_.U)(()=>{this.isLoading=!1})).subscribe(),this.depotsFiltered=this.searchDepotsControl.valueChanges.pipe((0,q.b)(200),(0,k.O)(null),(0,re.x)(()=>{this.isLoading=!1}),(0,ee.z)(t=>null!==t&&"string"==typeof t&&(this.selectedDepot&&t!==this.selectedDepot.name||!this.selectedDepot)?(this.isLoading=!0,this._depotsService.findActiveDepots(t.trim())):(0,S.of)())),this.productsFiltered=this.searchProductsControl.valueChanges.pipe((0,q.b)(200),(0,k.O)(null),(0,re.x)(()=>{this.isLoading=!1}),(0,ee.z)(t=>{if(null!==t&&"string"==typeof t&&(this.selectedProduct&&t!==this.selectedProduct.name||!this.selectedProduct)){this.isLoading=!0;const i=this.selectedDepot?this.selectedDepot.id:null;return this._stocksService.findStockProducts(t.trim(),10,i,this.availability)}return(0,S.of)()}))}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,B.T)(this._sort.sortChange,this._paginator.page).pipe((0,f.w)(()=>(this.isLoading=!0,this._stocksService.getStocks(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,"",this.selectedDepot?this.selectedDepot.id:null,this.selectedProduct?this.selectedProduct.id:null,this.availability))),(0,_.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}viewStowageCard(t){this._documentsService.generateStowageCardDocument(t,this.merchant,this.user)}addDepot(t){this.selectedDepot=t,this.selectedProduct=null,this.searchProductsControl.setValue(""),this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}resetDepot(){this.selectedDepot=null,this.searchDepotsControl.setValue(""),this.selectedProduct=null,this.searchProductsControl.setValue("",{emitEvent:!1}),this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addProduct(t){this.selectedProduct=t,this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}resetProduct(){this.selectedProduct=null,this.searchProductsControl.setValue(""),this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}trackByFn(t,i){return t||i.id}openDialog(t){this._dialog.open(ft,{data:{stock:t},panelClass:"ath-dialog-panel",disableClose:!0})}generateReport(){this._stocksService.findStocks(this.selectedDepot?.id,this.selectedProduct?.id,this.availability).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{let i="Inventario ";null!==this.availability&&(i+=this.availability?"disponible":"agotado"),this.selectedDepot&&(i+=` para ${this.selectedDepot.name}`),this.selectedProduct&&(i+=` de ${this.selectedProduct.name}`),this.generatePDF("open",i,t)})}generatePDF(t="open",i,n){const a={header:{text:i.toLocaleUpperCase(),style:"header",marginTop:5},content:[{lineHeight:1.3,table:{headerRows:1,widths:[75,"*",120,40,50,50,50],body:[[{text:"UPC",style:"table_header"},{text:"Producto",style:"table_header"},{text:"Almac\xe9n",style:"table_header"},{text:"U/M",style:"table_header"},{text:"Costo",style:"table_header"},{text:"P.Venta",style:"table_header"},{text:"Stock",style:"table_header"}],...n.map(c=>[{style:"table_body",text:c.product.upc,alignment:"center"},{style:"table_body",text:c.product.name},{style:"table_body",text:c.depot.name,alignment:"center"},{style:"table_body",text:c.product?.uom?.abbr,alignment:"center"},{style:"table_body",text:c.product.cost.toFixed(2),alignment:"center"},{style:"table_body",text:c.product.price.toFixed(2),alignment:"center"},{style:"table_body",text:c.quantity,alignment:"center"}])]},layout:"lightHorizontalLines"}],footer:(c,l)=>({table:{widths:["*","*"],body:[[{text:`Reporte generador por: ${this.user.fullname} | Esta informaci\xf3n es exclusiva de ${this.merchant.name}`,bold:!0,fontSize:8},{text:`P\xe1gina ${c.toString()}/${l} - Fecha de impresi\xf3n ${w().format("DD/MM/yyyy HH:mm:ss")}`,bold:!0,fontSize:8,alignment:"right"}]]},margin:[30,0,30,0],layout:"noBorders",italics:!0}),defaultStyle:{fontSize:12},styles:{header:{fontSize:18,bold:!0,marginBottom:5,alignment:"center",fontFeatures:["c2sc","smcp"]},table_header:{fontSize:11,bold:!0,alignment:"center",fontFeatures:["c2sc","smcp"]},table_body:{fontSize:10}},pageOrientation:"landscape",pageSize:"LETTER",watermark:{text:this.merchant.name,color:"#fff",opacity:.07,angle:-35,bold:!0,italics:!1},info:{title:i,author:`${this.user.fullname}`,creationDate:w().toDate(),modDate:w().toDate(),producer:this.merchant.name}};switch(t){case t="download":D.createPdf(a).download();break;case t="open":D.createPdf(a).open();break;case t="print":D.createPdf(a).print()}}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-stocks"]],viewQuery:function(i,n){if(1&i&&(e.Gf(g.NW,5),e.Gf(C.YE,5)),2&i){let a;e.iGM(a=e.CRH())&&(n._paginator=a.first),e.iGM(a=e.CRH())&&(n._sort=a.first)}},standalone:!0,features:[e.jDz],decls:62,vars:31,consts:[["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-64"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","flex-wrap","items-center","mt-2","xl:fixed","right-8","sm:mt-0","shrink-0","sm:ml-4"],["appearance","fill",1,"w-full","mt-4","sm:w-auto","sm:mr-4","sm:mt-0","fuse-mat-dense","mat-fuse-de","fuse-mat-rounded","sm:min-w-72",3,"subscriptSizing"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete"],["depotsDepotsAutocomplete","matAutocomplete"],["class","cursor-pointer","svgIcon","mat_solid:cancel","matSuffix",""],["appearance","fill",1,"w-full","mt-4","sm:w-auto","sm:mr-4","sm:mt-0","fuse-mat-dense","mat-fuse-de","fuse-mat-rounded","sm:min-w-60",3,"subscriptSizing"],["depotsProductsAutocomplete","matAutocomplete"],[1,"mt-4","segmented-button","sm:mt-0"],[3,"ngModel","ngModelChange"],["matTooltip","Inventario disponible",3,"value"],["svgIcon","mat_solid:inventory_2",1,"icon-size-5"],["svgIcon","mat_solid:checklist"],["matTooltip","Inventario agotado",3,"value"],[1,"mt-4","sm:mt-0"],["mat-raised-button","",1,"ml-4","text-white","bg-gradient-to-r","from-yellow-500","to-yellow-600",3,"matMenuTriggerFor"],[1,"sm:hidden",3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[3,"xPosition"],["itemMenu","matMenu"],["mat-menu-item","",3,"disabled"],[3,"svgIcon"],["mat-menu-item","",3,"click"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto"],[3,"value","click"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer",3,"click"],["class","relative grid"],[1,"relative","grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","stocks-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"text-center"],[3,"mat-sort-header"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"pr-4","text-right"],[1,"border-b","first-letter:z-10","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-gray-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","stocks-grid","md:px-8"],[1,"truncate"],[1,"pr-2","text-center"],[1,"flex","flex-row","justify-end","gap-2","pr-8"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],["class","z-0 grid items-center gap-4 px-6 py-3 bg-white border-b dark:bg-default stocks-grid md:px-8"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"],[3,"value"]],template:function(i,n){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Almac\xe9n"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",7),e._uU(14,"Inventario"),e.qZA()()(),e.TgZ(15,"div",8)(16,"h2",9),e._uU(17," Inventario "),e.qZA()()(),e.TgZ(18,"div",10)(19,"mat-form-field",11),e._UZ(20,"mat-icon",12)(21,"input",13),e.TgZ(22,"mat-autocomplete",14,15),e.SjG(24,ic,2,2,"mat-option",54,e.x6l),e.ALo(26,"async"),e.qZA(),e.YNc(27,nc,1,0,"mat-icon",16),e.qZA(),e.TgZ(28,"mat-form-field",17),e._UZ(29,"mat-icon",12)(30,"input",13),e.TgZ(31,"mat-autocomplete",14,18),e.SjG(33,rc,2,2,"mat-option",54,e.x6l),e.ALo(35,"async"),e.qZA(),e.YNc(36,ac,1,0,"mat-icon",16),e.qZA(),e.TgZ(37,"div",19)(38,"mat-button-toggle-group",20),e.NdJ("ngModelChange",function(c){return n.availability=c})("ngModelChange",function(){return n.searchInputControl.setValue("")}),e.TgZ(39,"mat-button-toggle",21),e._UZ(40,"mat-icon",22),e.qZA(),e.TgZ(41,"mat-button-toggle",21),e._UZ(42,"mat-icon",23),e.qZA(),e.TgZ(43,"mat-button-toggle",24),e._UZ(44,"mat-icon",22),e.qZA()()(),e.TgZ(45,"div",25)(46,"button",26),e._UZ(47,"mat-icon",27),e.TgZ(48,"span",28),e._uU(49,"Reportes"),e.qZA()(),e.TgZ(50,"mat-menu",29,30)(52,"button",31),e._UZ(53,"mat-icon",32),e._uU(54," Pr\xf3ximamente "),e.qZA(),e.TgZ(55,"button",33),e.NdJ("click",function(){return n.generateReport()}),e._UZ(56,"mat-icon",32),e._uU(57," Generar "),e.qZA()()()()(),e.TgZ(58,"div",34)(59,"div",35),e.YNc(60,mc,2,1),e.ALo(61,"async"),e.qZA()()()),2&i){const a=e.MAs(23),c=e.MAs(32),l=e.MAs(51);let p;e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(7),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",n.searchDepotsControl)("matAutocomplete",a)("placeholder","Filtre por Almac\xe9n"),e.xp6(3),e.wJu(e.lcZ(26,25,n.depotsFiltered)),e.xp6(3),e.um2(27,n.selectedDepot?27:-1),e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",n.searchProductsControl)("matAutocomplete",c)("placeholder","Filtre por Productos"),e.xp6(3),e.wJu(e.lcZ(35,27,n.productsFiltered)),e.xp6(3),e.um2(36,n.selectedProduct?36:-1),e.xp6(2),e.Q6J("ngModel",n.availability),e.xp6(),e.Q6J("value",!0),e.xp6(2),e.Q6J("value",null),e.xp6(2),e.Q6J("value",!1),e.xp6(3),e.Q6J("matMenuTriggerFor",l),e.xp6(),e.Q6J("svgIcon","mat_solid:description"),e.xp6(3),e.Q6J("xPosition","before"),e.xp6(2),e.Q6J("disabled",!0),e.xp6(),e.Q6J("svgIcon","mat_solid:description"),e.xp6(3),e.Q6J("svgIcon","mat_solid:description"),e.xp6(4),e.um2(60,(p=e.lcZ(61,29,n.stocks$))?60:-1,p)}},dependencies:[h.Ov,h.uU,s.u5,s.Fj,s.JJ,s.On,Q.Bb,Q.XC,ie.ey,Q.ZL,v.ot,v.lW,lt.vV,lt.A9,lt.Yi,m.lN,m.KE,m.qo,m.R9,y.Ps,y.Hw,Z.c,Z.Nt,ne.Tx,ne.VK,ne.OP,ne.p6,g.TU,g.NW,X.LD,C.JX,C.YE,C.nU,h.mk,s.UX,s.oH,x.rH],encapsulation:2,changeDetection:0})}return o})();var gc=d(9427),ye=d(8382),fc=d(7604),_c=d(75598),oo=d(26306),vc=d(58504);const io=o=>o.dispatches,xc=(0,A.P1)(io,o=>o.dispatch),Qe=(0,A.P1)(io,o=>o.dispatches);var Se=d(75361);const bc=T.Ps`
    mutation CreateDispatch($createDispatchInput: CreateDispatchInput!) {
        createDispatch(createDispatchInput: $createDispatchInput) {
            ok
            message

            dispatch {
                id
                no
                userId
                merchantId
                createdAt
                haveSpare
                obsSpare
                haveMissing
                obsMissing
                haveDamaged
                obsDamaged
                depotInitId
                depotEndId
                depotInit {
                    id
                    name
                }
                depotEnd {
                    id
                    name
                }
                products {
                    productId
                    quantity
                    name
                    uom
                    spare
                    missing
                    damaged
                }
                needConfirmation
                confirmed
                confirmedAt
                confirmedBy
                user {
                    name
                    lastname1
                    lastname2
                    fullname
                }
            }
        }
    }
`,Cc=T.Ps`
    mutation ConfirmDispatch($confirmDispatchInput: ConfirmDispatchInput!) {
        confirmDispatch(confirmDispatchInput: $confirmDispatchInput) {
            ok
            message

            dispatch {
                id
                no
                userId
                merchantId
                createdAt
                haveSpare
                obsSpare
                haveMissing
                obsMissing
                haveDamaged
                obsDamaged
                depotInitId
                depotEndId
                depotInit {
                    id
                    name
                }
                depotEnd {
                    id
                    name
                }
                products {
                    productId
                    quantity
                    name
                    uom
                    spare
                    missing
                    damaged
                }
                needConfirmation
                confirmed
                confirmedAt
                confirmedBy
                user {
                    name
                    lastname1
                    lastname2
                    fullname
                }
            }
        }
    }
`,yc=(T.Ps`
    mutation UpdateDispatch($updateDispatchInput: UpdateDispatchInput!) {
        updateDispatch(updateDispatchInput: $updateDispatchInput) {
            ok
            message

            dispatch {
                id
                no
                userId
                merchantId
                createdAt
                haveSpare
                obsSpare
                haveMissing
                obsMissing
                haveDamaged
                obsDamaged
                depotInitId
                depotEndId
                depotInit {
                    id
                    name
                }
                depotEnd {
                    id
                    name
                }
                products {
                    productId
                    quantity
                    name
                    uom
                    spare
                    missing
                    damaged
                }
                needConfirmation
                confirmed
                confirmedAt
                confirmedBy
                user {
                    name
                    lastname1
                    lastname2
                    fullname
                }
            }
        }
    }
`,T.Ps`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateDispatchStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }
    }
`,T.Ps`
    mutation RemoveDispatch($removeDispatchId: String!) {
        removeDispatch(id: $removeDispatchId) {
            ok
            message
        }
    }
`),Zc=T.Ps`
    query FindAllDispatches($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllDispatches(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length,
                size,
                page,
                lastPage,
                startIndex,
                endIndex
            },

            dispatches {
                id
                no
                userId
                merchantId
                createdAt
                haveSpare
                obsSpare
                haveMissing
                obsMissing
                haveDamaged
                obsDamaged
                depotInitId
                depotEndId
                depotInit {
                    id
                    name
                }
                depotEnd {
                    id
                    name
                }
                products {
                    productId
                    quantity
                    name
                    uom
                    spare
                    missing
                    damaged
                }
                needConfirmation
                confirmed
                confirmedAt
                confirmedBy
                user {
                    name
                    lastname1
                    lastname2
                    fullname
                }
            }
        }
    }
`,Tc=T.Ps`
    query FindDispatchById($dispatchId: String!) {
        findDispatchById(dispatchId: $dispatchId) {
            ok
            message

            dispatch {
                id
                no
                userId
                merchantId
                createdAt
                haveSpare
                obsSpare
                haveMissing
                obsMissing
                haveDamaged
                obsDamaged
                depotInitId
                depotEndId
                depotInit {
                    id
                    name
                }
                depotEnd {
                    id
                    name
                }
                products {
                    productId
                    quantity
                    name
                    uom
                    spare
                    missing
                    damaged
                }
                needConfirmation
                confirmed
                confirmedAt
                confirmedBy
                user {
                    name
                    lastname1
                    lastname2
                    fullname
                }
            }
        }
    }
`;T.Ps`
    query findDispatchByLocationAndEmployee {
        findDispatchByLocationAndEmployee {
            ok
            message

            dispatch {
                id
                no
                userId
                merchantId
                createdAt
                haveSpare
                obsSpare
                haveMissing
                obsMissing
                haveDamaged
                obsDamaged
                depotInitId
                depotEndId
                depotInit {
                    id
                    name
                }
                depotEnd {
                    id
                    name
                }
                products {
                    productId
                    quantity
                    name
                    uom
                    spare
                    missing
                    damaged
                }
                needConfirmation
                confirmed
                confirmedAt
                confirmedBy
                user {
                    name
                    lastname1
                    lastname2
                    fullname
                }
            }
        }
    }
`;let De=(()=>{class o{constructor(t,i){this.apolloProvider=t,this.store=i,this._apollo=this.apolloProvider.use("BALANC")}createDispatch(t){return this.store.select(Qe).pipe((0,_e.q)(1),(0,f.w)(i=>this._apollo.mutate({mutation:bc,variables:{createDispatchInput:t},errorPolicy:"all"}).pipe((0,F.b)(({data:n})=>{const a=structuredClone(i);a.push(n.createDispatch.dispatch),this.store.dispatch((0,Se.G2)({dispatches:a}))}))))}confirmDispatch(t){return this.store.select(Qe).pipe((0,_e.q)(1),(0,f.w)(i=>this._apollo.mutate({mutation:Cc,variables:{confirmDispatchInput:t},errorPolicy:"all"}).pipe((0,F.b)(({data:n})=>{const a=structuredClone(i);a.push(n.confirmDispatch.dispatch),this.store.dispatch((0,Se.G2)({dispatches:a}))}))))}getDispatches(t=0,i=50,n="no",a="desc",c="",l=null,p=null){return this._apollo.query({query:Zc,errorPolicy:"all",variables:{page:t,size:i,sort:n,order:a,search:c,depotId:l,productId:p}}).pipe((0,F.b)(({data:b})=>{this.store.dispatch((0,Se.G2)({dispatches:b.findAllDispatches.dispatches})),this.store.dispatch((0,Te.Jr)({pagination:b.findAllDispatches.pagination}))}))}findDispatchById(t){return this._apollo.query({query:Tc,variables:{dispatchId:t},errorPolicy:"all"}).pipe((0,F.b)(({data:i})=>{this.store.dispatch((0,Se.Du)({dispatch:i.findDispatchById.dispatch}))}))}removeDispatch(t){return this.store.select(Qe).pipe((0,_e.q)(1),(0,f.w)(i=>this._apollo.mutate({mutation:yc,variables:{removeDispatchId:t},errorPolicy:"all"}).pipe((0,F.b)(()=>{const n=structuredClone(i),a=i.findIndex(c=>c.id===t);n.splice(a,1),this.store.dispatch((0,Se.G2)({dispatches:n}))}))))}static#e=this.\u0275fac=function(i){return new(i||o)(e.LFG(T._M),e.LFG(A.yh))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),Ac=(()=>{class o{constructor(){this._dispatchesService=(0,e.f3M)(De)}resolve(t,i){return this._dispatchesService.getDispatches()}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),Ic=(()=>{class o{constructor(){this._dispatchesService=(0,e.f3M)(De),this._router=(0,e.f3M)(x.F0)}resolve(t,i){const n=t.paramMap.get("dispatchId");if("new"!==n)return this._dispatchesService.findDispatchById(n).pipe((0,oo.K)(a=>{console.error(a);const c=i.url.split("/").slice(0,-1).join("/");return this._router.navigateByUrl(c),(0,vc._)(a)}))}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var kc=d(31451);let wc=(()=>{class o{constructor(t){this._movementsService=t}resolve(t,i){return this._movementsService.getMovements()}static#e=this.\u0275fac=function(i){return new(i||o)(e.LFG(We))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var qc=d(21189);let Fc=(()=>{class o{constructor(t){this._periodsService=t}resolve(t,i){return this._periodsService.findAllPeriodsByDepotId()}static#e=this.\u0275fac=function(i){return new(i||o)(e.LFG(Me))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var dt=d(53308);let Sc=(()=>{class o{constructor(t){this._receptionsService=t}resolve(t,i){return this._receptionsService.getReceptions()}static#e=this.\u0275fac=function(i){return new(i||o)(e.LFG(at))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),Dc=(()=>{class o{constructor(t,i){this._stocksService=t,this._router=i}resolve(t,i){return this._stocksService.getStocks().pipe((0,oo.K)(n=>this._router.navigateByUrl("/dashboard")))}static#e=this.\u0275fac=function(i){return new(i||o)(e.LFG(Ae.T),e.LFG(x.F0))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var no=d(85194);const ro=(o,r)=>r.id;function Uc(o,r){1&o&&(e.TgZ(0,"mat-error",45),e._uU(1," Valor m\xednimo 0 "),e.qZA())}function Pc(o,r){1&o&&(e.TgZ(0,"mat-error",45),e._uU(1," Valor requerido "),e.qZA())}function Mc(o,r){1&o&&(e.TgZ(0,"mat-error",45),e._uU(1," Valor m\xednimo 0 "),e.qZA())}function Ec(o,r){1&o&&(e.TgZ(0,"mat-error",45),e._uU(1," Valor requerido "),e.qZA())}function Jc(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Cantidad excedida "),e.qZA())}function Rc(o,r){1&o&&(e.TgZ(0,"mat-error",45),e._uU(1," Valor m\xednimo 0 "),e.qZA())}function Nc(o,r){1&o&&(e.TgZ(0,"mat-error",45),e._uU(1," Valor requerido "),e.qZA())}function Qc(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Cantidad excedida "),e.qZA())}function Lc(o,r){if(1&o&&(e.TgZ(0,"div",38)(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"div",39),e._uU(4),e.qZA(),e.TgZ(5,"div",40),e._uU(6),e.qZA(),e.TgZ(7,"div",37),e._uU(8),e.ALo(9,"number"),e.qZA(),e.TgZ(10,"div",41)(11,"mat-form-field",42),e._UZ(12,"input",43),e.qZA(),e.YNc(13,Uc,2,0,"mat-error",44)(14,Pc,2,0,"mat-error",44),e.qZA(),e.TgZ(15,"div",41)(16,"mat-form-field",42),e._UZ(17,"input",43),e.qZA(),e.YNc(18,Mc,2,0,"mat-error",44)(19,Ec,2,0,"mat-error",44)(20,Jc,2,0,"mat-error"),e.qZA(),e.TgZ(21,"div",41)(22,"mat-form-field",42),e._UZ(23,"input",43),e.qZA(),e.YNc(24,Rc,2,0,"mat-error",44)(25,Nc,2,0,"mat-error",44)(26,Qc,2,0,"mat-error"),e.qZA()()),2&o){const t=r.$implicit,i=r.$index;e.xp6(2),e.hij(" ",i+1," "),e.xp6(),e.Q6J("matTooltip",t.get("name").value),e.xp6(),e.hij(" ",t.get("name").value," "),e.xp6(2),e.hij(" ",t.get("uom").value," "),e.xp6(2),e.hij(" ",e.xi3(9,25,t.get("quantity").value,"1.0-4")," "),e.xp6(3),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("min",0)("max",9999999)("formControl",t.get("spare")),e.xp6(),e.um2(13,t.get("spare").hasError("min")?13:-1),e.xp6(),e.um2(14,t.get("spare").hasError("required")?14:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("min",0)("max",t.get("quantity").value)("formControl",t.get("missing")),e.xp6(),e.um2(18,t.get("missing").hasError("min")?18:-1),e.xp6(),e.um2(19,t.get("missing").hasError("required")?19:-1),e.xp6(),e.um2(20,t.hasError("totalQuantityExceeded")||t.get("missing").hasError("max")?20:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("min",0)("max",t.get("quantity").value)("formControl",t.get("damaged")),e.xp6(),e.um2(24,t.get("damaged").hasError("min")?24:-1),e.xp6(),e.um2(25,t.get("damaged").hasError("required")?25:-1),e.xp6(),e.um2(26,t.hasError("totalQuantityExceeded")||t.get("damaged").hasError("max")?26:-1)}}function Wc(o,r){if(1&o&&(e.TgZ(0,"div",34)(1,"div",35),e._UZ(2,"div"),e.TgZ(3,"div",36),e._uU(4," Producto "),e.qZA(),e.TgZ(5,"div",36),e._uU(6," UM "),e.qZA(),e.TgZ(7,"div",37),e._uU(8," Cantidad "),e.qZA(),e.TgZ(9,"div",37),e._uU(10," Sobrante "),e.qZA(),e.TgZ(11,"div",37),e._uU(12," Faltante "),e.qZA(),e.TgZ(13,"div",37),e._uU(14," Averiada "),e.qZA()(),e.SjG(15,Lc,27,28,"div",46,ro),e.qZA()),2&o){const t=e.oxw();e.xp6(15),e.wJu(t.dispatchConfirmationFormGroup.get("products").controls)}}function zc(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Las observaciones sobre sobrante son obligatorias si tienes repuestos. "),e.qZA())}function $c(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Las observaciones sobre sobrante no deben pasar los 5000 caracteres "),e.qZA())}function Gc(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Las observaciones sobre faltantes son obligatorias si tienes faltantes. "),e.qZA())}function Oc(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Las observaciones sobre faltantes no deben pasar los 5000 caracteres "),e.qZA())}function jc(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Las observaciones sobre aver\xedas son obligatorias si tienes da\xf1os. "),e.qZA())}function Bc(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Las observaciones sobre aver\xedas no deben pasar los 5000 caracteres "),e.qZA())}const ut=o=>({"stepper-reception-form-grid":o});function Hc(o,r){if(1&o&&(e.TgZ(0,"mat-step",19)(1,"div",13),e.ALo(2,"async"),e.TgZ(3,"form",47)(4,"div",48)(5,"mat-form-field",49)(6,"mat-label"),e._uU(7,"Observaciones sobre Sobrantes"),e.qZA(),e._UZ(8,"textarea",50,51),e.YNc(10,zc,2,0,"mat-error")(11,$c,2,0,"mat-error"),e.TgZ(12,"mat-hint",52),e._uU(13),e.qZA()()(),e.TgZ(14,"div",48)(15,"mat-form-field",49)(16,"mat-label"),e._uU(17,"Observaciones sobre Faltantes"),e.qZA(),e._UZ(18,"textarea",50,53),e.YNc(20,Gc,2,0,"mat-error")(21,Oc,2,0,"mat-error"),e.TgZ(22,"mat-hint",52),e._uU(23),e.qZA()()(),e.TgZ(24,"div",48)(25,"mat-form-field",49)(26,"mat-label"),e._uU(27,"Observaciones de Aver\xedas"),e.qZA(),e._UZ(28,"textarea",50,54),e.YNc(30,jc,2,0,"mat-error")(31,Bc,2,0,"mat-error"),e.TgZ(32,"mat-hint",52),e._uU(33),e.qZA()()()(),e.TgZ(34,"div",16)(35,"button",17),e._uU(36,"Atr\xe1s"),e.qZA(),e.TgZ(37,"button",18),e._uU(38,"Siguiente"),e.qZA()()()()),2&o){const t=e.MAs(9),i=e.MAs(19),n=e.MAs(29),a=e.oxw();e.Q6J("stepControl",a.dispatchConfirmationFormGroup),e.xp6(),e.Q6J("ngClass",e.VKq(32,ut,"horizontal"===e.lcZ(2,30,a.stepperOrientation))),e.xp6(2),e.Q6J("formGroup",a.dispatchConfirmationFormGroup),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","obsSpare")("rows",2)("spellcheck",!1)("maxlength",5e3)("required",a.dispatchConfirmationFormGroup.get("haveSpare").value),e.xp6(2),e.um2(10,a.dispatchConfirmationFormGroup.get("obsSpare").hasError("required")?10:-1),e.xp6(),e.um2(11,a.dispatchConfirmationFormGroup.get("obsSpare").hasError("maxlength")?11:-1),e.xp6(2),e.hij("",t.value.length||0,"/5000"),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","obsMissing")("rows",2)("spellcheck",!1)("maxlength",5e3)("required",a.dispatchConfirmationFormGroup.get("haveMissing").value),e.xp6(2),e.um2(20,a.dispatchConfirmationFormGroup.get("obsMissing").hasError("required")?20:-1),e.xp6(),e.um2(21,a.dispatchConfirmationFormGroup.get("obsMissing").hasError("maxlength")?21:-1),e.xp6(2),e.hij("",i.value.length||0,"/5000"),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","obsDamaged")("rows",2)("spellcheck",!1)("maxlength",5e3)("required",a.dispatchConfirmationFormGroup.get("haveDamaged").value),e.xp6(2),e.um2(30,a.dispatchConfirmationFormGroup.get("obsDamaged").hasError("required")?30:-1),e.xp6(),e.um2(31,a.dispatchConfirmationFormGroup.get("obsDamaged").hasError("maxlength")?31:-1),e.xp6(2),e.hij("",n.value.length||0,"/5000")}}function Vc(o,r){if(1&o&&(e.TgZ(0,"div",38)(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"div",40),e._uU(4),e.qZA(),e.TgZ(5,"div",40),e._uU(6),e.qZA(),e.TgZ(7,"div",37),e._uU(8),e.ALo(9,"number"),e.qZA(),e.TgZ(10,"div",37),e._uU(11),e.ALo(12,"number"),e.qZA(),e.TgZ(13,"div",37),e._uU(14),e.ALo(15,"number"),e.qZA(),e.TgZ(16,"div",37),e._uU(17),e.ALo(18,"number"),e.qZA()()),2&o){const t=r.$implicit,i=r.$index;e.xp6(2),e.hij(" ",i+1," "),e.xp6(2),e.hij(" ",t.get("name").value," "),e.xp6(2),e.hij(" ",t.get("uom").value," "),e.xp6(2),e.hij(" ",e.xi3(9,7,t.get("quantity").value,"1.0-4")," "),e.xp6(3),e.hij(" ",e.xi3(12,10,t.get("spare").value,"1.0-4")," "),e.xp6(3),e.hij(" ",e.xi3(15,13,t.get("missing").value,"1.0-4")," "),e.xp6(3),e.hij(" ",e.xi3(18,16,t.get("damaged").value,"1.0-4")," ")}}function Yc(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",24)(1,"span",25),e._uU(2,"Cantidades"),e.qZA(),e.TgZ(3,"button",26),e.NdJ("click",function(){e.CHM(t),e.oxw();const n=e.MAs(22);return e.KtG(n.selectedIndex=1)}),e._UZ(4,"mat-icon",27),e.qZA()(),e.TgZ(5,"div",55)(6,"div",56),e._UZ(7,"div"),e.TgZ(8,"div",36),e._uU(9," Producto "),e.qZA(),e.TgZ(10,"div",36),e._uU(11," UM "),e.qZA(),e.TgZ(12,"div",37),e._uU(13," Cantidad "),e.qZA(),e.TgZ(14,"div",37),e._uU(15," Sobrante "),e.qZA(),e.TgZ(16,"div",37),e._uU(17," Faltante "),e.qZA(),e.TgZ(18,"div",37),e._uU(19," Averiada "),e.qZA()(),e.SjG(20,Vc,19,19,"div",46,ro),e.qZA()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("svgIcon","mat_solid:edit"),e.xp6(16),e.wJu(t.dispatchConfirmationFormGroup.get("products").controls)}}function Kc(o,r){1&o&&(e.TgZ(0,"span",57),e._uU(1," Sin observaciones "),e.qZA())}function Xc(o,r){if(1&o&&(e.TgZ(0,"div",58)(1,"span",59),e._uU(2,"Observaciones sobre sobrantes"),e.qZA(),e.TgZ(3,"div",57),e._uU(4),e.qZA()()),2&o){const t=e.oxw();e.xp6(4),e.hij(" ",t.dispatchConfirmationFormGroup.get("obsSpare").value," ")}}function el(o,r){if(1&o&&(e.TgZ(0,"div",58)(1,"span",59),e._uU(2,"Observaciones sobre faltantes"),e.qZA(),e.TgZ(3,"div",57),e._uU(4),e.qZA()()),2&o){const t=e.oxw();e.xp6(4),e.hij(" ",t.dispatchConfirmationFormGroup.get("obsMissing").value," ")}}function tl(o,r){if(1&o&&(e.TgZ(0,"div",58)(1,"span",59),e._uU(2,"Observaciones sobre aver\xedas"),e.qZA(),e.TgZ(3,"div",57),e._uU(4),e.qZA()()),2&o){const t=e.oxw();e.xp6(4),e.hij(" ",t.dispatchConfirmationFormGroup.get("obsDamaged").value," ")}}let ol=(()=>{class o{constructor(){this.dispatch=null,this.user=null,this._changeDetectorRef=(0,e.f3M)(e.sBO),this._dispatchesService=(0,e.f3M)(De),this._formBuilder=(0,e.f3M)(s.qu),this._fuseConfirmationService=(0,e.f3M)(H.R),this._router=(0,e.f3M)(x.F0),this._snackBar=(0,e.f3M)(G.ux),this._stepperIntl=(0,e.f3M)(O.$c).optionalLabel="Opcional",this._unsubscribeAll=new E.x,this.store=(0,e.f3M)(A.yh),this.stepperOrientation=(0,e.f3M)(Xt.Yg).observe("(min-width: 800px)").pipe((0,_.U)(({matches:t})=>t?"horizontal":"vertical"))}ngOnInit(){this.dispatchConfirmationFormGroup=this._formBuilder.group({haveDamaged:new s.NI(!1),haveMissing:new s.NI(!1),haveSpare:new s.NI(!1),obsDamaged:new s.NI("",[s.kI.maxLength(5e3)]),obsMissing:new s.NI("",[s.kI.maxLength(5e3)]),obsSpare:new s.NI("",[s.kI.maxLength(5e3)]),products:new s.Oe([])}),this.store.select(se.rk).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(xc).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.dispatch=t;for(const i of t.products){const n=this._formBuilder.group({productId:new s.NI(i.productId,[s.kI.required]),name:new s.NI(i.name,[s.kI.required]),uom:new s.NI(i.uom,[s.kI.required]),quantity:new s.NI(i.quantity,[te.L.onlyNumbersPattern(),s.kI.required,s.kI.min(.1),s.kI.max(i.quantity)]),spare:new s.NI(i.spare,[te.L.onlyNumbersPattern(),s.kI.required,s.kI.min(0),s.kI.max(i.quantity)]),missing:new s.NI(i.missing,[te.L.onlyNumbersPattern(),s.kI.required,s.kI.min(0),s.kI.max(i.quantity)]),damaged:new s.NI(i.damaged,[te.L.onlyNumbersPattern(),s.kI.required,s.kI.min(0),s.kI.max(i.quantity)])});this.dispatchConfirmationFormGroup.get("products").push(n)}this._changeDetectorRef.markForCheck()}),this.dispatchConfirmationFormGroup.get("products").valueChanges.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{const i=t.reduce((c,l)=>c+l.spare,0),n=t.reduce((c,l)=>c+l.missing,0),a=t.reduce((c,l)=>c+l.damaged,0);i>0?this.dispatchConfirmationFormGroup.get("haveSpare").setValue(!0):this.dispatchConfirmationFormGroup.get("haveSpare").setValue(!1),n>0?this.dispatchConfirmationFormGroup.get("haveMissing").setValue(!0):this.dispatchConfirmationFormGroup.get("haveMissing").setValue(!1),a>0?this.dispatchConfirmationFormGroup.get("haveDamaged").setValue(!0):this.dispatchConfirmationFormGroup.get("haveDamaged").setValue(!1),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}confirmDispatch(){let t=this.dispatchConfirmationFormGroup.getRawValue();t.id=this.dispatch.id,this._fuseConfirmationService.open({title:"Confirmar Despacho",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,u.R)(this._unsubscribeAll)).subscribe(n=>{"confirmed"===n&&this._dispatchesService.confirmDispatch(t).pipe((0,u.R)(this._unsubscribeAll)).subscribe(({data:a})=>{this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.confirmDispatch.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/warehouse/dispatches-list")})})}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["dispatch-confirmation"]],standalone:!0,features:[e.jDz],decls:59,vars:28,consts:[[1,"flex","flex-col","flex-auto","min-w-0","overflow-auto","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","pb-3","print:hidden","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-7"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],["routerLink","/warehouse/dispatches-list'",1,"ml-1","text-primary-500"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],[1,"h-full","sm:overflow-auto",3,"orientation"],["stepper",""],["label","Cantidades Recibidas",3,"stepControl"],[1,"grid","h-full","grid-cols-1","pt-4","sm:px-4",3,"ngClass"],["fuseScrollbar","",1,"h-full","pb-6"],["class","grid ","fuseScrollbar",""],[1,"flex","items-center","justify-end","gap-x-4"],["mat-button","","matStepperPrevious",""],["color","primary","mat-flat-button","","matStepperNext",""],["label","Observaciones",3,"stepControl"],["label","Resumen",3,"stepControl"],["fuseScrollbar","",1,"flex","flex-col","justify-between","p-10","pt-8","overscroll-y-contain","print:row-span-2","bg-gray-50","dark:bg-primary","dark:bg-opacity-5"],[1,"flex","flex-col","w-full","gap-2"],[1,""],[1,"flex","flex-row","items-center","gap-1"],[1,"font-bold"],["mat-icon-button","",1,"print:hidden",3,"click"],[1,"icon-size-4",3,"svgIcon"],["class","text-secondary"],[1,"flex","flex-col","gap-2"],["class","flex flex-col text-md"],[1,"mt-10"],[1,"flex","items-center","justify-end","print:hidden","gap-x-4"],["color","primary","mat-flat-button","",3,"disabled","click"],["fuseScrollbar","",1,"grid"],[1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","reception-form-products-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-primary","dark:bg-opacity-5"],[1,"text-left"],[1,"text-center"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","reception-form-products-grid","md:px-8"],[1,"truncate",3,"matTooltip"],[1,"truncate"],[1,"flex","flex-col","items-center","justify-center"],[1,"fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],["matInput","","type","number",1,"font-mono","font-semibold","text-center",3,"min","max","formControl"],["class","w-full text-sm text-center"],[1,"w-full","text-sm","text-center"],["class","grid items-center gap-4 px-6 py-3 border-b reception-form-products-grid md:px-8"],["fuseScrollbar","",1,"grid","w-full","gap-4","px-4","pb-6","lg:grid-cols-4","sm:gap-6",3,"formGroup"],[1,"lg:col-span-2"],[1,"w-full","fuse-mat-textarea",3,"subscriptSizing"],["matInput","","matTextareaAutosize","",3,"formControlName","rows","spellcheck","maxlength","required"],["obsSpare",""],[1,"w-full","text-right"],["obsMissing",""],["obsDamaged",""],[1,"grid","overscroll-y-auto"],[1,"grid","gap-4","px-6","py-4","font-semibold","bg-gray-100","reception-form-products-grid","md:px-8","text-md","text-secondary","dark:bg-primary","dark:bg-opacity-5"],[1,"text-secondary"],[1,"flex","flex-col","text-md"],[1,"font-semibold"]],template:function(i,n){if(1&i){const a=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",3)(5,"div")(6,"a",4),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Almac\xe9n"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Recepciones"),e.qZA()(),e.TgZ(16,"div",5),e._UZ(17,"mat-icon",6),e.TgZ(18,"a",7),e._uU(19,"Confirmar Recepci\xf3n"),e.qZA()()()()(),e._UZ(20,"div",9),e.qZA(),e.TgZ(21,"mat-stepper",10,11),e.ALo(23,"async"),e.TgZ(24,"mat-step",12)(25,"div",13),e.ALo(26,"async"),e.TgZ(27,"div",14),e.YNc(28,Wc,17,0,"div",15),e.qZA(),e.TgZ(29,"div",16)(30,"button",17),e._uU(31,"Atr\xe1s"),e.qZA(),e.TgZ(32,"button",18),e._uU(33,"Siguiente"),e.qZA()()()(),e.YNc(34,Hc,39,34,"mat-step",19),e.TgZ(35,"mat-step",20)(36,"div",13),e.ALo(37,"async"),e.TgZ(38,"div",21)(39,"div",22),e.YNc(40,Yc,22,1),e.TgZ(41,"div",23)(42,"div",24)(43,"span",25),e._uU(44,"Observaciones"),e.qZA(),e.TgZ(45,"button",26),e.NdJ("click",function(){e.CHM(a);const l=e.MAs(22);return e.KtG(l.selectedIndex=2)}),e._UZ(46,"mat-icon",27),e.qZA()(),e.YNc(47,Kc,2,0,"span",28),e.TgZ(48,"div",29),e.YNc(49,Xc,5,1,"div",30)(50,el,5,1,"div",30)(51,tl,5,1,"div",30),e.qZA()()(),e.TgZ(52,"span",31),e._uU(53),e.qZA()(),e.TgZ(54,"div",32)(55,"button",17),e._uU(56,"Atr\xe1s"),e.qZA(),e.TgZ(57,"button",33),e.NdJ("click",function(){return n.confirmDispatch()}),e._uU(58,"Confirmar Despacho"),e.qZA()()()()()()}2&i&&(e.xp6(9),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("orientation",e.lcZ(23,18,n.stepperOrientation)),e.xp6(3),e.Q6J("stepControl",n.dispatchConfirmationFormGroup),e.xp6(),e.Q6J("ngClass",e.VKq(24,ut,"horizontal"===e.lcZ(26,20,n.stepperOrientation))),e.xp6(3),e.um2(28,n.dispatchConfirmationFormGroup.get("products").controls.length>0?28:-1),e.xp6(6),e.um2(34,n.dispatchConfirmationFormGroup.get("haveSpare").value||n.dispatchConfirmationFormGroup.get("haveMissing").value||n.dispatchConfirmationFormGroup.get("haveDamaged").value?34:-1),e.xp6(),e.Q6J("stepControl",n.dispatchConfirmationFormGroup),e.xp6(),e.Q6J("ngClass",e.VKq(26,ut,"horizontal"===e.lcZ(37,22,n.stepperOrientation))),e.xp6(4),e.um2(40,n.dispatchConfirmationFormGroup.get("products").controls.length>0?40:-1),e.xp6(6),e.Q6J("svgIcon","mat_solid:edit"),e.xp6(),e.um2(47,n.dispatchConfirmationFormGroup.get("obsSpare").value||n.dispatchConfirmationFormGroup.get("obsMissing").value||n.dispatchConfirmationFormGroup.get("obsDamaged").value?-1:47),e.xp6(2),e.um2(49,n.dispatchConfirmationFormGroup.get("obsSpare").value?49:-1),e.xp6(),e.um2(50,n.dispatchConfirmationFormGroup.get("obsMissing").value?50:-1),e.xp6(),e.um2(51,n.dispatchConfirmationFormGroup.get("obsDamaged").value?51:-1),e.xp6(2),e.hij("Recibido por: ",n.user.employee.fullname," "),e.xp6(4),e.Q6J("disabled",n.dispatchConfirmationFormGroup.invalid))},dependencies:[h.Ov,h.JJ,s.u5,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.Q7,s.nD,s.qQ,s.Fd,v.ot,v.lW,v.RK,y.Ps,y.Hw,m.lN,m.KE,m.hX,m.bx,m.TO,Z.c,Z.Nt,O.T5,O.C0,O.Vq,O.Ic,O.fd,N.AV,N.gM,h.mk,s.UX,s.oH,s.sg,s.u,x.rH],encapsulation:2,changeDetection:0})}return o})();function il(o,r){if(1&o&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(),e.hij(" ",t.name," ")}}function nl(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El almac\xe9n de salida obligatorio "),e.qZA())}function rl(o,r){if(1&o&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(),e.hij(" ",t.name," ")}}function al(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El almac\xe9n de entrada obligatorio "),e.qZA())}function sl(o,r){1&o&&(e.TgZ(0,"div",26),e._uU(1," \xa1Seleccione el almac\xe9n de salida! "),e.qZA())}function cl(o,r){1&o&&(e.TgZ(0,"div",27),e._UZ(1,"mat-spinner"),e.qZA())}function ll(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-option",36),e.NdJ("click",function(n){const c=e.CHM(t).$implicit;return e.oxw(2).addProductToDispatch(c),e.KtG(n.stopPropagation())}),e.TgZ(1,"div",37),e.NdJ("click",function(n){const c=e.CHM(t).$implicit;return e.oxw(2).addProductToDispatch(c),e.KtG(n.stopPropagation())}),e.TgZ(2,"span",38),e._UZ(3,"mat-checkbox",39),e._uU(4),e.qZA(),e.TgZ(5,"span",40),e._uU(6),e.qZA(),e.TgZ(7,"span",41),e._uU(8),e.ALo(9,"number"),e.qZA()()()}if(2&o){const t=r.$implicit;e.Q6J("value",t),e.xp6(3),e.Q6J("checked",t.checked),e.xp6(),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",t.depot," "),e.xp6(2),e.AsE("",e.xi3(9,6,t.quantity,"1.2-2")," ",t.uom," ")}}const dl=(o,r)=>r.id;function ul(o,r){1&o&&(e.TgZ(0,"mat-error",57),e._uU(1," Valor m\xednimo 0.1 "),e.qZA())}function pl(o,r){if(1&o&&(e.TgZ(0,"mat-error",57),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(),e.hij(" Valor m\xe1ximo ",t.quantity," ")}}function ml(o,r){1&o&&(e.TgZ(0,"mat-error",57),e._uU(1," Patr\xf3n no v\xe1lido "),e.qZA())}function hl(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",46)(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"div",47),e._uU(4),e.qZA(),e.TgZ(5,"div",48)(6,"div",49)(7,"button",50),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.decrementProductQty(a))}),e._UZ(8,"mat-icon",51),e.qZA(),e.TgZ(9,"mat-form-field",52),e._UZ(10,"input",53),e.qZA(),e.TgZ(11,"button",50),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.incrementProductQty(a))}),e._UZ(12,"mat-icon",51),e.qZA()(),e.YNc(13,ul,2,0,"mat-error",54)(14,pl,2,1,"mat-error",54)(15,ml,2,0,"mat-error",54),e.qZA(),e.TgZ(16,"div",55)(17,"button",56),e.NdJ("click",function(){const a=e.CHM(t).$index,c=e.oxw(3);return e.KtG(c.removeProductToDispatch(a))}),e._UZ(18,"mat-icon",51),e.qZA()()()}if(2&o){const t=r.$implicit,i=r.$index;e.xp6(2),e.hij(" ",i+1," "),e.xp6(),e.Q6J("matTooltip",t.get("name").value),e.xp6(),e.hij(" ",t.get("name").value," "),e.xp6(3),e.Q6J("disabled",t.get("quantity").value<=.1||t.get("quantity").hasError("pattern")),e.xp6(),e.Q6J("svgIcon","mat_solid:remove"),e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("min",.1)("formControl",t.get("quantity")),e.xp6(),e.Q6J("disabled",t.get("quantity").hasError("pattern")),e.xp6(),e.Q6J("svgIcon","mat_solid:add"),e.xp6(),e.um2(13,t.get("quantity").hasError("min")?13:-1),e.xp6(),e.um2(14,t.get("quantity").hasError("max")?14:-1),e.xp6(),e.um2(15,t.get("quantity").hasError("pattern")&&!t.get("quantity").hasError("min")?15:-1),e.xp6(3),e.Q6J("svgIcon","mat_solid:close")}}function gl(o,r){if(1&o&&(e.TgZ(0,"div",42)(1,"div",43),e._UZ(2,"div"),e.TgZ(3,"div",44),e._uU(4," Producto "),e.qZA(),e.TgZ(5,"div",45),e._uU(6," Cantidad "),e.qZA(),e.TgZ(7,"div",45),e._uU(8," Quitar "),e.qZA()(),e.SjG(9,hl,19,14,"div",58,dl),e.qZA()),2&o){const t=e.oxw(2);e.xp6(9),e.wJu(t.dispatchingForm.get("products").controls)}}function fl(o,r){1&o&&(e.TgZ(0,"div",26),e._uU(1," \xa1No ha seleccionado ning\xfan producto a\xfan! "),e.qZA())}const _l=()=>({suppressScrollY:!0});function vl(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",28)(1,"mat-form-field",29),e._UZ(2,"mat-icon",30)(3,"input",31),e.TgZ(4,"mat-autocomplete",32,33),e.NdJ("closed",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.searchProductControl.reset())}),e.SjG(6,ll,10,9,"mat-option",59,e.x6l),e.ALo(8,"async"),e.qZA()(),e.TgZ(9,"div",34),e.YNc(10,gl,11,0,"div",35)(11,fl,2,0),e.qZA()()}if(2&o){const t=e.MAs(5),i=e.oxw();e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",i.searchProductControl)("matAutocomplete",t)("placeholder","Buscar existencia de productos en inventario"),e.xp6(),e.Q6J("displayWith",i.displayFn),e.xp6(2),e.wJu(e.lcZ(8,8,i.productsFiltered)),e.xp6(3),e.Q6J("fuseScrollbarOptions",e.DdM(10,_l)),e.xp6(),e.um2(10,i.dispatchingForm.get("products").controls.length>0?10:11)}}const xl=()=>({suppressScrollX:!0});let bl=(()=>{class o{constructor(){this.depotsEnd=[],this.depotsEndFilter=[],this.loadingProducts=!1,this.ownDepots=[],this.ownDepotsFilter=[],this.products=[],this.productsInStock$=(0,S.of)([]),this.searchProductControl=new s.NI(null),this.stayHere=!1,this._changeDetectorRef=(0,e.f3M)(e.sBO),this._dispatchesService=(0,e.f3M)(De),this._formBuilder=(0,e.f3M)(s.qu),this._fuseConfirmationService=(0,e.f3M)(H.R),this._router=(0,e.f3M)(x.F0),this._snackBar=(0,e.f3M)(G.ux),this._stocksService=(0,e.f3M)(Ae.T),this._unsubscribeAll=new E.x,this.store=(0,e.f3M)(A.yh)}ngOnInit(){this.dispatchingForm=this._formBuilder.group({id:new s.NI,depotInitId:new s.NI(null,[s.kI.required]),depotEndId:new s.NI(null,[s.kI.required]),needConfirmation:new s.NI(!0),products:new s.Oe([])}),this.store.select(W.$I).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.depotsEnd=t.filter(i=>!i.static),this.depotsEndFilter=t.filter(i=>!i.static),this._changeDetectorRef.markForCheck()}),this.store.select(W.Wt).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.ownDepots=t.filter(i=>!i.static),this._changeDetectorRef.markForCheck()}),this.productsInStock$=this.store.select(ge.K2),this.dispatchingForm.get("depotInitId").valueChanges.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.depotsEndFilter=this.depotsEnd.filter(i=>i.id!==t),this.searchProductControl.setValue(""),this.dispatchingForm.get("depotEndId").setValue(null),this._changeDetectorRef.markForCheck()}),this.productsFiltered=this.searchProductControl.valueChanges.pipe((0,q.b)(200),(0,k.O)(""),(0,ee.z)(t=>{const i=this.dispatchingForm.get("depotInitId").value;return this._mapChecked(null!==t&&"string"==typeof t&&i?this._stocksService.getProductsInStockAvailable(t,100,i):this.productsInStock$)}))}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}addStockProduct(t){const i=this._formBuilder.group({productId:new s.NI(t.productId,[s.kI.required]),name:new s.NI(t.name,[s.kI.required]),uom:new s.NI(t.uom,[s.kI.required]),depotId:new s.NI(t.depotId,[s.kI.required]),quantity:new s.NI(1,[te.L.onlyNumbersPattern(),s.kI.required,s.kI.min(.1),s.kI.max(t.quantity)])});this.dispatchingForm.get("products").push(i),this._changeDetectorRef.markForCheck()}removeStockProduct(t){this.dispatchingForm.get("products").removeAt(t),this._changeDetectorRef.markForCheck()}addProductToDispatch(t){const i=this.dispatchingForm.get("products").getRawValue().findIndex(n=>n.productId===t.productId&&n.depotId===t.depotId);t.checked?(this.removeStockProduct(i),t.checked=!1):t.checked=!0,!(i>-1)&&this.addStockProduct(t)}incrementProductQty(t){let i=t.get("quantity").value;t.get("quantity").setValue(+i+1)}decrementProductQty(t){let i=t.get("quantity").value;t.get("quantity").setValue(+i-1)}removeProductToDispatch(t){this.removeStockProduct(t),this.searchProductControl.reset()}createDispatch(){if(this.dispatchingForm.invalid)return;if(0===this.dispatchingForm.get("products").controls.length)return void this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Alerta",message:"Debe agrear al menos un producto al despacho",type:"warning",svgIcon:"mat_solid:warning"}});const t=this.dispatchingForm.getRawValue();delete t.id,t.products.forEach(n=>{delete n.depotId,n.quantity=Number(n.quantity)}),this._fuseConfirmationService.open({title:"Generar Despacho",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,u.R)(this._unsubscribeAll)).subscribe(n=>{"confirmed"===n&&this._dispatchesService.createDispatch(t).pipe((0,u.R)(this._unsubscribeAll),(0,re.x)(()=>{this._changeDetectorRef.markForCheck()})).subscribe(({data:a})=>{a&&(this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:a.createDispatch.message,type:"success",svgIcon:"mat_solid:done"}}),this.stayHere?this.restoreForm():this._router.navigateByUrl("/warehouse/dispatches-list"))})})}displayFn(t){return t&&t.name?t.name:""}restoreForm(){this.dispatchingForm.get("products").clear(),this.searchProductControl.reset(),this.dispatchingForm.reset(),this.searchProductControl.setValue("")}_mapChecked(t){return t.pipe((0,_.U)(i=>i.map(n=>this.dispatchingForm.get("products").getRawValue().some(c=>c.productId===n.productId&&c.depotId===n.depotId)?{...structuredClone(n),checked:!0}:{...structuredClone(n),checked:!1})))}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-dispatches-form"]],standalone:!0,features:[e.jDz],decls:52,vars:18,consts:[["fuseScrollbar","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-auto","bg-card","dark:bg-transparent",3,"fuseScrollbarOptions"],[1,"relative","flex","flex-col","px-6","py-8","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],["routerLink","/warehouse/dispatches-list",1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["color","primary",3,"ngModel","ngModelChange"],["mat-flat-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"disabled","click"],[1,"flex","flex-col","px-4","mt-4","mb-12","gap-y-8","sm:px-8"],[1,"shadow","rounded-2xl","bg-card"],[1,"grid","p-10","gap-x-4","sm:grid-cols-2",3,"formGroup"],["dispatchingNgForm","ngForm"],[1,"w-full","fuse-mat-dense"],[3,"formControlName","required"],[1,"sm:col-span-2"],["color","primary",3,"formControlName"],["class","p-8 text-4xl font-semibold tracking-tight text-center border-t sm:p-30"],["class","flex items-center justify-center w-full h-200"],["class","p-6 pb-0"],[3,"value"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-30"],[1,"flex","items-center","justify-center","w-full","h-200"],[1,"p-6","pb-0"],["appearance","fill",1,"w-full","fuse-mat-dense",3,"subscriptSizing"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete",3,"displayWith","closed"],["productsAutocomplete","matAutocomplete"],["fuseScrollbar","",1,"flex","flex-col","flex-auto","pb-2","mt-2","min-h-72",3,"fuseScrollbarOptions"],["class","grid"],[1,"w-full",3,"value","click"],[1,"grid","w-full","grid-cols-6",3,"click"],[1,"flex","flex-row","items-center","col-span-5","truncate","md:col-span-3"],["color","primary",3,"checked"],[1,"items-center","hidden","col-span-2","md:flex"],[1,"flex","items-center","text-center"],[1,"grid"],[1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","dispatching-products-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-primary","dark:bg-opacity-5"],[1,"text-left"],[1,"text-center"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","dispatching-products-grid","md:px-8"],[1,"truncate",3,"matTooltip"],[1,"flex","flex-col","justify-center"],[1,"flex","flex-row","items-center","justify-center","gap-2"],["mat-stroked-button","",1,"p-2","leading-6","min-w-7","min-h-7","h-7",3,"disabled","click"],[1,"icon-size-5",3,"svgIcon"],[1,"fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],["matInput","","type","number","name","quantity",1,"font-mono","font-semibold","text-center",3,"min","formControl"],["class","w-full text-sm text-center"],[1,"flex","justify-center"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"w-full","text-sm","text-center"],["class","grid items-center gap-4 px-6 py-3 border-b dispatching-products-grid md:px-8"],["class","w-full",3,"value"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Almac\xe9n"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",8),e._uU(14,"Despachos"),e.qZA()(),e.TgZ(15,"div",5),e._UZ(16,"mat-icon",6),e.TgZ(17,"a",7),e._uU(18,"Despachar Mercanc\xedas"),e.qZA()()(),e.TgZ(19,"div",9)(20,"h2",10),e._uU(21," Despachar Mercanc\xedas "),e.qZA()()(),e.TgZ(22,"div",11)(23,"mat-checkbox",12),e.NdJ("ngModelChange",function(c){return n.stayHere=c}),e._uU(24,"Permanecer aqu\xed"),e.qZA(),e.TgZ(25,"button",13),e.NdJ("click",function(){return n.createDispatch()}),e._uU(26," Generar Despacho "),e.qZA()()(),e.TgZ(27,"div",14)(28,"div",15)(29,"form",16,17)(31,"mat-form-field",18)(32,"mat-label"),e._uU(33,"Almac\xe9n de Salida"),e.qZA(),e.TgZ(34,"mat-select",19),e.SjG(35,il,2,2,"mat-option",25,e.x6l),e.qZA(),e.YNc(37,nl,2,0,"mat-error"),e.qZA(),e.TgZ(38,"mat-form-field",18)(39,"mat-label"),e._uU(40,"Almac\xe9n de Entrada"),e.qZA(),e.TgZ(41,"mat-select",19),e.SjG(42,rl,2,2,"mat-option",25,e.x6l),e.qZA(),e.YNc(44,al,2,0,"mat-error"),e.qZA(),e.TgZ(45,"div",20)(46,"mat-checkbox",21),e._uU(47,"\xbfNecesita Confirmaci\xf3n?"),e.qZA()()()(),e.TgZ(48,"div",15),e.YNc(49,sl,2,0,"div",22)(50,cl,2,0,"div",23)(51,vl,12,11,"div",24),e.qZA()()()),2&i&&(e.Q6J("fuseScrollbarOptions",e.DdM(17,xl)),e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(7),e.Q6J("ngModel",n.stayHere),e.xp6(2),e.Q6J("disabled",n.dispatchingForm.invalid),e.xp6(4),e.Q6J("formGroup",n.dispatchingForm),e.xp6(5),e.Q6J("formControlName","depotInitId")("required",!0),e.xp6(),e.wJu(n.ownDepots),e.xp6(2),e.um2(37,n.dispatchingForm.get("depotInitId").hasError("required")?37:-1),e.xp6(4),e.Q6J("formControlName","depotEndId")("required",!0),e.xp6(),e.wJu(n.depotsEndFilter),e.xp6(2),e.um2(44,n.dispatchingForm.get("depotEndId").hasError("required")?44:-1),e.xp6(2),e.Q6J("formControlName","needConfirmation"),e.xp6(3),e.um2(49,null===n.dispatchingForm.get("depotInitId").value?49:-1),e.xp6(),e.um2(50,n.loadingProducts?50:-1),e.xp6(),e.um2(51,n.loadingProducts||null===n.dispatchingForm.get("depotInitId").value?-1:51))},dependencies:[h.Ov,h.JJ,s.u5,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.Q7,s.qQ,s.On,nt.H,Q.Bb,Q.XC,ie.ey,Q.ZL,v.ot,v.lW,ue.p9,ue.oG,m.lN,m.KE,m.hX,m.TO,m.qo,y.Ps,y.Hw,Z.c,Z.Nt,K.Cq,K.Ou,X.LD,X.gD,N.AV,N.gM,s.UX,s.oH,s.sg,s.u,x.rH],encapsulation:2,changeDetection:0})}return o})();var Cl=d(90621);const yl=()=>["/warehouse/dispatches-form"];function Zl(o,r){1&o&&(e.TgZ(0,"button",17),e._UZ(1,"mat-icon",18),e.TgZ(2,"span",19),e._uU(3,"Agregar"),e.qZA()()),2&o&&(e.Q6J("routerLink",e.DdM(2,yl)),e.xp6(),e.Q6J("svgIcon","mat_solid:add"))}const Tl=(o,r)=>r.id,Al=(o,r)=>({"text-red-500":o,"text-green-500":r}),Il=o=>["/warehouse/dispatch-confirm",o];function kl(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",26)(1,"div",27),e._uU(2),e.qZA(),e.TgZ(3,"div",28),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"div",27),e._uU(7),e.qZA(),e.TgZ(8,"div",27),e._uU(9),e.qZA(),e.TgZ(10,"div",23),e._uU(11),e.qZA(),e.TgZ(12,"div",29),e._UZ(13,"mat-icon",30),e.qZA(),e.TgZ(14,"div",31)(15,"button",32),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.viewDispatchReport(a))}),e._UZ(16,"mat-icon",33),e.qZA(),e.TgZ(17,"button",34),e._UZ(18,"mat-icon",33),e.qZA()()()}if(2&o){const t=r.$implicit;e.xp6(2),e.hij(" ",t.no," "),e.xp6(2),e.hij(" ",e.xi3(5,12,t.createdAt,"dd/MM/yyyy hh:mm a")," "),e.xp6(3),e.hij(" ",t.depotInit.name," "),e.xp6(2),e.hij(" ",t.depotEnd.name," "),e.xp6(2),e.hij(" ",t.user.fullname," "),e.xp6(2),e.Q6J("ngClass",e.WLB(15,Al,!t.confirmed,t.confirmed))("svgIcon",t.confirmed?"mat_solid:done":"mat_solid:close")("matTooltip",t.confirmed?"Confirmado":"Sin Confirmaci\xf3n"),e.xp6(3),e.Q6J("svgIcon","mat_solid:description"),e.xp6(),e.Q6J("routerLink",e.VKq(18,Il,t.id))("disabled",t.confirmed),e.xp6(),e.Q6J("svgIcon","mat_solid:find_in_page")}}const wl=o=>({"pointer-events-none":o}),ql=()=>[5,10,25,100];function Fl(o,r){if(1&o&&(e.TgZ(0,"div",20)(1,"div",21)(2,"div",22),e._uU(3,"No."),e.qZA(),e.TgZ(4,"div",23),e._uU(5," Fecha "),e.qZA(),e.TgZ(6,"div",23),e._uU(7," Origen "),e.qZA(),e.TgZ(8,"div",23),e._uU(9," Destino "),e.qZA(),e.TgZ(10,"div",23),e._uU(11," Empleado "),e.qZA(),e.TgZ(12,"div",24),e._uU(13," Confirmaci\xf3n "),e.qZA(),e.TgZ(14,"div",24),e._uU(15," Detalles "),e.qZA()(),e.SjG(16,kl,19,20,"div",35,Tl),e.qZA(),e._UZ(18,"mat-paginator",25)),2&o){const t=e.oxw();e.xp6(2),e.Q6J("mat-sort-header","no"),e.xp6(14),e.wJu(t.dispatches),e.xp6(2),e.Q6J("ngClass",e.VKq(7,wl,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(9,ql))("showFirstLastButtons",!0)}}function Sl(o,r){1&o&&(e.TgZ(0,"div",36),e._uU(1,"\xa1No se ha creado ning\xfan despacho!"),e.qZA())}const Dl=()=>["Cajero"];let Ul=(()=>{class o{constructor(){this.isLoading=!1,this.dispatches=[],this.searchInputControl=new s.NI(""),this.merchant=null,this.user=null,this._changeDetectorRef=(0,e.f3M)(e.sBO),this._dispatchesService=(0,e.f3M)(De),this._documentsService=(0,e.f3M)(Ie.S),this._unsubscribeAll=new E.x,this._permissionsService=(0,e.f3M)(Cl.YI),this.store=(0,e.f3M)(A.yh)}ngOnInit(){this.store.select(se.rk).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(me.Qs).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(ae.B).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.store.select(Qe).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.dispatches=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,q.b)(300),(0,f.w)(t=>null!==t?(this.isLoading=!0,this._dispatchesService.getDispatches(0,25,"no","desc",t)):(0,S.of)()),(0,_.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this.waitForPaginatorLoad().then(()=>{this._sort&&this._paginator&&(this._sort.sort({id:"no",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,B.T)(this._sort.sortChange,this._paginator.page).pipe((0,f.w)(()=>this._dispatchesService.getDispatches(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value)),(0,_.U)(()=>{this.isLoading=!1})).subscribe())})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}viewDispatchReport(t){this._documentsService.generateDispatchDocument(t,this.merchant,this.user)}waitForPaginatorLoad(){var t=this;return(0,Ze.Z)(function*(){for(;!t._paginator||void 0===t._paginator;)yield new Promise(i=>{setTimeout(i,200)});return t._paginator})()}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["dispatches-list"]],viewQuery:function(i,n){if(1&i&&(e.Gf(g.NW,5),e.Gf(C.YE,5)),2&i){let a;e.iGM(a=e.CRH())&&(n._paginator=a.first),e.iGM(a=e.CRH())&&(n._sort=a.first)}},standalone:!0,features:[e.jDz],decls:27,vars:10,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["class","ml-4","mat-raised-button","","class","text-white bg-gradient-to-r from-primary-500 to-primary-700",3,"routerLink",4,"ngxPermissionsExcept"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-auto"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"routerLink"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","dispatches-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[3,"mat-sort-header"],[1,""],[1,"text-center"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","dispatches-grid","md:px-8"],[1,"truncate"],[1,"flex","flex-wrap","gap-1","font-mono"],[1,"flex","items-center","justify-center"],[1,"icon-size-7",3,"ngClass","svgIcon","matTooltip"],[1,"flex","flex-row","items-center","justify-center","gap-1"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink","disabled"],["class","grid items-center gap-4 px-6 py-3 border-b dispatches-grid md:px-8"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Almac\xe9n"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",7),e._uU(14,"Registro de Despachos"),e.qZA()()(),e.TgZ(15,"div",8)(16,"h2",9),e._uU(17," Registro de Despachos "),e.qZA()()(),e.TgZ(18,"div",10)(19,"mat-form-field",11),e._UZ(20,"mat-icon",12)(21,"input",13),e.qZA(),e.YNc(22,Zl,4,3,"button",14),e.qZA()(),e.TgZ(23,"div",15)(24,"div",16),e.YNc(25,Fl,19,10)(26,Sl,2,0),e.qZA()()()),2&i&&(e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(7),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),e.xp6(),e.Q6J("ngxPermissionsExcept",e.DdM(9,Dl)),e.xp6(3),e.um2(25,n.dispatches.length>0?25:26))},dependencies:[h.uU,h.mk,m.lN,m.KE,m.qo,C.JX,C.YE,C.nU,g.TU,g.NW,v.ot,v.lW,y.Ps,y.Hw,Z.c,Z.Nt,N.AV,N.gM,s.UX,s.Fj,s.JJ,s.oH,x.rH],encapsulation:2})}return o})();var Pl=d(44565);const Ml=["stockTemplateFile"],El=(o,r)=>r.id;function Jl(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Campo requerido "),e.qZA())}function Rl(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Campo requerido "),e.qZA())}function Nl(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Valor entre 3 y 255 caracteres. "),e.qZA())}function Ql(o,r){if(1&o&&(e.TgZ(0,"mat-option",45),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t.abbr),e.xp6(),e.hij(" ",t.abbr," ")}}function Ll(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Campo requerido "),e.qZA())}function Wl(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Valor m\xednimo de 0.1 "),e.qZA())}function zl(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Campo requerido "),e.qZA())}function $l(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"form",26)(1,"div"),e._uU(2),e.qZA(),e.ynx(3),e.TgZ(4,"mat-form-field",27),e._UZ(5,"input",28),e.YNc(6,Jl,2,0,"mat-error"),e.qZA(),e.BQk(),e.ynx(7),e.TgZ(8,"mat-form-field",29),e._UZ(9,"input",30),e.qZA(),e.BQk(),e.ynx(10),e.TgZ(11,"mat-form-field",29),e._UZ(12,"input",30),e.qZA(),e.BQk(),e.TgZ(13,"mat-form-field",29),e._UZ(14,"input",28),e.YNc(15,Rl,2,0,"mat-error")(16,Nl,2,0,"mat-error"),e.qZA(),e.TgZ(17,"mat-form-field",29),e._UZ(18,"input",31,32),e.TgZ(20,"span",33),e._uU(21),e.qZA()(),e.ynx(22),e.TgZ(23,"mat-form-field",29)(24,"mat-select",34),e.SjG(25,Ql,2,2,"mat-option",45,e.x6l),e.ALo(27,"async"),e.qZA()(),e.BQk(),e.TgZ(28,"mat-form-field",29),e._UZ(29,"input",35),e.YNc(30,Ll,2,0,"mat-error")(31,Wl,2,0,"mat-error"),e.qZA(),e.TgZ(32,"mat-form-field",36),e._UZ(33,"mat-icon",37)(34,"input",38),e.YNc(35,zl,2,0,"mat-error"),e.qZA(),e.ynx(36),e.TgZ(37,"mat-form-field",29),e._UZ(38,"input",39),e.qZA(),e.BQk(),e.TgZ(39,"mat-form-field",29),e._UZ(40,"mat-icon",40)(41,"input",41),e.qZA(),e.TgZ(42,"mat-form-field",29),e._UZ(43,"mat-icon",42)(44,"input",41),e.qZA(),e.TgZ(45,"mat-form-field",29),e._UZ(46,"mat-icon",42)(47,"input",41),e.qZA(),e.TgZ(48,"mat-form-field",29),e._UZ(49,"mat-icon",42)(50,"input",41),e.qZA(),e.TgZ(51,"mat-form-field",29),e._UZ(52,"mat-icon",42)(53,"input",41),e.qZA(),e.TgZ(54,"div",43)(55,"button",44),e.NdJ("click",function(){const a=e.CHM(t).$index,c=e.oxw(3);return e.KtG(c.removeProduct(a))}),e._UZ(56,"mat-icon",24),e.qZA()()()}if(2&o){const t=r.$implicit,i=r.$index,n=e.MAs(19),a=e.oxw(3);e.Q6J("formGroup",t),e.xp6(2),e.Oqu(i+1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("formControlName","upc"),e.xp6(),e.um2(6,t.get("upc").hasError("required")?6:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("formControlName","sku"),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("formControlName","bCode"),e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("formControlName","name"),e.xp6(),e.um2(15,t.get("name").hasError("required")?15:-1),e.xp6(),e.um2(16,t.get("name").hasError("minlength")||t.get("name").hasError("maxlength")?16:-1),e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("formControlName","description"),e.xp6(3),e.hij("",n.value.length," / 10000"),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("formControlName","uom"),e.xp6(),e.wJu(e.lcZ(27,38,a.uoms$)),e.xp6(3),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("formControlName","quantity"),e.xp6(),e.um2(30,t.get("quantity").hasError("required")?30:-1),e.xp6(),e.um2(31,t.get("quantity").hasError("min")?31:-1),e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(2),e.Q6J("formControlName","price"),e.xp6(),e.um2(35,t.get("price").hasError("required")?35:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("formControlName","brand"),e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(2),e.Q6J("formControlName","weight"),e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(2),e.Q6J("formControlName","width"),e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(2),e.Q6J("formControlName","length"),e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(2),e.Q6J("formControlName","height"),e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(2),e.Q6J("formControlName","volume"),e.xp6(3),e.Q6J("svgIcon","mat_solid:close")}}function Gl(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",18)(1,"div",19)(2,"div"),e._uU(3,"#"),e.qZA(),e.TgZ(4,"div",20),e._uU(5,"UPC *"),e.qZA(),e.TgZ(6,"div",20),e._uU(7,"SKU"),e.qZA(),e.TgZ(8,"div",20),e._uU(9,"C\xf3digo"),e.qZA(),e.TgZ(10,"div",20),e._uU(11,"Nombre *"),e.qZA(),e.TgZ(12,"div",20),e._uU(13,"Descripci\xf3n"),e.qZA(),e.TgZ(14,"div",20),e._uU(15,"U.Medida"),e.qZA(),e.TgZ(16,"div",20),e._uU(17,"Cantidad *"),e.qZA(),e.TgZ(18,"div",20),e._uU(19,"Precio *"),e.qZA(),e.TgZ(20,"div",20),e._uU(21,"Marca"),e.qZA(),e.TgZ(22,"div",20),e._uU(23,"Peso"),e.qZA(),e.TgZ(24,"div",20),e._uU(25,"Ancho"),e.qZA(),e.TgZ(26,"div",20),e._uU(27,"Largo"),e.qZA(),e.TgZ(28,"div",20),e._uU(29,"Altura"),e.qZA(),e.TgZ(30,"div",20),e._uU(31,"Volumen"),e.qZA(),e.TgZ(32,"div",21),e._uU(33,"Quitar"),e.qZA()(),e.SjG(34,$l,57,40,"form",46,El),e.TgZ(36,"div",22)(37,"div",23),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.addNewProduct())}),e._UZ(38,"mat-icon",24),e.TgZ(39,"span",25),e._uU(40," Agregar Producto "),e.qZA()(),e.TgZ(41,"div",23),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.addNewProduct())}),e._UZ(42,"mat-icon",24),e.TgZ(43,"span",25),e._uU(44," Agregar Producto "),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(34),e.wJu(t),e.xp6(4),e.Q6J("svgIcon","mat_solid:add_circle"),e.xp6(4),e.Q6J("svgIcon","mat_solid:add_circle")}}function Ol(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",47)(1,"div",48)(2,"label",49),e._UZ(3,"mat-icon",50),e._uU(4," Importar Plantilla "),e.qZA(),e.TgZ(5,"input",51,52),e.NdJ("change",function(n){e.CHM(t);const a=e.oxw(2);return e.KtG(a.importStockFormTemplateFile(n))}),e.qZA()(),e.TgZ(7,"div",53),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.addNewProduct())}),e.TgZ(8,"label",54),e._UZ(9,"mat-icon",50),e._uU(10," Agregar Producto "),e.qZA()()()}2&o&&(e.xp6(3),e.Q6J("svgIcon","mat_solid:upload"),e.xp6(6),e.Q6J("svgIcon","mat_solid:add"))}function jl(o,r){1&o&&e.YNc(0,Gl,45,2,"div",17)(1,Ol,11,2),2&o&&e.um2(0,r.length>0?0:1)}const Bl=o=>({"cursor-not-allowed":o});let Hl=(()=>{class o{constructor(t,i,n,a,c,l){this._changeDetectorRef=t,this._dialog=i,this._formBuilder=n,this._router=a,this._productsService=c,this.store=l,this.uoms$=(0,S.of)([]),this._snackBar=(0,e.f3M)(G.ux),this._unsubscribeAll=new E.x}ngOnInit(){this.uoms$=this.store.select(Bt.av),this.productsForm=this._formBuilder.group({products:this._formBuilder.array([])}),this.store.select(ge.Wy).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{if(t&&t.length>0){const i=t.map(n=>this.createProductFormGroup(n));this.productsForm.setControl("products",this._formBuilder.array(i)),this._changeDetectorRef.markForCheck()}})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}addNewProduct(){this.productsForm.get("products").push(this.createEmptyProductFormGroup())}removeProduct(t){this.productsForm.get("products").removeAt(t)}importStockFormTemplateFile(t){const i=t.target;this.isExcelFile=!!i.files[0].name.match(/(.xls|.xlsx)/),i.files.length>1&&(this.stockTemplateFile.nativeElement.value=""),this.isExcelFile?this._productsService.importStockFormTemplateFile(t):this.stockTemplateFile.nativeElement.value=""}selectDepot(){const t=this.productsForm.get("products").getRawValue();this.openDialog().afterClosed().pipe((0,u.R)(this._unsubscribeAll)).subscribe(n=>{n&&!Ne.W.IsNullOrEmpty(n.depot)&&this.importProducts(t,n.depot.id)})}createProductFormGroup(t){return this._formBuilder.group({upc:[t.upc,[s.kI.required]],sku:[t.sku],bCode:[t.bCode],name:[t.name,[s.kI.required]],description:[t.description,[s.kI.maxLength(1e4)]],uom:[t.uom],quantity:[t.quantity,[s.kI.min(.1)]],price:[t.price,[s.kI.required,s.kI.min(0)]],brand:[t.brand],weight:[t.weight,[s.kI.min(0)]],width:[t.width,[s.kI.min(0)]],length:[t.length,[s.kI.min(0)]],height:[t.height,[s.kI.min(0)]],volume:[t.volume,[s.kI.min(0)]]})}createEmptyProductFormGroup(){return this._formBuilder.group({upc:[null,[s.kI.required]],sku:[null],bCode:[null],name:[null,[s.kI.required]],description:[null,[s.kI.maxLength(1e4)]],uom:[""],quantity:[1,[s.kI.min(.1)]],price:[0,[s.kI.required,s.kI.min(0)]],brand:[""],weight:[0,[s.kI.min(0)]],width:[0,[s.kI.min(0)]],length:[0,[s.kI.min(0)]],height:[0,[s.kI.min(0)]],volume:[0,[s.kI.min(0)]]})}openDialog(){return this._dialog.open(Pl.v,{data:{},panelClass:"ath-dialog-panel",disableClose:!0})}importProducts(t,i){this._productsService.importProductsFromTemplateFile(t,i).pipe((0,u.R)(this._unsubscribeAll)).subscribe(({data:n})=>{n&&(this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:n.importProductsFromTemplateFile.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.store.dispatch((0,Yt.vp)()),this._router.navigateByUrl("/warehouse/products")),this._changeDetectorRef.markForCheck()})}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(e.sBO),e.Y36(R.uw),e.Y36(s.qu),e.Y36(x.F0),e.Y36(Pe.s),e.Y36(A.yh))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["load-products"]],viewQuery:function(i,n){if(1&i&&e.Gf(Ml,5),2&i){let a;e.iGM(a=e.CRH())&&(n.stockTemplateFile=a.first)}},standalone:!0,features:[e.jDz],decls:27,vars:8,consts:[["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/warehouse/products",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["mat-raised-button","",1,"ml-8","text-white","md:ml-0","md:fixed","right-8","bg-gradient-to-r","from-primary-500","to-primary-600",3,"disabled","ngClass","click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto","h-full"],["class","grid"],[1,"grid"],[1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","products-Template-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-gray-900"],[1,"text-center"],[1,"text-end"],[1,"flex","justify-between","px-8","py-8"],[1,"inline-flex","items-center","rounded","cursor-pointer",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2","font-medium","text-secondary","group-hover:underline"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","products-Template-grid","md:px-8",3,"formGroup"],["matTooltip","C\xf3digo de barras",1,"w-full","fuse-mat-dense",3,"subscriptSizing"],["matInput","","type","text","minlength","3","maxlength","255","required","",3,"formControlName"],[1,"w-full","fuse-mat-dense",3,"subscriptSizing"],["matInput","","type","text","minlength","3","maxlength","255",3,"formControlName"],["matInput","","type","text","matInput","","matTextareaAutoSize","","maxlength","10000","rows","1",3,"formControlName"],["descriptionLength",""],["matSuffix","",1,"ml-2"],[3,"formControlName"],["matInput","","type","number","min","0.1","max","999999999","required","",3,"formControlName"],[1,"w-full","sm:","fuse-mat-dense",3,"subscriptSizing"],["matPrefix","","svgIcon","mat_solid:attach_money"],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName"],["matInput","","type","text","minlength","1","maxlength","255",3,"formControlName"],["matPrefix","","svgIcon","mat_solid:scale"],["matInput","","type","number","min","0","max","999999999","maxlength","9",3,"formControlName"],["matPrefix","","svgIcon","mat_solid:square_foot"],[1,"flex","justify-end"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[3,"value"],["class","z-0 grid items-center gap-4 px-6 py-3 bg-white border-b dark:bg-default products-Template-grid md:px-8",3,"formGroup"],[1,"flex","flex-row","items-center","justify-center","w-full","min-h-full","space-x-4"],[1,"flex","flex-col","items-center","justify-center","p-5","rounded-md","cursor-pointer","hover:bg-hover","hover:shadow-md"],["for","stock-template-file-input",1,"flex","flex-col","items-center","justify-center","text-xl","font-bold","cursor-pointer"],[1,"icon-size-20",3,"svgIcon"],["id","stock-template-file-input","type","file","accept",".xls, .xlsx",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"change"],["stockTemplateFile",""],[1,"flex","flex-col","items-center","justify-center","p-5","rounded-md","cursor-pointer","hover:bg-hover","hover:shadow-md",3,"click"],[1,"flex","flex-col","items-center","justify-center","text-xl","font-bold","cursor-pointer"]],template:function(i,n){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div")(6,"a",4),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Productos"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Crear Productos"),e.qZA()()()(),e.TgZ(16,"div",9)(17,"h2",10),e._uU(18," Plantilla de Existencia "),e.qZA()()(),e.TgZ(19,"div",11)(20,"button",12),e.NdJ("click",function(){return n.selectDepot()}),e._UZ(21,"mat-icon",13),e.TgZ(22,"span",14),e._uU(23,"Seleccionar Almac\xe9n y Guardar"),e.qZA()()()(),e.TgZ(24,"div",15)(25,"div",16),e.YNc(26,jl,2,1),e.qZA()()()),2&i){let a;e.xp6(9),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(7),e.Q6J("disabled",n.productsForm.invalid||0===n.productsForm.get("products").getRawValue().length)("ngClass",e.VKq(6,Bl,n.productsForm.invalid||0===n.productsForm.get("products").getRawValue().length)),e.xp6(),e.Q6J("svgIcon","mat_solid:save"),e.xp6(5),e.um2(26,(a=n.productsForm.get("products").controls)?26:-1,a)}},dependencies:[h.Ov,v.ot,v.lW,m.lN,m.KE,m.TO,m.qo,m.R9,y.Ps,y.Hw,Z.c,Z.Nt,X.LD,X.gD,ie.ey,h.mk,s.UX,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.Q7,s.wO,s.nD,s.qQ,s.Fd,s.sg,s.u],encapsulation:2,changeDetection:0})}return o})();function Vl(o,r){if(1&o&&(e.TgZ(0,"div",21)(1,"div",22),e._uU(2),e.qZA(),e.TgZ(3,"div",20),e._uU(4),e.qZA(),e.TgZ(5,"div",20),e._uU(6),e.qZA(),e.TgZ(7,"div",20),e._uU(8),e.qZA(),e.TgZ(9,"div",20),e._uU(10),e.qZA(),e.TgZ(11,"div",20),e._uU(12),e.qZA(),e.TgZ(13,"div",20),e._uU(14),e.qZA(),e.TgZ(15,"div",20),e._uU(16),e.qZA(),e.TgZ(17,"div",20),e._uU(18),e.qZA(),e.TgZ(19,"div",20),e._uU(20),e.ALo(21,"number"),e.qZA()()),2&o){const t=r.$implicit;e.xp6(2),e.hij(" ",t.productName," "),e.xp6(2),e.hij(" ",t.uomAbbr," "),e.xp6(2),e.hij(" ",t.initialInventory," "),e.xp6(2),e.hij(" ",t.entries," "),e.xp6(2),e.hij(" ",t.shrinkages," "),e.xp6(2),e.hij(" ",t.losses," "),e.xp6(2),e.hij(" ",t.sold," "),e.xp6(2),e.hij(" ",t.returned," "),e.xp6(2),e.hij(" ",t.finalInventory," "),e.xp6(2),e.hij(" ",e.xi3(21,10,t.totalSales,"1.2-2")," ")}}function Yl(o,r){if(1&o&&(e.TgZ(0,"div",18)(1,"div",19)(2,"div"),e._uU(3,"Producto"),e.qZA(),e.TgZ(4,"div",20),e._uU(5," U.M "),e.qZA(),e.TgZ(6,"div",20),e._uU(7," Inicial "),e.qZA(),e.TgZ(8,"div",20),e._uU(9," Entrada "),e.qZA(),e.TgZ(10,"div",20),e._uU(11," Merma "),e.qZA(),e.TgZ(12,"div",20),e._uU(13," Perdido "),e.qZA(),e.TgZ(14,"div",20),e._uU(15," Vendido "),e.qZA(),e.TgZ(16,"div",20),e._uU(17," Devuelto "),e.qZA(),e.TgZ(18,"div",20),e._uU(19," Final "),e.qZA(),e.TgZ(20,"div",20),e._uU(21," Importe de Venta "),e.qZA()(),e.SjG(22,Vl,22,13,"div",23,e.x6l),e.qZA()),2&o){const t=e.oxw(3);e.xp6(22),e.wJu(t.ipv.ipvProductsData)}}function Kl(o,r){if(1&o&&(e.TgZ(0,"div",24),e._uU(1),e.qZA()),2&o){const t=e.oxw(3);e.xp6(),e.hij(" \xa1No se han encontrado productos en el almac\xe9n ",t.depot.name,"! ")}}function Xl(o,r){if(1&o&&(e.TgZ(0,"div",16),e.YNc(1,Yl,24,0,"div",17)(2,Kl,2,1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(),e.um2(1,t.period.currentStock.length>0?1:2)}}function ed(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"a",4),e._uU(5,"Inicio"),e.qZA()(),e.TgZ(6,"div",5),e._UZ(7,"mat-icon",6),e.TgZ(8,"a",7),e._uU(9,"Almac\xe9n"),e.qZA()(),e.TgZ(10,"div",5),e._UZ(11,"mat-icon",6),e.TgZ(12,"a",8),e._uU(13,"Cierres de Inventario"),e.qZA()()(),e.TgZ(14,"div",9)(15,"h2",10),e._uU(16),e.qZA()()(),e.TgZ(17,"div",11)(18,"button",12),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.closePeriodByDepotId())}),e.TgZ(19,"span",13),e._uU(20,"Cerrar Inventario"),e.qZA()()()(),e.TgZ(21,"div",14),e.YNc(22,Xl,3,1,"div",15),e.qZA()}if(2&o){const t=e.oxw();e.xp6(7),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(5),e.hij(" Cerrar inventario de ",t.depot.name," "),e.xp6(6),e.um2(22,t.ipv?22:-1)}}function td(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",25)(1,"div",26),e._UZ(2,"mat-icon",27),e.qZA(),e.TgZ(3,"div",28),e._uU(4," No hay inventario vigente para el almac\xe9n "),e._UZ(5,"br"),e._uU(6),e.qZA(),e.TgZ(7,"div",29),e._uU(8," Debe abrir un nuevo per\xedodo inventario "),e.qZA(),e.TgZ(9,"button",30),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.openPeriodByDepotId(n.depot.id))}),e._UZ(10,"mat-icon",31),e._uU(11," Abrir Inventario "),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("svgIcon","mat_solid:date_range"),e.xp6(4),e.hij(" ",null==t.depot?null:t.depot.name," "),e.xp6(3),e.Q6J("color","primary")("disabled",t.isLoading),e.xp6(),e.Q6J("svgIcon","mat_solid:key")}}let od=(()=>{class o{constructor(){this.depot=null,this.isLoading=!1,this.period=null,this.ipv=null,this._changeDetectorRef=(0,e.f3M)(e.sBO),this._fuseConfirmationService=(0,e.f3M)(H.R),this._periodsService=(0,e.f3M)(Me),this._router=(0,e.f3M)(x.F0),this._snackBar=(0,e.f3M)(G.ux),this._unsubscribeAll=new E.x,this.store=(0,e.f3M)(A.yh)}ngOnInit(){this.store.select(W.ae).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.depot=t,this.isLoading=!0,this._periodsService.findCurrentPeriodByDepotId(t.id).pipe((0,u.R)(this._unsubscribeAll),(0,re.x)(()=>{this.isLoading=!1})).subscribe(({data:i})=>{this.period=i.findCurrentPeriodByDepotId.period,this.period&&(this.isLoading=!0,this._periodsService.getIpvByDepotId(t.id).pipe((0,u.R)(this._unsubscribeAll),(0,re.x)(()=>{this.isLoading=!1})).subscribe(n=>{this.ipv=n,this._changeDetectorRef.markForCheck()}))}),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}openPeriodByDepotId(t){this._fuseConfirmationService.open({title:"Abrir inventario.",message:"\xbfEst\xe1 seguro que desea abrir en inventario?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._periodsService.openPeriodByDepotId(t).pipe((0,u.R)(this._unsubscribeAll)).subscribe(({data:a})=>{this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.openPeriodByDepotId.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/warehouse/inventory-periods"),this._changeDetectorRef.markForCheck()})})}closePeriodByDepotId(){const t={periodId:this.period.id};this._fuseConfirmationService.open({title:"Cerrar inventario.",message:"\xbfEst\xe1 seguro que desea cerrar en inventario?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._periodsService.closePeriodByDepotId(t).pipe((0,u.R)(this._unsubscribeAll)).subscribe(({data:a})=>{a&&(this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.closePeriodByDepotId.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/warehouse/inventory-periods"),this._changeDetectorRef.markForCheck())})})}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-period-admin"]],standalone:!0,features:[e.jDz],decls:3,vars:1,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-64"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],["routerLink","/warehouse/inventory-periods ",1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"click"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-col","items-center","flex-auto","p-6","sm:p-10"],["class","w-full"],[1,"w-full"],["class","relative grid"],[1,"relative","grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","period-stocks-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"text-center"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","period-stocks-grid","md:px-8"],[1,"truncate"],["class","z-0 grid items-center gap-4 px-6 py-3 bg-white border-b dark:bg-default period-stocks-grid md:px-8"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"],[1,"flex","flex-col","items-center","w-full","p-6","transition-shadow","duration-150","ease-in-out","rounded-lg","shadow","bg-card","hover:shadow-xl"],[1,"flex","items-center","justify-center","p-4","rounded-full","bg-primary-50","text-primary-700","dark:bg-primary","dark:text-on-primary"],[1,"text-current",3,"svgIcon"],[1,"mt-5","text-lg","font-medium","leading-5","text-center"],[1,"mt-0.5","line-clamp-2","text-secondary"],["mat-flat-button","",1,"mt-5",3,"color","disabled","click"],[3,"svgIcon"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0),e.YNc(1,ed,23,4)(2,td,12,5),e.qZA()),2&i&&(e.xp6(),e.um2(1,null!==n.period&&"open"===n.period.state?1:2))},dependencies:[h.JJ,v.ot,v.lW,y.Ps,y.Hw],encapsulation:2})}return o})();var pt=d(85199);const ao=o=>o.incomes,mt=((0,A.P1)(ao,o=>o.income),(0,A.P1)(ao,o=>o.incomes));var Ue=d(7314);const id=T.Ps`
   query FindAllIncomes($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllIncomes(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length,
                size,
                page,
                lastPage,
                startIndex,
                endIndex
            }

            incomes {
                id
                no
                userId
                depotId
                createdAt

                products {
                    productId
                    quantity
                    product {
                        name
                        price
                        uom {
                            abbr
                        }
                    }
                }

                depot {
                    name
                }

                user {
                    fullname
                }
            }
        }
    }
`,nd=T.Ps`
    query FindIncomeById($findIncomeById: String!) {
        findIncomeById(id: $findIncomeById) {
            ok
            message

            income {
                id
                no
                userId
                depotId
                createdAt

                products {
                    productId
                    quantity
                    product {
                        name
                        price
                    }
                }

                user {
                    fullname
                }
            }
        }
    }
`,rd=T.Ps`
    mutation CreateIncome($createIncomeInput: CreateIncomeInput!) {
        createIncome(createIncomeInput: $createIncomeInput) {
            ok
            message

            income {
                id
                no
                userId
                depotId
                createdAt

                products {
                    productId
                    quantity
                    product {
                        name
                        price
                    }
                }


                user {
                    fullname
                }
            }
        }
    }
`,ad=T.Ps`
    mutation UpdateIncome($updateIncomeInput: UpdateIncomeInput!) {
        updatedIncome(updateIncomeInput: $updateIncomeInput) {
            ok
            message

            income {
                id
                no
                userId
                depotId
                createdAt

                products {
                    productId
                    quantity
                    product {
                        name
                        price
                    }
                }
            }
        }
    }
`,sd=T.Ps`
    mutation RemoveIncome($removeIncomeId: String!) {
        removeIncome(id: $removeIncomeId) {
            ok
            message
        }
    }
`;let ht=(()=>{class o{constructor(t,i,n){this.apolloProvider=t,this._snackBar=i,this.store=n,this._apollo=this.apolloProvider.use("BALANC")}createIncome(t){return this._apollo.mutate({mutation:rd,variables:{createIncomeInput:t},errorPolicy:"all"}).pipe((0,F.b)(({data:i})=>{this.store.dispatch((0,Ue.T5)({income:i.createIncome.income}))}))}getIncomes(t=0,i=50,n="no",a="desc",c=""){return this._apollo.query({query:id,errorPolicy:"all",variables:{page:t,size:i,sort:n,order:a,search:c}}).pipe((0,F.b)(({data:l})=>{this.store.dispatch((0,Ue.ts)({incomes:l.findAllIncomes.incomes})),this.store.dispatch((0,Te.Jr)({pagination:l.findAllIncomes.pagination}))}))}getIncomeById(t){return this._apollo.query({query:nd,variables:{findIncomeByIdId:t},errorPolicy:"all"}).pipe((0,F.b)(({data:i})=>{this.store.dispatch((0,Ue.T5)({income:i.findIncomeById.income}))}))}updateIncome(t){return this.store.select(mt).pipe((0,_e.q)(1),(0,f.w)(i=>this._apollo.mutate({mutation:ad,variables:{updateIncomeInput:t},errorPolicy:"all"}).pipe((0,F.b)(({data:n})=>{const a=structuredClone(i);a[i.findIndex(l=>l.id===t.id)]=n.updateIncome.income,this.store.dispatch((0,Ue.ts)({incomes:a}))}))))}removeIncome(t){return this.store.select(mt).pipe((0,_e.q)(1),(0,f.w)(i=>this._apollo.mutate({mutation:sd,variables:{removeIncomeId:t},errorPolicy:"all"}).pipe((0,F.b)(()=>{const n=structuredClone(i),a=i.findIndex(c=>c.id===t);n.splice(a,1),this.store.dispatch((0,Ue.ts)({incomes:n}))}))))}static#e=this.\u0275fac=function(i){return new(i||o)(e.LFG(T._M),e.LFG(G.ux),e.LFG(A.yh))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();const cd=(o,r)=>r.id;function ld(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",24)(1,"div",21),e._uU(2),e.qZA(),e.TgZ(3,"div",25),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"div",22),e._uU(7),e.qZA(),e.TgZ(8,"div",26)(9,"button",27),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.viewIncomeReport(a))}),e._UZ(10,"mat-icon",28),e.qZA()()()}if(2&o){const t=r.$implicit;e.xp6(2),e.hij(" ",t.no," "),e.xp6(2),e.hij(" ",e.xi3(5,4,t.createdAt,"dd/MM/yyyy hh:mm a")," "),e.xp6(3),e.hij(" ",t.user.fullname," "),e.xp6(3),e.Q6J("svgIcon","mat_solid:assignment")}}const dd=o=>({"pointer-events-none":o}),ud=()=>[5,10,25,100];function pd(o,r){if(1&o&&(e.TgZ(0,"div",19)(1,"div",20)(2,"div",21),e._uU(3," N\xfamero "),e.qZA(),e.TgZ(4,"div",21),e._uU(5," Fecha "),e.qZA(),e.TgZ(6,"div",22),e._uU(7," Empleado "),e.qZA(),e.TgZ(8,"div",21),e._uU(9," Acciones "),e.qZA()(),e.SjG(10,ld,11,7,"div",29,cd),e.qZA(),e._UZ(12,"mat-paginator",23)),2&o){const t=e.oxw();e.xp6(10),e.wJu(t.incomes),e.xp6(2),e.Q6J("ngClass",e.VKq(6,dd,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(8,ud))("showFirstLastButtons",!0)}}function md(o,r){1&o&&(e.TgZ(0,"div",30),e._uU(1," \xa1No se ha registrado ninguna entrada hasta el momento! "),e.qZA())}let hd=(()=>{class o{constructor(){this.isLoading=!1,this.incomes=[],this.searchInputControl=new s.NI(null),this.user=null,this.merchant=null,this._unsubscribeAll=new E.x,this._changeDetectorRef=(0,e.f3M)(e.sBO),this._dialog=(0,e.f3M)(R.uw),this._fuseConfirmationService=(0,e.f3M)(H.R),this._incomesService=(0,e.f3M)(ht),this._documentsService=(0,e.f3M)(Ie.S),this.store=(0,e.f3M)(A.yh)}ngOnInit(){this.store.select(se.rk).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(me.Qs).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(ae.B).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.store.select(mt).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.incomes=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,q.b)(300),(0,f.w)(t=>{if(null!==t)return this.isLoading=!0,this._incomesService.getIncomes(0,25,"no","desc",t)}),(0,_.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"no",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,B.T)(this._sort.sortChange,this._paginator.page).pipe((0,f.w)(()=>(this.isLoading=!0,this._incomesService.getIncomes(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,_.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}viewIncomeReport(t){this._documentsService.generateIncomeReportDocument(t,this.merchant,this.user)}trackByFn(t,i){return i.id||t}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-incomes"]],viewQuery:function(i,n){if(1&i&&(e.Gf(g.NW,5),e.Gf(C.YE,5)),2&i){let a;e.iGM(a=e.CRH())&&(n._paginator=a.first),e.iGM(a=e.CRH())&&(n._sort=a.first)}},standalone:!0,features:[e.jDz],decls:30,vars:9,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","","routerLink","/warehouse/income-form",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","incomes-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"text-center"],[1,"text-left"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","incomes-grid","md:px-8"],[1,"font-mono","text-center"],[1,"flex","flex-row","flex-wrap","justify-center","gap-3"],["mat-stroked-button","","matTooltip","Informe de entrada",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],["class","grid items-center gap-4 px-6 py-3 border-b incomes-grid md:px-8"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Almac\xe9n"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",7),e._uU(14,"Entradas"),e.qZA()()(),e.TgZ(15,"div",8)(16,"h2",9),e._uU(17," Registro de entradas "),e.qZA()()(),e.TgZ(18,"div",10)(19,"mat-form-field",11),e._UZ(20,"mat-icon",12)(21,"input",13),e.qZA(),e.TgZ(22,"button",14),e._UZ(23,"mat-icon",15),e.TgZ(24,"span",16),e._uU(25,"Agregar"),e.qZA()()()(),e.TgZ(26,"div",17)(27,"div",18),e.YNc(28,pd,13,9)(29,md,2,0),e.qZA()()()),2&i&&(e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(7),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),e.xp6(2),e.Q6J("svgIcon","mat_solid:add"),e.xp6(5),e.um2(28,n.incomes.length>0?28:29))},dependencies:[h.uU,h.mk,m.lN,m.KE,m.qo,C.JX,C.YE,g.TU,g.NW,v.ot,v.lW,y.Ps,y.Hw,Z.c,Z.Nt,s.UX,s.Fj,s.JJ,s.oH,x.rH],encapsulation:2})}return o})();function gd(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-option",22),e.NdJ("click",function(n){const c=e.CHM(t).$implicit;return e.oxw().addProductToIncome(c),e.KtG(n.stopPropagation())}),e.TgZ(1,"div",23),e.NdJ("click",function(n){const c=e.CHM(t).$implicit;return e.oxw().addProductToIncome(c),e.KtG(n.stopPropagation())}),e.TgZ(2,"span",24),e._UZ(3,"mat-checkbox",25),e._uU(4),e.qZA(),e.TgZ(5,"span",26),e._uU(6),e.ALo(7,"number"),e.qZA()()()}if(2&o){const t=r.$implicit;e.Q6J("value",t),e.xp6(3),e.Q6J("checked",t.checked),e.xp6(),e.hij(" ",t.name," "),e.xp6(2),e.AsE("",e.xi3(7,5,t.quantity,"1.2-2")," ",t.uom.abbr,"")}}const fd=(o,r)=>r.id;function _d(o,r){1&o&&(e.TgZ(0,"mat-error",42),e._uU(1," Valor m\xednimo 0.1 "),e.qZA())}function vd(o,r){if(1&o&&(e.TgZ(0,"mat-error",42),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(),e.hij(" Valor m\xe1ximo ",t.quantity," ")}}function xd(o,r){1&o&&(e.TgZ(0,"mat-error",42),e._uU(1," Patr\xf3n no v\xe1lido "),e.qZA())}function bd(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",31)(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"div",32),e._uU(4),e.qZA(),e.TgZ(5,"div",33)(6,"div",34)(7,"button",35),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.decrementProductQty(a))}),e._UZ(8,"mat-icon",36),e.qZA(),e.TgZ(9,"mat-form-field",37),e._UZ(10,"input",38),e.qZA(),e.TgZ(11,"button",35),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.incrementProductQty(a))}),e._UZ(12,"mat-icon",36),e.qZA()(),e.YNc(13,_d,2,0,"mat-error",39)(14,vd,2,1,"mat-error",39)(15,xd,2,0,"mat-error",39),e.qZA(),e.TgZ(16,"div",40)(17,"button",41),e.NdJ("click",function(){const a=e.CHM(t).$index,c=e.oxw(2);return e.KtG(c.removeProductFromIncome(a))}),e._UZ(18,"mat-icon",36),e.qZA()()()}if(2&o){const t=r.$implicit,i=r.$index;e.xp6(2),e.hij(" ",i+1," "),e.xp6(),e.Q6J("matTooltip",t.get("name").value),e.xp6(),e.hij(" ",t.get("name").value," "),e.xp6(3),e.Q6J("disabled",t.get("quantity").value<=.1||t.get("quantity").hasError("pattern")),e.xp6(),e.Q6J("svgIcon","mat_solid:remove"),e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("min",.1)("formControl",t.get("quantity")),e.xp6(),e.Q6J("disabled",t.get("quantity").hasError("pattern")),e.xp6(),e.Q6J("svgIcon","mat_solid:add"),e.xp6(),e.um2(13,t.get("quantity").hasError("min")?13:-1),e.xp6(),e.um2(14,t.get("quantity").hasError("max")?14:-1),e.xp6(),e.um2(15,t.get("quantity").hasError("pattern")&&!t.get("quantity").hasError("min")?15:-1),e.xp6(3),e.Q6J("svgIcon","mat_solid:close")}}function Cd(o,r){if(1&o&&(e.TgZ(0,"div",27)(1,"div",28),e._UZ(2,"div"),e.TgZ(3,"div",29),e._uU(4," Producto "),e.qZA(),e.TgZ(5,"div",30),e._uU(6," Cantidad "),e.qZA(),e.TgZ(7,"div",30),e._uU(8," Quitar "),e.qZA()(),e.SjG(9,bd,19,14,"div",43,fd),e.qZA()),2&o){const t=e.oxw();e.xp6(9),e.wJu(t.incomeForm.get("products").controls)}}function yd(o,r){1&o&&(e.TgZ(0,"div",44),e._uU(1," \xa1No ha seleccionado ning\xfan producto a\xfan! "),e.qZA())}const Zd=()=>({suppressScrollX:!0}),Td=()=>({suppressScrollY:!0});let Ad=(()=>{class o{constructor(){this.incomeProducts=!1,this.previewsProductsFormData=[],this.depot=null,this.searchProductControl=new s.NI(null),this._changeDetectorRef=(0,e.f3M)(e.sBO),this._formBuilder=(0,e.f3M)(s.qu),this._unsubscribeAll=new E.x,this._fuseConfirmationService=(0,e.f3M)(H.R),this._incomesService=(0,e.f3M)(ht),this._router=(0,e.f3M)(x.F0),this._snackBar=(0,e.f3M)(G.ux),this.store=(0,e.f3M)(A.yh)}ngOnInit(){this.incomeForm=this._formBuilder.group({products:new s.Oe([])}),this.incomeForm.get("products").valueChanges.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this._changeDetectorRef.markForCheck()}),this.store.select(W.ae).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.depot=t,this._changeDetectorRef.markForCheck()}),this.store.select(ge.nR).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.products=t,this.productsFiltered=this._mapChecked(t),this._changeDetectorRef.markForCheck()}),this.searchProductControl.valueChanges.pipe((0,q.b)(200),(0,u.R)(this._unsubscribeAll)).subscribe(t=>{null!=t&&""!==t?(this.productsFiltered=this._mapChecked(this.products).filter(i=>i.name.toLowerCase().includes(t.toLocaleLowerCase())),this._changeDetectorRef.markForCheck()):this.productsFiltered=this._mapChecked(this.products)})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}displayFn(t){return t&&t.name?t.name:""}addProductToIncome(t){const i=this.incomeForm.get("products").getRawValue().findIndex(a=>a.productId===t.id);if(t.checked?(this.removeProductFromIncome(i),t.checked=!1):t.checked=!0,i>-1)return;const n=this._formBuilder.group({productId:new s.NI(t.id,[s.kI.required]),name:new s.NI(t.name,[s.kI.required]),uom:new s.NI(t.uom,[s.kI.required]),quantity:new s.NI(1,[te.L.onlyNumbersPattern(),s.kI.required,s.kI.min(.1)])});this.incomeForm.get("products").push(n),this._changeDetectorRef.markForCheck()}removeProductFromIncome(t){this.incomeForm.get("products").removeAt(t),this.productsFiltered=this._mapChecked(this.products),this._changeDetectorRef.markForCheck()}incrementProductQty(t){const i=t.get("quantity").value;t.get("quantity").setValue(+i+1)}decrementProductQty(t){const i=t.get("quantity").value;t.get("quantity").setValue(+i-1)}createIncome(){if(this.incomeForm.invalid)return;if(0===this.incomeForm.get("products").controls.length)return void this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Alerta",message:"Debe agrear al menos un producto a la entrada",type:"warning",svgIcon:"mat_solid:warning"}});const{products:t}=this.incomeForm.getRawValue(),i={depotId:this.depot.id,products:t.map(a=>({productId:a.productId,quantity:Number(a.quantity)}))};this._fuseConfirmationService.open({title:"Generar entrada",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,u.R)(this._unsubscribeAll)).subscribe(a=>{"confirmed"===a&&this._incomesService.createIncome(i).subscribe(({})=>{this._snackBar.openFromComponent(M.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:"Entrada registrada correctamente",type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/warehouse/incomes")})})}_mapChecked(t){return t.map(i=>this.incomeForm.get("products").getRawValue().some(a=>a.productId===i.id)?{...structuredClone(i),checked:!0}:{...structuredClone(i),checked:!1})}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-income-form"]],standalone:!0,features:[e.jDz],decls:38,vars:15,consts:[["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0",3,"fuseScrollbarOptions"],[1,"relative","flex","flex-col","px-6","py-8","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["mat-flat-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"disabled","click"],[1,"flex","flex-col","px-4","mt-4","mb-12","gap-y-8","sm:px-8"],[1,"col-span-4","shadow","rounded-2xl","bg-card"],[1,"p-6","pb-0"],["appearance","fill",1,"w-full","fuse-mat-dense",3,"subscriptSizing"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete",3,"displayWith","closed"],["productsAutocomplete","matAutocomplete"],["fuseScrollbar","",1,"flex","flex-col","flex-auto","pb-2","mt-2","min-h-72",3,"fuseScrollbarOptions"],["class","grid"],[1,"w-full",3,"value","click"],[1,"grid","w-full","grid-cols-6",3,"click"],[1,"flex","flex-row","items-center","col-span-5","truncate","md:col-span-3"],["color","primary",3,"checked"],[1,"flex","items-center","text-center"],[1,"grid"],[1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","income-products-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-primary","dark:bg-opacity-5"],[1,"text-left"],[1,"text-center"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","income-products-grid","md:px-8"],[1,"truncate",3,"matTooltip"],[1,"flex","flex-col","justify-center"],[1,"flex","flex-row","items-center","justify-center","gap-2"],["mat-stroked-button","",1,"p-2","leading-6","min-w-7","min-h-7","h-7",3,"disabled","click"],[1,"icon-size-5",3,"svgIcon"],[1,"fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],["matInput","","type","text","name","quantity",1,"font-mono","font-semibold","text-center",3,"min","formControl"],["class","w-full text-sm text-center"],[1,"flex","justify-center"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"w-full","text-sm","text-center"],["class","grid items-center gap-4 px-6 py-3 border-b income-products-grid md:px-8"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-30"],["class","w-full",3,"value"]],template:function(i,n){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Almac\xe9n"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",7),e._uU(14,"Entradas"),e.qZA()(),e.TgZ(15,"div",5),e._UZ(16,"mat-icon",6),e.TgZ(17,"a",7),e._uU(18,"Recibir"),e.qZA()()(),e.TgZ(19,"div",8)(20,"h2",9),e._uU(21," Recibir mercanc\xedas "),e.qZA()()(),e.TgZ(22,"div",10)(23,"button",11),e.NdJ("click",function(){return n.createIncome()}),e._uU(24," Registrar Entrada "),e.qZA()()(),e.TgZ(25,"div",12)(26,"div",13)(27,"div",14)(28,"mat-form-field",15),e._UZ(29,"mat-icon",16)(30,"input",17),e.TgZ(31,"mat-autocomplete",18,19),e.NdJ("closed",function(){return n.searchProductControl.reset()}),e.SjG(33,gd,8,8,"mat-option",45,e.x6l),e.qZA()(),e.TgZ(35,"div",20),e.YNc(36,Cd,11,0,"div",21)(37,yd,2,0),e.qZA()()()()()),2&i){const a=e.MAs(32);e.Q6J("fuseScrollbarOptions",e.DdM(13,Zd)),e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(7),e.Q6J("disabled",n.incomeForm.invalid),e.xp6(5),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",n.searchProductControl)("matAutocomplete",a)("placeholder","Buscar existencia de productos en inventario"),e.xp6(),e.Q6J("displayWith",n.displayFn),e.xp6(2),e.wJu(n.productsFiltered),e.xp6(2),e.Q6J("fuseScrollbarOptions",e.DdM(14,Td)),e.xp6(),e.um2(36,n.incomeForm.get("products").controls.length>0?36:37)}},dependencies:[h.JJ,nt.H,Q.Bb,Q.XC,ie.ey,Q.ZL,v.ot,v.lW,ue.p9,ue.oG,m.lN,m.KE,m.TO,m.qo,y.Ps,y.Hw,Z.c,Z.Nt,C.JX,N.AV,N.gM,s.UX,s.Fj,s.JJ,s.oH,x.rH],encapsulation:2})}return o})();const kd=[{path:"",component:L,resolve:{},children:[{path:"depots",component:qo,resolve:{depots:ye.s6,employees:kc.Q}},{path:"incomes",component:hd,resolve:{incomes:(()=>{class o{constructor(t){this._incomesService=t}resolve(t,i){return this._incomesService.getIncomes()}static#e=this.\u0275fac=function(i){return new(i||o)(e.LFG(ht))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})()}},{path:"income-form",component:Ad,resolve:{products:dt.SE,terminal:pt.M}},{path:"inventory-admin/:depotId",component:od,resolve:{terminal:pt.M}},{path:"inventory-periods",component:sn,resolve:{periods:Fc,terminal:pt.M}},{path:"movements",component:yi,resolve:{movements:wc}},{path:"stocks",component:hc,resolve:{stocks:Dc}},{path:"products",component:ha,children:[{path:"",component:Ma,resolve:{products:dt.SE}},{path:"product/:productId",component:ma,resolve:{brands:fc.J,categories:_c.ek,currencies:gc.g,uoms:no.d,depots:ye._u,product:dt.M6}},{path:"from-template",component:Hl,resolve:{depots:ye._u,uoms:no.d}}]},{path:"receptions",component:tc,children:[{path:"new",component:$s,resolve:{purchases:qc.N6,depots:ye._u}},{path:"list",component:ec,resolve:{receptions:Sc}}]},{path:"dispatches-list",component:Ul,resolve:{dispatches:Ac}},{path:"dispatches-form",component:bl,data:{permissions:{only:["Administrador","Super Administrador","despachos-create"]}},resolve:{depots:ye._u,ownDepots:ye.Uj}},{path:"dispatch-confirm/:dispatchId",component:ol,resolve:{dispatch:Ic}}]}]}}]);