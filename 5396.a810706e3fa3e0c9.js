"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[5396],{47413:(de,Q,l)=>{l.d(Q,{Dz:()=>$,Lx:()=>z});var a=l(59640);const e=v=>v.pagination,$=(0,a.Mz)(e,v=>v.pagination),z=(0,a.Mz)(e,v=>v.secondaryPagination)},45396:(de,Q,l)=>{l.r(Q),l.d(Q,{default:()=>li});var a=l(51188),e=l(17705);let $=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["box"]],standalone:!0,features:[e.aNF],decls:1,vars:0,template:function(n,i){1&n&&e.nrm(0,"router-outlet")},dependencies:[a.n3],encapsulation:2})}return o})();var z=l(95416),v=l(75351),U=l(14823),F=l(60177),G=l(99213),j=l(88834),D=l(59115),O=l(4626),A=l(21413),m=l(56977),W=l(59640),N=l(50891),V=l(86800),ee=l(69938),x=l(46601),s=l(89417),Y=l(67376),K=l(94794),E=l(53719),T=l(59042),P=l(71365),ue=l(37403);function pe(o,c){1&o&&(e.j41(0,"h2",2),e.EFF(1," Editar monto inicial de caja "),e.k0s())}function he(o,c){1&o&&(e.j41(0,"h2",2),e.EFF(1," Devoluci\xf3n de efectivo de caja "),e.k0s())}function be(o,c){1&o&&(e.j41(0,"h2",2),e.EFF(1," Pr\xe9stamo de efectivo de caja "),e.k0s())}function p(o,c){1&o&&(e.j41(0,"h2",2),e.EFF(1," Gasto de efectivo de caja "),e.k0s())}function I(o,c){1&o&&(e.j41(0,"mat-form-field",6)(1,"mat-label"),e.EFF(2,"Motivo"),e.k0s(),e.nrm(3,"textarea",11),e.k0s()),2&o&&(e.R7$(3),e.Y8G("formControlName","reason"))}let d=(()=>{class o{constructor(t,n,i,r,b,g){this.data=t,this._boxService=n,this._changeDetectorRef=i,this._dialogRef=r,this._formBuilder=b,this._fuseConfirmationService=g,this._unsubscribeAll=new A.B,this._snackBar=(0,e.WQX)(z.UG),this.dialogMode=t.dialogMode,this.boxMovementType=this.data.boxMovementType}ngOnInit(){this.boxMovementForm=this._formBuilder.group({id:new s.MJ,terminalId:new s.MJ(this.data.terminalId,[s.k0.required]),amount:new s.MJ(null,[s.k0.required,s.k0.min(0),s.k0.maxLength(9)]),reason:new s.MJ(null,[s.k0.maxLength(250)])})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}createBoxMovement(){let t=this.boxMovementForm.getRawValue();t=(0,Y.omit)(t,["id"]),t.movementType=this.boxMovementType,this._fuseConfirmationService.open({title:"Crear movimiento",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,m.Q)(this._unsubscribeAll)).subscribe(i=>{"confirmed"===i&&this._boxService.createBoxMovement(t).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(({data:r})=>{r&&(this._snackBar.openFromComponent(K.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:"Movimiento creado correctamente",title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"mat_solid:done"}}),this.closeDialog()),this._changeDetectorRef.markForCheck()})})}static#e=this.\u0275fac=function(n){return new(n||o)(e.rXU(v.Vh),e.rXU(P.R),e.rXU(e.gRc),e.rXU(v.CP),e.rXU(s.ok),e.rXU(x.G))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["box-admin-dialog"]],standalone:!0,features:[e.aNF],decls:19,vars:12,consts:[[1,"relative","px-6","pt-5","flex","flex-col","w-full","h-full","max-h-screen"],[1,"flex","flex-col","items-start","border-b"],["mat-dialog-title","",1,"text-xl","font-semibold"],["mat-dialog-content","",1,"flex","mt-4","flex-col","items-center","flex-auto","w-full","border-b"],[1,"flex","flex-col","w-full",3,"formGroup","autocomplete"],[1,"flex","flex-col","flex-auto","gap-4"],[1,"w-full"],["matInput","","type","number",3,"formControlName","required"],["mat-dialog-actions","",1,"flex","items-center","justify-between","w-full","pt-2","pb-3"],["mat-button","",3,"click","color"],["mat-button","",3,"click","disabled","color"],["matInput","","cdkTextareaAutosize","","maxlength","250","rows","4",3,"formControlName"]],template:function(n,i){1&n&&(e.j41(0,"div",0)(1,"div",1),e.DNE(2,pe,2,0,"h2",2)(3,he,2,0,"h2",2)(4,be,2,0,"h2",2)(5,p,2,0,"h2",2),e.k0s(),e.j41(6,"div",3)(7,"form",4)(8,"div",5)(9,"mat-form-field",6)(10,"mat-label"),e.EFF(11,"Monto"),e.k0s(),e.nrm(12,"input",7),e.k0s(),e.DNE(13,I,4,1,"mat-form-field",6),e.k0s()()(),e.j41(14,"div",8)(15,"button",9),e.bIt("click",function(){return i.closeDialog()}),e.EFF(16,"Cancelar"),e.k0s(),e.j41(17,"button",10),e.bIt("click",function(){return i.createBoxMovement()}),e.EFF(18," Guardar "),e.k0s()()()),2&n&&(e.R7$(2),e.vxM("initial"===i.boxMovementType?2:-1),e.R7$(),e.vxM("return"===i.boxMovementType?3:-1),e.R7$(),e.vxM("loan"===i.boxMovementType?4:-1),e.R7$(),e.vxM("spent"===i.boxMovementType?5:-1),e.R7$(2),e.Y8G("formGroup",i.boxMovementForm)("autocomplete","off"),e.R7$(5),e.Y8G("formControlName","amount")("required",!0),e.R7$(),e.vxM("initial"!==i.boxMovementType?13:-1),e.R7$(2),e.Y8G("color","warn"),e.R7$(2),e.Y8G("disabled",i.boxMovementForm.invalid)("color","primary"))},dependencies:[E.RG,E.rl,E.nJ,T.fS,T.fg,ue.xb,j.Hl,j.$z,s.X1,s.qT,s.me,s.Q0,s.BC,s.cb,s.YS,s.tU,s.j4,s.JD],encapsulation:2,changeDetection:0})}return o})();var h=l(82431),C=l(31849),B=l(65478);const te=(o,c)=>c.id,fe=o=>["/modules/box/admin/closer",o],Me=o=>({"hover:ring hover:ring-primary-200 hover:ring-inset cursor-pointer":o}),Re=o=>({hidden:o});function Te(o,c){if(1&o){const t=e.RV6();e.j41(0,"button",45),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.openBox(!0))}),e.nrm(1,"mat-icon",22),e.EFF(2," Abrir caja con saldo anterior "),e.k0s(),e.j41(3,"button",45),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.openBox(!1))}),e.nrm(4,"mat-icon",22),e.EFF(5," Abrir caja sin saldo "),e.k0s()}2&o&&(e.R7$(),e.Y8G("svgIcon","mat_solid:key"),e.R7$(3),e.Y8G("svgIcon","mat_solid:key"))}function Ie(o,c){if(1&o){const t=e.RV6();e.j41(0,"button",45),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.openBoxAdminDialog("initial"))}),e.nrm(1,"mat-icon",22),e.EFF(2," Editar monto inicial "),e.k0s(),e.j41(3,"button",46),e.nrm(4,"mat-icon",22),e.EFF(5," Cerrar caja "),e.k0s()}if(2&o){const t=e.XpG(2);e.R7$(),e.Y8G("svgIcon","mat_solid:edit"),e.R7$(2),e.Y8G("routerLink",e.eq3(3,fe,t.box.id)),e.R7$(),e.Y8G("svgIcon","mat_solid:lock")}}function Se(o,c){if(1&o){const t=e.RV6();e.j41(0,"button",47)(1,"span",21),e.EFF(2,"Movimientos de caja"),e.k0s(),e.nrm(3,"mat-icon",22),e.k0s(),e.j41(4,"mat-menu",null,1)(6,"button",45),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.openBoxAdminDialog("return"))}),e.nrm(7,"mat-icon",22),e.EFF(8," Devoluci\xf3n "),e.k0s(),e.j41(9,"button",45),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.openBoxAdminDialog("loan"))}),e.nrm(10,"mat-icon",22),e.EFF(11," Pr\xe9stamo "),e.k0s(),e.j41(12,"button",45),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.openBoxAdminDialog("spent"))}),e.nrm(13,"mat-icon",22),e.EFF(14," Gasto "),e.k0s(),e.j41(15,"button",45),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.openBoxAdminDialog("depot"))}),e.nrm(16,"mat-icon",22),e.EFF(17," Dep\xf3sito "),e.k0s(),e.j41(18,"button",45),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.openBoxAdminDialog("extraction"))}),e.nrm(19,"mat-icon",22),e.EFF(20," Extracci\xf3n "),e.k0s()()}if(2&o){const t=e.sdS(5);e.Y8G("matMenuTriggerFor",t),e.R7$(3),e.Y8G("svgIcon","mat_solid:expand_more"),e.R7$(4),e.Y8G("svgIcon","mat_solid:settings_backup_restore"),e.R7$(3),e.Y8G("svgIcon","mat_solid:real_estate_agent"),e.R7$(3),e.Y8G("svgIcon","mat_solid:paid"),e.R7$(3),e.Y8G("svgIcon","mat_solid:south_west"),e.R7$(3),e.Y8G("svgIcon","mat_solid:north_east")}}function Ge(o,c){if(1&o&&(e.j41(0,"div",51)(1,"div",52),e.nrm(2,"div",53),e.j41(3,"div",54),e.EFF(4),e.k0s()(),e.j41(5,"div",55),e.EFF(6),e.nI1(7,"percent"),e.k0s()()),2&o){const t=c.$implicit,n=c.$index,i=e.XpG(3);e.R7$(2),e.xc7("background-color",i.boxMovementDistribution.colors[n]),e.R7$(2),e.JRh(i.data.labels[n]),e.R7$(2),e.SpI(" ",e.i5U(7,4,t/i.data.total,"1.2-2")," ")}}function Ae(o,c){if(1&o&&(e.j41(0,"div",44)(1,"div",48),e.nrm(2,"apx-chart",49),e.k0s(),e.j41(3,"div",50),e.Z7z(4,Ge,8,7,"div",51,e.fX1),e.k0s()()),2&o){const t=e.XpG(2);e.R7$(2),e.Y8G("chart",t.boxMovementDistribution.chart)("colors",t.boxMovementDistribution.colors)("labels",t.boxMovementDistribution.labels)("plotOptions",t.boxMovementDistribution.plotOptions)("series",t.boxMovementDistribution.series)("states",t.boxMovementDistribution.states)("tooltip",t.boxMovementDistribution.tooltip),e.R7$(2),e.Dyx(t.data.series)}}function Le(o,c){if(1&o){const t=e.RV6();e.j41(0,"div",4)(1,"div",5)(2,"div",6)(3,"div")(4,"a",7),e.EFF(5,"Inicio"),e.k0s()(),e.j41(6,"div",8),e.nrm(7,"mat-icon",9),e.j41(8,"a",10),e.EFF(9,"Caja"),e.k0s()(),e.j41(10,"div",11),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return i.selectedTerminal=null,e.Njj(i.box=null)}),e.nrm(11,"mat-icon",9),e.j41(12,"a",12),e.EFF(13,"Administraci\xf3n"),e.k0s()()(),e.j41(14,"div",13)(15,"h2",14),e.EFF(16," Administraci\xf3n de caja "),e.k0s(),e.j41(17,"div",15)(18,"span",16),e.EFF(19),e.nI1(20,"date"),e.k0s(),e.j41(21,"span",17),e.EFF(22),e.nI1(23,"titlecase"),e.k0s()()()(),e.j41(24,"div",18)(25,"div",19)(26,"button",20)(27,"span",21),e.EFF(28,"Opciones"),e.k0s(),e.nrm(29,"mat-icon",22),e.k0s(),e.j41(30,"mat-menu",null,0),e.DNE(32,Te,6,2)(33,Ie,6,5),e.k0s()(),e.DNE(34,Se,21,7),e.k0s()(),e.j41(35,"div",23)(36,"div",24)(37,"div",25)(38,"div",26)(39,"div",27),e.nrm(40,"div",28),e.k0s(),e.j41(41,"div",29),e.EFF(42,"Monto inicial"),e.k0s(),e.j41(43,"div",30),e.EFF(44),e.nI1(45,"currency"),e.k0s()(),e.j41(46,"div",26)(47,"div",27),e.nrm(48,"div",31),e.k0s(),e.j41(49,"div",29),e.EFF(50,"Ingresos"),e.k0s(),e.j41(51,"div",30),e.EFF(52),e.nI1(53,"currency"),e.k0s()(),e.j41(54,"div",26)(55,"div",27),e.nrm(56,"div",32),e.k0s(),e.j41(57,"div",29),e.EFF(58,"Devoluciones"),e.k0s(),e.j41(59,"div",30),e.EFF(60),e.nI1(61,"currency"),e.k0s()(),e.j41(62,"div",26)(63,"div",27),e.nrm(64,"div",33),e.k0s(),e.j41(65,"div",29),e.EFF(66,"Pr\xe9stamos"),e.k0s(),e.j41(67,"div",30),e.EFF(68),e.nI1(69,"currency"),e.k0s()(),e.j41(70,"div",26)(71,"div",27),e.nrm(72,"div",34),e.k0s(),e.j41(73,"div",35),e.EFF(74,"Gastos"),e.k0s(),e.j41(75,"div",30),e.EFF(76),e.nI1(77,"currency"),e.k0s()(),e.j41(78,"div",26)(79,"div",27),e.nrm(80,"div",36),e.k0s(),e.j41(81,"div",35),e.EFF(82,"Dep\xf3sitos"),e.k0s(),e.j41(83,"div",30),e.EFF(84),e.nI1(85,"currency"),e.k0s()(),e.j41(86,"div",26)(87,"div",27),e.nrm(88,"div",37),e.k0s(),e.j41(89,"div",35),e.EFF(90,"Extracciones"),e.k0s(),e.j41(91,"div",30),e.EFF(92),e.nI1(93,"currency"),e.k0s()(),e.j41(94,"div",26),e.nrm(95,"div",19),e.j41(96,"div",38),e.EFF(97,"Ingresos Totales "),e.k0s(),e.j41(98,"div",39),e.EFF(99),e.nI1(100,"currency"),e.k0s()(),e.j41(101,"div",26),e.nrm(102,"div",19),e.j41(103,"div",40),e.EFF(104,"Egresos Totales "),e.k0s(),e.j41(105,"div",41),e.EFF(106),e.nI1(107,"currency"),e.k0s()(),e.j41(108,"div",26),e.nrm(109,"div",19),e.j41(110,"div",42),e.EFF(111,"Saldo"),e.k0s(),e.j41(112,"div",43),e.EFF(113),e.nI1(114,"currency"),e.k0s()()(),e.DNE(115,Ae,6,7,"div",44),e.k0s()()}if(2&o){const t=e.sdS(31),n=e.XpG();e.R7$(7),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(8),e.SpI(" Fecha de caja: ",e.i5U(20,20,n.box.open,"dd/MM/YYYY hh:mm a")," "),e.R7$(3),e.SpI(" ",e.bMT(23,23,n.box.status)," "),e.R7$(4),e.Y8G("matMenuTriggerFor",t),e.R7$(3),e.Y8G("svgIcon","mat_solid:expand_more"),e.R7$(3),e.vxM("cerrada"===n.box.status?32:-1),e.R7$(),e.vxM("abierta"===n.box.status?33:-1),e.R7$(),e.vxM("abierta"===n.box.status?34:-1),e.R7$(10),e.JRh(e.i5U(45,25,n.data.series[0],"$ ")),e.R7$(8),e.JRh(e.i5U(53,28,n.data.series[1],"$ ")),e.R7$(8),e.JRh(e.i5U(61,31,n.data.series[2],"$ ")),e.R7$(8),e.JRh(e.i5U(69,34,n.data.series[3],"$ ")),e.R7$(8),e.JRh(e.i5U(77,37,n.data.series[4],"$ ")),e.R7$(8),e.JRh(e.i5U(85,40,n.data.series[5],"$ ")),e.R7$(8),e.JRh(e.i5U(93,43,n.data.series[6],"$ ")),e.R7$(7),e.JRh(e.i5U(100,46,n.data.series[0]+n.data.series[1]+n.data.series[5],"$ ")),e.R7$(7),e.SpI(" ",e.i5U(107,49,n.data.series[2]+n.data.series[3]+n.data.series[4]+n.data.series[6],"$ ")," "),e.R7$(7),e.JRh(e.i5U(114,52,n.data.series[0]+n.data.series[1]-n.data.series[2]-n.data.series[3]-n.data.series[4]+n.data.series[5]-n.data.series[6],"$ ")),e.R7$(2),e.vxM(n.data.total>0?115:-1)}}function we(o,c){if(1&o){const t=e.RV6();e.j41(0,"fuse-card",60),e.bIt("click",function(){const i=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.selectTerminal(i))}),e.j41(1,"div",52),e.nrm(2,"mat-icon",61),e.j41(3,"div",62)(4,"div",63),e.EFF(5),e.k0s(),e.j41(6,"div",64),e.EFF(7),e.k0s()()(),e.j41(8,"button",65),e.bIt("click",function(){const i=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.openBoxOpenerDialog(i))}),e.nrm(9,"mat-icon",66),e.k0s()()}if(2&o){const t=c.$implicit;e.Y8G("ngClass",e.eq3(6,Me,t.openedBox)),e.R7$(2),e.Y8G("svgIcon","mat_solid:point_of_sale"),e.R7$(3),e.JRh(t.name),e.R7$(2),e.JRh(t.depot.name),e.R7$(),e.Y8G("ngClass",e.eq3(8,Re,t.openedBox)),e.R7$(),e.Y8G("svgIcon","mat_solid:key")}}function ze(o,c){if(1&o&&(e.j41(0,"div",3)(1,"div",56)(2,"h1",57),e.EFF(3,"Selecciona la terminal para la cual desea abrir la caja"),e.k0s()(),e.j41(4,"div",58),e.Z7z(5,we,10,10,"fuse-card",59,te),e.k0s()()),2&o){const t=e.XpG();e.R7$(5),e.Dyx(t.terminals)}}let Ye=(()=>{class o{constructor(){this.balance=0,this.box=null,this.data={total:0,series:[0,0,0,0,0,0,0],labels:["Monto Inicial","Ingresos","Devoluciones","Prestamos","Gastos","Dep\xf3sitos","Extracciones"],colors:["#64748B","#22C55E","#EF4444","#EAB308","#06B6D4","#3f10cd","#ff498b"]},this.selectedTerminal=null,this.terminals=[],this._boxService=(0,e.WQX)(P.R),this._changeDetectorRef=(0,e.WQX)(e.gRc),this._dialog=(0,e.WQX)(v.bZ),this._fuseConfirmationService=(0,e.WQX)(x.G),this._router=(0,e.WQX)(a.Ix),this._snackBar=(0,e.WQX)(z.UG),this._unsubscribeAll=new A.B,this.store=(0,e.WQX)(W.il)}ngOnInit(){window.Apex={chart:{events:{mounted:(t,n)=>{this._fixSvgFill(t.el)},updated:(t,n)=>{this._fixSvgFill(t.el)}}}},this.store.select(V.Ye).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(t=>{this.terminals=t,1===this.terminals.length&&this._boxService.getLastBoxByTerminalId(this.terminals[0].id).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(()=>{this.selectedTerminal=this.terminals[0]}),this._changeDetectorRef.markForCheck()}),this.store.select(N.k2).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(t=>{this.box=t,this.box&&(this.data.total=t.initial+t.income+t.return+t.loan+t.spent+t.depot-t.extraction,this.data.series=[t.initial,t.income,t.return,t.loan,t.spent,t.depot,t.extraction],this.balance=t.initial+t.income+t.depot-t.extraction-t.return-t.loan-t.spent,this._prepareChartData()),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}selectTerminal(t){this.selectedTerminal=t,t.openedBox&&this.store.dispatch((0,ee.yw)({box:t.openedBox})),this._changeDetectorRef.markForCheck()}openBoxOpenerDialog(t){this._dialog.open(h.o,{data:{title:"Abrir caja.",message:"\xbfEst\xe1 seguro que desea abrir la caja?",terminal:t},panelClass:"ath-dialog-panel",maxWidth:"400px"})}openBox(t){this._fuseConfirmationService.open({title:"Abrir caja.",message:"\xbfEst\xe1 seguro que desea abrir la caja",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,m.Q)(this._unsubscribeAll)).subscribe(i=>{"confirmed"===i&&this._boxService.openBox(this.selectedTerminal.id,t).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(({data:r})=>{this._snackBar.openFromComponent(K.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:r.openBox.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()})})}openBoxAdminDialog(t){this._dialog.open(d,{data:{boxMovementType:t,terminalId:this.selectedTerminal.id},width:"90%",maxWidth:"400px",panelClass:"ath-dialog-panel",disableClose:!0})}trackByFn(t,n){return n.id||t}_fixSvgFill(t){const n=this._router.url;Array.from(t.querySelectorAll("*[fill]")).filter(i=>-1!==i.getAttribute("fill").indexOf("url(")).forEach(i=>{const r=i.getAttribute("fill");i.setAttribute("fill",`url(${n}${r.slice(r.indexOf("#"))}`)})}_prepareChartData(){this.boxMovementDistribution={chart:{animations:{speed:400,animateGradually:{enabled:!1}},fontFamily:"inherit",foreColor:"inherit",height:"100%",type:"donut",sparkline:{enabled:!0}},colors:this.data.colors,labels:this.data.labels,plotOptions:{pie:{customScale:.9,expandOnClick:!1,donut:{size:"0%"}}},series:this.data.series,states:{hover:{filter:{type:"none"}},active:{filter:{type:"none"}}},tooltip:{enabled:!0,fillSeriesColor:!1,theme:"dark",custom:({seriesIndex:t,w:n})=>`<div class="flex items-center h-8 min-h-8 max-h-8 px-3">\n                                                     <div class="w-3 h-3 rounded-full" style="background-color: ${n.config.colors[t]};"></div>\n                                                     <div class="ml-2 text-md leading-none">${n.config.labels[t]}:</div>\n                                                     <div class="ml-2 text-md font-bold leading-none">${(n.config.series[t]/this.data.total*100).toFixed(2)}%</div>\n                                                 </div>`}}}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["box-admin"]],standalone:!0,features:[e.aNF],decls:3,vars:1,consts:[["optionsMenu","matMenu"],["movementsMenu","matMenu"],["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"flex","flex-col","items-center","justify-center","w-full","h-full","px-3","space-y-5"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap",3,"click"],[1,"ml-1","text-primary-500","cursor-pointer"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","flex-col","gap-2","md:flex-row"],[1,"font-mono"],[1,"px-2.5","rounded-full","bg-primary-500","w-fit"],[1,"flex","flex-col","items-center","gap-2","mt-6","md:flex-row","shrink-0","lg:mt-0","lg:ml-4"],[1,""],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-yellow-500","to-yellow-600",3,"matMenuTriggerFor"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[3,"svgIcon"],[1,"flex","flex-auto","overflow-hidden","overflow-y-scroll"],[1,"grid","w-full","grid-cols-1","gap-2","p-8","md:grid-cols-2"],[1,"flex","flex-col","border","divide-y"],[1,"grid","w-full","grid-cols-3"],[1,"flex","items-center","justify-center"],[1,"leading-10","rounded-full","h-7","w-7","bg-slate-500"],[1,"font-semibold","leading-10","uppercase"],[1,"font-mono","leading-10","text-center"],[1,"leading-10","bg-green-500","rounded-full","h-7","w-7"],[1,"leading-10","bg-red-500","rounded-full","h-7","w-7"],[1,"leading-10","bg-yellow-500","rounded-full","h-7","w-7"],[1,"leading-10","rounded-full","h-7","w-7","bg-cyan-500"],[1,"w-auto","font-semibold","leading-10","uppercase"],[1,"leading-10","bg-blue-500","rounded-full","h-7","w-7"],[1,"leading-10","bg-pink-500","rounded-full","h-7","w-7"],[1,"w-auto","py-1","text-xl","font-bold","leading-10","text-green-500","uppercase"],[1,"py-1","font-mono","text-xl","font-bold","leading-10","text-center","text-green-500"],[1,"w-auto","py-1","text-xl","font-bold","leading-10","text-red-500","uppercase"],[1,"py-1","font-mono","text-xl","font-bold","leading-10","text-center","text-red-500"],[1,"w-auto","py-1","text-xl","font-bold","leading-10","uppercase","dark:text-slate-500"],[1,"py-1","font-mono","text-xl","font-bold","leading-10","text-center","dark:text-slate-500"],[1,"flex","flex-row","flex-auto","p-6","overflow-hidden","shadow","bg-card","rounded-2xl"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"routerLink"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"matMenuTriggerFor"],[1,"flex","flex-col","flex-auto","w-1/2","mt-6","h-44"],[1,"flex","items-center","justify-center","flex-auto","w-full","h-full",3,"chart","colors","labels","plotOptions","series","states","tooltip"],[1,"w-1/2","divide-y"],[1,"grid","grid-cols-2","py-3"],[1,"flex","items-center"],[1,"w-2","h-2","rounded-full","flex-0"],[1,"ml-3","truncate"],[1,"font-mono","font-medium","text-right"],[1,"flex","flex-col","items-center","justify-center","w-full"],[1,"text-4xl","font-bold","text-center"],[1,"flex","flex-row","flex-wrap","items-center","justify-center","w-full","gap-5"],[1,"group","flex","items-center","justify-between","w-full","p-6","transition-all","duration-300","ease-in-out","cursor-pointer","max-w-80","filter-info",3,"ngClass"],[1,"group","flex","items-center","justify-between","w-full","p-6","transition-all","duration-300","ease-in-out","cursor-pointer","max-w-80","filter-info",3,"click","ngClass"],[1,"mr-6","icon-size-12",3,"svgIcon"],[1,"flex","flex-col"],[1,"text-2xl","font-semibold","leading-tight"],[1,"text-md","text-secondary"],["mat-icon-button","","matTooltip","Abrir caja",1,"group-hover:animate-ping","animate-pulse","hover:animate-pulse",3,"click","ngClass"],[1,"icon-size-5",3,"svgIcon"]],template:function(n,i){1&n&&(e.j41(0,"div",2),e.DNE(1,Le,116,55)(2,ze,7,0,"div",3),e.k0s()),2&n&&(e.R7$(),e.vxM(i.box?1:2))},dependencies:[F.oe,F.vh,C.$,j.Hl,j.$z,j.iY,G.m_,G.An,D.Cn,B.uv,D.kk,D.fb,D.Cp,O.J,O.Q,F.YU,F.m1,a.Wk,F.PV,U.uc,U.oV],encapsulation:2,changeDetection:0})}return o})();var Ne=l(10467),ie=l(96695),J=l(2042),L=l(25084),se=l(7673),ye=l(57786),Z=l(70152),oe=l(25558),H=l(96354),ge=l(99172),xe=l(70980),_e=l(31397),ve=l(47413),Fe=l(63729),Ce=l(70819),ke=l(64193),Ee=l(78357),M=l(97586),je=l(77235),re=l(82643),f=function(o){return o.initial="initial",o.income="income",o.return="return",o.loan="loan",o.spent="spent",o.depot="depot",o.extraction="extraction",o}(f||{});let De=(()=>{class o{constructor(){re.vfs=je.b.vfs}boxCloseReport(t,n,i){const r=[],b=`Cierre de caja ${M(t.close).format("DD/MM/yy hh:mm a")}`,g=[{text:"Informaci\xf3n General",style:"header"},{text:`Local: ${t.terminal.location.name}`,style:"subheader"},{text:`Nombre de la Caja: ${t.terminal.name}`,style:"subheader"},{text:`Usuario: ${t.user.fullname}`,style:"subheader"},{text:`Total Inicial: ${t.initial.toFixed(2)}`,style:"subheader"},{text:`Ingresos: ${t.income.toFixed(2)}`,style:"subheader"},{text:`Devoluciones: ${t.return.toFixed(2)}`,style:"subheader"},{text:`Pr\xe9stamos: ${t.loan.toFixed(2)}`,style:"subheader"},{text:`Gastos: ${t.spent.toFixed(2)}`,style:"subheader"},{text:`Dep\xf3sitos: ${t.depot.toFixed(2)}`,style:"subheader"},{text:`Extracciones: ${t.extraction.toFixed(2)}`,style:"subheader"},{text:`Gastos: ${t.spent.toFixed(2)}`,style:"subheader"},{text:`Total Final: ${(t.initial+t.income+t.depot-t.return-t.loan-t.spent-t.extraction).toFixed(2)}`,style:"subheader"}],_=[{marginTop:10,columns:[{text:"Billetes",style:"header"},{text:"Monedas",style:"header"}]},{columns:[{table:{headerRows:1,widths:["*",80,100],body:[[{text:"Denominaci\xf3n",style:"table_header",alignment:"left"},{text:"Cantidad",style:"table_header"},{text:"Importe",style:"table_header",alignment:"right"}],[{text:"Billetes de 1",bold:!0,style:"table_body",alignment:"left"},{text:t.cashDistribution?.b1,style:"table_body"},{text:(1*t.cashDistribution?.b1).toFixed(2),style:"table_body",alignment:"right"}],[{text:"Billetes de 3",bold:!0,style:"table_body",alignment:"left"},{text:t.cashDistribution?.b3,style:"table_body"},{text:(3*t.cashDistribution?.b3).toFixed(2),style:"table_body",alignment:"right"}],[{text:"Billetes de 5",bold:!0,style:"table_body",alignment:"left"},{text:t.cashDistribution?.b5,style:"table_body"},{text:(5*t.cashDistribution?.b5).toFixed(2),style:"table_body",alignment:"right"}],[{text:"Billetes de 10",bold:!0,style:"table_body",alignment:"left"},{text:t.cashDistribution?.b10,style:"table_body"},{text:(10*t.cashDistribution?.b10).toFixed(2),style:"table_body",alignment:"right"}],[{text:"Billetes de 20",bold:!0,style:"table_body",alignment:"left"},{text:t.cashDistribution?.b20,style:"table_body"},{text:(20*t.cashDistribution?.b20).toFixed(2),style:"table_body",alignment:"right"}],[{text:"Billetes de 50",bold:!0,style:"table_body",alignment:"left"},{text:t.cashDistribution?.b50,style:"table_body"},{text:(50*t.cashDistribution?.b50).toFixed(2),style:"table_body",alignment:"right"}],[{text:"Billetes de 100",bold:!0,style:"table_body",alignment:"left"},{text:t.cashDistribution?.b100,style:"table_body"},{text:(100*t.cashDistribution?.b100).toFixed(2),style:"table_body",alignment:"right"}],[{text:"Billetes de 200",bold:!0,style:"table_body",alignment:"left"},{text:t.cashDistribution?.b200,style:"table_body"},{text:(200*t.cashDistribution?.b200).toFixed(2),style:"table_body",alignment:"right"}],[{text:"Billetes de 500",bold:!0,style:"table_body",alignment:"left"},{text:t.cashDistribution?.b500,style:"table_body"},{text:(500*t.cashDistribution?.b500).toFixed(2),style:"table_body",alignment:"right"}],[{text:"Billetes de 1000",bold:!0,style:"table_body",alignment:"left"},{text:t.cashDistribution?.b1000,style:"table_body"},{text:(1e3*t.cashDistribution?.b1000).toFixed(2),style:"table_body",alignment:"right"}]]},layout:{hLineWidth:(u,k)=>.7,vLineWidth:(u,k)=>0,hLineColor:(u,k)=>"#eeeeee"}},{table:{headerRows:1,widths:["*",80,100],body:[[{text:"Denominaci\xf3n",style:"table_header",alignment:"left"},{text:"Cantidad",style:"table_header"},{text:"Importe",style:"table_header",alignment:"right"}],[{text:"Monedas de 1",style:"table_body",bold:!0,alignment:"left"},{text:t.cashDistribution?.m1,style:"table_body"},{text:(1*t.cashDistribution?.m1).toFixed(2),style:"table_body",alignment:"right"}],[{text:"Monedas de 3",style:"table_body",bold:!0,alignment:"left"},{text:t.cashDistribution?.m3,style:"table_body"},{text:(3*t.cashDistribution?.m3).toFixed(2),style:"table_body",alignment:"right"}],[{text:"Monedas de 5",style:"table_body",bold:!0,alignment:"left"},{text:t.cashDistribution?.m5,style:"table_body"},{text:(5*t.cashDistribution?.m5).toFixed(2),style:"table_body",alignment:"right"}],[{text:"Monedas de 0.01",style:"table_body",bold:!0,alignment:"left"},{text:t.cashDistribution?.c1,style:"table_body"},{text:(.01*t.cashDistribution?.c1).toFixed(2),style:"table_body",alignment:"right"}],[{text:"Monedas de 0.02",style:"table_body",bold:!0,alignment:"left"},{text:t.cashDistribution?.c2,style:"table_body"},{text:(.02*t.cashDistribution?.c2).toFixed(2),style:"table_body",alignment:"right"}],[{text:"Monedas de 0.05",style:"table_body",bold:!0,alignment:"left"},{text:t.cashDistribution?.c5,style:"table_body"},{text:(.05*t.cashDistribution?.c5).toFixed(2),style:"table_body",alignment:"right"}],[{text:"Monedas de 0.20",style:"table_body",bold:!0,alignment:"left"},{text:t.cashDistribution?.c20,style:"table_body"},{text:(.2*t.cashDistribution?.c20).toFixed(2),style:"table_body",alignment:"right"}]]},layout:{hLineWidth:(u,k)=>.7,vLineWidth:(u,k)=>0,hLineColor:(u,k)=>"#eeeeee"}}]}],y=t.boxMovements.reduce((u,k)=>{const ne=k.movementType,w=u.findIndex(q=>q.movementType===ne);return-1===w?u.push({movementType:ne,movements:[k]}):u[w].movements.push(k),u},[]),S=[[{text:"MOVIMIENTOS DE CAJA",style:"table_header",colSpan:4},{text:""},{text:""},{text:""}],[{text:"Tipo",style:"table_header"},{text:"N\xba",style:"table_header"},{text:"Monto",style:"table_header"},{text:"Motivo",style:"table_header"}]];for(const u of y){let k=this.translateMovementType(u.movementType);const ne=[{rowSpan:u.movements.length,text:k,alignment:"left",style:"table_body"},{text:u.movements[0].no,style:"table_body"},{text:u.movements[0].amount.toFixed(2),style:"table_body"},{text:u.movements[0].reason,style:"table_body",margin:[8,0,0,0],alignment:"left"}];S.push(ne);for(let w=1;w<u.movements.length;w++){const q=[{text:"",alignment:"center"},{text:u.movements[w].no,style:"table_body"},{text:u.movements[w].amount.toFixed(2),style:"table_body"},{text:u.movements[w].reason,style:"table_body",margin:[8,0,0,0],alignment:"left"}];S.push(q)}}const R=[{table:{headerRows:2,widths:[60,100,60,"*"],body:S},layout:{hLineWidth:(u,k)=>.7,vLineWidth:(u,k)=>.7,hLineColor:(u,k)=>"#eeeeee",vLineColor:(u,k)=>"#eeeeee"},marginTop:30}];r.push(g,_),t.boxMovements.length>0&&r.push(R);const X={header:{text:b,style:"header",marginTop:5},content:r,footer:(u,k)=>({table:{widths:["*","*"],body:[[{text:`Reporte generador por: ${i.fullname} | Esta informaci\xf3n es exclusiva de ${n.name}`,bold:!0,fontSize:8},{text:`P\xe1gina ${u.toString()}/${k} - Fecha de impresi\xf3n ${M().format("DD/MM/yyyy HH:mm:ss")}`,bold:!0,fontSize:8,alignment:"right"}]]},margin:[30,0,30,0],layout:"noBorders",italics:!0}),defaultStyle:{fontSize:12},styles:{header:{fontSize:18,bold:!0,marginBottom:5,alignment:"center",fontFeatures:["c2sc","smcp"]},subheader:{fontSize:14,bold:!0,marginBottom:2,alignment:"left",fontFeatures:["c2sc","smcp"]},table_header:{fontSize:11,bold:!0,alignment:"center",fillColor:"#eeeeee",fontFeatures:["c2sc","smcp"]},table_footer:{fontSize:12,bold:!0,alignment:"center",fillColor:"#eeeeee",fontFeatures:["c2sc","smcp"]},table_body:{fontSize:10,alignment:"center"}},pageOrientation:"portrait",pageSize:"LETTER",watermark:{text:n.name,color:"#fff",opacity:.07,angle:-35,bold:!0,italics:!1},info:{title:b,author:`${i.fullname}`,creationDate:M().toDate(),modDate:M().toDate(),producer:n.name}};re.createPdf(X).open()}generateBoxSaleResumeDocument(t){const r={content:[{text:t.locationName,style:"header"},{text:"Resumen de Caja y Ventas",style:"subheader"},{text:`${M(t.openedAt).format("DD/MM/yyyy hh:mm:ss a")}`,style:"body"},{text:"-",style:"body",fontSize:5},{text:`${M(t.closedAT).format("DD/MM/yyyy hh:mm:ss a")}`,style:"body"},{text:"---------------------------------------"},{text:"Ventas",alignment:"center",bold:!0,fontSize:8},{text:"---------------------------------------"},{table:{widths:[44,16,"*"],body:[[{text:"Promociones",style:"table_body"},{text:t.salesPromotionCount,alignment:"center",style:"table_body"},{text:"$ "+t.salesPromotion.toFixed(2),alignment:"right",style:"table_body"}],[{text:"Descuentos",style:"table_body"},{text:t.salesDiscountCount,alignment:"center",style:"table_body"},{text:"$ "+t.salesDiscount.toFixed(2),alignment:"right",style:"table_body"}],[{text:"Efectivo",style:"table_body",marginTop:6},{text:t.salesCashCount,alignment:"center",style:"table_body",marginTop:6},{text:"$ "+t.salesCash.toFixed(2),alignment:"right",style:"table_body",marginTop:6}],[{text:"Transferencia",style:"table_body"},{text:t.salesTransferCount,alignment:"center",style:"table_body"},{text:"$ "+t.salesTransfer.toFixed(2),alignment:"right",style:"table_body"}],[{text:"Venta Total",style:"table_body",bold:!0},{text:t.salesTransferCount+t.salesCashCount,alignment:"center",style:"table_body",bold:!0},{text:"$ "+(t.salesCash+t.salesTransfer).toFixed(2),alignment:"right",style:"table_body",bold:!0}]]},layout:{hLineWidth:(b,g)=>0,vLineWidth:(b,g)=>0}},{text:"---------------------------------------"},{text:"Caja",alignment:"center",bold:!0,fontSize:8},{text:"---------------------------------------"},{table:{widths:["*","*"],body:[[{text:"Total Inicial",style:"table_body"},{text:"$ "+t.boxData.initial.toFixed(2),alignment:"right",style:"table_body"}],[{text:"Ingresos",style:"table_body"},{text:"$ "+t.boxData.income.toFixed(2),alignment:"right",style:"table_body"}],[{text:"Devoluciones",style:"table_body"},{text:"$ "+t.boxData.return.toFixed(2),alignment:"right",style:"table_body"}],[{text:"Pr\xe9stamos",style:"table_body"},{text:"$ "+t.boxData.loan.toFixed(2),alignment:"right",style:"table_body"}],[{text:"Dep\xf3sitos",style:"table_body"},{text:"$ "+t.boxData.depot.toFixed(2),alignment:"right",style:"table_body"}],[{text:"Extracciones",style:"table_body"},{text:"$ "+t.boxData.extraction.toFixed(2),alignment:"right",style:"table_body"}],[{text:"Gastos",style:"table_body"},{text:"$ "+t.boxData.spent.toFixed(2),alignment:"right",style:"table_body"}],[{text:"Total final",style:"table_body",bold:!0},{text:"$ "+(t.boxData.initial+t.boxData.income+t.boxData.depot-t.boxData.return-t.boxData.loan-t.boxData.spent-t.boxData.extraction).toFixed(2),alignment:"right",style:"table_body",bold:!0}]]},layout:{hLineWidth:(b,g)=>0,vLineWidth:(b,g)=>0}}],styles:{header:{alignment:"center",fontSize:10,bold:!0},subheader:{alignment:"center",fontSize:9,bold:!0,margin:[0,2,0,2]},body:{alignment:"center",bold:!1,fontSize:6,margin:[0,0,0,0]},line:{margin:[0,3,0,3]},table_header:{fontSize:10,bold:!0,alignment:"center",fillColor:"#eeeeee"},table_body:{fontSize:7}},pageSize:{width:150,height:320},pageMargins:[10,15,10,15]};re.createPdf(r).open()}generateBoxMovementsDocument(t,n,i,r){const b=n.reduce((_,y)=>{const S=y.boxId;return _[S]?_[S].push(y):_[S]=[y],_},{}),g={content:[{layout:{hLineWidth:(_,y)=>.5,vLineWidth:(_,y)=>0,hLineColor:(_,y)=>"#eeeeee"},table:{headerRows:1,widths:["*","*"],body:[[{text:"Documento",style:"table_header_simple",fontSize:8,bold:!0,alignment:"left"},{text:"Per\xedodo",style:"table_header_simple",fontSize:8,bold:!0,alignment:"center"}],[{text:"Registro de movimientos de caja",fontSize:10,bold:!0},{text:`${M(t.start).format("DD-MM-yyyy hh:mm a")} al ${M(t.end).format("DD-MM-yyyy hh:mm a")}`,fontSize:10,bold:!0,alignment:"center"}]]}},{table:{headerRows:1,widths:[20,50,100,100,70,"*"],body:[[{text:"N\xba",style:"table_header"},{text:"Tipo",style:"table_header"},{text:"N\xba.Caja",style:"table_header"},{text:"Fecha",style:"table_header"},{text:"Monto",style:"table_header"},{text:"Motivo",style:"table_header"}],...Object.keys(b).map(_=>{const y=[];let S=1;if(!b.hasOwnProperty(_))return y;const R=n.find(u=>u.boxId===_).box;y.push([{text:`N\xba: ${R.no}  -  Fecha de Cierre: ${R.close?M(R.close).format("DD/MM/yyyy hh mm A"):"Abierta"} -  Monto de cierre: $${R.initial+R.income+R.depot-R.return-R.loan-R.spent-R.extraction}`,colSpan:6,alignment:"center",bold:!0,fontSize:10,fillColor:"whitesmoke"},{},{},{},{},{}]);let X=b[_];for(const u of X){const k=X.indexOf(u),ne=X.filter((ae,le)=>le<k);let w={},q={};const $e=this.translateMovementType(u.movementType);if(0===ne.length){const ae=X.filter(le=>le.movementType===u.movementType).length;w={text:$e,style:"table_body",rowSpan:ae},q={text:"1",style:"table_body",alignment:"center",rowSpan:ae}}else if(X[k].movementType!==X[k-1].movementType){const ae=X.filter(le=>le.movementType===u.movementType).length;w={text:$e,style:"table_body",rowSpan:ae},S++,q={text:S.toString(),style:"table_body",alignment:"center",rowSpan:ae}}y.push([q,w,{text:u.no,style:"table_body",alignment:"center"},{text:M(u.createdAt).format("DD/MM/yyyy hh mm A"),style:"table_body",alignment:"center"},{text:u.amount.toFixed(2),style:"table_body",alignment:"right"},{text:u?.reason,style:"table_body",alignment:"left"}])}return y}).flat()]},layout:{hLineWidth:(_,y)=>.7,vLineWidth:(_,y)=>.7,hLineColor:(_,y)=>"#eeeeee",vLineColor:(_,y)=>"#eeeeee"},marginTop:30,marginBottom:30}],footer:(_,y)=>({stack:[_===y?{layout:{hLineWidth:(S,R)=>.7,vLineWidth:(S,R)=>0,hLineColor:(S,R)=>"#eeeeee"},table:{headerRows:1,widths:["*","*","*"],body:[[{style:"table_header_simple",text:"elabora",fontFeatures:["c2sc","smcp"],alignment:"left"},{style:"table_header_simple",text:"",fontFeatures:["c2sc","smcp"],alignment:"left"},{style:"table_header_simple",text:"revisa",fontFeatures:["c2sc","smcp"],alignment:"left"}],[{text:"Nombre y apellidos",bold:!0,fontSize:8,fontFeatures:["c2sc","smcp"]},{text:"",bold:!0,fontSize:8,fontFeatures:["c2sc","smcp"]},{text:"Nombre y apellidos",bold:!0,fontSize:8,fontFeatures:["c2sc","smcp"]}],[{style:"table_header_simple",text:r.employee.fullname,fontSize:10,alignment:"left",fontFeatures:["c2sc","smcp"]},{style:"table_header_simple",text:""},{style:"table_header_simple",text:""}],[{text:"Firma",bold:!0,fontSize:8,fontFeatures:["c2sc","smcp"]},{text:"",bold:!0,fontSize:8,fontFeatures:["c2sc","smcp"]},{text:"Firma",bold:!0,fontSize:8,fontFeatures:["c2sc","smcp"]}],[{style:"table_header_simple",text:" "},{style:"table_header_simple",text:" "},{style:"table_header_simple",text:" "}]]},margin:[40,0,40,0]}:null,{table:{widths:["*","*"],body:[[{text:`Registro de movimientos en el per\xedodo ${M(t.start).format("DD-MM-yyyy hh:mm a")} al ${M(t.end).format("DD-MM-yyyy hh:mm a")}`,bold:!0,fontSize:8},{text:`P\xe1gina ${_.toString()}/${y} - Fecha de impresi\xf3n ${M().format("DD/MM/yyyy HH:mm:ss")}`,bold:!0,fontSize:8,alignment:"right"}]]},margin:_===y?[40,15,40,0]:[40,145,40,0],layout:"noBorders",italics:!0}]}),defaultStyle:{fontSize:12},styles:{header:{fontSize:16,bold:!0,marginBottom:5,alignment:"center",fontFeatures:["c2sc","smcp"]},table_header_simple:{fontSize:8,bold:!0,alignment:"center",fillColor:"#eeeeee"},table_header:{fontSize:10,bold:!0,alignment:"center",fillColor:"#eeeeee"},table_body:{fontSize:10},totals_name:{bold:!0,fillColor:"#eeeeee",alignment:"right",fontFeatures:["c2sc","smcp"],fontSize:10},totals_value:{alignment:"right",bold:!0,fontSize:11}},pageOrientation:"landscape",pageBreakBefore:(_,y)=>1===_.headlineLevel&&y.length>0,pageSize:"LETTER",pageMargins:[40,40,40,180],watermark:{text:i.name,color:"#fff",opacity:.07,angle:-35,bold:!0,italics:!1},info:{title:`Registro de movimientos en el per\xedodo ${M(t.start).format("DD-MM-yyyy hh:mm a")} al ${M(t.end).format("DD-MM-yyyy hh:mm a")}`,author:r.fullname,creationDate:M().toDate(),modDate:M().toDate(),producer:i.name}};re.createPdf(g).open()}translateMovementType(t){switch(t){case f.initial:return"Inicial";case f.income:return"Ingreso";case f.return:return"Devoluci\xf3n";case f.loan:return"Pr\xe9stamo";case f.spent:return"Gasto";case f.depot:return"Dep\xf3sito";case f.extraction:return"Extracci\xf3n"}}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();re.vfs=je.b.vfs;var Oe=l(56730),Ve=l(7997),Xe=l(23083),Qe=l(49098),Ue=l(74892),ce=l(55364);const We=["locationFilter"],Je=["terminalFilter"],He=["statusFilter"],Ke=()=>({wheelPropagation:!1}),Be=(o,c,t)=>({"boxes-grid-1":o,"boxes-grid-2":c,"boxes-grid-3":t}),me=o=>({hidden:o}),Ze=()=>["abierta","cerrada"],qe=(o,c)=>({"pointer-events-none":o,hidden:c}),et=()=>[10,25,50,100],tt=(o,c)=>({"text-orange-700 bg-orange-50":o,"text-green-700 bg-green-50":c});function it(o,c){if(1&o){const t=e.RV6();e.j41(0,"mat-icon",50),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.range.reset())}),e.k0s()}}function ot(o,c){if(1&o){const t=e.RV6();e.j41(0,"mat-form-field",37)(1,"mat-date-range-input",38),e.nrm(2,"input",39)(3,"input",40),e.k0s(),e.nrm(4,"mat-datepicker-toggle",41)(5,"mat-date-range-picker",42,3),e.DNE(7,it,1,0,"mat-icon",43),e.k0s(),e.j41(8,"div",44)(9,"button",45),e.nrm(10,"mat-icon",46),e.j41(11,"span",47),e.EFF(12,"Reportes"),e.k0s()(),e.j41(13,"mat-menu",48,4)(15,"button",49),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.generateBoxesReport())}),e.EFF(16,"Resumen de cajas"),e.k0s()()()}if(2&o){const t=e.sdS(6),n=e.sdS(14),i=e.XpG();e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("formGroup",i.range)("rangePicker",t)("max",i.maxDate),e.R7$(3),e.Y8G("for",t),e.R7$(3),e.vxM(i.range.get("start").value||i.range.get("end").value?7:-1),e.R7$(2),e.Y8G("disabled",!i.range.get("start").value||!i.range.get("end").value||i.range.invalid)("matMenuTriggerFor",n),e.R7$(),e.Y8G("svgIcon","mat_solid:plagiarism")}}function nt(o,c){if(1&o){const t=e.RV6();e.j41(0,"div",51)(1,"div",52),e.EFF(2),e.k0s(),e.j41(3,"div",53),e.EFF(4),e.k0s(),e.j41(5,"div",53),e.EFF(6),e.k0s(),e.j41(7,"div",54),e.EFF(8),e.nI1(9,"date"),e.k0s(),e.j41(10,"div",55),e.EFF(11),e.nI1(12,"currency"),e.k0s(),e.j41(13,"div",54),e.EFF(14),e.nI1(15,"date"),e.k0s(),e.j41(16,"div",55),e.EFF(17),e.nI1(18,"currency"),e.k0s(),e.j41(19,"div",56)(20,"div",57)(21,"span",58),e.EFF(22),e.nI1(23,"uppercase"),e.k0s()()(),e.j41(24,"div",59)(25,"button",60),e.nrm(26,"mat-icon",61),e.k0s(),e.j41(27,"mat-menu",48,5)(29,"button",62),e.bIt("click",function(){const i=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.boxCloseReport(i))}),e.EFF(30,"Resumen de caja"),e.k0s(),e.j41(31,"button",49),e.bIt("click",function(){const i=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.saleProductsReport(i.id))}),e.EFF(32,"Ventas por productos"),e.k0s(),e.j41(33,"button",49),e.bIt("click",function(){const i=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.salesByCategoriesProducts(i.id))}),e.EFF(34,"Ventas por categor\xedas"),e.k0s(),e.j41(35,"button",49),e.bIt("click",function(){const i=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.saleResumeDocument(i.id))}),e.EFF(36,"Resumen de caja y ventas"),e.k0s()(),e.j41(37,"button",63),e.nrm(38,"mat-icon",61),e.k0s(),e.j41(39,"mat-menu",48,4)(41,"button",49),e.bIt("click",function(){const i=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.printIPV(i.id))}),e.EFF(42,"Ventas por productos"),e.k0s(),e.j41(43,"button",49),e.bIt("click",function(){const i=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.printIPVCategories(i.id))}),e.EFF(44,"Ventas por categor\xedas"),e.k0s(),e.j41(45,"button",49),e.bIt("click",function(){const i=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.printBoxAndSales(i.id))}),e.EFF(46,"Resumen de caja y ventas"),e.k0s()()()()}if(2&o){const t=c.$implicit,n=e.sdS(28),i=e.sdS(40),r=e.XpG(2);e.Y8G("ngClass",e.sMw(32,Be,1===r.user.accessLevel,2===r.user.accessLevel,3===r.user.accessLevel)),e.R7$(2),e.SpI(" ",t.no," "),e.R7$(),e.Y8G("ngClass",e.eq3(36,me,r.user.accessLevel<3)),e.R7$(),e.SpI(" ",t.location.name," "),e.R7$(),e.Y8G("ngClass",e.eq3(38,me,1===r.user.accessLevel)),e.R7$(),e.SpI(" ",t.terminal.name," "),e.R7$(2),e.SpI(" ",e.i5U(9,18,t.open,"dd/MM/yyyy HH:mm a")," "),e.R7$(3),e.SpI(" ",e.i5U(12,21,t.initial,"$ ")," "),e.R7$(3),e.SpI(" ",e.i5U(15,24,t.close,"dd/MM/yyyy HH:mm a")," "),e.R7$(3),e.SpI(" ",e.i5U(18,27,t.initial+t.income+t.depot-t.return-t.loan-t.spent-t.extraction,"$ ")," "),e.R7$(3),e.Y8G("ngClass",e.l_i(40,tt,"cerrada"===t.status,"abierta"===t.status)),e.R7$(2),e.SpI(" ",e.bMT(23,30,t.status)," "),e.R7$(3),e.Y8G("matMenuTriggerFor",n),e.R7$(),e.Y8G("svgIcon","mat_solid:request_page"),e.R7$(3),e.Y8G("disabled","abierta"===t.status),e.R7$(8),e.Y8G("matMenuTriggerFor",i)("disabled","abierta"===t.status),e.R7$(),e.Y8G("svgIcon","mat_solid:print")}}function at(o,c){1&o&&e.Z7z(0,nt,47,43,"div",51,e.BUC().trackByFn,!0),2&o&&e.Dyx(c)}function st(o,c){1&o&&(e.j41(0,"div",35),e.EFF(1," \xa1No se ha registrado ning\xfan cierre de caja! "),e.k0s())}let rt=(()=>{class o{constructor(){this.boxes$=(0,se.of)([]),this.isLoading=!1,this.isSlideLoading=!1,this.merchant=null,this.selectedSlide=null,this.user=null,this.maxDate=new Date,this.searchLocationsControl=new s.MJ(null),this.searchTerminalsControl=new s.MJ(null),this.searchInputControl=new s.MJ,this.filterInputControl=new s.MJ,this.selectedLocation=null,this.selectedTerminal=null,this.selectedStatus=[],this.range=new s.gE({start:new s.MJ({disabled:!1,value:null},[ce.t.futureDateValidator()]),end:new s.MJ({disabled:!1,value:null},[ce.t.futureDateValidator()])}),this._boxReportsService=(0,e.WQX)(De),this._boxService=(0,e.WQX)(P.R),this._changeDetectorRef=(0,e.WQX)(e.gRc),this._documentsService=(0,e.WQX)(Oe.Q),this._snackBar=(0,e.WQX)(z.UG),this._unsubscribeAll=new A.B,this.store=(0,e.WQX)(W.il),this._printerService=(0,e.WQX)(Ve.k),this._salesService=(0,e.WQX)(Xe.w),this._locationsService=(0,e.WQX)(Qe.O),this._terminalsService=(0,e.WQX)(Ue.T)}ngOnInit(){this.store.select(Ce.Xb).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(Fe.SW).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.boxes$=this.store.select(N.Gf),this.store.select(ve.Dz).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,m.Q)(this._unsubscribeAll),(0,Z.B)(300),(0,oe.n)(t=>(this.isLoading=!0,this._boxService.getBoxes(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,t,this.selectedLocation?.id,this.selectedTerminal?.id,this.selectedStatus,this.range.get("start").value,this.range.get("end").value))),(0,H.T)(()=>{this.isLoading=!1})).subscribe(),this.locationsFiltered=this.searchLocationsControl.valueChanges.pipe((0,Z.B)(200),(0,ge.Z)(null),(0,xe.j)(()=>{this.isLoading=!1}),(0,_e.Z)(t=>null!==t&&"string"==typeof t&&(this.selectedLocation&&t!==this.selectedLocation.name||!this.selectedLocation)?(this.isLoading=!0,this._locationsService.findActiveLocations(t.trim())):(0,se.of)())),this.terminalsFiltered=this.searchTerminalsControl.valueChanges.pipe((0,Z.B)(200),(0,ge.Z)(null),(0,xe.j)(()=>{this.isLoading=!1}),(0,_e.Z)(t=>null!==t&&"string"==typeof t&&(this.selectedTerminal&&t!==this.selectedTerminal.name||!this.selectedTerminal)?(this.isLoading=!0,this._terminalsService.findTerminalsActiveByUser().pipe((0,H.T)(n=>n.data.findTerminalsActiveByUser.terminals))):(0,se.of)())),this.filterInputControl.valueChanges.pipe((0,m.Q)(this._unsubscribeAll),(0,Z.B)(300),(0,oe.n)(t=>(this.isLoading=!0,this._boxService.getBoxes(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.selectedLocation?.id,this.selectedTerminal?.id,this.selectedStatus,this.range.get("start").value,this.range.get("end").value))),(0,H.T)(()=>{this.isLoading=!1})).subscribe(),this.range.valueChanges.pipe((0,m.Q)(this._unsubscribeAll)).subscribe(t=>{this._boxService.getBoxes(0,this.pagination.size,this._sort.active,this._sort.direction,this.searchInputControl.value,this.selectedLocation?.id,this.selectedTerminal?.id,this.selectedStatus,t.start,t.end).pipe((0,m.Q)(this._unsubscribeAll)).subscribe()})}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"updatedAt",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,m.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,ye.h)(this._sort.sortChange,this._paginator.page).pipe((0,oe.n)(()=>(this.isLoading=!0,this._boxService.getBoxes(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.selectedLocation?.id,this.selectedTerminal?.id,this.selectedStatus,this.range.get("start").value,this.range.get("end").value))),(0,H.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this.store.dispatch((0,ee.Bx)())}resetLocation(){this.selectedLocation=null,this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addLocation(t){this.selectedLocation=t,this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}resetTerminal(){this.selectedTerminal=null,this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addTerminal(t){this.selectedTerminal=t,this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addStatus(t){this.selectedStatus=t,this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}generateBoxesReport(){const{start:t,end:n}=this.range.getRawValue();!t||!n||this._boxService.getAllBoxes(null,this.selectedLocation?.id,this.selectedTerminal?.id,t,n).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(({data:i})=>{i&&this._documentsService.generateBoxesReport(i.getBoxes.boxes,{start:i.getBoxes.startDate,end:i.getBoxes.endDate},this.merchant,this.user)})}boxCloseReport(t){this._boxService.getBoxById(t.id).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(({data:n})=>{t&&this._boxReportsService.boxCloseReport(n.findBoxById.box,this.merchant,this.user)})}saleProductsReport(t){this._salesService.getIpvSaleResume(t).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(n=>{if(n){const i=n.products.filter(b=>b.quantity>0).map(b=>({Producto:b?.name,Cantidad:b.quantity,Precio:b.priceAvg,Cajero:n.employeeName}));this._documentsService.generateIpvProducts(i,{start:n.openedAt,end:n.closedAT},this.merchant,[{name:n.locationName}],this.user,n.cashPaid,n.cardPaid)}})}salesByCategoriesProducts(t){this._salesService.getIpvSaleResumeCategory(t).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(n=>{n&&this._documentsService.generateSalesByCategoriesProducts(n,this.merchant,this.user)})}saleResumeDocument(t){this._boxService.getBoxSaleResume(t).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(n=>{n&&this._boxReportsService.generateBoxSaleResumeDocument(n)})}trackByFn(t,n){return t||n.id}printIPV(t){this._salesService.getIpvSaleResume(t).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(n=>{n&&this._printerService.printIpvSalesResumeTicket(n).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(({message:i})=>{this._snackBar.open(i,"Aceptar",{duration:3e3,panelClass:"text-center"})})})}printIPVCategories(t){this._salesService.getIpvSaleResumeCategory(t).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(n=>{n&&this._printerService.printIpvSalesResumeCategoryTicket(n).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(({message:i})=>{this._snackBar.open(i,"Aceptar",{duration:3e3,panelClass:"text-center"})})})}printBoxAndSales(t){this._boxService.getBoxSaleResume(t).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(n=>{n&&this._printerService.printBoxSaleResumeTicket(n).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(({message:i})=>{this._snackBar.open(i,"Aceptar",{duration:3e3,panelClass:"text-center"})})})}generateTicketDocument(t){var n=this;return(0,Ne.A)(function*(){n._documentsService.generateTicketDocument(t,n.merchant,n.user)})()}existTableFilter(){return this.statusFilter?.hasFilter||this.locationFilter?.hasFilter||this.terminalFilter?.hasFilter}clearTableFilters(){this.statusFilter?.hasFilter&&this.statusFilter.clearFilter(),this.locationFilter?.hasFilter&&this.locationFilter.clearFilter(),this.terminalFilter?.hasFilter&&this.terminalFilter.clearFilter()}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["box-history"]],viewQuery:function(n,i){if(1&n&&(e.GBs(ie.iy,5),e.GBs(J.B4,5),e.GBs(We,5),e.GBs(Je,5),e.GBs(He,5)),2&n){let r;e.mGM(r=e.lsd())&&(i._paginator=r.first),e.mGM(r=e.lsd())&&(i._sort=r.first),e.mGM(r=e.lsd())&&(i.locationFilter=r.first),e.mGM(r=e.lsd())&&(i.terminalFilter=r.first),e.mGM(r=e.lsd())&&(i.statusFilter=r.first)}},standalone:!0,features:[e.aNF],decls:66,vars:49,consts:[["locationFilter",""],["terminalFilter",""],["statusFilter",""],["picker",""],["reportsMenu","matMenu"],["reportsMenu1","matMenu"],["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent",3,"fuseScrollbarOptions"],[1,"relative","flex","flex-col","px-6","py-8","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/box/admin",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","flex-wrap","items-center","gap-2","mt-6","md:fixed","md:max-w-1/2","md:justify-end","right-8","shrink-0","lg:mt-0","lg:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto"],[1,"grid","border-t"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900",3,"ngClass"],[1,"flex","items-center","justify-center",3,"mat-sort-header"],[1,"flex","items-center","justify-start",3,"ngClass"],[3,"dataChange","filterType","searchEntityControl","entitiesFiltered"],[1,"flex","items-center","justify-center","min-w-40",3,"mat-sort-header"],[1,"flex","items-center","justify-end"],[1,"flex","items-center","justify-center"],[3,"mat-sort-header"],[3,"dataChange","filterType","data"],["color","warn","mat-icon-button","","matTooltip","Limpiar filtros",1,"w-6","h-6","min-h-6","min-w-6",3,"click","disabled"],[1,"icon-size-4",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"],[1,"border-b","first-letter:z-10","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-slate-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"sm:mx-4","min-w-64","fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],[3,"formGroup","rangePicker","max"],["matStartDate","","formControlName","start","placeholder","Fecha de inicio"],["matEndDate","","formControlName","end","placeholder","Fecha final"],["matPrefix","",3,"for"],["disabled","false"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer"],[1,""],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-yellow-500","to-yellow-600",3,"disabled","matMenuTriggerFor"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],["xPosition","before"],["mat-menu-item","",3,"click"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer",3,"click"],[1,"z-0","grid","items-center","bg-white","dark:bg-default","gap-4","px-6","py-3","border-b","md:px-8",3,"ngClass"],[1,"text-left"],[1,"text-left",3,"ngClass"],[1,"text-center","min-w-40"],[1,"font-mono","text-right"],[1,"flex","justify-center"],[1,"flex","items-center","justify-center","mr-4","p-1","text-center","truncate","delay-100","rounded-full","h-7","lock","dark:bg-white","dark:bg-opacity-5",3,"ngClass"],[1,"w-full","px-2","text-sm","font-medium","text-center"],[1,"flex","flex-row","justify-end","gap-2"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matMenuTriggerFor"],[1,"icon-size-5",3,"svgIcon"],["mat-menu-item","",3,"click","disabled"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matMenuTriggerFor","disabled"]],template:function(n,i){if(1&n){const r=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div",8)(3,"div",9)(4,"div")(5,"a",10),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",11),e.nrm(8,"mat-icon",12),e.j41(9,"a",13),e.EFF(10,"Caja"),e.k0s()(),e.j41(11,"div",11),e.nrm(12,"mat-icon",12),e.j41(13,"a",14),e.EFF(14,"Cierres de Caja"),e.k0s()()(),e.j41(15,"div",15)(16,"h2",16),e.EFF(17," Cierres de Caja "),e.k0s()()(),e.j41(18,"div",17)(19,"mat-form-field",18),e.nrm(20,"mat-icon",19)(21,"input",20),e.k0s(),e.DNE(22,ot,17,9),e.k0s()(),e.j41(23,"div",21)(24,"div",22)(25,"div",23)(26,"div",24)(27,"div",25)(28,"span"),e.EFF(29,"No."),e.k0s()(),e.j41(30,"div",26)(31,"span"),e.EFF(32," Unidad Comercial"),e.k0s(),e.j41(33,"table-filter",27,0),e.bIt("dataChange",function(g){return e.eBV(r),e.Njj(i.addLocation(g))}),e.k0s()(),e.j41(35,"div",26)(36,"span"),e.EFF(37,"Terminal (Caja)"),e.k0s(),e.j41(38,"table-filter",27,1),e.bIt("dataChange",function(g){return e.eBV(r),e.Njj(i.addTerminal(g))}),e.k0s()(),e.j41(40,"div",28)(41,"span"),e.EFF(42," Fecha Apertura"),e.k0s()(),e.j41(43,"div",29)(44,"span"),e.EFF(45," Monto Apertura"),e.k0s()(),e.j41(46,"div",28)(47,"span"),e.EFF(48,"Fecha Cierre"),e.k0s()(),e.j41(49,"div",29)(50,"span"),e.EFF(51,"Monto Cierre"),e.k0s()(),e.j41(52,"div",30)(53,"span",31),e.EFF(54,"Estado"),e.k0s(),e.j41(55,"table-filter",32,2),e.bIt("dataChange",function(g){return e.eBV(r),e.Njj(i.addStatus(g))}),e.k0s()(),e.j41(57,"div",29)(58,"span"),e.EFF(59,"Acciones"),e.k0s(),e.j41(60,"button",33),e.bIt("click",function(){return e.eBV(r),e.Njj(i.clearTableFilters())}),e.nrm(61,"mat-icon",34),e.k0s()()(),e.DNE(62,at,2,0),e.nI1(63,"async"),e.DNE(64,st,2,0,"div",35),e.k0s(),e.nrm(65,"mat-paginator",36),e.k0s()()()}if(2&n){let r;e.Y8G("fuseScrollbarOptions",e.lJ4(35,Ke)),e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Escriba para buscar..."),e.R7$(),e.vxM(i.user.accessLevel>=3?22:-1),e.R7$(4),e.Y8G("ngClass",e.sMw(36,Be,1===i.user.accessLevel,2===i.user.accessLevel,3===i.user.accessLevel)),e.R7$(),e.Y8G("mat-sort-header","no"),e.R7$(3),e.Y8G("ngClass",e.eq3(40,me,i.user.accessLevel<3)),e.R7$(3),e.Y8G("filterType","filterEntity")("searchEntityControl",i.searchLocationsControl)("entitiesFiltered",i.locationsFiltered),e.R7$(2),e.Y8G("ngClass",e.eq3(42,me,1===i.user.accessLevel)),e.R7$(3),e.Y8G("filterType","filterEntity")("searchEntityControl",i.searchTerminalsControl)("entitiesFiltered",i.terminalsFiltered),e.R7$(2),e.Y8G("mat-sort-header","open"),e.R7$(6),e.Y8G("mat-sort-header","close"),e.R7$(7),e.Y8G("mat-sort-header","status"),e.R7$(2),e.Y8G("filterType","multiSelect")("data",e.lJ4(44,Ze)),e.R7$(5),e.Y8G("disabled",!i.existTableFilter()),e.R7$(),e.Y8G("svgIcon","mat_solid:filter_list_off"),e.R7$(),e.vxM((r=e.bMT(63,33,i.boxes$))?62:64,r),e.R7$(3),e.Y8G("ngClass",e.l_i(45,qe,i.isLoading,i.pagination.length<10&&i.pagination.page<1))("length",i.pagination.length)("pageIndex",i.pagination.page)("pageSize",i.pagination.size)("pageSizeOptions",e.lJ4(48,et))("showFirstLastButtons",!0)}},dependencies:[j.Hl,j.$z,j.iY,E.RG,E.rl,E.JW,E.yw,T.fS,T.fg,G.m_,G.An,F.YU,s.X1,s.me,s.BC,s.cb,s.l_,s.j4,s.JD,F.Jj,J.NQ,J.B4,J.aE,F.vh,F.oe,F.Pc,D.Cn,D.kk,D.fb,D.Cp,ie.Ou,ie.iy,ke.p,Ee.i,L.X6,L.bU,L.el,L.xR,L.IG,L.SG],encapsulation:2,changeDetection:0})}return o})();var lt=l(90558);const ct=["boxFilter"],mt=["movementTypeFilter"],dt=()=>({wheelPropagation:!1}),ut=()=>["Inicial","Ingreso","Devoluci\xf3n","Pr\xe9stamo","Gasto","Dep\xf3sito","Extracci\xf3n"],pt=(o,c)=>({"pointer-events-none":o,hidden:c}),ht=()=>[10,25,50,100],bt=o=>({"text-red-500":o});function ft(o,c){if(1&o){const t=e.RV6();e.j41(0,"mat-icon",48),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.range.reset())}),e.k0s()}}function gt(o,c){if(1&o){const t=e.RV6();e.j41(0,"mat-form-field",35)(1,"mat-date-range-input",36),e.nrm(2,"input",37)(3,"input",38),e.k0s(),e.nrm(4,"mat-datepicker-toggle",39)(5,"mat-date-range-picker",40,2),e.DNE(7,ft,1,0,"mat-icon",41),e.k0s(),e.j41(8,"div",42)(9,"button",43),e.nrm(10,"mat-icon",44),e.j41(11,"span",45),e.EFF(12,"Reportes"),e.k0s()(),e.j41(13,"mat-menu",46,3)(15,"button",47),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.generateBoxMovementsReport())}),e.EFF(16,"Generar"),e.k0s()()()}if(2&o){const t=e.sdS(6),n=e.sdS(14),i=e.XpG();e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("formGroup",i.range)("rangePicker",t)("max",i.maxDate),e.R7$(3),e.Y8G("for",t),e.R7$(3),e.vxM(i.range.get("start").value||i.range.get("end").value?7:-1),e.R7$(2),e.Y8G("disabled",!i.range.get("start").value||!i.range.get("end").value||i.range.invalid)("matMenuTriggerFor",n),e.R7$(),e.Y8G("svgIcon","mat_solid:plagiarism")}}function xt(o,c){if(1&o&&(e.j41(0,"div",49)(1,"div"),e.EFF(2),e.k0s(),e.j41(3,"div",50),e.EFF(4),e.k0s(),e.j41(5,"div",51),e.EFF(6),e.nI1(7,"date"),e.k0s(),e.j41(8,"div",52),e.EFF(9),e.k0s(),e.j41(10,"div",53),e.EFF(11),e.nI1(12,"currency"),e.k0s(),e.j41(13,"div",54)(14,"span",55),e.EFF(15),e.k0s()(),e.nrm(16,"div",56),e.k0s()),2&o){const t=c.$implicit,n=e.XpG(2);e.R7$(2),e.SpI(" ",t.no," "),e.R7$(2),e.SpI(" ",null==t||null==t.box?null:t.box.no," "),e.R7$(2),e.SpI(" ",e.i5U(7,8,t.createdAt,"dd/MM/yyyy HH:mm a")," "),e.R7$(2),e.Y8G("ngClass",e.eq3(14,bt,null===t.reason)),e.R7$(),e.SpI(" ",t.reason||"Sin motivo"," "),e.R7$(2),e.SpI(" ",e.i5U(12,11,t.amount,"$ ")," "),e.R7$(3),e.Y8G("ngClass",n.movementClass(t.movementType)),e.R7$(),e.SpI(" ",n.translateMovementType(t.movementType)," ")}}function _t(o,c){1&o&&e.Z7z(0,xt,17,16,"div",49,e.BUC().trackByFn,!0),2&o&&e.Dyx(c)}function yt(o,c){1&o&&(e.j41(0,"div",33),e.EFF(1," \xa1No se ha registrado ning\xfan movimiento de caja! "),e.k0s())}let vt=(()=>{class o{constructor(){this.boxMovements$=(0,se.of)([]),this.isLoading=!1,this.pagination=new lt.xN,this.searchInputControl=new s.MJ,this.isSlideLoading=!1,this.selectedSlide=null,this.user=null,this.maxDate=new Date,this.merchant=null,this.filterInputControl=new s.MJ,this.searchBoxesControl=new s.MJ(null),this.selectedBox=null,this.selectedMovementsType=[],this.range=new s.gE({start:new s.MJ({disabled:!1,value:null},[ce.t.futureDateValidator()]),end:new s.MJ({disabled:!1,value:null},[ce.t.futureDateValidator()])}),this._boxReportsService=(0,e.WQX)(De),this._unsubscribeAll=new A.B,this._boxService=(0,e.WQX)(P.R),this._changeDetectorRef=(0,e.WQX)(e.gRc),this.store=(0,e.WQX)(W.il)}ngOnInit(){this.boxMovements$=this.store.select(N.Q9),this.store.select(ve.Dz).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.store.select(Ce.Xb).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(Fe.SW).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,m.Q)(this._unsubscribeAll),(0,Z.B)(300),(0,oe.n)(t=>(this.isLoading=!0,this._boxService.getBoxMovements(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,t,this.selectedBox?.id,this.selectedMovementsType,this.range.value.start,this.range.value.end))),(0,H.T)(()=>{this.isLoading=!1})).subscribe(),this.boxesFiltered=this.searchBoxesControl.valueChanges.pipe((0,Z.B)(200),(0,ge.Z)(null),(0,xe.j)(()=>{this.isLoading=!1}),(0,_e.Z)(t=>null!==t&&"string"==typeof t&&(this.selectedBox&&t!==this.selectedBox.no||!this.selectedBox)?(this.isLoading=!0,this._boxService.getAllBoxes(t.trim()).pipe((0,H.T)(n=>n.data.getBoxes.boxes))):(0,se.of)())),this.filterInputControl.valueChanges.pipe((0,m.Q)(this._unsubscribeAll),(0,Z.B)(300),(0,oe.n)(t=>(this.isLoading=!0,this._boxService.getBoxMovements(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.selectedBox?.id,this.selectedMovementsType,this.range.get("start").value,this.range.get("end").value))),(0,H.T)(()=>{this.isLoading=!1})).subscribe(),this.range.valueChanges.pipe((0,m.Q)(this._unsubscribeAll)).subscribe(t=>{this._boxService.getBoxMovements(0,this.pagination.size,this._sort.active,this._sort.direction,this.searchInputControl.value,this.selectedBox?.id,this.selectedMovementsType,t.start,t.end).pipe((0,m.Q)(this._unsubscribeAll)).subscribe()})}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"createdAt",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,m.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,ye.h)(this._sort.sortChange,this._paginator.page).pipe((0,oe.n)(()=>(this.isLoading=!0,this._boxService.getBoxMovements(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.selectedBox?.id,this.selectedMovementsType,this.range.value.start,this.range.value.end))),(0,H.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this.store.dispatch((0,ee.hr)())}addBox(t){this.selectedBox=t,this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addMovementType(t){const n=[f.initial,f.income,f.return,f.loan,f.spent,f.depot,f.extraction];this.selectedMovementsType=t.map(i=>n.find(r=>this.translateMovementType(r)===i)),this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}generateBoxMovementsReport(){const{start:t,end:n}=this.range.getRawValue();!t||!n||this._boxService.findBoxMovements(this.selectedBox?.id,this.selectedMovementsType,this.range.value.start,this.range.value.end).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(({data:i})=>{i&&this._boxReportsService.generateBoxMovementsDocument({start:i.findBoxMovements.startDate,end:i.findBoxMovements.endDate},i.findBoxMovements.boxMovements,this.merchant,this.user)})}existTableFilter(){return this.movementTypeFilter?.hasFilter||this.boxFilter?.hasFilter}clearTableFilters(){this.movementTypeFilter?.hasFilter&&this.movementTypeFilter.clearFilter(),this.boxFilter?.hasFilter&&this.boxFilter.clearFilter()}translateMovementType(t){switch(t){case f.initial:return"Inicial";case f.income:return"Ingreso";case f.return:return"Devoluci\xf3n";case f.loan:return"Pr\xe9stamo";case f.spent:return"Gasto";case f.depot:return"Dep\xf3sito";case f.extraction:return"Extracci\xf3n"}}movementClass(t){switch(t){case f.initial:return"text-slate-700 bg-slate-50";case f.income:return"text-green-700 bg-green-50";case f.return:return"text-yellow-700 bg-yellow-50";case f.loan:return"text-red-700 bg-red-50";case f.spent:return"text-cyan-700 bg-cyan-50";case f.depot:return"text-blue-700 bg-blue-50";case f.extraction:return"text-pink-700 bg-pink-50"}}trackByFn(t,n){return t||n.id}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["box-movements"]],viewQuery:function(n,i){if(1&n&&(e.GBs(ie.iy,5),e.GBs(J.B4,5),e.GBs(ct,5),e.GBs(mt,5)),2&n){let r;e.mGM(r=e.lsd())&&(i._paginator=r.first),e.mGM(r=e.lsd())&&(i._sort=r.first),e.mGM(r=e.lsd())&&(i.boxFilter=r.first),e.mGM(r=e.lsd())&&(i.movementTypeFilter=r.first)}},standalone:!0,features:[e.aNF],decls:56,vars:36,consts:[["boxFilter",""],["movementTypeFilter",""],["picker",""],["reportsMenu","matMenu"],["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent",3,"fuseScrollbarOptions"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","items-center","mt-6","shrink-0","lg:mt-0","lg:ml-4","gap-2"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","box-movements-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"flex","items-center","justify-center",3,"mat-sort-header"],[1,"flex","items-center","justify-center"],[3,"dataChange","filterType","entityPropertyName","searchEntityControl","entitiesFiltered"],[1,"flex","items-center","justify-center","min-w-40",3,"mat-sort-header"],[1,"hidden","md:flex","items-center"],[1,"flex","items-center","justify-end",3,"mat-sort-header"],[1,"flex","items-center","justify-center",3,"matTooltip"],[3,"dataChange","filterType","data"],[1,"flex","items-center","justify-end"],["color","warn","mat-icon-button","","matTooltip","Limpiar filtros",1,"w-6","h-6","min-h-6","min-w-6",3,"click","disabled"],[1,"icon-size-4",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"],[1,"border-b","first-letter:z-10","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-slate-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"sm:mx-4","min-w-64","fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],[3,"formGroup","rangePicker","max"],["matStartDate","","formControlName","start","placeholder","Fecha de inicio"],["matEndDate","","formControlName","end","placeholder","Fecha final"],["matPrefix","",3,"for"],["disabled","false"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer"],[1,""],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-yellow-500","to-yellow-600",3,"disabled","matMenuTriggerFor"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],["xPosition","before"],["mat-menu-item","",3,"click"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer",3,"click"],[1,"z-0","grid","items-center","bg-white","dark:bg-default","gap-4","px-6","py-3","border-b","box-movements-grid","md:px-8"],[1,"text-center"],[1,"text-center","min-w-40"],[1,"hidden","md:block",3,"ngClass"],[1,"text-right","mr-4"],[1,"flex","justify-center"],[1,"px-2.5","py-1","rounded-full",3,"ngClass"],[1,"flex","flex-row","justify-end","gap-2"]],template:function(n,i){if(1&n){const r=e.RV6();e.j41(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7)(4,"div")(5,"a",8),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",9),e.nrm(8,"mat-icon",10),e.j41(9,"a",11),e.EFF(10,"Caja"),e.k0s()(),e.j41(11,"div",9),e.nrm(12,"mat-icon",10),e.j41(13,"a",11),e.EFF(14,"Movimientos de Caja"),e.k0s()()(),e.j41(15,"div",12)(16,"h2",13),e.EFF(17," Movimientos de Caja "),e.k0s()()(),e.j41(18,"div",14)(19,"mat-form-field",15),e.nrm(20,"mat-icon",16)(21,"input",17),e.k0s(),e.DNE(22,gt,17,9),e.k0s()(),e.j41(23,"div",18)(24,"div",19)(25,"div",20)(26,"div",21)(27,"div",22)(28,"span"),e.EFF(29,"No."),e.k0s()(),e.j41(30,"div",23)(31,"span"),e.EFF(32,"No.Caja"),e.k0s(),e.j41(33,"table-filter",24,0),e.bIt("dataChange",function(g){return e.eBV(r),e.Njj(i.addBox(g))}),e.k0s()(),e.j41(35,"div",25)(36,"span"),e.EFF(37,"Fecha"),e.k0s()(),e.j41(38,"div",26)(39,"span"),e.EFF(40,"Motivo"),e.k0s()(),e.j41(41,"div",27)(42,"span"),e.EFF(43,"Monto"),e.k0s()(),e.j41(44,"div",28)(45,"span"),e.EFF(46,"Movimiento"),e.k0s(),e.j41(47,"table-filter",29,1),e.bIt("dataChange",function(g){return e.eBV(r),e.Njj(i.addMovementType(g))}),e.k0s()(),e.j41(49,"div",30)(50,"button",31),e.bIt("click",function(){return e.eBV(r),e.Njj(i.clearTableFilters())}),e.nrm(51,"mat-icon",32),e.k0s()()(),e.DNE(52,_t,2,0),e.nI1(53,"async"),e.DNE(54,yt,2,0,"div",33),e.k0s(),e.nrm(55,"mat-paginator",34),e.k0s()()()}if(2&n){let r;e.Y8G("fuseScrollbarOptions",e.lJ4(30,dt)),e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Escriba para buscar..."),e.R7$(),e.vxM(i.user.accessLevel>=3?22:-1),e.R7$(5),e.Y8G("mat-sort-header","no"),e.R7$(6),e.Y8G("filterType","filterEntity")("entityPropertyName","no")("searchEntityControl",i.searchBoxesControl)("entitiesFiltered",i.boxesFiltered),e.R7$(2),e.Y8G("mat-sort-header","createdAt"),e.R7$(6),e.Y8G("mat-sort-header","amount"),e.R7$(3),e.Y8G("matTooltip","Tipo de Movimiento"),e.R7$(3),e.Y8G("filterType","multiSelect")("data",e.lJ4(31,ut)),e.R7$(3),e.Y8G("disabled",!i.existTableFilter()),e.R7$(),e.Y8G("svgIcon","mat_solid:filter_list_off"),e.R7$(),e.vxM((r=e.bMT(53,28,i.boxMovements$))?52:54,r),e.R7$(3),e.Y8G("ngClass",e.l_i(32,pt,i.isLoading,i.pagination.length<10&&i.pagination.page<1))("length",i.pagination.length)("pageIndex",i.pagination.page)("pageSize",i.pagination.size)("pageSizeOptions",e.lJ4(35,ht))("showFirstLastButtons",!0)}},dependencies:[F.Jj,F.oe,F.vh,j.Hl,j.$z,j.iY,E.RG,E.rl,E.JW,E.yw,G.m_,G.An,T.fS,T.fg,D.Cn,D.kk,D.fb,D.Cp,ie.Ou,ie.iy,J.NQ,J.B4,J.aE,F.YU,s.X1,s.me,s.BC,s.cb,s.l_,s.j4,s.JD,a.Wk,U.uc,U.oV,ke.p,Ee.i,L.X6,L.bU,L.el,L.xR,L.IG,L.SG],encapsulation:2,changeDetection:0})}return o})();var Ft=l(5864);let Ct=(()=>{class o{constructor(t){this._boxService=t}resolve(t,n){const i=t.params.boxId;return Ft.H.IsNullOrEmpty(i)?null:this._boxService.getBoxById(i)}static#e=this.\u0275fac=function(n){return new(n||o)(e.KVO(P.R))};static#t=this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),kt=(()=>{class o{constructor(t){this._boxService=t}resolve(t,n){return this._boxService.getBoxes()}static#e=this.\u0275fac=function(n){return new(n||o)(e.KVO(P.R))};static#t=this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),Et=(()=>{class o{constructor(t){this._boxService=t}resolve(t,n){return this._boxService.getBoxMovements()}static#e=this.\u0275fac=function(n){return new(n||o)(e.KVO(P.R))};static#t=this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();function jt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de 1 peso es obligatoria. "),e.k0s())}function Dt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de estar entre 0 y 9999999999. "),e.k0s())}function Bt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de 3 pesos es obligatoria. "),e.k0s())}function $t(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de estar entre 0 y 9999999999. "),e.k0s())}function Mt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de 5 pesos es obligatoria. "),e.k0s())}function Rt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de estar entre 0 y 9999999999. "),e.k0s())}function Tt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de 10 pesos es obligatoria. "),e.k0s())}function It(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de estar entre 0 y 9999999999. "),e.k0s())}function St(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de 20 pesos es obligatoria. "),e.k0s())}function Gt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de estar entre 0 y 9999999999. "),e.k0s())}function At(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de 50 pesos es obligatoria. "),e.k0s())}function Lt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de estar entre 0 y 9999999999. "),e.k0s())}function wt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de 100 pesos es obligatoria. "),e.k0s())}function zt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de estar entre 0 y 9999999999. "),e.k0s())}function Yt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de 200 pesos es obligatoria. "),e.k0s())}function Nt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de estar entre 0 y 9999999999. "),e.k0s())}function Pt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de 500 pesos es obligatoria. "),e.k0s())}function Ot(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de estar entre 0 y 9999999999. "),e.k0s())}function Vt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de 1000 pesos es obligatoria. "),e.k0s())}function Xt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de billetes de estar entre 0 y 9999999999. "),e.k0s())}function Qt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de monedas de 1 centavo es obligatoria. "),e.k0s())}function Ut(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de monedas de estar entre 0 y 9999999999. "),e.k0s())}function Wt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de monedas de 2 centavos es obligatoria. "),e.k0s())}function Jt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de monedas de estar centavos 0 y 9999999999. "),e.k0s())}function Ht(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de monedas de 5 centavos es obligatoria. "),e.k0s())}function Kt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de monedas de estar centavos 0 y 9999999999. "),e.k0s())}function Zt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de monedas de 20 centavos es obligatoria. "),e.k0s())}function qt(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de monedas de estar centavos 0 y 9999999999. "),e.k0s())}function ei(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de monedas de 1 peso es obligatoria. "),e.k0s())}function ti(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de monedas de estar entre 0 y 9999999999. "),e.k0s())}function ii(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de monedas de 3 pesos es obligatoria. "),e.k0s())}function oi(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de monedas de estar entre 0 y 9999999999. "),e.k0s())}function ni(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de monedas de 5 pesos es obligatoria. "),e.k0s())}function ai(o,c){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad de monedas de estar entre 0 y 9999999999. "),e.k0s())}let si=(()=>{class o{constructor(){this.totalCashAmount=0,this.balance=0,this.box=null,this._boxService=(0,e.WQX)(P.R),this._changeDetectorRef=(0,e.WQX)(e.gRc),this._formBuilder=(0,e.WQX)(s.ok),this._fuseConfirmationService=(0,e.WQX)(x.G),this._router=(0,e.WQX)(a.Ix),this._snackBar=(0,e.WQX)(z.UG),this._unsubscribeAll=new A.B,this.store=(0,e.WQX)(W.il)}ngOnInit(){this.cashDistributionForm=this._formBuilder.group({b1:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(9999999999)]),b3:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(9999999999)]),b5:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(9999999999)]),b10:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(9999999999)]),b20:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(9999999999)]),b50:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(9999999999)]),b100:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(9999999999)]),b200:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(9999999999)]),b500:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(9999999999)]),b1000:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(9999999999)]),c1:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(9999999999)]),c2:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(9999999999)]),c5:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(9999999999)]),c20:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(9999999999)]),m1:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(9999999999)]),m3:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(9999999999)]),m5:new s.MJ(0,[s.k0.required,s.k0.min(0),s.k0.max(9999999999)])}),this.store.select(N.k2).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(t=>{this.box=t,this.balance=Number((t.initial+t.income+t.depot-t.return-t.loan-t.spent-t.extraction).toFixed(2)),this._changeDetectorRef.markForCheck()}),this.cashDistributionForm.valueChanges.pipe((0,m.Q)(this._unsubscribeAll)).subscribe(()=>{this.totalCashAmount=this.calculateTotalCashAmount(),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this.store.dispatch((0,ee.rY)())}calculateTotalCashAmount(){const n=Object.keys(this.cashDistributionForm.controls).map(i=>{const r=this.cashDistributionForm.controls[i].value;let b=parseFloat(i.substring(1));return i.startsWith("c")&&(b*=.01),r*b}).reduce((i,r)=>i+r,0);return Number(n.toFixed(2))}closeBox(){const t=this._fuseConfirmationService.open({title:"Cerrar caja.",message:"\xbfEst\xe1 seguro que desea cerrar la caja?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}),n=this.cashDistributionForm.getRawValue();t.afterClosed().pipe((0,m.Q)(this._unsubscribeAll)).subscribe(i=>{"confirmed"===i&&this._boxService.closeBox({id:this.box.id,cashDistribution:n,terminalId:this.box.terminalId}).pipe((0,m.Q)(this._unsubscribeAll)).subscribe(({data:r})=>{this._snackBar.openFromComponent(K.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:r.closeBox.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/modules/box/history"),this._changeDetectorRef.markForCheck()})})}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["app-box-closer"]],standalone:!0,features:[e.aNF],decls:143,vars:107,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","overflow-x-auto","overflow-y-auto","bg-card","dark:bg-transparent","lg:overflow-x-hidden"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/box/admin",1,"ml-1","text-primary-500"],["routerLink","/modules/box/history",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","flex-wrap","items-center","mt-2","shrink-0","lg:mt-0","lg:ml-4"],["mat-raised-button","",1,"mt-4","text-white","sm:mt-0","bg-gradient-to-r","from-primary-500","to-primary-600","hover:to-primary-900","hover:shadow-lg",3,"click","disabled"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-col","flex-auto","w-full","gap-3","p-6"],[1,"text-2xl","font-extrabold","leading-3","tracking-tight","truncate","md:text-3xl","sm:leading-10"],[1,"text-2xl","font-extrabold","leading-3","tracking-tight","truncate","md:text-3xl","sm:leading-10",3,"ngClass"],[3,"formGroup"],[1,"grid","gap-5","md:grid-cols-2"],[1,"grid","w-full","gap-5","sm:grid-cols-2","xl:grid-cols-3"],[1,"w-full","fuse-mat-dense"],["type","number","matInput","","required","",3,"formControlName","min","max"],[1,"grid","w-full","gap-5","gap-y-10","sm:grid-cols-2","xl:grid-cols-3"],[1,"w-full","fuse-mat-dense",3,"subscriptSizing"],[1,"max-h-20"]],template:function(n,i){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",5),e.nrm(8,"mat-icon",6),e.j41(9,"a",7),e.EFF(10,"Caja"),e.k0s()(),e.j41(11,"div",5),e.nrm(12,"mat-icon",6),e.j41(13,"a",8),e.EFF(14,"Historial"),e.k0s()(),e.j41(15,"div",5),e.nrm(16,"mat-icon",6),e.j41(17,"a",9),e.EFF(18,"Cerrar"),e.k0s()()(),e.j41(19,"div",10)(20,"h2",11),e.EFF(21," Cerrar de caja "),e.k0s()()(),e.j41(22,"div",12)(23,"button",13),e.bIt("click",function(){return i.closeBox()}),e.nrm(24,"mat-icon",14),e.j41(25,"span",15),e.EFF(26,"Cerrar Caja"),e.k0s()()()(),e.j41(27,"div",16)(28,"h2",17),e.EFF(29),e.nI1(30,"number"),e.k0s(),e.j41(31,"h2",18),e.EFF(32),e.nI1(33,"number"),e.k0s(),e.j41(34,"form",19)(35,"div",20)(36,"div",21)(37,"mat-form-field",22)(38,"mat-label"),e.EFF(39,"Billetes de 1 peso:"),e.k0s(),e.nrm(40,"input",23),e.DNE(41,jt,2,0,"mat-error")(42,Dt,2,0,"mat-error"),e.k0s(),e.j41(43,"mat-form-field",22)(44,"mat-label"),e.EFF(45,"Billetes de 3 pesos:"),e.k0s(),e.nrm(46,"input",23),e.DNE(47,Bt,2,0,"mat-error")(48,$t,2,0,"mat-error"),e.k0s(),e.j41(49,"mat-form-field",22)(50,"mat-label"),e.EFF(51,"Billetes de 5 pesos:"),e.k0s(),e.nrm(52,"input",23),e.DNE(53,Mt,2,0,"mat-error")(54,Rt,2,0,"mat-error"),e.k0s(),e.j41(55,"mat-form-field",22)(56,"mat-label"),e.EFF(57,"Billetes de 10 pesos:"),e.k0s(),e.nrm(58,"input",23),e.DNE(59,Tt,2,0,"mat-error")(60,It,2,0,"mat-error"),e.k0s(),e.j41(61,"mat-form-field",22)(62,"mat-label"),e.EFF(63,"Billetes de 20 pesos:"),e.k0s(),e.nrm(64,"input",23),e.DNE(65,St,2,0,"mat-error")(66,Gt,2,0,"mat-error"),e.k0s(),e.j41(67,"mat-form-field",22)(68,"mat-label"),e.EFF(69,"Billetes de 50 pesos:"),e.k0s(),e.nrm(70,"input",23),e.DNE(71,At,2,0,"mat-error")(72,Lt,2,0,"mat-error"),e.k0s(),e.j41(73,"mat-form-field",22)(74,"mat-label"),e.EFF(75,"Billetes de 100 pesos:"),e.k0s(),e.nrm(76,"input",23),e.DNE(77,wt,2,0,"mat-error")(78,zt,2,0,"mat-error"),e.k0s(),e.j41(79,"mat-form-field",22)(80,"mat-label"),e.EFF(81,"Billetes de 200 pesos:"),e.k0s(),e.nrm(82,"input",23),e.DNE(83,Yt,2,0,"mat-error")(84,Nt,2,0,"mat-error"),e.k0s(),e.j41(85,"mat-form-field",22)(86,"mat-label"),e.EFF(87,"Billetes de 500 pesos:"),e.k0s(),e.nrm(88,"input",23),e.DNE(89,Pt,2,0,"mat-error")(90,Ot,2,0,"mat-error"),e.k0s(),e.j41(91,"mat-form-field",22)(92,"mat-label"),e.EFF(93,"Billetes de 1000 pesos:"),e.k0s(),e.nrm(94,"input",23),e.DNE(95,Vt,2,0,"mat-error")(96,Xt,2,0,"mat-error"),e.k0s()(),e.j41(97,"div")(98,"div",24)(99,"mat-form-field",25)(100,"mat-label"),e.EFF(101,"Monedas de 1 centavo:"),e.k0s(),e.nrm(102,"input",23),e.DNE(103,Qt,2,0,"mat-error")(104,Ut,2,0,"mat-error"),e.k0s(),e.j41(105,"mat-form-field",25)(106,"mat-label"),e.EFF(107,"Monedas de 2 centavos:"),e.k0s(),e.nrm(108,"input",23),e.DNE(109,Wt,2,0,"mat-error")(110,Jt,2,0,"mat-error"),e.k0s(),e.j41(111,"mat-form-field",25)(112,"mat-label"),e.EFF(113,"Monedas de 5 centavos:"),e.k0s(),e.nrm(114,"input",23),e.DNE(115,Ht,2,0,"mat-error")(116,Kt,2,0,"mat-error"),e.k0s(),e.j41(117,"mat-form-field",25)(118,"mat-label"),e.EFF(119,"Monedas de 20 centavos:"),e.k0s(),e.nrm(120,"input",23),e.DNE(121,Zt,2,0,"mat-error")(122,qt,2,0,"mat-error"),e.k0s(),e.j41(123,"mat-form-field",25)(124,"mat-label"),e.EFF(125,"Monedas de 1 peso:"),e.k0s(),e.nrm(126,"input",23),e.DNE(127,ei,2,0,"mat-error")(128,ti,2,0,"mat-error"),e.k0s(),e.j41(129,"mat-form-field",25)(130,"mat-label"),e.EFF(131,"Monedas de 3 pesos:"),e.k0s(),e.nrm(132,"input",23),e.DNE(133,ii,2,0,"mat-error")(134,oi,2,0,"mat-error"),e.k0s(),e.j41(135,"div",26)(136,"mat-form-field",25)(137,"mat-label"),e.EFF(138,"Monedas de 5 pesos:"),e.k0s(),e.nrm(139,"input",23),e.DNE(140,ni,2,0,"mat-error")(141,ai,2,0,"mat-error"),e.k0s()(),e.nrm(142,"div"),e.k0s()()()()()()),2&n&&(e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.Y8G("disabled",i.balance!==i.totalCashAmount),e.R7$(),e.Y8G("svgIcon","mat_solid:lock"),e.R7$(5),e.SpI(" Importe de la caja: ",e.i5U(30,101,i.balance,"1.2-2")," "),e.R7$(2),e.Y8G("ngClass",i.balance!==i.totalCashAmount?"text-red-500":"text-green-600"),e.R7$(),e.SpI(" Distribuci\xf3n de efectivo por denominaciones: ",e.i5U(33,104,i.totalCashAmount,"1.2-2")," "),e.R7$(2),e.Y8G("formGroup",i.cashDistributionForm),e.R7$(6),e.Y8G("formControlName","b1")("min",0)("max",9999999999),e.R7$(),e.vxM(i.cashDistributionForm.get("b1").hasError("required")?41:-1),e.R7$(),e.vxM(i.cashDistributionForm.get("b1").hasError("min")||i.cashDistributionForm.get("b1").hasError("max")?42:-1),e.R7$(4),e.Y8G("formControlName","b3")("min",0)("max",9999999999),e.R7$(),e.vxM(i.cashDistributionForm.get("b3").hasError("required")?47:-1),e.R7$(),e.vxM(i.cashDistributionForm.get("b3").hasError("min")||i.cashDistributionForm.get("b3").hasError("max")?48:-1),e.R7$(4),e.Y8G("formControlName","b5")("min",0)("max",9999999999),e.R7$(),e.vxM(i.cashDistributionForm.get("b5").hasError("required")?53:-1),e.R7$(),e.vxM(i.cashDistributionForm.get("b5").hasError("min")||i.cashDistributionForm.get("b5").hasError("max")?54:-1),e.R7$(4),e.Y8G("formControlName","b10")("min",0)("max",9999999999),e.R7$(),e.vxM(i.cashDistributionForm.get("b10").hasError("required")?59:-1),e.R7$(),e.vxM(i.cashDistributionForm.get("b10").hasError("min")||i.cashDistributionForm.get("b10").hasError("max")?60:-1),e.R7$(4),e.Y8G("formControlName","b20")("min",0)("max",9999999999),e.R7$(),e.vxM(i.cashDistributionForm.get("b20").hasError("required")?65:-1),e.R7$(),e.vxM(i.cashDistributionForm.get("b20").hasError("min")||i.cashDistributionForm.get("b20").hasError("max")?66:-1),e.R7$(4),e.Y8G("formControlName","b50")("min",0)("max",9999999999),e.R7$(),e.vxM(i.cashDistributionForm.get("b50").hasError("required")?71:-1),e.R7$(),e.vxM(i.cashDistributionForm.get("b50").hasError("min")||i.cashDistributionForm.get("b50").hasError("max")?72:-1),e.R7$(4),e.Y8G("formControlName","b100")("min",0)("max",9999999999),e.R7$(),e.vxM(i.cashDistributionForm.get("b100").hasError("required")?77:-1),e.R7$(),e.vxM(i.cashDistributionForm.get("b100").hasError("min")||i.cashDistributionForm.get("b100").hasError("max")?78:-1),e.R7$(4),e.Y8G("formControlName","b200")("min",0)("max",9999999999),e.R7$(),e.vxM(i.cashDistributionForm.get("b200").hasError("required")?83:-1),e.R7$(),e.vxM(i.cashDistributionForm.get("b200").hasError("min")||i.cashDistributionForm.get("b200").hasError("max")?84:-1),e.R7$(4),e.Y8G("formControlName","b500")("min",0)("max",9999999999),e.R7$(),e.vxM(i.cashDistributionForm.get("b500").hasError("required")?89:-1),e.R7$(),e.vxM(i.cashDistributionForm.get("b500").hasError("min")||i.cashDistributionForm.get("b500").hasError("max")?90:-1),e.R7$(4),e.Y8G("formControlName","b1000")("min",0)("max",9999999999),e.R7$(),e.vxM(i.cashDistributionForm.get("b1000").hasError("required")?95:-1),e.R7$(),e.vxM(i.cashDistributionForm.get("b1000").hasError("min")||i.cashDistributionForm.get("b1000").hasError("max")?96:-1),e.R7$(3),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","c1")("min",0)("max",9999999999),e.R7$(),e.vxM(i.cashDistributionForm.get("c1").hasError("required")?103:-1),e.R7$(),e.vxM(i.cashDistributionForm.get("c1").hasError("min")||i.cashDistributionForm.get("c1").hasError("max")?104:-1),e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","c2")("min",0)("max",9999999999),e.R7$(),e.vxM(i.cashDistributionForm.get("c2").hasError("required")?109:-1),e.R7$(),e.vxM(i.cashDistributionForm.get("c2").hasError("min")||i.cashDistributionForm.get("c2").hasError("max")?110:-1),e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","c5")("min",0)("max",9999999999),e.R7$(),e.vxM(i.cashDistributionForm.get("c5").hasError("required")?115:-1),e.R7$(),e.vxM(i.cashDistributionForm.get("c5").hasError("min")||i.cashDistributionForm.get("c5").hasError("max")?116:-1),e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","c20")("min",0)("max",9999999999),e.R7$(),e.vxM(i.cashDistributionForm.get("c20").hasError("required")?121:-1),e.R7$(),e.vxM(i.cashDistributionForm.get("c20").hasError("min")||i.cashDistributionForm.get("c20").hasError("max")?122:-1),e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","m1")("min",0)("max",9999999999),e.R7$(),e.vxM(i.cashDistributionForm.get("m1").hasError("required")?127:-1),e.R7$(),e.vxM(i.cashDistributionForm.get("m1").hasError("min")||i.cashDistributionForm.get("m1").hasError("max")?128:-1),e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","m3")("min",0)("max",9999999999),e.R7$(),e.vxM(i.cashDistributionForm.get("m3").hasError("required")?133:-1),e.R7$(),e.vxM(i.cashDistributionForm.get("m3").hasError("min")||i.cashDistributionForm.get("m3").hasError("max")?134:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","m5")("min",0)("max",9999999999),e.R7$(),e.vxM(i.cashDistributionForm.get("m5").hasError("required")?140:-1),e.R7$(),e.vxM(i.cashDistributionForm.get("m5").hasError("min")||i.cashDistributionForm.get("m5").hasError("max")?141:-1))},dependencies:[F.QX,j.Hl,j.$z,E.RG,E.rl,E.nJ,E.TL,T.fS,T.fg,G.m_,G.An,F.YU,s.X1,s.qT,s.me,s.Q0,s.BC,s.cb,s.YS,s.VZ,s.zX,s.j4,s.JD,a.Wk],encapsulation:2,changeDetection:0})}return o})();const li=[{path:"",component:$,children:[{path:"admin",component:Ye,resolve:{terminals:l(40382).n}},{path:"history",component:rt,resolve:{boxes:kt}},{path:"movements",component:vt,resolve:{boxMovements:Et}},{path:"admin/closer/:boxId",component:si,resolve:{box:Ct}}]}]},49098:(de,Q,l)=>{l.d(Q,{O:()=>N});var a=l(88141),e=l(96354),$=l(24984),z=l(98216),v=l(53473);const U=v.J1`
    mutation CreateLocation($createLocationInput: CreateLocationInput!) {
        createLocation(createLocationInput: $createLocationInput) {

            ok
            message

            location {
                id
                active
                managerId
                # manager {
                #     name
                # }
                name
                slug
                phone
                address
                country
                state
                city
                zip
            }

        }
    }
`,F=v.J1`
    mutation UpdateLocation($updateLocationInput: UpdateLocationInput!) {
        updateLocation(updateLocationInput: $updateLocationInput) {
            ok
            message

            location {
                id
                active
                managerId
                # manager {
                #     name
                # }
                name
                slug
                phone
                address
                country
                state
                city
                zip
            }
        }
    }
`,G=v.J1`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateLocationStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }

    }
`,j=v.J1`
    mutation RemoveLocation($removeLocationId: String!) {
        removeLocation(id: $removeLocationId) {
            ok
            message
        }
    }
`,D=v.J1`
    query FindAllLocations($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllLocations(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length,
                size,
                page,
                lastPage,
                startIndex,
                endIndex
            },

            locations {
                id
                active
                managerId
                manager {
                    id
                    name
                    lastname1
                    lastname2
                    fullname
                }
                name
                slug
                phone
                address
                country
                state
                city
                zip
            }
        }
    }
`,O=v.J1`
    query findActiveLocations($search: String!, $size: Int!) {
        findActiveLocations(search: $search, size: $size) {
            id
            active
            managerId
            name
            slug
            phone
            address
            country
            state
            city
            zip
        }
    }
`,A=v.J1`
    query FindLocationById($findLocationByIdId: String!) {
        findLocationById(id: $findLocationByIdId) {
            ok
            message

            location {
                id
                active
                managerId
                # manager {
                #     name
                # }
                name
                slug
                phone
                address
                country
                state
                city
                zip
            }
        }
    }
`;var m=l(17705),W=l(59640);let N=(()=>{class V{constructor(x,s){this.apolloProvider=x,this.store=s,this._apollo=this.apolloProvider.use("BALANC")}createLocation(x){return this._apollo.mutate({mutation:U,variables:{createLocationInput:x},errorPolicy:"all"}).pipe((0,a.M)(({data:s})=>{s&&(this.store.dispatch((0,$.yJ)({location:s.createLocation.location})),this.store.dispatch((0,$.Og)({location:s.createLocation.location})))}))}getLocations(x=0,s=25,Y="name",K="asc",E=""){return this._apollo.query({query:D,errorPolicy:"all",variables:{page:x,size:s,sort:Y,order:K,search:E}}).pipe((0,a.M)(({data:T})=>{T&&(this.store.dispatch((0,z.Bp)({pagination:T.findAllLocations.pagination})),this.store.dispatch((0,$.xu)({locations:T.findAllLocations.locations})))}))}findActiveLocations(x="",s=25){return this._apollo.query({query:O,variables:{search:x,size:s},errorPolicy:"all"}).pipe((0,e.T)(({data:Y})=>Y?Y.findActiveLocations:[]),(0,a.M)(Y=>{Y&&this.store.dispatch((0,$.xu)({locations:Y}))}))}getLocationById(x){return this._apollo.query({query:A,variables:{findLocationByIdId:x},errorPolicy:"all"}).pipe((0,a.M)(({data:s})=>{s&&this.store.dispatch((0,$.Og)({location:s.findLocationById.location}))}))}updateLocation(x){return this._apollo.mutate({mutation:F,variables:{updateLocationInput:x},errorPolicy:"all"}).pipe((0,a.M)(({data:s})=>{s&&(this.store.dispatch((0,$.Nt)({location:s.updateLocation.location})),this.store.dispatch((0,$.Og)({location:s.updateLocation.location})))}))}updateLocationStatus(x){return this._apollo.mutate({mutation:G,variables:{updateEntityStatusInput:x},errorPolicy:"all"}).pipe((0,a.M)(({data:s})=>{s&&this.store.dispatch((0,$.jr)({id:x.id,active:x.active}))}))}removeLocation(x){return this._apollo.mutate({mutation:j,variables:{removeLocationId:x},errorPolicy:"all"}).pipe((0,a.M)(({data:s})=>{s&&this.store.dispatch((0,$.q$)({id:x}))}))}static#e=this.\u0275fac=function(s){return new(s||V)(m.KVO(v.Ic),m.KVO(W.il))};static#t=this.\u0275prov=m.jDH({token:V,factory:V.\u0275fac,providedIn:"root"})}return V})()},78357:(de,Q,l)=>{l.d(Q,{i:()=>be});var a=l(17705),e=l(89417),$=l(59115),z=l(99213),v=l(88834),U=l(21413),F=l(56977),G=l(5864),j=l(82765),D=l(60177),O=l(25084),A=l(53719),m=l(59042),W=l(82798),N=l(60850),V=l(86600);const ee=["bt"];function x(p,I){if(1&p&&(a.j41(0,"span"),a.EFF(1),a.nI1(2,"uppercase"),a.k0s()),2&p){const d=a.XpG().$implicit;a.R7$(),a.JRh(a.bMT(2,1,d.get("name").value))}}function s(p,I){if(1&p&&(a.j41(0,"span"),a.EFF(1),a.nI1(2,"titlecase"),a.k0s()),2&p){const d=a.XpG().$implicit;a.R7$(),a.JRh(a.bMT(2,1,d.get("name").value))}}function Y(p,I){if(1&p&&(a.j41(0,"div",15)(1,"mat-checkbox",16),a.DNE(2,x,3,3,"span")(3,s,3,3,"span"),a.k0s()()),2&p){const d=I.$implicit,h=a.XpG(2);a.R7$(),a.Y8G("formControl",d.get("checked")),a.R7$(),a.vxM(h.useUpperCase?2:-1),a.R7$(),a.vxM(h.useUpperCase?-1:3)}}function K(p,I){if(1&p&&(a.j41(0,"div",9),a.Z7z(1,Y,4,3,"div",15,a.fX1),a.k0s()),2&p){const d=a.XpG();a.R7$(),a.Dyx(d.formArray.controls)}}function E(p,I){if(1&p&&(a.j41(0,"mat-form-field",10),a.nrm(1,"input",17)(2,"mat-datepicker-toggle",18)(3,"mat-datepicker",null,4),a.k0s()),2&p){const d=a.sdS(4),h=a.XpG();a.Y8G("subscriptSizing","dynamic"),a.R7$(),a.Y8G("matDatepicker",d)("formControl",h.dateControl)("max",h.maxDate),a.R7$(),a.Y8G("for",d)}}function T(p,I){if(1&p){const d=a.RV6();a.j41(0,"mat-option",23),a.bIt("click",function(){const C=a.eBV(d).$implicit,B=a.XpG(2);return a.Njj(B.selectEntity(C))}),a.EFF(1),a.k0s()}if(2&p){const d=I.$implicit,h=a.XpG(2);a.Y8G("value",d[h.entityPropertyName]),a.R7$(),a.SpI(" ",d[h.entityPropertyName]," ")}}function P(p,I){if(1&p&&(a.j41(0,"mat-form-field",11),a.nrm(1,"mat-icon",19)(2,"input",20),a.j41(3,"mat-autocomplete",21,5),a.Z7z(5,T,2,2,"mat-option",22,a.fX1),a.nI1(7,"async"),a.k0s()()),2&p){const d=a.sdS(4),h=a.XpG();a.Y8G("subscriptSizing","dynamic"),a.R7$(),a.Y8G("svgIcon","mat_solid:search"),a.R7$(),a.Y8G("formControl",h.searchEntityControl)("matAutocomplete",d)("placeholder","Buscar..."),a.R7$(3),a.Dyx(a.bMT(7,5,h.entitiesFiltered))}}function ue(p,I){if(1&p&&(a.j41(0,"mat-form-field",10),a.nrm(1,"input",17)(2,"mat-datepicker-toggle",18)(3,"mat-datepicker",null,4),a.k0s()),2&p){const d=a.sdS(4),h=a.XpG();a.Y8G("subscriptSizing","dynamic"),a.R7$(),a.Y8G("matDatepicker",d)("formControl",h.dateControl)("max",h.maxDate),a.R7$(),a.Y8G("for",d)}}function pe(p,I){if(1&p){const d=a.RV6();a.j41(0,"mat-option",23),a.bIt("click",function(){const C=a.eBV(d).$implicit,B=a.XpG(2);return a.Njj(B.selectEntity(C))}),a.EFF(1),a.k0s()}if(2&p){const d=I.$implicit;a.Y8G("value",d.name),a.R7$(),a.SpI(" ",d.name," ")}}function he(p,I){if(1&p&&(a.j41(0,"mat-form-field",11),a.nrm(1,"mat-icon",19)(2,"input",20),a.j41(3,"mat-autocomplete",21,5),a.Z7z(5,pe,2,2,"mat-option",22,a.fX1),a.nI1(7,"async"),a.k0s()()),2&p){const d=a.sdS(4),h=a.XpG();a.Y8G("subscriptSizing","dynamic"),a.R7$(),a.Y8G("svgIcon","mat_solid:search"),a.R7$(),a.Y8G("formControl",h.searchEntityControl)("matAutocomplete",d)("placeholder","Buscar..."),a.R7$(3),a.Dyx(a.bMT(7,5,h.entitiesFiltered))}}let be=(()=>{class p{constructor(){this.entityPropertyName="name",this.useUpperCase=!1,this.dataChange=new a.bkB,this.data=[],this.maxDate=new Date,this.dateControl=new e.MJ({disabled:!0}),this.formArray=new e.Yp([]),this._unsubscribeAll=new U.B,this._formBuilder=(0,a.WQX)(e.ok),this._changeDetectorRef=(0,a.WQX)(a.gRc)}get hasFilter(){return!G.H.IsNullOrEmpty(this.selectedFilter)}ngOnInit(){this.initializeFormArray(),this.dateControl.valueChanges.pipe((0,F.Q)(this._unsubscribeAll)).subscribe(d=>{this.dataChange.next(d),this.selectedFilter=d,this.menu.closeMenu()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}clearFilter(){switch(this.filterType){case"filterEntity":this.searchEntityControl.setValue(""),this.dataChange.next(null),this.selectedFilter=null;break;case"date":this.dateControl.setValue(null);break;case"multiSelect":case"multiSelectEntity":this.clearFormArray()}this.menu.closeMenu()}closeMenu(){this.menu.closeMenu()}selectEntity(d){this.dataChange.next(d),this.selectedFilter=d,this.menu.closeMenu()}initializeFormArray(){switch(this.filterType){case"multiSelect":this.formArray=this._formBuilder.array(this.data.map(d=>this._formBuilder.group({name:[d],checked:[!1]})));break;case"multiSelectEntity":this.formArray=this._formBuilder.array(this.data.map(d=>this._formBuilder.group({id:[d.id],name:[d[this.entityPropertyName]],checked:[!1]})))}this._changeDetectorRef.markForCheck(),this.formArraySubscription=this.formArray.valueChanges.pipe((0,F.Q)(this._unsubscribeAll)).subscribe(d=>{let h=[];switch(this.filterType){case"multiSelect":h=d.filter(C=>C.checked).map(C=>C.name);break;case"multiSelectEntity":for(const C of d.filter(B=>B.checked)){const B=this.data.find(te=>te.id===C.id);h.push(B)}}this.dataChange.next(h),this.selectedFilter=h})}clearFormArray(){this.formArraySubscription.unsubscribe(),this.selectedFilter=[],this.dataChange.next([]),this.initializeFormArray()}static#e=this.\u0275fac=function(h){return new(h||p)};static#t=this.\u0275cmp=a.VBU({type:p,selectors:[["table-filter"]],viewQuery:function(h,C){if(1&h&&a.GBs(ee,7),2&h){let B;a.mGM(B=a.lsd())&&(C.menu=B.first)}},inputs:{entityPropertyName:"entityPropertyName",filterType:"filterType",useUpperCase:"useUpperCase",data:"data",entitiesFiltered:"entitiesFiltered",searchEntityControl:"searchEntityControl"},outputs:{dataChange:"dataChange"},standalone:!0,features:[a.aNF],decls:19,vars:6,consts:[["bt","matMenuTrigger"],["listStatusMenu","matMenu"],["dateEntity",""],["SearchEntity",""],["entityDate",""],["entitiesAutocomplete","matAutocomplete"],["mat-icon-button","","matTooltip","",1,"w-6","h-6","min-h-6","min-w-6",3,"color","matMenuTriggerFor"],[1,"icon-size-4",3,"svgIcon"],[3,"click"],[1,"w-full","px-4","py-4"],["appearance","fill",1,"w-full","px-4","pt-4","pb-6","fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],["appearance","fill",1,"w-full","px-4","pt-4","pb-6","fuse-mat-dense","mat-fuse-de","fuse-mat-rounded","max-w-64","min-w-64",3,"subscriptSizing"],[1,"flex","justify-end","w-full","p-2","pb-0","border-t-2"],["mat-flat-button","",3,"click"],["mat-button","","color","warn",3,"click"],[1,""],["color","primary",3,"formControl"],["matInput","","placeholder","Fecha",3,"matDatepicker","formControl","max"],["matIconSuffix","",3,"for"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete"],[3,"value"],[3,"click","value"]],template:function(h,C){if(1&h){const B=a.RV6();a.j41(0,"div")(1,"button",6,0),a.nrm(3,"mat-icon",7),a.k0s(),a.j41(4,"mat-menu",null,1)(6,"div",8),a.bIt("click",function(fe){return a.eBV(B),a.Njj(fe.stopPropagation())}),a.DNE(7,K,3,0,"div",9)(8,E,5,5,"mat-form-field",10)(9,P,8,7,"mat-form-field",11),a.j41(10,"div",12)(11,"button",13),a.bIt("click",function(){return a.eBV(B),a.Njj(C.closeMenu())}),a.EFF(12,"Cerrar"),a.k0s(),a.j41(13,"button",14),a.bIt("click",function(){return a.eBV(B),a.Njj(C.clearFilter())}),a.EFF(14,"Limpiar"),a.k0s()()()()(),a.DNE(15,ue,5,5,"ng-template",null,2,a.C5r)(17,he,8,7,"ng-template",null,3,a.C5r)}if(2&h){const B=a.sdS(5);a.R7$(),a.Y8G("color",C.hasFilter?"primary":"default")("matMenuTriggerFor",B),a.R7$(2),a.Y8G("svgIcon","mat_solid:filter_list"),a.R7$(4),a.vxM("multiSelect"===C.filterType||"multiSelectEntity"===C.filterType?7:-1),a.R7$(),a.vxM("date"===C.filterType?8:-1),a.R7$(),a.vxM("filterEntity"===C.filterType?9:-1)}},dependencies:[D.Jj,v.Hl,v.$z,v.iY,z.m_,z.An,$.Cn,$.kk,$.Cp,j.g7,j.So,D.Pc,D.PV,O.X6,O.Vh,O.bZ,O.bU,A.RG,A.rl,A.JW,A.yw,m.fS,m.fg,e.X1,e.me,e.BC,e.l_,N.jL,N.$3,V.wT,N.pN,W.Ve],encapsulation:2,changeDetection:0})}return p})()}}]);