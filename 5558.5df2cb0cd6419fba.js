"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[5558],{21809:(L,O,n)=>{n.d(O,{F:()=>p});var f=n(63729),a=n(21413),x=n(56977),m=n(94268),r=n(77235),g=n(82643),P=n(97586),i=n.n(P),I=n(60177),h=n(88834),d=n(99213),e=n(51188),t=n(54438),l=n(59640);const E=(o,D)=>[o,D],y=(o,D)=>({"text-lg":o,"text-2xl":D}),C=(o,D)=>({"col-span-3":o,"col-span-2":D}),$=()=>[""],A=()=>["$"],Q=(o,D)=>({"my-4":o,"my-3":D});function W(o,D){if(1&o){const s=t.RV6();t.j41(0,"div",2)(1,"button",36),t.bIt("click",function(){t.eBV(s);const c=t.XpG();return t.Njj(c.generatePDF("open"))}),t.nrm(2,"mat-icon",37),t.k0s(),t.j41(3,"button",36),t.bIt("click",function(){t.eBV(s);const c=t.XpG();return t.Njj(c.generatePDF("download"))}),t.nrm(4,"mat-icon",37),t.k0s(),t.j41(5,"button",36),t.bIt("click",function(){t.eBV(s);const c=t.XpG();return t.Njj(c.generatePDF("print"))}),t.nrm(6,"mat-icon",37),t.k0s()()}2&o&&(t.R7$(2),t.Y8G("svgIcon","heroicons_outline:eye"),t.R7$(2),t.Y8G("svgIcon","heroicons_outline:download"),t.R7$(2),t.Y8G("svgIcon","heroicons_outline:printer"))}function N(o,D){if(1&o&&(t.j41(0,"div"),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&o){const s=D.$implicit;t.R7$(),t.Lme("",t.i5U(2,2,s.total,t.lJ4(5,$))," ",s.currency,"")}}function w(o,D){if(1&o&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&o){const s=t.XpG();t.R7$(),t.SpI(" ",s.merchantInvoice.phoneNumbers[0].stateCode+" "+s.merchantInvoice.phoneNumbers[0].phoneNumber,"")}}function M(o,D){if(1&o&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&o){const s=t.XpG();t.R7$(),t.JRh(s.merchantInvoice.emails[0].email)}}function S(o,D){if(1&o&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&o){const s=t.XpG();t.R7$(),t.JRh(s.divInSpaces())}}function _(o,D){if(1&o&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&o){const s=t.XpG();t.R7$(),t.E5c("",s.requestQuotation.address,", ",s.requestQuotation.city,", ",s.requestQuotation.state,", Cuba ")}}function U(o,D){if(1&o&&(t.j41(0,"div",21),t.nrm(1,"div",38),t.j41(2,"div",39),t.EFF(3),t.k0s(),t.j41(4,"div",40),t.EFF(5),t.k0s(),t.j41(6,"div",41),t.EFF(7),t.nI1(8,"currency"),t.k0s(),t.j41(9,"div",41),t.EFF(10),t.nI1(11,"currency"),t.k0s()()),2&o){const s=D.$implicit;t.R7$(3),t.JRh(s.name),t.R7$(2),t.JRh(s.amount),t.R7$(2),t.Lme("",t.i5U(8,5,s.price,t.lJ4(11,$))," ",s.currency,""),t.R7$(3),t.JRh(t.i5U(11,8,s.quantity,t.lJ4(12,A)))}}function R(o,D){1&o&&t.nrm(0,"div",22)}function j(o,D){if(1&o&&t.nrm(0,"div",23),2&o){const s=t.XpG();t.Y8G("ngClass",t.l_i(1,Q,s.quotationInvoice.description,!s.quotationInvoice.description))}}function z(o,D){if(1&o&&(t.j41(0,"div",26),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&o){const s=D.$implicit;t.R7$(),t.Lme("",t.i5U(2,2,s.total,t.lJ4(5,$))," ",s.currency,"")}}function q(o,D){1&o&&(t.j41(0,"div",27),t.EFF(1," OBSERVACIONES"),t.k0s())}function V(o,D){if(1&o&&(t.j41(0,"span",28),t.EFF(1),t.k0s()),2&o){const s=t.XpG();t.R7$(),t.JRh(s.quotationInvoice.description)}}function v(o,D){if(1&o&&(t.j41(0,"div",34)(1,"div",42)(2,"span"),t.EFF(3),t.k0s(),t.j41(4,"span"),t.EFF(5,"-"),t.k0s()(),t.j41(6,"span",43),t.EFF(7),t.k0s()()),2&o){const s=D.$implicit;t.R7$(3),t.SpI("",s.percent,"%"),t.R7$(4),t.JRh(s.description)}}function T(o,D){if(1&o&&(t.j41(0,"div",44)(1,"span",45),t.EFF(2),t.k0s(),t.nrm(3,"img",46),t.k0s()),2&o){const s=t.XpG(2);t.R7$(2),t.JRh(s.eQr.name),t.R7$(),t.Y8G("src",s.eQr.qrUrl,t.B4B)}}function u(o,D){if(1&o&&(t.j41(0,"div",44)(1,"span",45),t.EFF(2),t.k0s(),t.nrm(3,"img",46),t.k0s()),2&o){const s=t.XpG(2);t.R7$(2),t.JRh(s.tQr.name),t.R7$(),t.Y8G("src",s.tQr.qrUrl,t.B4B)}}function b(o,D){if(1&o&&(t.j41(0,"div",35),t.DNE(1,T,4,2,"div",44)(2,u,4,2,"div",44),t.k0s()),2&o){const s=t.XpG();t.R7$(),t.vxM(1,s.eQr?1:-1),t.R7$(),t.vxM(2,s.tQr?2:-1)}}g.vfs=r.b.vfs,i().locale("es");let p=(()=>{class o{constructor(s,k){this.store=s,this._changeDetectorRef=k,this.selectedInvoice$=null,this.selectedInvoice=null,this.authUser=null,this.eQr=null,this.tQr=null,this.totalQuantity=[],this._unsubscribeAll=new a.B}ngOnInit(){this.store.select(f.SW).pipe((0,x.Q)(this._unsubscribeAll)).subscribe(s=>{this.linkRequest=s?"/modules/commercial/quotations":"/public/quotation",this.authUser=s,this._changeDetectorRef.markForCheck()}),this.selectedInvoice$=this.store.select(m.WK),this.selectedInvoice$.pipe((0,x.Q)(this._unsubscribeAll)).subscribe(s=>{this.selectedInvoice=s,this.merchantInvoice=s.merchantId,this.quotationInvoice=s.quotationId,this.requestQuotation=this.quotationInvoice.requestId,this.totalQuantity=this.getTotalQuantity(this.quotationInvoice),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}generatePDF(s){const c={content:[{columns:[{stack:[{columns:[{stack:[{text:"FACTURA",fontSize:16},{text:"VALIDEZ",margin:[0,4,0,0],fontSize:9},{text:"ESTADO",margin:[0,4,0,0],fontSize:9},{text:"IMPORTE TOTAL",margin:[0,4,0,0],fontSize:9}],width:100,color:"#7b838e"},{stack:[{text:this.selectedInvoice.no,alignment:"left",fontSize:16,margin:[0,0,0,0],bold:!0},{text:this.getValidity(),alignment:"left",bold:!0,opacity:.7,margin:[0,4,0,0],fontSize:9},{text:this.selectedInvoice.status.toUpperCase(),alignment:"left",bold:!0,opacity:.7,margin:[0,4,0,0],fontSize:9},{stack:[...this.totalQuantity.map(B=>[{text:`${B.total.toFixed(2)} ${B.currency}`,alignment:"left",bold:!0,opacity:.7,fontSize:9}])],margin:[0,4,0,0]}]}]},{columns:[{text:"OFERTA",margin:[0,4,0,0],fontSize:9,width:100,color:"#7b838e"},{text:this.selectedInvoice.quotationNo,margin:[0,4,0,0],alignment:"left",fontSize:9}],width:320}],width:320},{columns:[this.merchantInvoice.logoUrl?{image:"logo",width:60,alignment:"center",margin:[0,10,15,0]}:{},{canvas:[{type:"line",x1:0,y1:0,x2:0,y2:80,lineWidth:.5}],width:1},{stack:[{text:this.merchantInvoice.name,alignment:"left",fontSize:8,bold:!0},{text:`${this.merchantInvoice.address}  ${this.merchantInvoice.city}   ${this.merchantInvoice.state}   ${this.merchantInvoice.country}`,alignment:"left",fontSize:8},this.merchantInvoice.phoneNumbers.length>0?{text:`${this.merchantInvoice.phoneNumbers[0].stateCode}  ${this.merchantInvoice.phoneNumbers[0].phoneNumber}`,alignment:"left",fontSize:8}:{},this.merchantInvoice.emails.length>0?{text:`${this.merchantInvoice.emails[0].email}`,alignment:"left",fontSize:8}:{},{text:this.merchantInvoice.website,alignment:"left",fontSize:8},this.quotationInvoice.paymentMethodData.includeBankAccount?{text:this.divInSpaces(),alignment:"left",fontSize:8}:{}],margin:[15,2,0,0],lineHeight:1.2,alignment:"right"}],margin:[0,4,0,0]}]},{stack:[{text:`${this.requestQuotation.name}  ${this.requestQuotation.lastname}`,alignment:"left",fontSize:12,lineHeight:1.2,bold:!0,opacity:.8},this.requestQuotation.address?{text:`${this.requestQuotation.address}, ${this.requestQuotation.city}, ${this.requestQuotation.state}, Cuba`,alignment:"left",lineHeight:1.2,fontSize:8}:{},{text:`${this.requestQuotation.phoneNumber.stateCode} ${this.requestQuotation.phoneNumber.phoneNumber}`,alignment:"left",lineHeight:1.2,fontSize:8},{text:this.requestQuotation.email,alignment:"left",lineHeight:1.2,fontSize:8}],margin:[0,20,0,0]},{columns:[{text:"PRODUCTO O SERVICIO",color:"#64748B",alignment:"left",fontSize:8,width:350},{text:"CANTIDAD",color:"#64748B",alignment:"center",fontSize:8,width:40},{text:"PRECIO",color:"#64748B",alignment:"right",fontSize:8,width:70},{text:"TOTAL",color:"#64748B",alignment:"right",fontSize:8}],margin:[0,35,0,5]},...this.quotationInvoice.goodsData.map(B=>[{stack:[{canvas:[{type:"line",x1:0,y1:0,x2:535,y2:0,lineWidth:.1,lineColor:"#d2d6dd"}]},{columns:[{text:B.name,alignment:"left",fontSize:9,bold:!0,opacity:.7,width:350},{text:B.amount,alignment:"center",fontSize:9,width:40},{text:`${B.price.toFixed(2)} ${B.currency}`,alignment:"right",fontSize:9,width:70},{text:`$${B.quantity.toFixed(2)}`,alignment:"right",fontSize:9}],margin:[0,4,0,4]}]}]),{canvas:[{type:"line",x1:0,y1:0,x2:535,y2:0,lineWidth:.1,lineColor:"#d2d6dd"}]},{columns:[{text:"Total",alignment:"left",fontSize:9,color:"#7b838e"},{stack:[...this.totalQuantity.map(B=>[{text:`${B.total.toFixed(2)} ${B.currency}`,alignment:"right",bold:!0,opacity:.7,fontSize:9}])]}],margin:[0,5,0,0]},this.quotationInvoice.description?{stack:[{text:"OBSERVACIONES",color:"#64748B",alignment:"left",fontSize:8},{text:this.quotationInvoice.description,alignment:"left",fontSize:9,margin:[0,2,0,0]}],margin:[0,25,0,0]}:{}],footer:(B,K,G)=>[{stack:[{text:"T\xe9rminos o condiciones de pago.",alignment:"left",fontSize:9,bold:!0,opacity:.9},{columns:[this.merchantInvoice.logoUrl?{image:"logo",width:20,alignment:"center"}:{},{layout:"noBorders",lineHeight:1,table:{headerRows:0,widths:[15,2,"*"],body:[...this.quotationInvoice.paymentMethodData.terms.map(X=>[{text:`${X.percent}%`,alignment:"left",fontSize:6,opacity:.6},{text:"-",alignment:"left",fontSize:6,opacity:.6},{text:X.description,alignment:"left",fontSize:6,opacity:.6}])]},margin:[10,0,0,0]},"UseMerchantPayments"===this.quotationInvoice.paymentMethodData.paymentBy?{stack:[{columns:[this.merchantInvoice.commercialManagement.transfermovilQr?{stack:[],width:1}:{stack:[],width:55},this.merchantInvoice.commercialManagement.enzonaQr?{stack:[{text:"Enzona",alignment:"center",fontSize:8,opacity:.6,bold:!0,margin:[0,0,0,2]},{image:"enzonaUrl",width:55,alignment:"center"}],margin:[0,-10,0,0]}:{stack:[],width:55},this.merchantInvoice.commercialManagement.transfermovilQr?{stack:[{text:"Transfermovil",alignment:"center",fontSize:8,opacity:.6,bold:!0,margin:[0,0,0,2]},{image:"transfermovilUrl",width:55,alignment:"center"}],margin:[0,-10,0,0]}:{stack:[],width:1}],columnGap:15}],width:150,margin:[15,0,0,0]}:{stack:[],width:1}],margin:[0,8,0,0]}],margin:K>1?[40,30,40,15]:[40,50,40,15]},K>1?{text:B.toString()+" de "+K,alignment:"center"}:{text:"",alignment:"center"},{canvas:[{type:"rect",x:170,y:32,w:G.width-170,h:40}]}],defaultStyle:{fontSize:12},pageOrientation:"portrait",pageSize:"LETTER",pageMargins:[40,40,40,145],info:{title:"Factura",author:"",subject:"",creationDate:new Date},images:{logo:this.merchantInvoice.logoUrl,enzonaUrl:"UseMerchantPayments"===this.quotationInvoice.paymentMethodData.paymentBy&&this.merchantInvoice.commercialManagement.enzonaQr?this.merchantInvoice.commercialManagement.enzonaQr:"",transfermovilUrl:"UseMerchantPayments"===this.quotationInvoice.paymentMethodData.paymentBy&&this.merchantInvoice.commercialManagement.transfermovilQr?this.merchantInvoice.commercialManagement.transfermovilQr:""}};switch(s){case s="download":g.createPdf(c).download();break;case s="open":g.createPdf(c).open();break;case s="print":g.createPdf(c).print()}}getTotalQuantity(s){return s.goodsData.reduce((k,{currency:c})=>{if(!k.some(B=>B.currency===c)){const B=s.goodsData.filter(K=>K.currency===c).map(K=>K.quantity).reduce((K,G)=>K+G,0);k.push({currency:c,total:B})}return k},[])}getValidity(){return`${i()(this.selectedInvoice.createdAt).format("L")} - ${i()(this.selectedInvoice.createdAt).add(this.selectedInvoice.expirationDays,"days").format("L")}`}divInSpaces(){const s=this.selectedInvoice.bankAccount,k=[];for(let c=0;c<s.length;c++)k.push(s.substring(c,c+4)),c+=3;return k.join("-")}static#t=this.\u0275fac=function(k){return new(k||o)(t.rXU(l.il),t.rXU(t.gRc))};static#e=this.\u0275cmp=t.VBU({type:o,selectors:[["invoice-details"]],standalone:!0,features:[t.aNF],decls:78,vars:43,consts:[["cdkScrollable","",1,"flex","md:justify-center","w-full","print:overflow-visible"],[1,"inline-block","p-6","sm:p-10","text-left","print:p-0"],[1,"flex","items-center","flex-shrink-0","mt-6","md:mt-0","sm:ml-4","gap-x-4","justify-end"],[1,"w-240","p-16","rounded-2xl","shadow","bg-card","print:w-auto","print:rounded-none","print:shadow-none","print:bg-transparent"],[1,"flex","items-start","justify-between"],[1,"whitespace-nowrap","grid","grid-cols-2","gap-y-1",2,"width","260px !important"],[1,"text-3xl","tracking-tight","text-secondary"],[1,"text-2xl","flex","items-center","font-medium"],[1,"font-medium","tracking-tight","text-secondary"],[1,"font-medium"],[1,"font-medium","text-primary-500","hover:text-primary-700","cursor-pointer",3,"routerLink"],[1,"grid","auto-cols-max","grid-flow-col","gap-x-8","-mr-16","py-6","px-8","rounded-l-2xl","light"],[1,"place-self-center","w-24"],[1,"w-24",3,"src"],[1,"pl-8","overflow-auto","break-word","border-l","text-md",2,"width","220px !important","border-color","black"],[1,"mt-4","text-md","w-96","pr-8"],[1,"text-xl","font-medium"],[1,"grid","grid-cols-12","gap-x-1","mt-14"],[1,"col-span-6","font-medium","text-md","text-secondary"],[1,"col-span-2","font-medium","text-md","text-center","text-secondary","pl-10"],[1,"col-span-2","font-medium","text-md","text-right","text-secondary"],[1,"col-span-12","grid","grid-cols-12","gap-x-1"],[1,"col-span-12","mt-16"],[1,"col-span-12","border-b",3,"ngClass"],[1,"col-span-10","font-medium","tracking-tight","text-secondary",3,"ngClass"],[1,"flex","flex-col","col-span-2","text-right","font-medium",3,"ngClass"],[1,"col-span-2"],[1,"col-span-8","font-medium","text-md","mt-10","text-secondary"],[1,"col-span-12","break-words","mt-2"],[1,"mt-16","grid","grid-cols-3"],[1,"",3,"ngClass"],[1,"flex","items-start","mt-4"],[1,"flex-0","w-10","mt-1",3,"src"],[1,"flex","flex-col","ml-6","w-full"],[1,"grid","grid-cols-2","text-sm","text-secondary","w-full",2,"grid-template-columns","45px auto !important"],[1,"col-span-1","flex","justify-end","gap-8"],["mat-button","",1,"rounded-full",3,"click"],[1,"text-primary-700",3,"svgIcon"],[1,"col-span-12","my-4","border-b"],[1,"col-span-6","text-lg","font-medium"],[1,"col-span-2","self-center","text-center","pl-10"],[1,"col-span-2","self-center","text-right"],[1,"flex","justify-between"],[1,"ml-4"],[1,"text-center"],[1,"text-md","font-medium","text-secondary"],[1,"w-24","h-24","object-cover","mt-2",3,"src"]],template:function(k,c){1&k&&(t.j41(0,"div",0)(1,"div",1),t.DNE(2,W,7,3,"div",2),t.j41(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),t.EFF(7,"FACTURA"),t.k0s(),t.j41(8,"div",7),t.EFF(9),t.k0s(),t.j41(10,"div",8),t.EFF(11,"VALIDEZ"),t.k0s(),t.j41(12,"div",9),t.EFF(13),t.k0s(),t.j41(14,"div",8),t.EFF(15,"ESTADO"),t.k0s(),t.j41(16,"div",9),t.EFF(17),t.k0s(),t.j41(18,"div",8),t.EFF(19,"IMPORTE TOTAL"),t.k0s(),t.j41(20,"div",9),t.Z7z(21,N,3,6,"div",null,t.fX1),t.k0s(),t.j41(23,"div",8),t.EFF(24,"OFERTA"),t.k0s(),t.j41(25,"a",10),t.EFF(26),t.k0s()(),t.j41(27,"div",11)(28,"div",12),t.nrm(29,"img",13),t.k0s(),t.j41(30,"div",14)(31,"div",9),t.EFF(32),t.k0s(),t.j41(33,"div"),t.EFF(34),t.k0s(),t.DNE(35,w,2,1,"div")(36,M,2,1,"div"),t.j41(37,"div"),t.EFF(38),t.k0s(),t.DNE(39,S,2,1,"div"),t.k0s()()(),t.j41(40,"div",15)(41,"div",16),t.EFF(42),t.k0s(),t.DNE(43,_,2,3,"div"),t.j41(44,"div"),t.EFF(45),t.k0s(),t.j41(46,"div"),t.EFF(47),t.k0s()(),t.j41(48,"div",17)(49,"div",18),t.EFF(50,"PRODUCTO O SERVICIO"),t.k0s(),t.j41(51,"div",19),t.EFF(52,"CANTIDAD"),t.k0s(),t.j41(53,"div",20),t.EFF(54,"PRECIO"),t.k0s(),t.j41(55,"div",20),t.EFF(56,"TOTAL"),t.k0s(),t.Z7z(57,U,12,13,"div",21,t.fX1),t.DNE(59,R,1,0,"div",22)(60,j,1,4,"div",23),t.j41(61,"div",24),t.EFF(62,"TOTAL"),t.k0s(),t.j41(63,"div",25),t.Z7z(64,z,3,6,"div",26,t.fX1),t.k0s(),t.DNE(66,q,2,0,"div",27)(67,V,2,1,"span",28),t.k0s(),t.j41(68,"div",29)(69,"div",30)(70,"div",9),t.EFF(71,"T\xe9rminos o condiciones de pago."),t.k0s(),t.j41(72,"div",31),t.nrm(73,"img",32),t.j41(74,"div",33),t.Z7z(75,v,8,2,"div",34,t.fX1),t.k0s()()(),t.DNE(77,b,3,2,"div",35),t.k0s()()()()),2&k&&(t.R7$(2),t.vxM(2,c.authUser?-1:2),t.R7$(7),t.SpI("#",c.selectedInvoice.no,""),t.R7$(4),t.JRh(c.getValidity()),t.R7$(4),t.JRh(c.selectedInvoice.status.toUpperCase()),t.R7$(4),t.Dyx(c.totalQuantity),t.R7$(4),t.Y8G("routerLink",t.l_i(31,E,c.linkRequest,c.quotationInvoice._id)),t.R7$(),t.SpI("#",c.selectedInvoice.quotationNo,""),t.R7$(3),t.Y8G("src",c.merchantInvoice.logoUrl,t.B4B),t.R7$(3),t.JRh(c.merchantInvoice.name),t.R7$(2),t.LHq("",c.merchantInvoice.address,", ",c.merchantInvoice.city,", ",c.merchantInvoice.state,", ",c.merchantInvoice.country," "),t.R7$(),t.vxM(35,c.merchantInvoice.phoneNumbers.length>0?35:-1),t.R7$(),t.vxM(36,c.merchantInvoice.emails.length>0?36:-1),t.R7$(2),t.JRh(c.merchantInvoice.website),t.R7$(),t.vxM(39,c.quotationInvoice.paymentMethodData.includeBankAccount?39:-1),t.R7$(3),t.Lme("",c.requestQuotation.name," ",c.requestQuotation.lastname,""),t.R7$(),t.vxM(43,c.requestQuotation.address?43:-1),t.R7$(2),t.Lme("",c.requestQuotation.phoneNumber.stateCode," ",c.requestQuotation.phoneNumber.phoneNumber,""),t.R7$(2),t.JRh(c.requestQuotation.email),t.R7$(10),t.Dyx(c.quotationInvoice.goodsData),t.R7$(2),t.vxM(59,c.quotationInvoice.description?-1:59),t.R7$(),t.vxM(60,c.quotationInvoice.description?60:-1),t.R7$(),t.Y8G("ngClass",t.l_i(34,y,c.quotationInvoice.description,!c.quotationInvoice.description)),t.R7$(2),t.Y8G("ngClass",t.l_i(37,y,c.quotationInvoice.description,!c.quotationInvoice.description)),t.R7$(),t.Dyx(c.totalQuantity),t.R7$(2),t.vxM(66,c.quotationInvoice.description?66:-1),t.R7$(),t.vxM(67,c.quotationInvoice.description?67:-1),t.R7$(2),t.Y8G("ngClass",t.l_i(40,C,!c.eQr&&!c.tQr||"UseMerchantPayments"!==c.quotationInvoice.paymentMethodData.paymentBy,!(!c.eQr&&!c.tQr)&&"UseMerchantPayments"===c.quotationInvoice.paymentMethodData.paymentBy)),t.R7$(4),t.Y8G("src",c.merchantInvoice.logoUrl,t.B4B),t.R7$(2),t.Dyx(c.quotationInvoice.paymentMethodData.terms),t.R7$(2),t.vxM(77,(c.eQr||c.tQr)&&"UseMerchantPayments"===c.quotationInvoice.paymentMethodData.paymentBy?77:-1))},dependencies:[I.oe,h.Hl,h.$z,d.m_,d.An,I.YU,e.Wk],encapsulation:2,changeDetection:0})}return o})()},91602:(L,O,n)=>{n.d(O,{M:()=>P,R:()=>F});var f=n(18810),a=n(99437),x=n(96354),m=n(54438),r=n(9005),g=n(51188);let F=(()=>{class i{constructor(h){this._invoicesService=h}resolve(h,d){return this._invoicesService.getInvoices()}static#t=this.\u0275fac=function(d){return new(d||i)(m.KVO(r.U))};static#e=this.\u0275prov=m.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),P=(()=>{class i{constructor(h,d){this._invoicesService=h,this._router=d}resolve(h,d){return this._invoicesService.getInvoiceById(h.params.invoiceId).pipe((0,a.W)(t=>{console.error(t);const l=d.url.split("/").slice(0,-1).join("/");return this._router.navigateByUrl(l),(0,f.$)(t)}),(0,x.T)(t=>{if(!t.ok){let l=d.url.split("/").slice(0,-1).join("/");d.url.includes("public")&&(l=d.url.split("/").slice(0,-2).join("/")),this._router.navigateByUrl(l)}}))}static#t=this.\u0275fac=function(d){return new(d||i)(m.KVO(r.U),m.KVO(g.Ix))};static#e=this.\u0275prov=m.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()},94268:(L,O,n)=>{n.d(O,{WK:()=>x,nX:()=>m});var f=n(59640);const a=r=>r.invoices,x=(0,f.Mz)(a,r=>r.invoice),m=(0,f.Mz)(a,r=>r.invoices)},9005:(L,O,n)=>{n.d(O,{U:()=>i});var f=n(21626),a=n(88141),x=n(98216),m=n(45312),r=n(19117),g=n(54438),F=n(59640);const P=m.c.API_URL;let i=(()=>{class I{constructor(d,e){this._httpClient=d,this.store=e}getInvoices(d=0,e=20,t="createdAt",l="desc",E="",y=""){const C=(new f.Nl).append("page",d).append("size",e).append("sort",t).append("order",l).append("search",E).append("filter",y);return this._httpClient.get(`${P}/invoices/`,{params:C}).pipe((0,a.M)($=>{this.store.dispatch((0,x.Bp)({pagination:$.pagination})),this.store.dispatch((0,r.$6)({invoices:$.dataArr}))}))}getInvoiceById(d){return this._httpClient.get(`${P}/invoices/${d}`).pipe((0,a.M)(e=>{this.store.dispatch((0,r.ep)({invoice:e.data}))}))}createInvoice(d){return this._httpClient.post(`${P}/invoices`,d).pipe((0,a.M)(e=>{this.store.dispatch((0,r.iO)({invoice:e.data}))}))}updateInvoice(d){return this._httpClient.patch(`${P}/invoices/${d._id}`,d).pipe((0,a.M)(e=>{this.store.dispatch((0,r.Dq)({invoice:e.data}))}))}updateStatus(d,e,t=""){return this._httpClient.patch(`${P}/invoices/update-status`,{_id:d,status:e,canceledReason:t}).pipe((0,a.M)(l=>{this.store.dispatch((0,r.Dq)({invoice:l.data}))}))}deleteInvoice(d,e=0,t=20,l="createdAt",E="desc",y="",C=""){const $=(new f.Nl).append("page",e).append("size",t).append("sort",l).append("order",E).append("search",y).append("filter",C);return this._httpClient.delete(`${P}/invoices/${d}`,{params:$}).pipe((0,a.M)(A=>{this.store.dispatch((0,x.Bp)({pagination:A.pagination})),this.store.dispatch((0,r.$6)({invoices:A.dataArr}))}))}static#t=this.\u0275fac=function(e){return new(e||I)(g.KVO(f.Qq),g.KVO(F.il))};static#e=this.\u0275prov=g.jDH({token:I,factory:I.\u0275fac,providedIn:"root"})}return I})()},62621:(L,O,n)=>{n.d(O,{W:()=>I});var f=n(21626),a=n(88141),x=n(96354),m=n(87037),r=n(98216),g=n(45312),F=n(54438),P=n(59640);const i=g.c.API_URL;let I=(()=>{class h{constructor(e,t){this._httpClient=e,this.store=t}getPaymentConditions(e=0,t=20,l="active",E="desc",y=""){const C=(new f.Nl).append("page",e).append("size",t).append("sort",l).append("order",E).append("search",y);return this._httpClient.get(`${i}/payment-conditions/`,{params:C}).pipe((0,a.M)($=>{this.store.dispatch((0,r.Bp)({pagination:$.pagination})),this.store.dispatch((0,m.Ze)({paymentConditions:$.dataArr}))}))}getActivePaymentConditions(){return this._httpClient.get(`${i}/payment-conditions/active`).pipe((0,x.T)(e=>e.dataArr),(0,a.M)(e=>{this.store.dispatch((0,m.Ze)({paymentConditions:e}))}))}getPaymentConditionById(e){return this._httpClient.get(`${i}/payment-conditions/${e}`).pipe((0,a.M)(t=>{this.store.dispatch((0,m.QH)({paymentCondition:t.data}))}))}createPaymentCondition(e){return this._httpClient.post(`${i}/payment-conditions`,e).pipe((0,a.M)(t=>{this.store.dispatch((0,m.yX)({paymentCondition:t.data}))}))}updatePaymentCondition(e){return this._httpClient.patch(`${i}/payment-conditions/${e._id}`,e).pipe((0,a.M)(t=>{this.store.dispatch((0,m.vK)({paymentCondition:t.data}))}))}deletePaymentCondition(e,t=0,l=20,E="active",y="desc",C=""){const $=(new f.Nl).append("page",t).append("size",l).append("sort",E).append("order",y).append("search",C);return this._httpClient.delete(`${i}/payment-conditions/${e}`,{params:$}).pipe((0,a.M)(A=>{this.store.dispatch((0,r.Bp)({pagination:A.pagination})),this.store.dispatch((0,m.Ze)({paymentConditions:A.dataArr}))}))}static#t=this.\u0275fac=function(t){return new(t||h)(F.KVO(f.Qq),F.KVO(P.il))};static#e=this.\u0275prov=F.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()},5004:(L,O,n)=>{n.d(O,{Q:()=>V});var f=n(63729),a=n(21413),x=n(56977),m=n(78268),r=n(77235),g=n(82643),P=n(97586),i=n.n(P),I=n(60177),h=n(88834),d=n(99213),e=n(51188),t=n(54438),l=n(59640);const E=(v,T)=>[v,T],y=(v,T)=>({"text-lg":v,"text-2xl":T}),C=()=>[""],$=()=>["$"],A=(v,T)=>({"my-4":v,"my-3":T});function Q(v,T){if(1&v){const u=t.RV6();t.j41(0,"div",2)(1,"button",34),t.bIt("click",function(){t.eBV(u);const p=t.XpG();return t.Njj(p.generatePDF("open"))}),t.nrm(2,"mat-icon",35),t.k0s(),t.j41(3,"button",34),t.bIt("click",function(){t.eBV(u);const p=t.XpG();return t.Njj(p.generatePDF("download"))}),t.nrm(4,"mat-icon",35),t.k0s(),t.j41(5,"button",34),t.bIt("click",function(){t.eBV(u);const p=t.XpG();return t.Njj(p.generatePDF("print"))}),t.nrm(6,"mat-icon",35),t.k0s()()}2&v&&(t.R7$(2),t.Y8G("svgIcon","heroicons_outline:eye"),t.R7$(2),t.Y8G("svgIcon","heroicons_outline:download"),t.R7$(2),t.Y8G("svgIcon","heroicons_outline:printer"))}function W(v,T){if(1&v&&(t.j41(0,"div"),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&v){const u=T.$implicit;t.R7$(),t.Lme("",t.i5U(2,2,u.total,t.lJ4(5,C))," ",u.currency,"")}}function N(v,T){if(1&v&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&v){const u=t.XpG();t.R7$(),t.SpI(" ",u.merchantQuotation.phoneNumbers[0].stateCode+" "+u.merchantQuotation.phoneNumbers[0].phoneNumber,"")}}function w(v,T){if(1&v&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&v){const u=t.XpG();t.R7$(),t.JRh(u.merchantQuotation.emails[0].email)}}function M(v,T){if(1&v&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&v){const u=t.XpG();t.R7$(),t.E5c("",u.requestQuotation.address,", ",u.requestQuotation.city,", ",u.requestQuotation.state,", Cuba ")}}function S(v,T){if(1&v&&(t.j41(0,"div",21),t.nrm(1,"div",36),t.j41(2,"div",37),t.EFF(3),t.k0s(),t.j41(4,"div",38),t.EFF(5),t.k0s(),t.j41(6,"div",39),t.EFF(7),t.nI1(8,"currency"),t.k0s(),t.j41(9,"div",39),t.EFF(10),t.nI1(11,"currency"),t.k0s()()),2&v){const u=T.$implicit;t.R7$(3),t.JRh(u.name),t.R7$(2),t.JRh(u.amount),t.R7$(2),t.Lme("",t.i5U(8,5,u.price,t.lJ4(11,C))," ",u.currency,""),t.R7$(3),t.JRh(t.i5U(11,8,u.quantity,t.lJ4(12,$)))}}function _(v,T){1&v&&t.nrm(0,"div",22)}function U(v,T){if(1&v&&t.nrm(0,"div",23),2&v){const u=t.XpG();t.Y8G("ngClass",t.l_i(1,A,u.selectedQuotation.description,!u.selectedQuotation.description))}}function R(v,T){if(1&v&&(t.j41(0,"div",26),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&v){const u=T.$implicit;t.R7$(),t.Lme("",t.i5U(2,2,u.total,t.lJ4(5,C))," ",u.currency,"")}}function j(v,T){1&v&&(t.j41(0,"div",27),t.EFF(1,"OBSERVACIONES"),t.k0s())}function z(v,T){if(1&v&&(t.j41(0,"span",28),t.EFF(1),t.k0s()),2&v){const u=t.XpG();t.R7$(),t.JRh(u.selectedQuotation.description)}}function q(v,T){if(1&v&&(t.j41(0,"div",33)(1,"div",40)(2,"span"),t.EFF(3),t.k0s(),t.j41(4,"span"),t.EFF(5,"-"),t.k0s()(),t.j41(6,"span",41),t.EFF(7),t.k0s()()),2&v){const u=T.$implicit;t.R7$(3),t.SpI("",u.percent,"%"),t.R7$(4),t.JRh(u.description)}}g.vfs=r.b.vfs,i().locale("es");let V=(()=>{class v{constructor(u,b){this.store=u,this._changeDetectorRef=b,this.selectedQuotation$=null,this.selectedQuotation=null,this.authUser=null,this.totalQuantity=[],this._unsubscribeAll=new a.B}ngOnInit(){this.store.select(f.SW).pipe((0,x.Q)(this._unsubscribeAll)).subscribe(u=>{this.linkRequest=u?"/modules/commercial/request":"/public/request",this.authUser=u,this._changeDetectorRef.markForCheck()}),this.selectedQuotation$=this.store.select(m.dM),this.selectedQuotation$.pipe((0,x.Q)(this._unsubscribeAll)).subscribe(u=>{this.selectedQuotation=u,this.merchantQuotation=u.merchantId,this.requestQuotation=u.requestId,this.totalQuantity=this.getTotalQuantity(u),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}generatePDF(u){const p={content:[{columns:[{stack:[{columns:[{stack:[{text:"OFERTA",fontSize:16},{text:"VALIDEZ",margin:[0,4,0,0],fontSize:9},{text:"ESTADO",margin:[0,4,0,0],fontSize:9},{text:"IMPORTE TOTAL",margin:[0,4,0,0],fontSize:9}],width:100,color:"#7b838e"},{stack:[{text:this.selectedQuotation.no,alignment:"left",fontSize:16,margin:[0,0,0,0],bold:!0},{text:this.getValidity(),alignment:"left",bold:!0,opacity:.7,margin:[0,4,0,0],fontSize:9},{text:this.selectedQuotation.status.toUpperCase(),alignment:"left",bold:!0,opacity:.7,margin:[0,4,0,0],fontSize:9},{stack:[...this.totalQuantity.map(o=>[{text:`${o.total.toFixed(2)} ${o.currency}`,alignment:"left",bold:!0,opacity:.7,fontSize:9}])],margin:[0,4,0,0]}]}],width:320},{columns:[{text:"SOLICITUD",margin:[0,4,0,0],fontSize:9,width:100,color:"#7b838e"},{text:this.selectedQuotation.requestNo,margin:[0,4,0,0],alignment:"left",fontSize:9}],width:320}],width:320},{columns:[this.merchantQuotation.logoUrl?{image:"logo",width:60,alignment:"center",margin:[0,7,15,0]}:{},{canvas:[{type:"line",x1:0,y1:0,x2:0,y2:73,lineWidth:.1}],width:1},{stack:[{text:this.merchantQuotation.name,alignment:"left",fontSize:8,bold:!0},{text:`${this.merchantQuotation.address}  ${this.merchantQuotation.city}   ${this.merchantQuotation.state}   ${this.merchantQuotation.country}`,alignment:"left",fontSize:8},this.merchantQuotation.phoneNumbers.length>0?{text:`${this.merchantQuotation.phoneNumbers[0].stateCode}  ${this.merchantQuotation.phoneNumbers[0].phoneNumber}`,alignment:"left",fontSize:8}:{},this.merchantQuotation.emails.length>0?{text:`${this.merchantQuotation.emails[0].email}`,alignment:"left",fontSize:8}:{},{text:this.merchantQuotation.website,alignment:"left",fontSize:8}],margin:[15,2,0,0],lineHeight:1.2,alignment:"right"}],margin:[0,4,0,0]}]},{stack:[{text:`${this.requestQuotation.name}  ${this.requestQuotation.lastname}`,alignment:"left",fontSize:12,lineHeight:1.2,bold:!0,opacity:.8},this.requestQuotation.address?{text:`${this.requestQuotation.address}, ${this.requestQuotation.city}, ${this.requestQuotation.state}, Cuba`,alignment:"left",lineHeight:1.2,fontSize:8}:{},{text:`${this.requestQuotation.phoneNumber.stateCode} ${this.requestQuotation.phoneNumber.phoneNumber}`,alignment:"left",lineHeight:1.2,fontSize:8},{text:this.requestQuotation.email,alignment:"left",lineHeight:1.2,fontSize:8}],margin:[0,20,0,0]},{columns:[{text:"PRODUCTO O SERVICIO",color:"#64748B",alignment:"left",fontSize:8,width:350},{text:"CANTIDAD",color:"#64748B",alignment:"center",fontSize:8,width:40},{text:"PRECIO",color:"#64748B",alignment:"right",fontSize:8,width:70},{text:"TOTAL",color:"#64748B",alignment:"right",fontSize:8}],margin:[0,35,0,5]},...this.selectedQuotation.goodsData.map(o=>[{stack:[{canvas:[{type:"line",x1:0,y1:0,x2:535,y2:0,lineWidth:.1,lineColor:"#d2d6dd"}]},{columns:[{text:o.name,alignment:"left",fontSize:9,bold:!0,opacity:.7,width:350},{text:o.amount,alignment:"center",fontSize:9,width:40},{text:`${o.price.toFixed(2)} ${o.currency}`,alignment:"right",fontSize:9,width:70},{text:`$${o.quantity.toFixed(2)}`,alignment:"right",fontSize:9}],margin:[0,4,0,4]}]}]),{canvas:[{type:"line",x1:0,y1:0,x2:535,y2:0,lineWidth:.1,lineColor:"#d2d6dd"}]},{columns:[{text:"Total",alignment:"left",fontSize:9,color:"#7b838e"},{stack:[...this.totalQuantity.map(o=>[{text:`${o.total.toFixed(2)} ${o.currency}`,alignment:"right",bold:!0,opacity:.7,fontSize:9}])]}],margin:[0,5,0,0]},this.selectedQuotation.description?{stack:[{text:"OBSERVACIONES",color:"#64748B",alignment:"left",fontSize:8},{text:this.selectedQuotation.description,alignment:"left",fontSize:9,margin:[0,2,0,0]}],margin:[0,25,0,0]}:{}],footer:(o,D,s)=>[{stack:[{text:"T\xe9rminos o condiciones de pago.",alignment:"left",fontSize:9,bold:!0,opacity:.9},{columns:[this.merchantQuotation.logoUrl?{image:"logo",width:20,alignment:"center"}:{},{layout:"noBorders",lineHeight:1,table:{headerRows:0,widths:[15,2,"*"],body:[...this.selectedQuotation.paymentMethodData.terms.map(k=>[{text:`${k.percent}%`,alignment:"left",fontSize:6,opacity:.6},{text:"-",alignment:"left",fontSize:6,opacity:.6},{text:k.description,alignment:"left",fontSize:6,opacity:.6}])]},margin:[10,0,0,0]}],margin:[0,8,0,0]}],margin:D>1?[40,30,40,15]:[40,70,40,15]},D>1?{text:o.toString()+" de "+D,alignment:"center"}:{text:"",alignment:"center"},{canvas:[{type:"rect",x:170,y:32,w:s.width-170,h:40}]}],defaultStyle:{fontSize:12},pageOrientation:"portrait",pageSize:"LETTER",pageMargins:[40,40,40,145],info:{title:"Oferta",author:"",subject:"",creationDate:new Date},images:{logo:this.merchantQuotation.logoUrl}};switch(u){case u="download":g.createPdf(p).download();break;case u="open":g.createPdf(p).open();break;case u="print":g.createPdf(p).print()}}getTotalQuantity(u){return u.goodsData.reduce((b,{currency:p})=>{if(!b.some(o=>o.currency===p)){const o=u.goodsData.filter(D=>D.currency===p).map(D=>D.quantity).reduce((D,s)=>D+s,0);b.push({currency:p,total:o})}return b},[])}getValidity(){return`${i()(this.selectedQuotation.createdAt).format("L")} - ${i()(this.selectedQuotation.createdAt).add(this.selectedQuotation.expirationDays,"days").format("L")}`}static#t=this.\u0275fac=function(b){return new(b||v)(t.rXU(l.il),t.rXU(t.gRc))};static#e=this.\u0275cmp=t.VBU({type:v,selectors:[["quotation-details"]],standalone:!0,features:[t.aNF],decls:75,vars:37,consts:[["cdkScrollable","",1,"flex","md:justify-center","w-full","print:overflow-visible"],[1,"inline-block","p-6","sm:p-10","text-left","print:p-0"],[1,"flex","items-center","flex-shrink-0","mt-6","md:mt-0","sm:ml-4","gap-x-4","justify-end"],[1,"w-240","p-16","rounded-2xl","shadow","bg-card","print:w-auto","print:rounded-none","print:shadow-none","print:bg-transparent"],[1,"flex","items-start","justify-between"],[1,"grid","grid-cols-2","gap-y-1","whitespace-nowrap",2,"width","260px !important"],[1,"text-3xl","tracking-tight","text-secondary"],[1,"text-2xl","flex","items-center","font-medium"],[1,"font-medium","tracking-tight","text-secondary"],[1,"font-medium"],[1,"font-medium","text-primary-500","hover:text-primary-700","cursor-pointer",3,"routerLink"],[1,"grid","auto-cols-max","grid-flow-col","gap-x-8","-mr-16","py-6","px-8","rounded-l-2xl","light"],[1,"place-self-center","w-24"],[1,"w-24",3,"src"],[1,"pl-8","overflow-auto","break-word","border-l","text-md",2,"width","220px !important","border-color","black"],[1,"mt-4","text-md","w-96","pr-8"],[1,"text-xl","font-medium"],[1,"grid","grid-cols-12","gap-x-1","mt-14"],[1,"col-span-6","font-medium","text-md","text-secondary"],[1,"col-span-2","font-medium","text-md","text-center","text-secondary","pl-10"],[1,"col-span-2","font-medium","text-md","text-right","text-secondary"],[1,"col-span-12","grid","grid-cols-12","gap-x-1"],[1,"col-span-12","mt-16"],[1,"col-span-12","border-b",3,"ngClass"],[1,"col-span-10","font-medium","tracking-tight","text-secondary",3,"ngClass"],[1,"flex","flex-col","col-span-2","text-right","font-medium",3,"ngClass"],[1,"col-span-2"],[1,"col-span-8","font-medium","text-md","mt-10","text-secondary"],[1,"col-span-12","break-words","mt-2"],[1,"mt-16"],[1,"flex","items-start","mt-4"],[1,"flex-0","w-10","mt-1",3,"src"],[1,"flex","flex-col","ml-6","w-full"],[1,"grid","grid-cols-2","text-sm","text-secondary","w-full",2,"grid-template-columns","45px auto !important"],["mat-button","",1,"rounded-full",3,"click"],[1,"text-primary-700",3,"svgIcon"],[1,"col-span-12","my-4","border-b"],[1,"col-span-6","text-lg","font-medium"],[1,"col-span-2","self-center","text-center","pl-10"],[1,"col-span-2","self-center","text-right"],[1,"flex","justify-between"],[1,"ml-4"]],template:function(b,p){1&b&&(t.j41(0,"div",0)(1,"div",1),t.DNE(2,Q,7,3,"div",2),t.j41(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),t.EFF(7,"OFERTA"),t.k0s(),t.j41(8,"div",7),t.EFF(9),t.k0s(),t.j41(10,"div",8),t.EFF(11,"VALIDEZ"),t.k0s(),t.j41(12,"div",9),t.EFF(13),t.k0s(),t.j41(14,"div",8),t.EFF(15,"ESTADO"),t.k0s(),t.j41(16,"div",9),t.EFF(17),t.k0s(),t.j41(18,"div",8),t.EFF(19,"IMPORTE TOTAL"),t.k0s(),t.j41(20,"div",9),t.Z7z(21,W,3,6,"div",null,t.fX1),t.k0s(),t.j41(23,"div",8),t.EFF(24,"SOLICITUD"),t.k0s(),t.j41(25,"a",10),t.EFF(26),t.k0s()(),t.j41(27,"div",11)(28,"div",12),t.nrm(29,"img",13),t.k0s(),t.j41(30,"div",14)(31,"div",9),t.EFF(32),t.k0s(),t.j41(33,"div"),t.EFF(34),t.k0s(),t.DNE(35,N,2,1,"div")(36,w,2,1,"div"),t.j41(37,"div"),t.EFF(38),t.k0s()()()(),t.j41(39,"div",15)(40,"div",16),t.EFF(41),t.k0s(),t.DNE(42,M,2,3,"div"),t.j41(43,"div"),t.EFF(44),t.k0s(),t.j41(45,"div"),t.EFF(46),t.k0s()(),t.j41(47,"div",17)(48,"div",18),t.EFF(49,"PRODUCTO O SERVICIO"),t.k0s(),t.j41(50,"div",19),t.EFF(51,"CANTIDAD"),t.k0s(),t.j41(52,"div",20),t.EFF(53,"PRECIO"),t.k0s(),t.j41(54,"div",20),t.EFF(55,"TOTAL"),t.k0s(),t.Z7z(56,S,12,13,"div",21,t.fX1),t.DNE(58,_,1,0,"div",22)(59,U,1,4,"div",23),t.j41(60,"div",24),t.EFF(61,"TOTAL"),t.k0s(),t.j41(62,"div",25),t.Z7z(63,R,3,6,"div",26,t.fX1),t.k0s(),t.DNE(65,j,2,0,"div",27)(66,z,2,1,"span",28),t.k0s(),t.j41(67,"div",29)(68,"div",9),t.EFF(69,"T\xe9rminos o condiciones de pago."),t.k0s(),t.j41(70,"div",30),t.nrm(71,"img",31),t.j41(72,"div",32),t.Z7z(73,q,8,2,"div",33,t.fX1),t.k0s()()()()()()),2&b&&(t.R7$(2),t.vxM(2,p.authUser?-1:2),t.R7$(7),t.SpI("#",p.selectedQuotation.no,""),t.R7$(4),t.JRh(p.getValidity()),t.R7$(4),t.JRh(p.selectedQuotation.status.toUpperCase()),t.R7$(4),t.Dyx(p.totalQuantity),t.R7$(4),t.Y8G("routerLink",t.l_i(28,E,p.linkRequest,p.requestQuotation._id)),t.R7$(),t.SpI("#",p.selectedQuotation.requestNo,""),t.R7$(3),t.Y8G("src",p.merchantQuotation.logoUrl,t.B4B),t.R7$(3),t.JRh(p.merchantQuotation.name),t.R7$(2),t.LHq("",p.merchantQuotation.address,", ",p.merchantQuotation.city,", ",p.merchantQuotation.state,", ",p.merchantQuotation.country," "),t.R7$(),t.vxM(35,p.merchantQuotation.phoneNumbers.length>0?35:-1),t.R7$(),t.vxM(36,p.merchantQuotation.emails.length>0?36:-1),t.R7$(2),t.JRh(p.merchantQuotation.website),t.R7$(3),t.Lme("",p.requestQuotation.name," ",p.requestQuotation.lastname,""),t.R7$(),t.vxM(42,p.requestQuotation.address?42:-1),t.R7$(2),t.Lme("",p.requestQuotation.phoneNumber.stateCode," ",p.requestQuotation.phoneNumber.phoneNumber,""),t.R7$(2),t.JRh(p.requestQuotation.email),t.R7$(10),t.Dyx(p.selectedQuotation.goodsData),t.R7$(2),t.vxM(58,p.selectedQuotation.description?-1:58),t.R7$(),t.vxM(59,p.selectedQuotation.description?59:-1),t.R7$(),t.Y8G("ngClass",t.l_i(31,y,p.selectedQuotation.description,!p.selectedQuotation.description)),t.R7$(2),t.Y8G("ngClass",t.l_i(34,y,p.selectedQuotation.description,!p.selectedQuotation.description)),t.R7$(),t.Dyx(p.totalQuantity),t.R7$(2),t.vxM(65,p.selectedQuotation.description?65:-1),t.R7$(),t.vxM(66,p.selectedQuotation.description?66:-1),t.R7$(5),t.Y8G("src",p.merchantQuotation.logoUrl,t.B4B),t.R7$(2),t.Dyx(p.selectedQuotation.paymentMethodData.terms))},dependencies:[I.oe,h.Hl,h.$z,d.m_,d.An,I.YU,e.Wk],encapsulation:2,changeDetection:0})}return v})()},22674:(L,O,n)=>{n.d(O,{G:()=>F,z:()=>P});var f=n(18810),a=n(99437),x=n(96354),m=n(54438),r=n(55181),g=n(51188);let F=(()=>{class i{constructor(h){this._quotationsService=h}resolve(h,d){return this._quotationsService.getQuotations()}static#t=this.\u0275fac=function(d){return new(d||i)(m.KVO(r.X))};static#e=this.\u0275prov=m.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),P=(()=>{class i{constructor(h,d){this._quotationsService=h,this._router=d}resolve(h,d){return this._quotationsService.getQuotationById(h.params.quotationId).pipe((0,a.W)(t=>{console.error(t);const l=d.url.split("/").slice(0,-1).join("/");return this._router.navigateByUrl(l),(0,f.$)(t)}),(0,x.T)(t=>{if(!t.ok){let l=d.url.split("/").slice(0,-1).join("/");d.url.includes("public")&&(l=d.url.split("/").slice(0,-2).join("/")),this._router.navigateByUrl(l)}}))}static#t=this.\u0275fac=function(d){return new(d||i)(m.KVO(r.X),m.KVO(g.Ix))};static#e=this.\u0275prov=m.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()},78268:(L,O,n)=>{n.d(O,{EG:()=>m,dM:()=>x});var f=n(59640);const a=r=>r.quotations,x=(0,f.Mz)(a,r=>r.quotation),m=(0,f.Mz)(a,r=>r.quotations)},55181:(L,O,n)=>{n.d(O,{X:()=>h});var f=n(21626),a=n(88141),x=n(98216),m=n(55867),r=n(45312),g=n(23309),F=n(54438),P=n(82341),i=n(59640);const I=r.c.API_URL;let h=(()=>{class d{constructor(t,l,E){this._httpClient=t,this.rolesService=l,this.store=E}getQuotations(t=0,l=20,E="createdAt",y="desc",C="",$=""){const A=(new f.Nl).append("page",t).append("size",l).append("sort",E).append("order",y).append("search",C).append("filter",$);return this._httpClient.get(`${I}/quotations/`,{params:A}).pipe((0,a.M)(Q=>{this.store.dispatch((0,x.Bp)({pagination:Q.pagination})),this.store.dispatch((0,g.gp)({quotations:Q.dataArr}))}))}getQuotationById(t){return this._httpClient.get(`${I}/quotations/${t}`).pipe((0,a.M)(l=>{this.store.dispatch((0,g.Fh)({quotation:l.data}))}))}createQuotation(t){return this._httpClient.post(`${I}/quotations`,t).pipe((0,a.M)(l=>{this.store.dispatch((0,g.fl)({quotation:l.data})),this.store.dispatch((0,g.Fh)({quotation:l.data}))}))}updateQuotation(t){return this._httpClient.patch(`${I}/quotations/${t._id}`,t).pipe((0,a.M)(l=>{this.store.dispatch((0,g.Wh)({quotation:l.data}))}))}acceptQuotation(t){return this._httpClient.patch(`${I}/quotations/accept`,{_id:t,status:m.Sb.Aceptada}).pipe((0,a.M)(l=>{this.store.dispatch((0,g.Wh)({quotation:l.data})),this.store.dispatch((0,g.Fh)({quotation:l.data}))}))}rejectQuotation(t,l=""){return this._httpClient.patch(`${I}/quotations/reject`,{_id:t,rejectedReason:l,status:m.Sb.Rechazada}).pipe((0,a.M)(E=>{this.store.dispatch((0,g.Wh)({quotation:E.data})),this.store.dispatch((0,g.Fh)({quotation:E.data}))}))}deleteQuotation(t,l=0,E=20,y="createdAt",C="desc",$="",A=""){const Q=(new f.Nl).append("page",l).append("size",E).append("sort",y).append("order",C).append("search",$).append("filter",A);return this._httpClient.delete(`${I}/quotations/${t}`,{params:Q}).pipe((0,a.M)(W=>{this.store.dispatch((0,x.Bp)({pagination:W.pagination})),this.store.dispatch((0,g.gp)({quotations:W.dataArr}))}))}static#t=this.\u0275fac=function(l){return new(l||d)(F.KVO(f.Qq),F.KVO(P.y9),F.KVO(i.il))};static#e=this.\u0275prov=F.jDH({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()},55867:(L,O,n)=>{n.d(O,{Sb:()=>a,me:()=>x});var a=function(m){return m.Nueva="Nueva",m.Aceptada="Aceptada",m.Facturada="Facturada",m.Rechazada="Rechazada",m.Vencida="Vencida",m}(a||{});class x{constructor(r){this.paymentMethodId=r._id,this.name=r.name,this.merchantId=r.merchantId,this.terms=r.terms,this.paymentBy=r.paymentBy,this.includeBankAccount=r.includeBankAccount}}},94023:(L,O,n)=>{n.d(O,{B:()=>w});var f=n(21413),a=n(56977),x=n(40740),m=n(77235),r=n(82643),F=n(97586),P=n.n(F),i=n(63729),I=n(88834),h=n(99213),d=n(60177),e=n(54438),t=n(59640);const l=()=>[""],E=()=>["$"];function y(M,S){if(1&M){const _=e.RV6();e.j41(0,"div",2)(1,"button",27),e.bIt("click",function(){e.eBV(_);const R=e.XpG();return e.Njj(R.generatePDF("open"))}),e.nrm(2,"mat-icon",28),e.k0s(),e.j41(3,"button",27),e.bIt("click",function(){e.eBV(_);const R=e.XpG();return e.Njj(R.generatePDF("download"))}),e.nrm(4,"mat-icon",28),e.k0s(),e.j41(5,"button",27),e.bIt("click",function(){e.eBV(_);const R=e.XpG();return e.Njj(R.generatePDF("print"))}),e.nrm(6,"mat-icon",28),e.k0s()()}2&M&&(e.R7$(2),e.Y8G("svgIcon","heroicons_outline:eye"),e.R7$(2),e.Y8G("svgIcon","heroicons_outline:download"),e.R7$(2),e.Y8G("svgIcon","heroicons_outline:printer"))}function C(M,S){if(1&M&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&M){const _=e.XpG();e.R7$(),e.SpI(" ",_.merchantRequest.phoneNumbers[0].stateCode+" "+_.merchantRequest.phoneNumbers[0].phoneNumber,"")}}function $(M,S){if(1&M&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&M){const _=e.XpG();e.R7$(),e.JRh(_.merchantRequest.emails[0].email)}}function A(M,S){if(1&M&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&M){const _=e.XpG();e.R7$(),e.E5c("",_.selectedRequest.address,", ",_.selectedRequest.city,", ",_.selectedRequest.state,", Cuba ")}}function Q(M,S){if(1&M&&(e.j41(0,"div"),e.EFF(1),e.nI1(2,"currency"),e.k0s()),2&M){const _=S.$implicit;e.R7$(),e.Lme("",e.i5U(2,2,_.total,e.lJ4(5,l))," ",_.currency,"")}}function W(M,S){if(1&M&&(e.j41(0,"div",21),e.nrm(1,"div",22),e.j41(2,"div",29)(3,"div",30),e.EFF(4),e.k0s(),e.j41(5,"div",31),e.EFF(6),e.k0s()(),e.j41(7,"div",32),e.EFF(8),e.k0s(),e.j41(9,"div",33),e.EFF(10),e.nI1(11,"currency"),e.k0s(),e.j41(12,"div",33),e.EFF(13),e.nI1(14,"currency"),e.k0s()()),2&M){const _=S.$implicit;e.R7$(4),e.JRh(_.name),e.R7$(2),e.SpI(" ",_.description," "),e.R7$(2),e.JRh(_.amount),e.R7$(2),e.Lme("",e.i5U(11,6,_.price,e.lJ4(12,l))," ",_.currency,""),e.R7$(3),e.JRh(e.i5U(14,9,_.quantity,e.lJ4(13,E)))}}function N(M,S){if(1&M&&(e.j41(0,"div",26),e.EFF(1),e.nI1(2,"currency"),e.k0s()),2&M){const _=S.$implicit;e.R7$(),e.Lme("",e.i5U(2,2,_.total,e.lJ4(5,l))," ",_.currency,"")}}r.vfs=m.b.vfs,P().locale("es");let w=(()=>{class M{constructor(_,U){this.store=_,this._changeDetectorRef=U,this.selectedRequest$=null,this.selectedRequest=null,this.authUser=null,this.totalQuantity=[],this._unsubscribeAll=new f.B}ngOnInit(){this.store.select(i.SW).pipe((0,a.Q)(this._unsubscribeAll)).subscribe(_=>{this.authUser=_,this._changeDetectorRef.markForCheck()}),this.selectedRequest$=this.store.select(x.W9),this.selectedRequest$.pipe((0,a.Q)(this._unsubscribeAll)).subscribe(_=>{this.selectedRequest=_,this.merchantRequest=_.merchantId,this.totalQuantity=this.getTotalQuantity(_),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}generatePDF(_){const R={content:[{columns:[{columns:[this.merchantRequest.logoUrl?{image:"logo",width:60,alignment:"center",margin:[0,9,15,0]}:{},{canvas:[{type:"line",x1:0,y1:0,x2:0,y2:77,lineWidth:.1,lineColor:"#d2d6dd"}],width:1},{stack:[{text:this.merchantRequest.name,alignment:"left",fontSize:8,bold:!0},{text:`${this.merchantRequest.address}, ${this.merchantRequest.city}, ${this.merchantRequest.state}, ${this.merchantRequest.country}`,alignment:"left",fontSize:8},this.merchantRequest.phoneNumbers.length>0?{text:`${this.merchantRequest.phoneNumbers[0].stateCode}  ${this.merchantRequest.phoneNumbers[0].phoneNumber}`,alignment:"left",fontSize:8}:{},this.merchantRequest.emails.length>0?{text:`${this.merchantRequest.emails[0].email}`,alignment:"left",fontSize:8}:{},{text:this.merchantRequest.website,alignment:"left",fontSize:8}],width:150,margin:[15,2,0,0],lineHeight:1.2,alignment:"right"}],margin:[0,5,0,0]},{columns:[{stack:[{text:"SOLICITUD",alignment:"right",fontSize:16},{text:"CREADA EL",alignment:"right",margin:[0,4,0,0],fontSize:9},{text:"ESTADO",alignment:"right",margin:[0,4,0,0],fontSize:9},{text:"IMPORTE TOTAL",alignment:"right",margin:[0,4,0,0],fontSize:9}],width:100,color:"#7b838e"},{stack:[{text:this.selectedRequest.no,alignment:"left",fontSize:16,margin:[0,0,0,0],bold:!0},{text:P()(this.selectedRequest.createdAt).format("L"),alignment:"left",bold:!0,opacity:.7,margin:[0,4,0,0],fontSize:9},{text:this.selectedRequest.status.toUpperCase(),alignment:"left",bold:!0,opacity:.7,margin:[0,4,0,0],fontSize:9},...this.totalQuantity.map(j=>[{stack:[{text:`${j.total.toFixed(2)} ${j.currency}`,alignment:"left",bold:!0,opacity:.7,fontSize:9}],margin:[0,4,0,0]}])]}],columnGap:10}],margin:[16,0,0,15]},{columns:[{text:"Por",alignment:"center",color:"#7b838e",width:60,fontSize:14,margin:[0,this.selectedRequest.address?17:7,20,0]},{canvas:[{type:"line",x1:0,y1:0,x2:0,y2:this.selectedRequest.address?56:33,lineWidth:.1,lineColor:"#d2d6dd"}],width:1},{stack:[{text:`${this.selectedRequest.name}  ${this.selectedRequest.lastname}`,alignment:"left",fontSize:8,bold:!0,opacity:.8},this.selectedRequest.address?{text:`${this.selectedRequest.address}, ${this.selectedRequest.city}, ${this.selectedRequest.state}, Cuba`,alignment:"left",lineHeight:1.2,fontSize:8}:{},{text:`${this.selectedRequest.phoneNumber.stateCode} ${this.selectedRequest.phoneNumber.phoneNumber}`,alignment:"left",lineHeight:1.2,fontSize:8},{text:this.selectedRequest.email,alignment:"left",lineHeight:1.2,fontSize:8}],lineHeight:1.2,width:150,margin:[15,0,0,0]}],margin:[16,16,0,5]},{columns:[{text:"PRODUCTO O SERVICIO",color:"#64748B",alignment:"left",fontSize:8,width:350},{text:"CANTIDAD",color:"#64748B",alignment:"center",fontSize:8,width:40},{text:"PRECIO",color:"#64748B",alignment:"right",fontSize:8,width:70},{text:"TOTAL",color:"#64748B",alignment:"right",fontSize:8}],margin:[0,35,0,4]},{canvas:[{type:"line",x1:0,y1:0,x2:535,y2:0,lineWidth:.1,lineColor:"#d2d6dd"}]},...this.selectedRequest.goodsData.map(j=>[{stack:[{columns:[{stack:[{text:j.name,alignment:"left",fontSize:9,bold:!0,opacity:.7},{text:j.description,alignment:"left",fontSize:7,bold:!0,color:"#64748B",opacity:.7}],lineHeight:1.5,width:350},{stack:[{columns:[{text:j.amount,alignment:"center",fontSize:9,width:40},{text:`${j.price.toFixed(2)} ${j.currency}`,alignment:"right",fontSize:9,width:70},{text:`$${j.quantity.toFixed(2)}`,alignment:"right",fontSize:9}],margin:j.description?[0,7,0,0]:[0,0,0,0]}]}],margin:[0,4,0,2]},{canvas:[{type:"line",x1:0,y1:0,x2:535,y2:0,lineWidth:.1,lineColor:"#d2d6dd"}]}]}]),{columns:[{text:"Total",alignment:"left",fontSize:12,color:"#7b838e"},{stack:[...this.totalQuantity.map(j=>[{stack:[{text:`${j.total.toFixed(2)} ${j.currency}`,alignment:"right",bold:!0,opacity:.7,fontSize:12}]}])]}],margin:[0,35,0,0]}],footer:(j,z,q)=>[z>1?{text:j.toString()+" de "+z,alignment:"center",margin:[0,30,0,0]}:{text:"",alignment:"center"},{canvas:[{type:"rect",x:170,y:32,w:q.width-170,h:40}],margin:[0,30,0,0]}],defaultStyle:{fontSize:12},pageOrientation:"portrait",pageSize:"LETTER",pageMargins:[40,40,40,80],info:{title:"Solicitud",author:"",subject:"",creationDate:new Date},images:{logo:this.merchantRequest.logoUrl}};switch(_){case _="download":r.createPdf(R).download();break;case _="open":r.createPdf(R).open();break;case _="print":r.createPdf(R).print()}}getTotalQuantity(_){return _.goodsData.reduce((U,{currency:R})=>{if(!U.some(j=>j.currency===R)){const j=_.goodsData.filter(z=>z.currency===R).map(z=>z.quantity).reduce((z,q)=>z+q,0);U.push({currency:R,total:j})}return U},[])}static#t=this.\u0275fac=function(U){return new(U||M)(e.rXU(t.il),e.rXU(e.gRc))};static#e=this.\u0275cmp=e.VBU({type:M,selectors:[["request-details"]],standalone:!0,features:[e.aNF],decls:65,vars:21,consts:[["cdkScrollable","",1,"flex","w-full","md:justify-center","print:overflow-visible"],[1,"inline-block","p-6","text-left","sm:p-10","print:p-0"],[1,"flex","items-center","justify-end","flex-shrink-0","mt-6","md:mt-0","sm:ml-4","gap-x-4"],[1,"p-16","shadow","w-240","min-w-240","rounded-2xl","bg-card","print:w-auto","print:p-0","print:rounded-none","print:shadow-none","print:bg-transparent"],[1,"flex","items-start","overflow-hidden"],[1,"grid","w-6/12","grid-rows-2","overflow-hidden","place-items-start","gap-y-12"],[1,"grid","w-full","overflow-hidden","gap-x-8",2,"grid-template-columns","96px auto !important"],[1,"w-24","place-self-center"],[1,"w-24",3,"src"],[1,"pl-10","overflow-auto","border-l","text-md","break-word"],[1,"font-medium"],[1,"grid","gap-x-8",2,"grid-template-columns","96px auto !important"],[1,"w-24","text-2xl","text-center","place-self-center","text-secondary"],[1,"grid","ml-auto","gap-x-4","gap-y-1",2,"grid-template-columns","123px auto !important"],[1,"text-3xl","tracking-tight","justify-self-end","text-secondary"],[1,"flex","items-center","text-2xl","font-medium"],[1,"font-medium","tracking-tight","justify-self-end","text-secondary"],[1,"grid","grid-cols-12","mt-8","gap-x-1"],[1,"col-span-6","font-medium","text-md","text-secondary"],[1,"col-span-2","pl-10","font-medium","text-center","text-md","text-secondary"],[1,"col-span-2","font-medium","text-right","text-md","text-secondary"],[1,"grid","grid-cols-12","col-span-12","gap-x-1"],[1,"col-span-12","my-4","border-b"],[1,"col-span-12","mt-16"],[1,"col-span-4","text-2xl","font-medium","tracking-tight","text-secondary"],[1,"flex","flex-col","justify-end","col-span-8","text-2xl","font-medium","text-right"],[1,"col-span-2"],["mat-button","",1,"rounded-full",3,"click"],[1,"text-primary-700",3,"svgIcon"],[1,"col-span-6"],[1,"text-lg","font-medium"],[1,"mt-2","whitespace-pre-line","text-md","text-secondary"],[1,"self-center","col-span-2","pl-10","text-center"],[1,"self-center","col-span-2","text-right"]],template:function(U,R){1&U&&(e.j41(0,"div",0)(1,"div",1),e.DNE(2,y,7,3,"div",2),e.j41(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),e.nrm(8,"img",8),e.k0s(),e.j41(9,"div",9)(10,"div",10),e.EFF(11),e.k0s(),e.j41(12,"div"),e.EFF(13),e.k0s(),e.DNE(14,C,2,1,"div")(15,$,2,1,"div"),e.k0s()(),e.j41(16,"div",11)(17,"div",12),e.EFF(18," Por "),e.k0s(),e.j41(19,"div",9)(20,"div",10),e.EFF(21),e.k0s(),e.nrm(22,"div"),e.DNE(23,A,2,3,"div"),e.j41(24,"div"),e.EFF(25),e.k0s(),e.j41(26,"div"),e.EFF(27),e.k0s()()()(),e.j41(28,"div",13)(29,"div",14),e.EFF(30,"SOLICITUD"),e.k0s(),e.j41(31,"div",15),e.EFF(32),e.k0s(),e.j41(33,"div",16),e.EFF(34,"CREADA EL"),e.k0s(),e.j41(35,"div",10),e.EFF(36),e.nI1(37,"date"),e.k0s(),e.j41(38,"div",16),e.EFF(39,"ESTADO"),e.k0s(),e.j41(40,"div",10),e.EFF(41),e.k0s(),e.j41(42,"div",16),e.EFF(43,"IMPORTE TOTAL"),e.k0s(),e.j41(44,"div",10),e.Z7z(45,Q,3,6,"div",null,e.fX1),e.k0s()()(),e.j41(47,"div",17)(48,"div",18),e.EFF(49,"PRODUCTO O SERVICIO"),e.k0s(),e.j41(50,"div",19),e.EFF(51,"CANTIDAD"),e.k0s(),e.j41(52,"div",20),e.EFF(53,"PRECIO"),e.k0s(),e.j41(54,"div",20),e.EFF(55,"TOTAL"),e.k0s(),e.Z7z(56,W,15,14,"div",21,e.fX1),e.nrm(58,"div",22)(59,"div",23),e.j41(60,"div",24),e.EFF(61,"TOTAL"),e.k0s(),e.j41(62,"div",25),e.Z7z(63,N,3,6,"div",26,e.fX1),e.k0s()()()()()),2&U&&(e.R7$(2),e.vxM(2,R.authUser?-1:2),e.R7$(6),e.Y8G("src",R.merchantRequest.logoUrl,e.B4B),e.R7$(3),e.JRh(R.merchantRequest.name),e.R7$(2),e.LHq("",R.merchantRequest.address,", ",R.merchantRequest.city,", ",R.merchantRequest.state,", ",R.merchantRequest.country," "),e.R7$(),e.vxM(14,R.merchantRequest.phoneNumbers.length>0?14:-1),e.R7$(),e.vxM(15,R.merchantRequest.emails.length>0?15:-1),e.R7$(6),e.Lme("",R.selectedRequest.name," ",R.selectedRequest.lastname,""),e.R7$(2),e.vxM(23,R.selectedRequest.address?23:-1),e.R7$(2),e.Lme("",R.selectedRequest.phoneNumber.stateCode," ",R.selectedRequest.phoneNumber.phoneNumber,""),e.R7$(2),e.JRh(R.selectedRequest.email),e.R7$(5),e.SpI("#",R.selectedRequest.no,""),e.R7$(4),e.JRh(e.i5U(37,18,R.selectedRequest.createdAt,"dd/MM/yyyy")),e.R7$(5),e.JRh(R.selectedRequest.status.toUpperCase()),e.R7$(4),e.Dyx(R.totalQuantity),e.R7$(11),e.Dyx(R.selectedRequest.goodsData),e.R7$(7),e.Dyx(R.totalQuantity))},dependencies:[d.oe,d.vh,I.Hl,I.$z,h.m_,h.An],encapsulation:2,changeDetection:0})}return M})()},48874:(L,O,n)=>{n.d(O,{K:()=>I,R:()=>i});var f=n(27468),a=n(18810),x=n(99437),m=n(96354),r=n(54438),g=n(22949),F=n(62621),P=n(51188);let i=(()=>{class h{constructor(e,t){this._requestsService=e,this._paymentMethods=t}resolve(e,t){return(0,f.p)([this._requestsService.getRequests(),this._paymentMethods.getActivePaymentConditions()])}static#t=this.\u0275fac=function(t){return new(t||h)(r.KVO(g.k),r.KVO(F.W))};static#e=this.\u0275prov=r.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})(),I=(()=>{class h{constructor(e,t){this._requestsService=e,this._router=t}resolve(e,t){return this._requestsService.getRequestById(e.params.requestId).pipe((0,x.W)(E=>{console.error(E);const y=t.url.split("/").slice(0,-1).join("/");return this._router.navigateByUrl(y),(0,a.$)(E)}),(0,m.T)(E=>{if(!E.ok){let y=t.url.split("/").slice(0,-1).join("/");t.url.includes("public")&&(y=t.url.split("/").slice(0,-2).join("/")),this._router.navigateByUrl(y)}}))}static#t=this.\u0275fac=function(t){return new(t||h)(r.KVO(g.k),r.KVO(P.Ix))};static#e=this.\u0275prov=r.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()},40740:(L,O,n)=>{n.d(O,{W9:()=>x,lz:()=>m});var f=n(59640);const a=r=>r.requests,x=(0,f.Mz)(a,r=>r.request),m=(0,f.Mz)(a,r=>r.requests)},22949:(L,O,n)=>{n.d(O,{k:()=>h});var f=n(21626),a=n(88141),x=n(98216),m=n(42835),r=n(45312),g=n(91013),F=n(54438),P=n(82341),i=n(59640);const I=r.c.API_URL;let h=(()=>{class d{constructor(t,l,E){this._httpClient=t,this.rolesService=l,this.store=E}getRequests(t=0,l=20,E="createdAt",y="desc",C="",$=""){const A=(new f.Nl).append("page",t).append("size",l).append("sort",E).append("order",y).append("search",C).append("filter",$);return this._httpClient.get(`${I}/requests/`,{params:A}).pipe((0,a.M)(Q=>{this.store.dispatch((0,x.Bp)({pagination:Q.pagination})),this.store.dispatch((0,g.Zg)({requests:Q.dataArr}))}))}getRequestById(t){return this._httpClient.get(`${I}/requests/${t}`).pipe((0,a.M)(l=>{this.store.dispatch((0,g.Id)({request:l.data}))}))}createRequest(t){return this._httpClient.post(`${I}/requests`,t).pipe((0,a.M)(l=>{this.store.dispatch((0,g.WL)({request:l.data}))}))}updateRequest(t){return this._httpClient.patch(`${I}/requests/${t._id}`,t).pipe((0,a.M)(l=>{this.store.dispatch((0,g.H5)({request:l.data}))}))}rejectRequest(t,l){return this._httpClient.patch(`${I}/requests/reject`,{_id:t,rejectedReason:l,status:m.FI.Rechazada}).pipe((0,a.M)(E=>{this.store.dispatch((0,g.H5)({request:E.data}))}))}deleteRequest(t,l=0,E=20,y="createdAt",C="desc",$="",A=""){const Q=(new f.Nl).append("page",l).append("size",E).append("sort",y).append("order",C).append("search",$).append("filter",A);return this._httpClient.delete(`${I}/requests/${t}`,{params:Q}).pipe((0,a.M)(W=>{this.store.dispatch((0,x.Bp)({pagination:W.pagination})),this.store.dispatch((0,g.Zg)({requests:W.dataArr}))}))}static#t=this.\u0275fac=function(l){return new(l||d)(F.KVO(f.Qq),F.KVO(P.y9),F.KVO(i.il))};static#e=this.\u0275prov=F.jDH({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()},42835:(L,O,n)=>{n.d(O,{FI:()=>a});var a=function(m){return m.Nueva="Nueva",m.Aceptada="Aceptada",m.Rechazada="Rechazada",m}(a||{})},53440:(L,O,n)=>{n.d(O,{s:()=>e});var f=n(60177),a=n(89417),x=n(88834),m=n(75351),r=n(32102),g=n(99213),F=n(59042),P=n(87122),i=n(54438);const I=t=>({"cursor-not-allowed":t});function h(t,l){1&t&&(i.j41(0,"mat-error"),i.EFF(1," EL motivo del rechazo es obligatorio "),i.k0s())}function d(t,l){1&t&&(i.j41(0,"mat-error"),i.EFF(1," EL motivo del rechazo debe contener entre 3 y 1000 caracteres. "),i.k0s())}let e=(()=>{class t{constructor(E,y){this.data=E,this._dialogRef=y,this.rejectControl=new a.MJ(""),this.rejectedReasonRequired=!0,this.rejectedReasonRequired=E.rejectedReasonRequired}ngOnInit(){this.rejectControl.setValidators(this.rejectedReasonRequired?[a.k0.required,a.k0.minLength(3),a.k0.maxLength(1e3)]:[a.k0.minLength(3),a.k0.maxLength(1e3)]),this.rejectControl.setValue(this.data.rejectedReason)}accept(){this._dialogRef.close({reason:this.rejectControl.value})}cancel(){this._dialogRef.close()}static#t=this.\u0275fac=function(y){return new(y||t)(i.rXU(m.Vh),i.rXU(m.CP))};static#e=this.\u0275cmp=i.VBU({type:t,selectors:[["commercial-reject-confirm-dialog"]],standalone:!0,features:[i.aNF],decls:28,vars:15,consts:[[1,"h-full","ng-star-inserted"],[1,"relative","flex","flex-col","w-full","h-full"],[1,"flex","items-center","h-full"],[1,"block","w-full"],[1,"flex","flex-col","items-center","flex-auto","p-8","pb-4","sm:flex-row","sm:items-start","sm:pb-6"],["ng-reflect-ng-class","[object Object]",1,"flex","items-center","justify-center","w-10","h-10","text-blue-600","bg-blue-100","rounded-full","flex-0","sm:mr-4","dark:text-blue-50","dark:bg-blue-600","ng-star-inserted"],["role","img","aria-hidden","true","ng-reflect-svg-icon","heroicons_outline:question-mar","data-mat-icon-type","svg","data-mat-icon-name","question-mark-circle","data-mat-icon-namespace","heroicons_outline",1,"text-current","mat-icon","notranslate","mat-icon-no-color"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","fit","","height","100%","width","100%","preserveAspectRatio","xMidYMid meet","focusable","false"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex","flex-col","items-center","mt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left","ng-star-inserted"],[1,"text-xl","font-medium","leading-6","ng-star-inserted"],[1,"text-secondary","ng-star-inserted"],[1,"pb-6","pl-8","pr-8","mt-10","sm:mt-0","sm:pl-22",3,"autocomplete"],[1,"w-full","fuse-mat-textarea"],["matPrefix","","svgIcon","mat_solid:subject",1,"hidden","sm:flex","icon-size-5"],["matInput","",3,"formControl","placeholder","minLength","maxLength","required"],[1,"flex","flex-wrap","justify-center","px-6","py-4","space-x-3","tems-center","md:justify-end","bg-gray-50","dark:bg-black/10","ng-star-inserted"],["mat-stroked-button","",3,"click"],["mat-flat-button","","mat-button","",3,"click","color","disabled","ngClass"]],template:function(y,C){1&y&&(i.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"mat-icon",6),i.qSk(),i.j41(7,"svg",7),i.nrm(8,"path",8),i.k0s()()(),i.joV(),i.j41(9,"div",9)(10,"div",10),i.EFF(11),i.k0s(),i.j41(12,"div",11),i.EFF(13),i.k0s()()(),i.j41(14,"form",12)(15,"div")(16,"mat-form-field",13)(17,"mat-label"),i.EFF(18,"Motivo"),i.k0s(),i.nrm(19,"mat-icon",14)(20,"textarea",15),i.DNE(21,h,2,0,"mat-error")(22,d,2,0,"mat-error"),i.k0s()()()()(),i.j41(23,"div",16)(24,"button",17),i.bIt("click",function(){return C.cancel()}),i.EFF(25,"Cancelar"),i.k0s(),i.j41(26,"button",18),i.bIt("click",function(){return C.accept()}),i.EFF(27," Aceptar "),i.k0s()()()()),2&y&&(i.R7$(11),i.JRh(C.data.title),i.R7$(2),i.JRh(C.data.message),i.R7$(),i.Y8G("autocomplete","off"),i.R7$(6),i.Y8G("formControl",C.rejectControl)("placeholder","Escriba el motivo del rechazo")("minLength",3)("maxLength",1e3)("required",C.rejectedReasonRequired),i.R7$(),i.vxM(21,C.rejectControl.hasError("required")?21:-1),i.R7$(),i.vxM(22,C.rejectControl.hasError("maxlength")||C.rejectControl.hasError("minlength")?22:-1),i.R7$(4),i.Y8G("color","primary")("disabled",C.rejectControl.invalid)("ngClass",i.eq3(13,I,C.rejectControl.invalid)))},dependencies:[m.hM,r.RG,r.rl,r.nJ,r.TL,r.JW,F.fS,F.fg,g.m_,g.An,x.Hl,x.$z,f.YU,a.X1,a.qT,a.me,a.BC,a.cb,a.YS,a.l_],encapsulation:2,data:{animation:P.X},changeDetection:0})}return t})()}}]);