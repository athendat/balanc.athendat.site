"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[5946],{5946:(St,$,m)=>{m.d($,{M:()=>vt});var a=m(54438),E=m(21626),P=m(7673),K=m(92771),J=m(96697),Z=m(25558),q=m(45312),j=m(95416),k=m(94794),w=m(75351),_=m(10467),B=m(345),tt=m(56977),et=m(61594),H=m(57786),R=m(33726),W=m(60177);const it=["wrapper"],at=["sourceImage"];function rt(s,h){if(1&s){const t=a.RV6();a.j41(0,"img",5,1),a.bIt("load",function(){a.eBV(t);const i=a.XpG();return a.Njj(i.imageLoadedInView())})("mousedown",function(i){a.eBV(t);const r=a.XpG();return a.Njj(r.startMove(i,r.moveTypes.Drag))})("touchstart",function(i){a.eBV(t);const r=a.XpG();return a.Njj(r.startMove(i,r.moveTypes.Drag))})("error",function(i){a.eBV(t);const r=a.XpG();return a.Njj(r.loadImageError(i))}),a.k0s()}if(2&s){const t=a.XpG();a.xc7("visibility",t.imageVisible?"visible":"hidden")("transform",t.safeTransformStyle),a.AVh("ngx-ic-draggable",!t.disabled&&t.allowMoveImage),a.Y8G("src",t.safeImgDataUrl,a.B4B),a.BMQ("alt",t.imageAltText)}}function nt(s,h){if(1&s){const t=a.RV6();a.qex(0),a.j41(1,"span",9),a.bIt("mousedown",function(i){a.eBV(t);const r=a.XpG(2);return a.Njj(r.startMove(i,r.moveTypes.Resize,"topleft"))})("touchstart",function(i){a.eBV(t);const r=a.XpG(2);return a.Njj(r.startMove(i,r.moveTypes.Resize,"topleft"))}),a.nrm(2,"span",10),a.k0s(),a.j41(3,"span",11),a.nrm(4,"span",10),a.k0s(),a.j41(5,"span",12),a.bIt("mousedown",function(i){a.eBV(t);const r=a.XpG(2);return a.Njj(r.startMove(i,r.moveTypes.Resize,"topright"))})("touchstart",function(i){a.eBV(t);const r=a.XpG(2);return a.Njj(r.startMove(i,r.moveTypes.Resize,"topright"))}),a.nrm(6,"span",10),a.k0s(),a.j41(7,"span",13),a.nrm(8,"span",10),a.k0s(),a.j41(9,"span",14),a.bIt("mousedown",function(i){a.eBV(t);const r=a.XpG(2);return a.Njj(r.startMove(i,r.moveTypes.Resize,"bottomright"))})("touchstart",function(i){a.eBV(t);const r=a.XpG(2);return a.Njj(r.startMove(i,r.moveTypes.Resize,"bottomright"))}),a.nrm(10,"span",10),a.k0s(),a.j41(11,"span",15),a.nrm(12,"span",10),a.k0s(),a.j41(13,"span",16),a.bIt("mousedown",function(i){a.eBV(t);const r=a.XpG(2);return a.Njj(r.startMove(i,r.moveTypes.Resize,"bottomleft"))})("touchstart",function(i){a.eBV(t);const r=a.XpG(2);return a.Njj(r.startMove(i,r.moveTypes.Resize,"bottomleft"))}),a.nrm(14,"span",10),a.k0s(),a.j41(15,"span",17),a.nrm(16,"span",10),a.k0s(),a.j41(17,"span",18),a.bIt("mousedown",function(i){a.eBV(t);const r=a.XpG(2);return a.Njj(r.startMove(i,r.moveTypes.Resize,"top"))})("touchstart",function(i){a.eBV(t);const r=a.XpG(2);return a.Njj(r.startMove(i,r.moveTypes.Resize,"top"))}),a.k0s(),a.j41(18,"span",19),a.bIt("mousedown",function(i){a.eBV(t);const r=a.XpG(2);return a.Njj(r.startMove(i,r.moveTypes.Resize,"right"))})("touchstart",function(i){a.eBV(t);const r=a.XpG(2);return a.Njj(r.startMove(i,r.moveTypes.Resize,"right"))}),a.k0s(),a.j41(19,"span",20),a.bIt("mousedown",function(i){a.eBV(t);const r=a.XpG(2);return a.Njj(r.startMove(i,r.moveTypes.Resize,"bottom"))})("touchstart",function(i){a.eBV(t);const r=a.XpG(2);return a.Njj(r.startMove(i,r.moveTypes.Resize,"bottom"))}),a.k0s(),a.j41(20,"span",21),a.bIt("mousedown",function(i){a.eBV(t);const r=a.XpG(2);return a.Njj(r.startMove(i,r.moveTypes.Resize,"left"))})("touchstart",function(i){a.eBV(t);const r=a.XpG(2);return a.Njj(r.startMove(i,r.moveTypes.Resize,"left"))}),a.k0s(),a.bVm()}}function ot(s,h){if(1&s){const t=a.RV6();a.j41(0,"div",6),a.bIt("keydown",function(i){a.eBV(t);const r=a.XpG();return a.Njj(r.keyboardAccess(i))}),a.j41(1,"div",7),a.bIt("mousedown",function(i){a.eBV(t);const r=a.XpG();return a.Njj(r.startMove(i,r.moveTypes.Move))})("touchstart",function(i){a.eBV(t);const r=a.XpG();return a.Njj(r.startMove(i,r.moveTypes.Move))}),a.k0s(),a.DNE(2,nt,21,0,"ng-container",8),a.k0s()}if(2&s){const t=a.XpG();a.xc7("top",t.cropper.y1,"px")("left",t.cropper.x1,"px")("width",t.cropper.x2-t.cropper.x1,"px")("height",t.cropper.y2-t.cropper.y1,"px")("margin-left","center"===t.alignImage?t.marginLeft:null)("visibility",t.imageVisible?"visible":"hidden"),a.AVh("ngx-ic-round",t.roundCropper),a.BMQ("aria-label",t.cropperFrameAriaLabel),a.R7$(2),a.Y8G("ngIf",!t.hideResizeSquares)}}class st{constructor(){this.format="png",this.output="blob",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperFrameAriaLabel="Crop photo",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(h){Object.keys(h).filter(t=>t in this).forEach(t=>this[t]=h[t]),this.validateOptions()}setOptionsFromChanges(h){Object.keys(h).filter(t=>t in this).forEach(t=>this[t]=h[t].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}var u=function(s){return s.Drag="drag",s.Move="move",s.Resize="resize",s.Pinch="pinch",s}(u||{});function F(s,h){return s/100*h}let gt=(()=>{class s{crop(t,e,i,r,n){const o=this.getImagePosition(t,e,i,n),c=o.x2-o.x1,p=o.y2-o.y1,l=document.createElement("canvas");l.width=c,l.height=p;const g=l.getContext("2d");if(!g)return null;null!=i.backgroundColor&&(g.fillStyle=i.backgroundColor,g.fillRect(0,0,c,p));const d=(i.transform.scale||1)*(i.transform.flipH?-1:1),x=(i.transform.scale||1)*(i.transform.flipV?-1:1),{translateH:M,translateV:A}=this.getCanvasTranslate(t,i,n),y=t.transformed;g.setTransform(d,0,0,x,y.size.width/2+M,y.size.height/2+A),g.translate(-o.x1/d,-o.y1/x),g.rotate((i.transform.rotate||0)*Math.PI/180),g.drawImage(y.image,-y.size.width/2,-y.size.height/2);const C={width:c,height:p,imagePosition:o,cropperPosition:{...e}};i.containWithinAspectRatio&&(C.offsetImagePosition=this.getOffsetImagePosition(t,e,i,n));const f=this.getResizeRatio(c,p,i);return 1!==f&&(C.width=Math.round(c*f),C.height=i.maintainAspectRatio?Math.round(C.width/i.aspectRatio):Math.round(p*f),function lt(s,h,t){const e=s.width,i=s.height,r=e/(h=Math.round(h)),n=i/(t=Math.round(t)),o=Math.ceil(r/2),c=Math.ceil(n/2),p=s.getContext("2d");if(p){const l=p.getImageData(0,0,e,i),g=p.createImageData(h,t),d=l.data,x=g.data;for(let M=0;M<t;M++)for(let A=0;A<h;A++){const y=4*(A+M*h),C=M*n;let f=0,I=0,Q=0,X=0,L=0,V=0,G=0;const bt=Math.floor(A*r),wt=Math.floor(M*n);let T=Math.ceil((A+1)*r),O=Math.ceil((M+1)*n);T=Math.min(T,e),O=Math.min(O,i);for(let S=wt;S<O;S++){const Y=Math.abs(C-S)/c,Rt=A*r,It=Y*Y;for(let z=bt;z<T;z++){const N=Math.abs(Rt-z)/o,v=Math.sqrt(It+N*N);if(v>=1)continue;f=2*v*v*v-3*v*v+1;const b=4*(z+S*e);G+=f*d[b+3],Q+=f,d[b+3]<255&&(f=f*d[b+3]/250),X+=f*d[b],L+=f*d[b+1],V+=f*d[b+2],I+=f}}x[y]=X/I,x[y+1]=L/I,x[y+2]=V/I,x[y+3]=G/Q}s.width=h,s.height=t,p.putImageData(g,0,0)}}(l,C.width,C.height)),"blob"===r?this.cropToBlob(C,l,i):(C.base64=l.toDataURL("image/"+i.format,this.getQuality(i)),C)}cropToBlob(t,e,i){var r=this;return(0,_.A)(function*(){return t.blob=yield new Promise(n=>e.toBlob(n,"image/"+i.format,r.getQuality(i))),t.blob&&(t.objectUrl=URL.createObjectURL(t.blob)),t})()}getCanvasTranslate(t,e,i){if("px"===e.transform.translateUnit){const r=this.getRatio(t,i);return{translateH:(e.transform.translateH||0)*r,translateV:(e.transform.translateV||0)*r}}return{translateH:e.transform.translateH?F(e.transform.translateH,t.transformed.size.width):0,translateV:e.transform.translateV?F(e.transform.translateV,t.transformed.size.height):0}}getRatio(t,e){return t.transformed.size.width/e.width}getImagePosition(t,e,i,r){const n=this.getRatio(t,r),o={x1:Math.round(e.x1*n),y1:Math.round(e.y1*n),x2:Math.round(e.x2*n),y2:Math.round(e.y2*n)};return i.containWithinAspectRatio||(o.x1=Math.max(o.x1,0),o.y1=Math.max(o.y1,0),o.x2=Math.min(o.x2,t.transformed.size.width),o.y2=Math.min(o.y2,t.transformed.size.height)),o}getOffsetImagePosition(t,e,i,r){const n=i.canvasRotation+t.exifTransform.rotate,o=this.getRatio(t,r);let c,p;n%2?(c=(t.transformed.size.width-t.original.size.height)/2,p=(t.transformed.size.height-t.original.size.width)/2):(c=(t.transformed.size.width-t.original.size.width)/2,p=(t.transformed.size.height-t.original.size.height)/2);const l={x1:Math.round(e.x1*o)-c,y1:Math.round(e.y1*o)-p,x2:Math.round(e.x2*o)-c,y2:Math.round(e.y2*o)-p};return i.containWithinAspectRatio||(l.x1=Math.max(l.x1,0),l.y1=Math.max(l.y1,0),l.x2=Math.min(l.x2,t.transformed.size.width),l.y2=Math.min(l.y2,t.transformed.size.height)),l}getResizeRatio(t,e,i){const r=i.resizeToWidth/t,n=i.resizeToHeight/e,o=new Array;i.resizeToWidth>0&&o.push(r),i.resizeToHeight>0&&o.push(n);const c=0===o.length?1:Math.min(...o);return c>1&&!i.onlyScaleDown?c:Math.min(c,1)}getQuality(t){return Math.min(1,Math.max(0,t.imageQuality/100))}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=a.jDH({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),mt=(()=>{class s{resetCropperPosition(t,e,i,r){if(t?.nativeElement)if(i.cropperStaticHeight&&i.cropperStaticWidth)e.x1=0,e.x2=r.width>i.cropperStaticWidth?i.cropperStaticWidth:r.width,e.y1=0,e.y2=r.height>i.cropperStaticHeight?i.cropperStaticHeight:r.height;else{const n=Math.min(i.cropperScaledMaxWidth,r.width),o=Math.min(i.cropperScaledMaxHeight,r.height);if(i.maintainAspectRatio)if(r.width/i.aspectRatio<r.height){e.x1=0,e.x2=n;const c=n/i.aspectRatio;e.y1=(r.height-c)/2,e.y2=e.y1+c}else{e.y1=0,e.y2=o;const c=o*i.aspectRatio;e.x1=(r.width-c)/2,e.x2=e.x1+c}else e.x1=0,e.x2=n,e.y1=0,e.y2=o}}move(t,e,i){const r=this.getClientX(t)-e.clientX,n=this.getClientY(t)-e.clientY;i.x1=e.x1+r,i.y1=e.y1+n,i.x2=e.x2+r,i.y2=e.y2+n}resize(t,e,i,r,n){const o=this.getClientX(t)-e.clientX,c=this.getClientY(t)-e.clientY;switch(e.position){case"left":i.x1=Math.min(Math.max(e.x1+o,i.x2-n.cropperScaledMaxWidth),i.x2-n.cropperScaledMinWidth);break;case"topleft":i.x1=Math.min(Math.max(e.x1+o,i.x2-n.cropperScaledMaxWidth),i.x2-n.cropperScaledMinWidth),i.y1=Math.min(Math.max(e.y1+c,i.y2-n.cropperScaledMaxHeight),i.y2-n.cropperScaledMinHeight);break;case"top":i.y1=Math.min(Math.max(e.y1+c,i.y2-n.cropperScaledMaxHeight),i.y2-n.cropperScaledMinHeight);break;case"topright":i.x2=Math.max(Math.min(e.x2+o,i.x1+n.cropperScaledMaxWidth),i.x1+n.cropperScaledMinWidth),i.y1=Math.min(Math.max(e.y1+c,i.y2-n.cropperScaledMaxHeight),i.y2-n.cropperScaledMinHeight);break;case"right":i.x2=Math.max(Math.min(e.x2+o,i.x1+n.cropperScaledMaxWidth),i.x1+n.cropperScaledMinWidth);break;case"bottomright":i.x2=Math.max(Math.min(e.x2+o,i.x1+n.cropperScaledMaxWidth),i.x1+n.cropperScaledMinWidth),i.y2=Math.max(Math.min(e.y2+c,i.y1+n.cropperScaledMaxHeight),i.y1+n.cropperScaledMinHeight);break;case"bottom":i.y2=Math.max(Math.min(e.y2+c,i.y1+n.cropperScaledMaxHeight),i.y1+n.cropperScaledMinHeight);break;case"bottomleft":i.x1=Math.min(Math.max(e.x1+o,i.x2-n.cropperScaledMaxWidth),i.x2-n.cropperScaledMinWidth),i.y2=Math.max(Math.min(e.y2+c,i.y1+n.cropperScaledMaxHeight),i.y1+n.cropperScaledMinHeight);break;case"center":const p=t.scale,l=Math.min(Math.max(n.cropperScaledMinWidth,Math.abs(e.x2-e.x1)*p),n.cropperScaledMaxWidth),g=Math.min(Math.max(n.cropperScaledMinHeight,Math.abs(e.y2-e.y1)*p),n.cropperScaledMaxHeight);i.x1=e.clientX-l/2,i.x2=e.clientX+l/2,i.y1=e.clientY-g/2,i.y2=e.clientY+g/2,i.x1<0?(i.x2-=i.x1,i.x1=0):i.x2>r.width&&(i.x1-=i.x2-r.width,i.x2=r.width),i.y1<0?(i.y2-=i.y1,i.y1=0):i.y2>r.height&&(i.y1-=i.y2-r.height,i.y2=r.height)}n.maintainAspectRatio&&this.checkAspectRatio(e.position,i,r,n)}checkAspectRatio(t,e,i,r){let n=0,o=0;switch(t){case"top":e.x2=e.x1+(e.y2-e.y1)*r.aspectRatio,n=Math.max(e.x2-i.width,0),o=Math.max(0-e.y1,0),(n>0||o>0)&&(e.x2-=o*r.aspectRatio>n?o*r.aspectRatio:n,e.y1+=o*r.aspectRatio>n?o:n/r.aspectRatio);break;case"bottom":e.x2=e.x1+(e.y2-e.y1)*r.aspectRatio,n=Math.max(e.x2-i.width,0),o=Math.max(e.y2-i.height,0),(n>0||o>0)&&(e.x2-=o*r.aspectRatio>n?o*r.aspectRatio:n,e.y2-=o*r.aspectRatio>n?o:n/r.aspectRatio);break;case"topleft":e.y1=e.y2-(e.x2-e.x1)/r.aspectRatio,n=Math.max(0-e.x1,0),o=Math.max(0-e.y1,0),(n>0||o>0)&&(e.x1+=o*r.aspectRatio>n?o*r.aspectRatio:n,e.y1+=o*r.aspectRatio>n?o:n/r.aspectRatio);break;case"topright":e.y1=e.y2-(e.x2-e.x1)/r.aspectRatio,n=Math.max(e.x2-i.width,0),o=Math.max(0-e.y1,0),(n>0||o>0)&&(e.x2-=o*r.aspectRatio>n?o*r.aspectRatio:n,e.y1+=o*r.aspectRatio>n?o:n/r.aspectRatio);break;case"right":case"bottomright":e.y2=e.y1+(e.x2-e.x1)/r.aspectRatio,n=Math.max(e.x2-i.width,0),o=Math.max(e.y2-i.height,0),(n>0||o>0)&&(e.x2-=o*r.aspectRatio>n?o*r.aspectRatio:n,e.y2-=o*r.aspectRatio>n?o:n/r.aspectRatio);break;case"left":case"bottomleft":e.y2=e.y1+(e.x2-e.x1)/r.aspectRatio,n=Math.max(0-e.x1,0),o=Math.max(e.y2-i.height,0),(n>0||o>0)&&(e.x1+=o*r.aspectRatio>n?o*r.aspectRatio:n,e.y2-=o*r.aspectRatio>n?o:n/r.aspectRatio);break;case"center":e.x2=e.x1+(e.y2-e.y1)*r.aspectRatio,e.y2=e.y1+(e.x2-e.x1)/r.aspectRatio;const c=Math.max(0-e.x1,0),p=Math.max(e.x2-i.width,0),l=Math.max(e.y2-i.height,0),g=Math.max(0-e.y1,0);(c>0||p>0||l>0||g>0)&&(e.x1+=l*r.aspectRatio>c?l*r.aspectRatio:c,e.x2-=g*r.aspectRatio>p?g*r.aspectRatio:p,e.y1+=g*r.aspectRatio>p?g:p/r.aspectRatio,e.y2-=l*r.aspectRatio>c?l:c/r.aspectRatio)}}getClientX(t){return t.touches?.[0].clientX||t.clientX||0}getClientY(t){return t.touches?.[0].clientY||t.clientY||0}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=a.jDH({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();let Mt=(()=>{class s{constructor(){this.autoRotateSupported=function ft(){return new Promise(s=>{const h=new Image;h.onload=()=>{s(1===h.width&&2===h.height)},h.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(t,e){var i=this;return(0,_.A)(function*(){const r=yield t.arrayBuffer();return yield i.checkImageTypeAndLoadImageFromArrayBuffer(r,t.type,e)})()}checkImageTypeAndLoadImageFromArrayBuffer(t,e,i){return this.isValidImageType(e)?this.loadImageFromArrayBuffer(t,i,e):Promise.reject(new Error("Invalid image type"))}isValidImageType(t){return/image\/(png|jpg|jpeg|bmp|gif|tiff|svg|webp|x-icon|vnd.microsoft.icon)/.test(t)}loadImageFromURL(t,e){var i=this;return(0,_.A)(function*(){const n=yield(yield fetch(t)).blob(),o=yield n.arrayBuffer();return yield i.loadImageFromArrayBuffer(o,e,n.type)})()}loadBase64Image(t,e){const i=this.base64ToArrayBuffer(t);return this.loadImageFromArrayBuffer(i,e)}base64ToArrayBuffer(t){t=t.replace(/^data:([^;]+);base64,/gim,"");const e=atob(t),i=e.length,r=new Uint8Array(i);for(let n=0;n<i;n++)r[n]=e.charCodeAt(n);return r.buffer}loadImageFromArrayBuffer(t,e,i){var r=this;return(0,_.A)(function*(){const n=yield new Promise(function(){var o=(0,_.A)(function*(c,p){try{const l=new Blob([t],i?{type:i}:void 0),g=URL.createObjectURL(l),d=new Image,M="image/svg+xml"===i?yield r.getSvgImageSize(l):void 0;d.onload=()=>c({originalImage:d,originalImageSize:M,originalObjectUrl:g,originalArrayBuffer:t}),d.onerror=p,d.src=g}catch(l){p(l)}});return function(c,p){return o.apply(this,arguments)}}());return yield r.transformImageFromArrayBuffer(n,e,null!=n.originalImageSize)})()}getSvgImageSize(t){return(0,_.A)(function*(){const r=(new DOMParser).parseFromString(yield t.text(),"image/svg+xml").querySelector("svg");if(!r)throw Error("Failed to parse SVG image");const n=r.getAttribute("width"),o=r.getAttribute("height");if(n&&o)return null;const c=r.getAttribute("viewBox")||r.getAttribute("viewbox");if(c){const p=c.split(" ");return{width:+p[2],height:+p[3]}}throw Error("Failed to load SVG image. SVG must have width + height or viewBox definition.")})()}transformImageFromArrayBuffer(t,e,i=!1){var r=this;return(0,_.A)(function*(){const o=function ut(s){switch("object"==typeof s&&(s=function xt(s){const h=new DataView(s);if(65496!==h.getUint16(0,!1))return-2;const t=h.byteLength;let e=2;for(;e<t;){if(h.getUint16(e+2,!1)<=8)return-1;const i=h.getUint16(e,!1);if(e+=2,65505==i){if(1165519206!==h.getUint32(e+=2,!1))return-1;const r=18761==h.getUint16(e+=6,!1);e+=h.getUint32(e+4,r);const n=h.getUint16(e,r);e+=2;for(let o=0;o<n;o++)if(274==h.getUint16(e+12*o,r))return h.getUint16(e+12*o+8,r)}else{if(65280&~i)break;e+=h.getUint16(e,!1)}}return-1}(s)),s){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}((yield r.autoRotateSupported)?-1:t.originalArrayBuffer);return t.originalImage&&t.originalImage.complete?r.transformLoadedImage({original:{objectUrl:t.originalObjectUrl,image:t.originalImage,size:t.originalImageSize??{width:t.originalImage.naturalWidth,height:t.originalImage.naturalHeight}},exifTransform:o},e,i):Promise.reject(new Error("No image loaded"))})()}transformLoadedImage(t,e,i=!1){var r=this;return(0,_.A)(function*(){const n=e.canvasRotation+t.exifTransform.rotate,o=t.original.size;if(!i&&0===n&&!t.exifTransform.flip&&!e.containWithinAspectRatio)return{original:{objectUrl:t.original.objectUrl,image:t.original.image,size:{...o}},transformed:{objectUrl:t.original.objectUrl,image:t.original.image,size:{...o}},exifTransform:t.exifTransform};const c=r.getTransformedSize(o,t.exifTransform,e),p=document.createElement("canvas");p.width=c.width,p.height=c.height;const l=p.getContext("2d");l?.setTransform(t.exifTransform.flip?-1:1,0,0,1,p.width/2,p.height/2),l?.rotate(Math.PI*(n/2)),l?.drawImage(t.original.image,-o.width/2,-o.height/2);const g=yield new Promise(M=>p.toBlob(M,e.format));if(!g)throw new Error("Failed to get Blob for transformed image.");const d=URL.createObjectURL(g),x=yield r.loadImageFromObjectUrl(d);return{original:{objectUrl:t.original.objectUrl,image:t.original.image,size:{...o}},transformed:{objectUrl:d,image:x,size:{width:x.width,height:x.height}},exifTransform:t.exifTransform}})()}loadImageFromObjectUrl(t){return new Promise((e,i)=>{const r=new Image;r.onload=()=>e(r),r.onerror=i,r.src=t})}getTransformedSize(t,e,i){const r=i.canvasRotation+e.rotate;if(i.containWithinAspectRatio){if(r%2){const o=t.height/i.aspectRatio;return{width:Math.max(t.height,t.width*i.aspectRatio),height:Math.max(t.width,o)}}{const o=t.width/i.aspectRatio;return{width:Math.max(t.width,t.height*i.aspectRatio),height:Math.max(t.height,o)}}}return r%2?{height:t.width,width:t.height}:{width:t.width,height:t.height}}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=a.jDH({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ct=(()=>{class s{constructor(t,e,i,r,n,o,c){this.cropService=t,this.cropperPositionService=e,this.loadImageService=i,this.sanitizer=r,this.cd=n,this.zone=o,this.hammerLoader=c,this.settings=new st,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.marginLeft="0px",this.maxSize={width:0,height:0},this.moveTypes=u,this.imageVisible=!1,this.cropperFrameAriaLabel=this.settings.cropperFrameAriaLabel,this.output=this.settings.output,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resetCropOnAspectRatioChange=this.settings.resetCropOnAspectRatioChange,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.allowMoveImage=!1,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.hidden=!1,this.imageCropped=new a.bkB,this.startCropImage=new a.bkB,this.imageLoaded=new a.bkB,this.cropperReady=new a.bkB,this.loadImageFailed=new a.bkB,this.transformChange=new a.bkB,this.reset()}ngOnChanges(t){this.onChangesUpdateSettings(t),this.onChangesInputImage(t),this.loadedImage?.original.image.complete&&(t.containWithinAspectRatio||t.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e)),(t.cropper||t.maintainAspectRatio||t.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),!this.maintainAspectRatio||!this.resetCropOnAspectRatioChange&&this.aspectRatioIsCorrect()||!t.maintainAspectRatio&&!t.aspectRatio?t.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop()):this.resetCropperPosition()),t.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop()),t.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesUpdateSettings(t){this.settings.setOptionsFromChanges(t),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&(this.hideResizeSquares=!0,this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1}))}onChangesInputImage(t){(t.imageChangedEvent||t.imageURL||t.imageBase64||t.imageFile)&&this.reset(),t.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),t.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),t.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),t.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){return this.imageChangedEvent?.target?.files?.length>0}setCssTransform(){const t=this.transform?.translateUnit||"%";this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle(`translate(${this.transform.translateH||0}${t}, ${this.transform.translateV||0}${t}) scaleX(`+(this.transform.scale||1)*(this.transform.flipH?-1:1)+") scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+") rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=void 0,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(t){this.loadImageService.loadImageFile(t,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e))}loadBase64Image(t){this.loadImageService.loadBase64Image(t,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e))}loadImageFromURL(t){this.loadImageService.loadImageFromURL(t,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e))}setLoadedImage(t){this.loadedImage=t,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(t.transformed.objectUrl),this.cd.markForCheck()}loadImageError(t){console.error(t),this.loadImageFailed.emit()}imageLoadedInView(){null!=this.loadedImage&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit({...this.maxSize}),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage?.nativeElement?.offsetWidth>0}onResize(){if(this.loadedImage)if(this.hidden)this.resizedWhileHidden=!0;else{const t={...this.maxSize};this.setMaxSize(),this.resizeCropperPosition(t),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()}}activatePinchGesture(){var t=this;return(0,_.A)(function*(){yield t.hammerLoader?.();const e=window?.Hammer||null;if(e){const i=new e(t.wrapper.nativeElement);i.get("pinch").set({enable:!0}),i.on("pinchmove",t.onPinch.bind(t)),i.on("pinchend",t.pinchStop.bind(t)),i.on("pinchstart",t.startPinch.bind(t))}else(0,a.naY)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")})()}resizeCropperPosition(t){(t.width!==this.maxSize.width||t.height!==this.maxSize.height)&&(this.cropper.x1=this.cropper.x1*this.maxSize.width/t.width,this.cropper.x2=this.cropper.x2*this.maxSize.width/t.width,this.cropper.y1=this.cropper.y1*this.maxSize.height/t.height,this.cropper.y2=this.cropper.y2*this.maxSize.height/t.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings,this.maxSize),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(t){this.changeKeyboardStepSize(t),this.keyboardMoveCropper(t)}changeKeyboardStepSize(t){const e=+t.key;e>=1&&e<=9&&(this.settings.stepSize=e)}keyboardMoveCropper(t){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t.key))return;const i=t.shiftKey?u.Resize:u.Move,r=t.altKey?function ct(s){switch(s){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";default:return"right"}}(t.key):function ht(s){switch(s){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";default:return"left"}}(t.key),n=function pt(s,h){switch(s){case"ArrowUp":return{clientX:0,clientY:-1*h};case"ArrowRight":return{clientX:h,clientY:0};case"ArrowDown":return{clientX:0,clientY:h};default:return{clientX:-1*h,clientY:0}}}(t.key,this.settings.stepSize);t.preventDefault(),t.stopPropagation(),this.startMove({clientX:0,clientY:0},i,r),this.handleMouseMove(n),this.handleMouseUp()}startMove(t,e,i=null){this.disabled||this.moveStart?.active&&this.moveStart?.type===u.Pinch||e===u.Drag&&!this.allowMoveImage||(t.preventDefault&&t.preventDefault(),this.moveStart={active:!0,type:e,position:i,transform:{...this.transform},clientX:this.cropperPositionService.getClientX(t),clientY:this.cropperPositionService.getClientY(t),...this.cropper},this.initMouseMove())}initMouseMove(){(0,H.h)((0,R.R)(document,"mousemove"),(0,R.R)(document,"touchmove")).pipe((0,tt.Q)((0,H.h)((0,R.R)(document,"mouseup"),(0,R.R)(document,"touchend")).pipe((0,et.$)()))).subscribe({next:t=>this.zone.run(()=>{this.handleMouseMove(t),this.cd.markForCheck()}),complete:()=>this.zone.run(()=>{this.handleMouseUp(),this.cd.markForCheck()})})}startPinch(t){this.safeImgDataUrl&&(t.preventDefault&&t.preventDefault(),this.moveStart={active:!0,type:u.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2,...this.cropper})}handleMouseMove(t){if(this.moveStart.active)if(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===u.Move)this.cropperPositionService.move(t,this.moveStart,this.cropper),this.checkCropperPosition(!0);else if(this.moveStart.type===u.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1);else if(this.moveStart.type===u.Drag){const e=this.cropperPositionService.getClientX(t)-this.moveStart.clientX,i=this.cropperPositionService.getClientY(t)-this.moveStart.clientY;this.transform={...this.transform,translateH:(this.moveStart.transform?.translateH||0)+e,translateV:(this.moveStart.transform?.translateV||0)+i},this.setCssTransform()}}onPinch(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===u.Pinch&&(this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.markForCheck())}setMaxSize(){if(this.sourceImage){const t=getComputedStyle(this.sourceImage.nativeElement);this.maxSize.width=parseFloat(t.width),this.maxSize.height=parseFloat(t.height),this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){this.loadedImage?.transformed?.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.settings.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):20}setCropperScaledMaxSize(){if(this.loadedImage?.transformed?.image){const t=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/t:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/t:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(t=!1){this.cropper.x1<0&&(this.cropper.x2-=t?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=t?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=t?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=t?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}handleMouseUp(){this.moveStart.active&&(this.moveStart.active=!1,this.moveStart?.type===u.Drag?this.transformChange.emit(this.transform):this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(t=this.settings.output){if(null!=this.loadedImage?.transformed?.image){if(this.startCropImage.emit(),"blob"===t)return this.cropToBlob();if("base64"===t)return this.cropToBase64()}return null}cropToBlob(){var t=this;return new Promise((e,i)=>this.zone.run((0,_.A)(function*(){const r=yield t.cropService.crop(t.loadedImage,t.cropper,t.settings,"blob",t.maxSize);r?(t.imageCropped.emit(r),e(r)):i("Crop image failed")})))}cropToBase64(){const t=this.cropService.crop(this.loadedImage,this.cropper,this.settings,"base64",this.maxSize);return t?(this.imageCropped.emit(t),t):null}aspectRatioIsCorrect(){return(this.cropper.x2-this.cropper.x1)/(this.cropper.y2-this.cropper.y1)===this.aspectRatio}}return s.\u0275fac=function(t){return new(t||s)(a.rXU(gt),a.rXU(mt),a.rXU(Mt),a.rXU(B.up),a.rXU(a.gRc),a.rXU(a.SKi),a.rXU(B.Bn,8))},s.\u0275cmp=a.VBU({type:s,selectors:[["image-cropper"]],viewQuery:function(t,e){if(1&t&&(a.GBs(it,7),a.GBs(at,5)),2&t){let i;a.mGM(i=a.lsd())&&(e.wrapper=i.first),a.mGM(i=a.lsd())&&(e.sourceImage=i.first)}},hostVars:6,hostBindings:function(t,e){1&t&&a.bIt("resize",function(){return e.onResize()},!1,a.tSv),2&t&&(a.xc7("text-align",e.alignImage),a.AVh("disabled",e.disabled)("ngx-ix-hidden",e.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",imageAltText:"imageAltText",cropperFrameAriaLabel:"cropperFrameAriaLabel",output:"output",format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange"},features:[a.OA$],decls:5,vars:10,consts:[["wrapper",""],["sourceImage",""],["class","ngx-ic-source-image","role","presentation",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart","error",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],["role","presentation",1,"ngx-ic-source-image",3,"load","mousedown","touchstart","error","src"],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],["role","presentation",1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(t,e){1&t&&(a.j41(0,"div",null,0),a.DNE(2,rt,2,8,"img",2),a.nrm(3,"div",3),a.DNE(4,ot,3,16,"div",4),a.k0s()),2&t&&(a.xc7("background",e.imageVisible&&e.backgroundColor),a.R7$(2),a.Y8G("ngIf",e.safeImgDataUrl),a.R7$(),a.xc7("width",e.maxSize.width,"px")("height",e.maxSize.height,"px")("margin-left","center"===e.alignImage?e.marginLeft:null),a.R7$(),a.Y8G("ngIf",e.imageVisible))},dependencies:[W.bT],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535C;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ix-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0}),s})(),_t=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=a.$C({type:s}),s.\u0275inj=a.G2t({imports:[[W.MD]]}),s})();var yt=m(46421),U=m(88834);let At=(()=>{class s{constructor(t,e,i,r){this.data=t,this._dialogRef=e,this._snackBar=i,this.sanitizer=r,this.imageChangedEvent="",this.croppedImage="",this.imageChangedEvent=t.image}ngOnInit(){}imageCropped(t){this.croppedImage=this.sanitizer.bypassSecurityTrustUrl(t.objectUrl),this.blob=t.blob}imageLoaded(t){}cropperReady(){}loadImageFailed(){this._snackBar.openFromComponent(k.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Alerta",message:"No se pudo cargar la imagen, int\xe9ntelo nuevamente.",type:"warning",svgIcon:"mat_solid:warning"}}),this._dialogRef.close()}saveImage(){const t=new File([this.blob],`${(0,yt.A)()}.${this.blob.type.split("/")[1]}`,{type:this.blob.type});this._dialogRef.close(t)}static#t=this.\u0275fac=function(e){return new(e||s)(a.rXU(w.Vh),a.rXU(w.CP),a.rXU(j.UG),a.rXU(B.up))};static#e=this.\u0275cmp=a.VBU({type:s,selectors:[["cropper-image-dialog"]],standalone:!0,features:[a.aNF],decls:18,vars:5,consts:[[1,"relative","flex","flex-col","justify-between","w-full","h-full","max-h-screen"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","border-b","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],[1,"mb-4","text-xl","font-semibold"],[1,"grid","flex-auto","w-full","gap-6","px-8","pb-6","sm:grid-cols-2","sm:gap-2"],[1,"w-full","h-full"],[1,"w-full","my-2","font-semibold","text-center"],[1,"p-0",3,"imageCropped","imageLoaded","cropperReady","loadImageFailed","imageChangedEvent","maintainAspectRatio"],[3,"src"],[1,"flex","items-center","justify-between","w-full","px-8","py-4","text-swamp-200","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-button","","mat-dialog-close","",1,"-ml-4","rounded-full",3,"color"],["mat-flat-button","",1,"rounded-full",3,"click","color"]],template:function(e,i){1&e&&(a.j41(0,"div",0)(1,"div",1)(2,"span",2),a.EFF(3,"Ajustar Imagen"),a.k0s()(),a.j41(4,"div",3)(5,"div",4)(6,"div",5),a.EFF(7," Original "),a.k0s(),a.j41(8,"image-cropper",6),a.bIt("imageCropped",function(n){return i.imageCropped(n)})("imageLoaded",function(n){return i.imageLoaded(n)})("cropperReady",function(){return i.cropperReady()})("loadImageFailed",function(){return i.loadImageFailed()}),a.k0s()(),a.j41(9,"div",4)(10,"div",5),a.EFF(11," Resultado "),a.k0s(),a.nrm(12,"img",7),a.k0s()(),a.j41(13,"div",8)(14,"button",9),a.EFF(15,"Cancelar"),a.k0s(),a.j41(16,"button",10),a.bIt("click",function(){return i.saveImage()}),a.EFF(17,"Guardar"),a.k0s()()()),2&e&&(a.R7$(8),a.Y8G("imageChangedEvent",i.imageChangedEvent)("maintainAspectRatio",!0),a.R7$(4),a.Y8G("src",i.croppedImage,a.B4B),a.R7$(2),a.Y8G("color","warn"),a.R7$(2),a.Y8G("color","primary"))},dependencies:[w.hM,w.tx,U.Hl,U.$z,_t,Ct],encapsulation:2})}return s})();const D=q.c.API_URL;let vt=(()=>{class s{constructor(){this._httpClient=(0,a.WQX)(E.Qq),this._snackBar=(0,a.WQX)(j.UG),this._dialog=(0,a.WQX)(w.bZ)}uploadImage(t,e){const i=new FormData;return i.append("image",e,e.name),this._httpClient.post(`${D}/cloudinary/upload/${t}`,i)}removeImage(t){let e=t.slice(t.indexOf("upload"),t.length).split(".")[0];e=e.split("/").splice(2,e.length).join("/");const i=(new E.Nl).set("public_id",e);return this._httpClient.delete(`${D}/cloudinary/remove`,{params:i})}openCropperDialog(t,e){const i=this._dialog.open(At,{data:{image:t},panelClass:"ath-dialog-panel",minWidth:"200px",maxWidth:"500px",disableClose:!0});return e?i.afterClosed().pipe((0,J.s)(1),(0,Z.n)(r=>this.convertToBase64(r))):i.afterClosed()}validMaxMBSize(t,e){return!(t.size/1024/1024>e&&(this._snackBar.openFromComponent(k.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:`Tama\xf1o demasiado grande ${(t.size/1024/1024).toFixed(1)} MB . La imagen no debe superar a ${e}MB`,title:"Confirmaci\xf3n",type:"error",svgIcon:"mat_solid:done"}}),1))}validImageType(t){return!!["image/jpeg","image/jpg","image/webp","image/png"].includes(t.type)}convertToBase64(t){if(!t)return(0,P.of)("");const e=new K.m(1),i=new FileReader;return i.readAsDataURL(t),i.onload=r=>e.next(r.target.result.toString()),e}static#t=this.\u0275fac=function(e){return new(e||s)};static#e=this.\u0275prov=a.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})()}}]);