"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[689],{30324:(O,B,r)=>{r.r(B),r.d(B,{default:()=>Xn});var b=r(51188),t=r(54438);let j=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#n=this.\u0275cmp=t.VBU({type:e,selectors:[["app-accounting"]],standalone:!0,features:[t.aNF],decls:1,vars:0,template:function(o,i){1&o&&t.nrm(0,"router-outlet")},dependencies:[b.n3],encapsulation:2})}return e})();var f=r(60177),v=r(55542),k=r(88834),l=r(99213),R=r(9183),_=r(30450),Q=r(14823),y=r(47358);class Z{}var H=r(64109),K=r(45024),x=r(75351),$=r(95416),m=r(89079),lt=r(85943),d=r(46601),p=r(27115),u=r(94794),a=r(89417),A=r(60850),C=r(82798),S=r(86600),I=r(59042),g=r(32102),dt=r(7673),tt=r(70152),mt=r(99172),M=r(96354),T=r(59640),z=r(19669),w=r(41017);const ut=(e,c)=>c.id,it=e=>({"cursor-not-allowed":e});function pt(e,c){1&e&&(t.j41(0,"h2",3),t.EFF(1,"Agregar cuenta"),t.k0s())}function ht(e,c){1&e&&(t.j41(0,"h2",3),t.EFF(1,"Editar cuenta"),t.k0s())}function gt(e,c){if(1&e&&(t.j41(0,"mat-option",13),t.EFF(1),t.k0s()),2&e){const n=c.$implicit;t.Y8G("value",n),t.R7$(),t.Lme(" ",n.no," - ",n.name," ")}}function ft(e,c){1&e&&(t.j41(0,"mat-error"),t.EFF(1," El t\xedtulo de la cuenta es obligatorio. "),t.k0s())}function kt(e,c){1&e&&(t.j41(0,"mat-error"),t.EFF(1," El t\xedtulo del elemento de cuenta debe poseer entre 1 y 10 caracteres. "),t.k0s())}function bt(e,c){1&e&&(t.j41(0,"mat-error"),t.EFF(1," El t\xedtulo de la cuenta es obligatorio. "),t.k0s())}function vt(e,c){1&e&&(t.j41(0,"mat-error"),t.EFF(1," El t\xedtulo del elemento de cuenta debe poseer entre 3 y 255 caracteres. "),t.k0s())}function xt(e,c){1&e&&(t.j41(0,"mat-error"),t.EFF(1," Debe seleccionar la naturaleza de la cuenta. "),t.k0s())}function Ct(e,c){if(1&e){const n=t.RV6();t.j41(0,"div",5)(1,"div",7)(2,"form",8)(3,"div",9)(4,"mat-form-field",10)(5,"mat-label"),t.EFF(6,"Padre"),t.k0s(),t.nrm(7,"input",11),t.j41(8,"mat-autocomplete",12,0),t.bIt("optionSelected",function(i){t.eBV(n);const s=t.XpG();return t.Njj(s.onSelectAccount(i))}),t.j41(10,"mat-option",13),t.EFF(11,"Sin Padre"),t.k0s(),t.Z7z(12,gt,2,3,"mat-option",13,ut),t.nI1(14,"async"),t.k0s()(),t.j41(15,"mat-form-field",10)(16,"mat-label"),t.EFF(17,"N\xfamero de la cuenta"),t.k0s(),t.nrm(18,"input",14),t.DNE(19,ft,2,0,"mat-error")(20,kt,2,0,"mat-error"),t.k0s(),t.j41(21,"mat-form-field",10)(22,"mat-label"),t.EFF(23,"Nombre de la cuenta"),t.k0s(),t.nrm(24,"input",15),t.DNE(25,bt,2,0,"mat-error")(26,vt,2,0,"mat-error"),t.k0s(),t.j41(27,"mat-form-field",16)(28,"mat-label"),t.EFF(29,"Naturaleza"),t.k0s(),t.j41(30,"mat-select",17)(31,"mat-option",18),t.EFF(32,"Acreedora"),t.k0s(),t.j41(33,"mat-option",19),t.EFF(34,"Deudora"),t.k0s(),t.j41(35,"mat-option",20),t.EFF(36,"Mixta"),t.k0s()(),t.DNE(37,xt,2,0,"mat-error"),t.k0s()()()()()}if(2&e){const n=t.sdS(9),o=t.XpG();t.R7$(2),t.Y8G("formGroup",o.accountForm)("autocomplete","off"),t.R7$(2),t.Y8G("subscriptSizing","dynamic"),t.R7$(3),t.Y8G("formControlName","parent")("type","text")("matAutocomplete",n),t.R7$(),t.Y8G("displayWith",o.displayFn),t.R7$(2),t.Y8G("value",null),t.R7$(2),t.Dyx(t.bMT(14,26,o.filteredAccounts$)),t.R7$(3),t.Y8G("subscriptSizing","dynamic"),t.R7$(3),t.Y8G("formControlName","no")("type","text")("placeholder","N\xfamero de la cuenta")("maxLength",10),t.R7$(),t.vxM(19,o.accountForm.get("no").hasError("required")?19:-1),t.R7$(),t.vxM(20,o.accountForm.get("no").hasError("maxLength")||o.accountForm.get("no").hasError("minLength")?20:-1),t.R7$(),t.Y8G("subscriptSizing","dynamic"),t.R7$(3),t.Y8G("formControlName","name")("type","text")("placeholder","Nombre de la cuenta")("minLength",3)("maxLength",255),t.R7$(),t.vxM(25,o.accountForm.get("name").hasError("required")?25:-1),t.R7$(),t.vxM(26,o.accountForm.get("name").hasError("maxLength")||o.accountForm.get("name").hasError("minLength")?26:-1),t.R7$(4),t.Y8G("formControlName","type")("placeholder","Seleccione una opci\xf3n"),t.R7$(7),t.vxM(37,o.accountForm.get("type").hasError("required")?37:-1)}}function _t(e,c){if(1&e){const n=t.RV6();t.j41(0,"button",23),t.bIt("click",function(){t.eBV(n);const i=t.XpG(2);return t.Njj(i.updateAccount())}),t.EFF(1," Actualizar "),t.k0s()}if(2&e){const n=t.XpG(2);t.Y8G("color","primary")("disabled",n.accountForm.invalid)("ngClass",t.eq3(3,it,n.accountForm.invalid))}}function At(e,c){if(1&e){const n=t.RV6();t.j41(0,"button",23),t.bIt("click",function(){t.eBV(n);const i=t.XpG(2);return t.Njj(i.createAccount())}),t.EFF(1," Agregar "),t.k0s()}if(2&e){const n=t.XpG(2);t.Y8G("color","primary")("disabled",n.accountForm.invalid)("ngClass",t.eq3(3,it,n.accountForm.invalid))}}function Ft(e,c){if(1&e&&(t.j41(0,"div",6)(1,"button",21),t.EFF(2," Cancelar "),t.k0s(),t.DNE(3,_t,2,5,"button",22)(4,At,2,5,"button",22),t.k0s()),2&e){const n=t.XpG();t.R7$(),t.Y8G("matDialogClose","cancelled"),t.R7$(2),t.vxM(3,"edit"===n.data.dialogMode?3:-1),t.R7$(),t.vxM(4,"add"===n.data.dialogMode?4:-1)}}let yt=(()=>{class e{#t=(0,t.WQX)(w.u);#n=(0,t.WQX)(t.gRc);#e=(0,t.WQX)(t.abz);#o=(0,t.WQX)(x.CP);#c=(0,t.WQX)(a.ze);#a=(0,t.WQX)(d.G);#i=(0,t.WQX)($.UG);#s=(0,t.WQX)(T.il);constructor(n){this.data=n,this.dialogMode=n.dialogMode,this.account=n.account,this.parentId=n.parentId}ngOnInit(){if(this.#s.select(z.N8).pipe((0,m.pQ)(this.#e)).subscribe(({accounts:n})=>{this.accounts=n,this.filteredAccounts$=(0,dt.of)(n),this.#n.markForCheck()}),this.accountForm=this.#c.group({id:new a.MJ(null),no:new a.MJ(null,[a.k0.required,a.k0.minLength(1),a.k0.maxLength(10)]),name:new a.MJ(null,[a.k0.required,a.k0.minLength(3),a.k0.maxLength(255)]),parentId:new a.MJ(null),parent:new a.MJ(null),type:new a.MJ(null,[a.k0.required])}),this.account&&this.accountForm.patchValue(this.account),this.parentId){this.accountForm.get("parentId").setValue(this.parentId);const n=this.accounts.find(o=>o.id===this.parentId);this.accountForm.get("parent").setValue(n)}this.filteredAccounts$=this.accountForm.get("parent").valueChanges.pipe((0,m.pQ)(this.#e),(0,tt.B)(100),(0,mt.Z)(""),(0,M.T)(n=>("string"==typeof n?n:n?.name)?this.accounts.filter(i=>i.name.toLocaleLowerCase().includes(n.toLocaleLowerCase())):this.accounts)),this.accountForm.get("parent").valueChanges.pipe((0,m.pQ)(this.#e)).subscribe(n=>{this.#n.markForCheck()})}createAccount(){const n=this.accountForm.getRawValue();delete n.id,delete n.parent,this.#a.open({title:"Crear cuenta",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this.#t.createAccount(n).pipe((0,m.pQ)(this.#e)).subscribe(({data:s})=>{this.#i.openFromComponent(u.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.createAccount.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this.#n.markForCheck(),this.#o.close()})})}updateAccount(){const n=this.accountForm.getRawValue();delete n.parent,this.#a.open({title:"Actualizar cuenta",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this.#t.updateAccount(n).pipe((0,m.pQ)(this.#e)).subscribe(({data:s})=>{this.#i.openFromComponent(u.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.updateAccount.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this.#n.markForCheck(),this.#o.close()})})}displayFn(n){return n?`${n.no} - ${n.name}`:"Sin Padre"}onSelectAccount(n){const{id:o}=n.option.value;this.accountForm.get("parentId").setValue(o)}static#r=this.\u0275fac=function(o){return new(o||e)(t.rXU(x.Vh))};static#l=this.\u0275cmp=t.VBU({type:e,selectors:[["accounting-account-dialog"]],standalone:!0,features:[t.aNF],decls:7,vars:4,consts:[["auto","matAutocomplete"],[1,"relative","flex","flex-col","w-full","max-h-screen"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["mat-dialog-title","",1,"text-2xl"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6"],[1,"w-full","overflow-hidden"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-between","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],[1,"flex","border-t"],[1,"flex","flex-col","w-full","pt-8",3,"formGroup","autocomplete"],[1,"flex","flex-col","gap-6"],[1,"fuse-mat-dense",3,"subscriptSizing"],["matInput","","placeholder","Elemento padre","aria-label","Elemento padre",3,"formControlName","type","matAutocomplete"],[3,"optionSelected","displayWith"],[3,"value"],["matInput","","required","",3,"formControlName","type","placeholder","maxLength"],["matInput","","required","",3,"formControlName","type","placeholder","minLength","maxLength"],[1,"fuse-mat-dense"],["required","",3,"formControlName","placeholder"],["value","acreedora"],["value","deudora"],["value","mixta"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","disabled","ngClass"],["mat-flat-button","",3,"click","color","disabled","ngClass"]],template:function(o,i){1&o&&(t.j41(0,"div",1)(1,"div",2),t.DNE(2,pt,2,0,"h2",3)(3,ht,2,0,"h2",3),t.k0s(),t.j41(4,"div",4),t.DNE(5,Ct,38,28,"div",5),t.k0s(),t.DNE(6,Ft,5,3,"div",6),t.k0s()),2&o&&(t.R7$(2),t.vxM(2,"add"===i.dialogMode?2:-1),t.R7$(),t.vxM(3,"edit"===i.dialogMode?3:-1),t.R7$(2),t.vxM(5,"view"!==i.dialogMode?5:-1),t.R7$(),t.vxM(6,"view"!==i.data.dialogMode?6:-1))},dependencies:[f.Jj,A.jL,A.$3,S.wT,A.pN,k.Hl,k.$z,x.tx,x.BI,g.RG,g.rl,g.nJ,g.TL,l.m_,I.fS,I.fg,S.Sy,S.pZ,C.Ve,C.VO,_.mV,f.YU,a.X1,a.qT,a.me,a.BC,a.cb,a.YS,a.j4,a.JD],encapsulation:2,changeDetection:0})}return e})();function It(e,c){if(1&e){const n=t.RV6();t.j41(0,"mat-slide-toggle",45),t.bIt("change",function(i){t.eBV(n);const s=t.XpG().$implicit,F=t.XpG(2);return t.Njj(F.updateAccountStatus(i,s,s.item.id))}),t.k0s()}if(2&e){const n=t.XpG().$implicit;t.Y8G("checked",n.item.active)("color","primary")}}function Tt(e,c){1&e&&t.nrm(0,"mat-spinner",40),2&e&&t.Y8G("diameter",20)("color","primary")}function Bt(e,c){if(1&e){const n=t.RV6();t.j41(0,"mat-tree-node",30),t.bIt("mouseenter",function(){const i=t.eBV(n).$implicit,s=t.XpG(2);return t.Njj(s.mouseEnterLeave(i.item.id))})("mouseleave",function(){const i=t.eBV(n).$implicit,s=t.XpG(2);return t.Njj(s.mouseEnterLeave(i.item.id))})("click",function(){const i=t.eBV(n).$implicit,s=t.XpG(2);return t.Njj(s.mouseOver(i.item.id))})("click",function(){const i=t.eBV(n).$implicit,s=t.XpG(2);return t.Njj(s.dobleClick(i))}),t.j41(1,"div",31)(2,"button",32),t.nrm(3,"mat-icon",33),t.k0s()(),t.j41(4,"div",34)(5,"span",35),t.EFF(6),t.k0s()(),t.j41(7,"div",31)(8,"span",36),t.EFF(9),t.k0s()(),t.j41(10,"div",37),t.EFF(11),t.nI1(12,"titlecase"),t.k0s(),t.j41(13,"div",37),t.EFF(14),t.k0s(),t.j41(15,"div",38),t.DNE(16,It,1,2,"mat-slide-toggle",39)(17,Tt,1,2,"mat-spinner",40),t.k0s(),t.j41(18,"div",41)(19,"button",42),t.bIt("click",function(){const i=t.eBV(n).$implicit,s=t.XpG(2);return t.Njj(s.createAccount(i))}),t.nrm(20,"mat-icon",33),t.k0s(),t.j41(21,"button",43),t.bIt("click",function(){const i=t.eBV(n).$implicit,s=t.XpG(2);return t.Njj(s.editAccount(i))}),t.nrm(22,"mat-icon",33),t.k0s(),t.j41(23,"button",44),t.bIt("click",function(){const i=t.eBV(n).$implicit,s=t.XpG(2);return t.Njj(s.removeAccount(i.item.id))}),t.nrm(24,"mat-icon",33),t.k0s()()()}if(2&e){const n=c.$implicit,o=t.XpG(2);t.R7$(2),t.Y8G("disabled",0===o.flatNodeMap.get(n).children.length),t.BMQ("aria-label","Expandir "+n.item.name),t.R7$(),t.Y8G("svgIcon",o.treeControl.isExpanded(n)?"mat_solid:expand_more":"mat_solid:chevron_right"),t.R7$(3),t.JRh(n.item.no),t.R7$(3),t.JRh(n.item.name),t.R7$(2),t.SpI(" ",t.bMT(12,14,n.item.type)," "),t.R7$(3),t.SpI(" ",o.flatNodeMap.get(n).children.length," "),t.R7$(2),t.vxM(16,o.isLoading&&o.selectedSlide===n.item.id?-1:16),t.R7$(),t.vxM(17,o.isLoading&&o.selectedSlide===n.item.id?17:-1),t.R7$(2),t.Y8G("disabled",n.item.parentId),t.R7$(),t.Y8G("svgIcon","mat_solid:add"),t.R7$(2),t.Y8G("svgIcon","mat_solid:edit"),t.R7$(),t.Y8G("disabled",n.item.hasChild),t.R7$(),t.Y8G("svgIcon","mat_solid:delete")}}function jt(e,c){if(1&e&&(t.j41(0,"div",25),t.nrm(1,"div"),t.j41(2,"div",26),t.EFF(3," No. "),t.k0s(),t.j41(4,"div",27),t.EFF(5," Nombre "),t.k0s(),t.j41(6,"div",26),t.EFF(7," Naturaleza "),t.k0s(),t.j41(8,"div",26),t.EFF(9," Subcuentas "),t.k0s(),t.j41(10,"div",26),t.EFF(11," Estado "),t.k0s(),t.j41(12,"div",26),t.EFF(13," Acciones "),t.k0s()(),t.j41(14,"mat-tree",28),t.DNE(15,Bt,25,16,"mat-tree-node",29),t.k0s()),2&e){const n=t.XpG();t.R7$(14),t.Y8G("dataSource",n.dataSource)("treeControl",n.treeControl)}}function $t(e,c){1&e&&(t.j41(0,"div",46),t.EFF(1," \xa1No se ha creado ninguna cuenta a\xfan! "),t.k0s())}let Et=(()=>{class e{#t;#n;#e;#o;#c;#a;#i;#s;constructor(){this.accounts=[],this.flatNodeMap=new Map,this.nestedNodeMap=new Map,this.selectedParent=null,this.checklistSelection=new K.CB(!0),this.isLoading=!1,this.selectedSlide=null,this.dialog=(0,t.WQX)(x.bZ),this.#t=(0,t.WQX)(w.u),this.#n=(0,t.WQX)(t.gRc),this.#e=(0,t.WQX)(t.abz),this.#o=(0,t.WQX)(lt.V),this.#c=(0,t.WQX)(d.G),this.#a=(0,t.WQX)(p.F),this.#i=(0,t.WQX)($.UG),this.#s=(0,t.WQX)(T.il),this.getLevel=n=>n.level,this.isExpandable=n=>n.expandable,this.getChildren=n=>n.children,this.hasChild=(n,o)=>o.expandable,this.hasNoContent=(n,o)=>""===o.item.name,this.transformer=(n,o)=>{const i=this.nestedNodeMap.get(n),s=i&&i.item===n.item?i:new Z;return s.item=n.item,s.level=o,s.expandable=!!n.children?.length,this.flatNodeMap.set(s,n),this.nestedNodeMap.set(n,s),s},this.treeFlattener=new y.yj(this.transformer,this.getLevel,this.isExpandable,this.getChildren),this.treeControl=new H.XW(this.getLevel,this.isExpandable),this.dataSource=new y.zw(this.treeControl,this.treeFlattener)}ngOnInit(){this.#s.select(z.N8).pipe((0,m.pQ)(this.#e)).subscribe(({accountsNodes:o})=>{this.dataSource.data=o,this.#n.markForCheck()}),this.#a.onMediaChange$.pipe((0,m.pQ)(this.#e)).subscribe(({matchingAliases:n})=>{this.isScreenSmall=!n.includes("md")})}createAccount(n){n?this.#r(null,n.item.id,"add"):this.#r(null,null,"add")}editAccount(n){let o=this.accounts.find(i=>i.id===n.item.parentId);o=void 0===o?null:o,this.#r(n.item,n.item.parentId,"edit")}updateAccountStatus(n,o,i){this.isLoading=!0,this.selectedSlide=i,this.#t.updateAccountStatus({active:n.checked,id:o.item.id}).pipe((0,m.pQ)(this.#e)).subscribe(({data:s})=>{this.#i.openFromComponent(u.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.updateAccountStatus.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.isLoading=!1,this.selectedSlide=null,this.#n.markForCheck()}),this.#n.markForCheck()}removeAccount(n){this.#c.open({title:"Eliminar cuenta",message:"\xbfEsta seguro que desea eliminar esta cuenta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this.#t.removeAccount(n).pipe((0,m.pQ)(this.#e)).subscribe(({data:s})=>{this.#i.openFromComponent(u.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.removeAccount.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this.#n.markForCheck()})})}mouseEnterLeave(n){this.selectedAccountId=n===this.selectedAccountId?"":n}mouseOver(n){this.overAccountId=n===this.overAccountId?"":n}dobleClick(n){this.treeControl.isExpanded(n)?this.treeControl.collapse(n):this.treeControl.expand(n)}expandAll(){this.treeControl.expandAll()}collapseAll(){this.treeControl.collapseAll()}#r(n,o=null,i){this.dialog.open(yt,{data:{account:n,parentId:o,dialogMode:i},disableClose:!0,panelClass:"ath-nrp-dialog-panel"})}static#l=this.\u0275fac=function(o){return new(o||e)};static#d=this.\u0275cmp=t.VBU({type:e,selectors:[["accounting-accounts"]],standalone:!0,features:[t.aNF],decls:42,vars:6,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-row","justify-between","w-full","min-w-0","overflow-x-hidden","overflow-y-hidden","bg-card","dark:bg-transparent"],[1,"flex","flex-col","flex-auto","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-20"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/dashboard",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight"],[1,"flex","flex-row-reverse","flex-wrap","items-center","mt-2","lg:justify-end","sm:flex-row","lg:mt-0","shrink-0","lg:ml-4"],["mat-raised-button","",1,"text-white","lg:ml-4","bg-gradient-to-r","from-primary-500","to-primary-600","hover:to-primary-900","hover:shadow-lg",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],["mat-stroked-button","",1,"ml-4",3,"click"],["svgIcon","mat_solid:close_fullscreen"],[1,"hidden","ml-2","mr-1","sm:block"],["mat-stroked-button","",1,"ml-0","sm:ml-4",3,"click"],["svgIcon","mat_solid:expand"],[1,"flex","flex-col","flex-auto"],[1,"grid"],[1,"sticky","top-0","z-10","grid","gap-4","px-0","py-4","font-semibold","shadow","accounts-tree-nodes","xl:pr-8","text-md","text-secondary","bg-gray-50","dark:bg-gray-900"],[1,"text-center"],[1,""],[3,"dataSource","treeControl"],["matTreeNodePadding","","class","grid accounts-tree-nodes gap-4 relative cursor-pointer py-1.5 border-b rounded-md bg-opacity-5 dark:bg-opacity-12",3,"mouseenter","mouseleave","click",4,"matTreeNodeDef"],["matTreeNodePadding","",1,"grid","accounts-tree-nodes","gap-4","relative","cursor-pointer","py-1.5","border-b","rounded-md","bg-opacity-5","dark:bg-opacity-12",3,"mouseenter","mouseleave","click"],["matTreeNodePadding","","matTreeNodePaddingIndent","20",1,"flex","items-center"],["mat-icon-button","","matTreeNodeToggle","","color","primary",3,"disabled"],[1,"icon-size-5",3,"svgIcon"],["matTreeNodePadding","","matTreeNodePaddingIndent","20",1,"flex","items-center","justify-center"],[1,"cursor-default"],[1,"cursor-default","whitespace-nowrap","line-clamp-1"],["matTreeNodePadding","","matTreeNodePaddingIndent","20",1,"text-center"],[1,"flex","items-center","justify-center"],[3,"checked","color"],[3,"diameter","color"],[1,"flex","flex-row","justify-end","gap-2","pr-2","text-right"],["mat-stroked-button","","matTooltip","Agregar Subcuenta",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click","disabled"],["mat-stroked-button","","matTooltip","Editar Cuenta",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],["mat-stroked-button","","matTooltip","Eliminar Cuenta",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click","disabled"],[3,"change","checked","color"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(o,i){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"div",4)(6,"div",5)(7,"a",6),t.EFF(8,"Inicio"),t.k0s()(),t.j41(9,"div",5),t.nrm(10,"mat-icon",7),t.j41(11,"a",8),t.EFF(12,"Contabilidad"),t.k0s()(),t.j41(13,"div",5),t.nrm(14,"mat-icon",7),t.j41(15,"a",8),t.EFF(16,"Libro de Cuentas"),t.k0s()()(),t.j41(17,"div",9)(18,"a",10),t.nrm(19,"mat-icon",7),t.j41(20,"span",11),t.EFF(21,"Regresar"),t.k0s()()()(),t.j41(22,"div",12)(23,"div",13),t.EFF(24," Libro de Cuentas "),t.k0s()()(),t.j41(25,"div",14)(26,"button",15),t.bIt("click",function(){return i.createAccount(null)}),t.nrm(27,"mat-icon",16),t.j41(28,"span",17),t.EFF(29,"Nueva"),t.k0s()(),t.j41(30,"button",18),t.bIt("click",function(){return i.collapseAll()}),t.nrm(31,"mat-icon",19),t.j41(32,"span",20),t.EFF(33,"Contraer"),t.k0s()(),t.j41(34,"button",21),t.bIt("click",function(){return i.expandAll()}),t.nrm(35,"mat-icon",22),t.j41(36,"span",20),t.EFF(37,"Expandir"),t.k0s()()()(),t.j41(38,"div",23)(39,"div",24),t.DNE(40,jt,16,2)(41,$t,2,0),t.k0s()()()()),2&o&&(t.R7$(10),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("routerLink","./.."),t.R7$(),t.Y8G("svgIcon","mat_solid:chevron_left"),t.R7$(8),t.Y8G("svgIcon","mat_solid:add"),t.R7$(13),t.vxM(40,i.dataSource.data&&i.dataSource.data.length>0?40:41))},dependencies:[v.uv,k.Hl,k.$z,k.iY,l.m_,l.An,R.D6,R.LG,_.mV,_.sG,Q.uc,Q.oV,y.jH,y.yI,y.yF,y.pO,y.lQ,y.d6,b.Wk,f.PV],styles:[".accounts-tree-nodes[_ngcontent-%COMP%]{grid-template-columns:20px 60px 300px 100px 100px 80px 150px}@media (min-width: 960px){.accounts-tree-nodes[_ngcontent-%COMP%]{grid-template-columns:20px 60px 300px 100px 100px 100px 150px}}"],changeDetection:0})}return e})();var D=r(96695),E=r(2042),Y=r(21413),at=r(57786),h=r(56977),G=r(25558),st=r(61911),ct=r(47413),Rt=r(63729),Gt=r(70819),Nt=r(25941),L=r(88007),St=r(91401);const nt=(e,c)=>c.id;function Dt(e,c){1&e&&(t.j41(0,"h2",2),t.EFF(1," Agregar Cuenta Bancaria "),t.k0s())}function Mt(e,c){1&e&&(t.j41(0,"h2",2),t.EFF(1," Editar Cuenta Bancaria "),t.k0s())}function wt(e,c){if(1&e&&(t.j41(0,"div",4)(1,"div",7)(2,"div",8)(3,"div",9)(4,"div",10)(5,"h6",11),t.EFF(6,"Nombre"),t.k0s(),t.j41(7,"span",12),t.EFF(8),t.k0s()()()()()()),2&e){const n=t.XpG();t.R7$(8),t.JRh(n.data.bank.name||"Sin nombre")}}function Xt(e,c){if(1&e&&(t.j41(0,"mat-option",18),t.EFF(1),t.k0s()),2&e){const n=c.$implicit;t.Y8G("value",n.id),t.R7$(),t.JRh(n.name)}}function Qt(e,c){if(1&e&&(t.j41(0,"mat-option",18),t.EFF(1),t.k0s()),2&e){const n=c.$implicit;t.Y8G("value",n.id),t.R7$(),t.JRh(n.iso)}}function zt(e,c){if(1&e&&(t.j41(0,"mat-option",18),t.EFF(1),t.k0s()),2&e){const n=c.$implicit;t.Y8G("value",n.id),t.R7$(),t.Lme("",n.no," - ",n.name,"")}}function Yt(e,c){if(1&e&&(t.j41(0,"mat-optgroup",22),t.Z7z(1,zt,2,3,"mat-option",18,t.fX1),t.k0s()),2&e){const n=c.$implicit;t.Y8G("label",n.name),t.R7$(),t.Dyx(n.children)}}function Lt(e,c){if(1&e&&(t.j41(0,"div",5)(1,"div",13)(2,"form",14)(3,"mat-form-field",15)(4,"mat-label"),t.EFF(5,"Nombre"),t.k0s(),t.nrm(6,"input",16),t.k0s(),t.j41(7,"mat-form-field",15)(8,"mat-label"),t.EFF(9,"Banco"),t.k0s(),t.j41(10,"mat-select",17),t.Z7z(11,Xt,2,2,"mat-option",18,nt),t.k0s()(),t.j41(13,"mat-form-field",15)(14,"mat-label"),t.EFF(15,"N\xfamero de cuenta"),t.k0s(),t.nrm(16,"input",19),t.k0s(),t.j41(17,"mat-form-field",15)(18,"mat-label"),t.EFF(19,"Beneficiario"),t.k0s(),t.nrm(20,"input",20),t.k0s(),t.j41(21,"mat-form-field",15)(22,"mat-label"),t.EFF(23,"Moneda"),t.k0s(),t.j41(24,"mat-select",17),t.Z7z(25,Qt,2,2,"mat-option",18,nt),t.k0s()(),t.j41(27,"mat-form-field",15)(28,"mat-label"),t.EFF(29,"Cuenta Contable"),t.k0s(),t.j41(30,"mat-select",21),t.Z7z(31,Yt,3,1,"mat-optgroup",22,nt),t.k0s(),t.j41(33,"mat-hint"),t.EFF(34,"Cuenta contable asociada a la moneda"),t.k0s()()()()()),2&e){const n=t.XpG();t.R7$(2),t.Y8G("formGroup",n.bankAccountForm)("autocomplete","off"),t.R7$(4),t.Y8G("formControlName","name")("placeholder","Nombre de la cuenta"),t.R7$(4),t.Y8G("formControlName","bankId")("placeholder","Seleccione un banco"),t.R7$(),t.Dyx(n.banks),t.R7$(5),t.Y8G("formControlName","no")("placeholder","0000 0000 0000 0000"),t.R7$(4),t.Y8G("formControlName","beneficiary"),t.R7$(4),t.Y8G("formControlName","currencyId")("placeholder","Seleccione una moneda"),t.R7$(),t.Dyx(n.currencies),t.R7$(5),t.Y8G("formControlName","accountId")("placeholder","Seleccione una cuenta"),t.R7$(),t.Dyx(n.accounts)}}function Vt(e,c){if(1&e){const n=t.RV6();t.j41(0,"button",25),t.bIt("click",function(){t.eBV(n);const i=t.XpG(2);return t.Njj(i.updateBankAccount())}),t.EFF(1," Actualizar "),t.k0s()}if(2&e){const n=t.XpG(2);t.Y8G("color","primary")("disabled",n.bankAccountForm.invalid)}}function Wt(e,c){if(1&e){const n=t.RV6();t.j41(0,"button",25),t.bIt("click",function(){t.eBV(n);const i=t.XpG(2);return t.Njj(i.createBankAccount())}),t.EFF(1," Agregar "),t.k0s()}if(2&e){const n=t.XpG(2);t.Y8G("color","primary")("disabled",n.bankAccountForm.invalid)}}function Pt(e,c){if(1&e&&(t.j41(0,"div",6)(1,"button",23),t.EFF(2," Cancelar "),t.k0s(),t.DNE(3,Vt,2,2,"button",24)(4,Wt,2,2,"button",24),t.k0s()),2&e){const n=t.XpG();t.R7$(),t.Y8G("matDialogClose","cancelled"),t.R7$(2),t.vxM(3,"edit"===n.data.dialogMode?3:-1),t.R7$(),t.vxM(4,"add"===n.data.dialogMode?4:-1)}}let Jt=(()=>{class e{#t;#n;#e;#o;#c;#a;#i;#s;constructor(n){this.data=n,this.dialogMode="view",this.#t=(0,t.WQX)(L.S),this.#n=(0,t.WQX)(t.gRc),this.#e=(0,t.WQX)(x.CP),this.#o=(0,t.WQX)(a.ok),this.#c=(0,t.WQX)(d.G),this.#a=(0,t.WQX)($.UG),this.#i=(0,t.WQX)(T.il),this.#s=new Y.B,this.dialogMode=n.dialogMode,this.bankAccount=n.bankAccount}ngOnInit(){this.bankAccountForm=this.#o.group({id:[null],name:[null,[a.k0.required,a.k0.minLength(3),a.k0.maxLength(255)]],bankId:[null,[a.k0.required]],no:[null,[a.k0.required,a.k0.minLength(3),a.k0.maxLength(20)]],beneficiary:[null,[a.k0.minLength(3),a.k0.maxLength(255)]],currencyId:[null,[a.k0.required]],accountId:[null]}),this.#i.select(z.N8).pipe((0,h.Q)(this.#s)).subscribe(({accounts:n})=>{this.accounts=n,console.log(n),this.#n.markForCheck()}),this.#i.select(Nt._S).pipe((0,h.Q)(this.#s)).subscribe(n=>{this.banks=n,this.#n.markForCheck()}),this.#i.select(St.y$).pipe((0,h.Q)(this.#s)).subscribe(n=>{this.currencies=n,this.#n.markForCheck()}),"edit"===this.dialogMode&&(console.log(this.bankAccount),this.bankAccountForm.patchValue(this.bankAccount))}ngOnDestroy(){this.#s.next(null),this.#s.complete()}closeDialog(){this.#e.close()}createBankAccount(){const n=this.bankAccountForm.getRawValue();delete n.id,this.#c.open({title:"Crear banco",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,h.Q)(this.#s)).subscribe(i=>{"confirmed"===i&&this.#t.createBankAccount(n).pipe((0,h.Q)(this.#s)).subscribe(({data:s})=>{s&&this.#a.openFromComponent(u.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.createBankAccount.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#n.markForCheck(),this.#e.close()})})}updateBankAccount(){const n=this.bankAccountForm.getRawValue();delete n.slug,this.#c.open({title:"Actualizar banco",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this.#t.updateBankAccount(n).pipe((0,h.Q)(this.#s)).subscribe(({data:s})=>{s&&(this.#a.openFromComponent(u.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.updateBankAccount.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#n.markForCheck(),this.#e.close())}),this.#n.markForCheck()})}static#r=this.\u0275fac=function(o){return new(o||e)(t.rXU(x.Vh))};static#l=this.\u0275cmp=t.VBU({type:e,selectors:[["accounting-bankAccount-dialog"]],standalone:!0,features:[t.aNF],decls:8,vars:5,consts:[[1,"relative","flex","flex-col","w-full","max-h-screenl"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],[1,"text-2xl","text-gray-400"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],[1,"flex-auto"],[1,"w-full","overflow-hidden"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-between","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"flex","flex-col","pt-3"],[1,"grid","w-full","grid-cols-1","gap-3","sm:grid-cols-2",3,"formGroup","autocomplete"],[1,"fuse-mat-dense"],["matInput","","type","text","required","","maxlength","250",3,"formControlName","placeholder"],["required","",3,"formControlName","placeholder"],[3,"value"],["matInput","","type","text","required","","maxlength","20",3,"formControlName","placeholder"],["matInput","","type","text","required","","maxlength","20",3,"formControlName"],[3,"formControlName","placeholder"],[3,"label"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","disabled"],["mat-flat-button","",3,"click","color","disabled"]],template:function(o,i){1&o&&(t.j41(0,"div",0)(1,"div",1),t.DNE(2,Dt,2,0,"h2",2)(3,Mt,2,0,"h2",2),t.k0s(),t.j41(4,"div",3),t.DNE(5,wt,9,1,"div",4)(6,Lt,35,13,"div",5),t.k0s(),t.DNE(7,Pt,5,3,"div",6),t.k0s()),2&o&&(t.R7$(2),t.vxM(2,"add"===i.data.dialogMode?2:-1),t.R7$(),t.vxM(3,"edit"===i.data.dialogMode?3:-1),t.R7$(2),t.vxM(5,"view"===i.data.dialogMode?5:-1),t.R7$(),t.vxM(6,6),t.R7$(),t.vxM(7,"view"!==i.data.dialogMode?7:-1))},dependencies:[k.Hl,k.$z,x.tx,g.RG,g.rl,g.nJ,g.MV,l.m_,I.fS,I.fg,C.Ve,C.VO,S.wT,S.D7,a.X1,a.qT,a.me,a.BC,a.cb,a.YS,a.tU,a.j4,a.JD],encapsulation:2})}return e})();class Ut{}const Ot=(e,c)=>c.id,qt=e=>({"pointer-events-none":e}),Zt=()=>[5,10,25,100];function Ht(e,c){if(1&e){const n=t.RV6();t.j41(0,"mat-slide-toggle",37),t.bIt("change",function(i){t.eBV(n);const s=t.XpG(),F=s.$implicit,N=s.$index,Qn=t.XpG(2);return t.Njj(Qn.updateBankAccountStatus(i,F,N))}),t.k0s()}if(2&e){const n=t.XpG().$implicit;t.Y8G("checked",n.active)("color","primary")}}function Kt(e,c){1&e&&t.nrm(0,"mat-spinner",32),2&e&&t.Y8G("diameter",20)("color","primary")}function tn(e,c){if(1&e){const n=t.RV6();t.j41(0,"div",25)(1,"div",27),t.EFF(2),t.k0s(),t.j41(3,"div",28)(4,"div",29),t.EFF(5),t.k0s()(),t.j41(6,"div",28)(7,"div",29),t.EFF(8),t.k0s()(),t.j41(9,"div",28)(10,"div",29),t.EFF(11),t.k0s()(),t.j41(12,"div",28)(13,"div",29),t.EFF(14),t.nI1(15,"number"),t.k0s()(),t.j41(16,"div",30),t.DNE(17,Ht,1,2,"mat-slide-toggle",31)(18,Kt,1,2,"mat-spinner",32),t.k0s(),t.j41(19,"div",33)(20,"button",34),t.bIt("click",function(){const i=t.eBV(n).$implicit,s=t.XpG(2);return t.Njj(s.updateBankAccount(i))}),t.nrm(21,"mat-icon",35),t.k0s(),t.j41(22,"button",36),t.bIt("click",function(){const i=t.eBV(n).$implicit,s=t.XpG(2);return t.Njj(s.deleteBankAccount(i))}),t.nrm(23,"mat-icon",35),t.k0s()()()}if(2&e){const n=c.$implicit,o=c.$index,i=t.XpG(2);t.R7$(2),t.SpI(" ",n.name," "),t.R7$(3),t.JRh(n.no),t.R7$(3),t.JRh(n.beneficiary),t.R7$(3),t.JRh((null==n.bank?null:n.bank.abbr)||""),t.R7$(3),t.Lme("",t.i5U(15,10,n.balance,"1.2-2")," ",(null==n.currency?null:n.currency.iso)||"",""),t.R7$(3),t.vxM(17,i.isLoading&&i.selectedSlide===o?-1:17),t.R7$(),t.vxM(18,i.isLoading&&i.selectedSlide===o?18:-1),t.R7$(3),t.Y8G("svgIcon","mat_solid:edit"),t.R7$(2),t.Y8G("svgIcon","mat_solid:delete")}}function nn(e,c){if(1&e&&(t.j41(0,"div",19)(1,"div",20)(2,"div",21),t.EFF(3,"Nombre"),t.k0s(),t.j41(4,"div",22),t.EFF(5," N\xfamero de Cuenta "),t.k0s(),t.j41(6,"div",22),t.EFF(7," Beneficiario "),t.k0s(),t.j41(8,"div",22),t.EFF(9," Banco "),t.k0s(),t.j41(10,"div",22),t.EFF(11," Moneda "),t.k0s(),t.j41(12,"div",23),t.EFF(13," Activo "),t.k0s(),t.j41(14,"div",24),t.EFF(15,"Acciones"),t.k0s()(),t.Z7z(16,tn,24,13,"div",25,Ot),t.k0s(),t.nrm(18,"mat-paginator",26)),2&e){const n=t.XpG();t.R7$(2),t.Y8G("mat-sort-header","name"),t.R7$(14),t.Dyx(n.bankAccounts),t.R7$(2),t.Y8G("ngClass",t.eq3(7,qt,n.isLoading))("length",n.pagination.length)("pageIndex",n.pagination.page)("pageSize",n.pagination.size)("pageSizeOptions",t.lJ4(9,Zt))("showFirstLastButtons",!0)}}function en(e,c){1&e&&(t.j41(0,"div",38),t.EFF(1,"\xa1No se ha creado ninguna cuenta bancaria!"),t.k0s())}let on=(()=>{class e{constructor(){this.bankAccounts=[],this.flashMessage=null,this.isLoading=!1,this.isSlideLoading=!1,this.merchant=null,this.merchantInputControl=new a.MJ,this.searchInputControl=new a.MJ,this.selectedSlide=null,this.user=null,this.#t=new Y.B,this.#n=(0,t.WQX)(L.S),this.#e=(0,t.WQX)(d.G),this.#o=(0,t.WQX)(t.gRc),this.#c=(0,t.WQX)(x.bZ),this.#a=(0,t.WQX)($.UG),this.store=(0,t.WQX)(T.il)}#t;#n;#e;#o;#c;#a;ngOnInit(){this.store.select(Rt.SW).pipe((0,h.Q)(this.#t)).subscribe(n=>{this.user=n,this.#o.markForCheck()}),this.store.select(Gt.Xb).pipe((0,h.Q)(this.#t)).subscribe(n=>{this.merchant=n,this.#o.markForCheck()}),this.store.select(st.b4).pipe((0,h.Q)(this.#t)).subscribe(n=>{this.bankAccounts=n,this.#o.markForCheck()}),this.store.select(ct.D).pipe((0,h.Q)(this.#t)).subscribe(n=>{this.pagination=n,this.#o.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,h.Q)(this.#t),(0,tt.B)(300),(0,G.n)(n=>(this.isLoading=!0,this.#n.getBankAccounts(this.pagination.page,this.pagination.size,this._sort.active,this._sort.direction,n))),(0,M.T)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"asc",disableClear:!0}),this.#o.markForCheck(),this._sort.sortChange.pipe((0,h.Q)(this.#t)).subscribe(()=>{this._paginator.pageIndex=0}),(0,at.h)(this._sort.sortChange,this._paginator.page).pipe((0,G.n)(()=>(this.isLoading=!0,this.#n.getBankAccounts(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction))),(0,M.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this.#t.next(null),this.#t.complete()}createBankAccount(){this.#i(new Ut,"add")}updateBankAccount(n){this.#i(n,"edit")}updateBankAccountStatus(n,o,i){this.isLoading=!0,this.selectedSlide=i,this.#n.updateBankAccountStatus({id:o.id,active:n.checked}).subscribe(({data:s})=>{this.#a.openFromComponent(u.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.updateBankAccountStatus.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.isLoading=!1,this.selectedSlide=-1,this.#o.markForCheck()})}deleteBankAccount(n){this.#e.open({title:"Cuidado",message:`\xbfEst\xe1 seguro que desea eliminar la cuenta bancaria: ${n.name}?`,icon:{show:!0,name:"mat_solid:question_mark",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,h.Q)(this.#t)).subscribe(i=>{"confirmed"===i&&this.#n.removeBankAccount(n.id).pipe((0,h.Q)(this.#t)).subscribe(({data:s})=>{s&&(this.#a.openFromComponent(u.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.removeBankAccount.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#o.markForCheck())})})}#i(n,o){this.#c.open(Jt,{data:{bankAccount:n,dialogMode:o},panelClass:"ath-dialog-panel",disableClose:!0})}static#s=this.\u0275fac=function(o){return new(o||e)};static#r=this.\u0275cmp=t.VBU({type:e,selectors:[["accounting-bankAccount-accounts"]],viewQuery:function(o,i){if(1&o&&(t.GBs(D.iy,5),t.GBs(E.B4,5)),2&o){let s;t.mGM(s=t.lsd())&&(i._paginator=s.first),t.mGM(s=t.lsd())&&(i._sort=s.first)}},standalone:!0,features:[t.aNF],decls:30,vars:9,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-600",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","bank-accounts-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[3,"mat-sort-header"],[1,"hidden","text-left","md:block"],[1,"hidden","mr-4","text-center","lg:block"],[1,"hidden","sm:block"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","bank-accounts-grid","md:px-8"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"truncate"],[1,"items-center","hidden","lg:flex"],[1,"min-w-4"],[1,"flex","justify-center","mr-4","text-center"],[3,"checked","color"],[3,"diameter","color"],[1,"flex","flex-row","justify-end","gap-2"],["mat-stroked-button","",1,"flex","flex-row","px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[3,"change","checked","color"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(o,i){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),t.EFF(6,"Inicio"),t.k0s()(),t.j41(7,"div",5),t.nrm(8,"mat-icon",6),t.j41(9,"a",7),t.EFF(10,"Contabilidad"),t.k0s()(),t.j41(11,"div",5),t.nrm(12,"mat-icon",6),t.j41(13,"a",7),t.EFF(14,"Cuentas Bancarias"),t.k0s()()(),t.j41(15,"div",8)(16,"h2",9),t.EFF(17," Cuentas Bancarias "),t.k0s()()(),t.j41(18,"div",10)(19,"mat-form-field",11),t.nrm(20,"mat-icon",12)(21,"input",13),t.k0s(),t.j41(22,"button",14),t.bIt("click",function(){return i.createBankAccount()}),t.nrm(23,"mat-icon",15),t.j41(24,"span",16),t.EFF(25,"Agregar"),t.k0s()()()(),t.j41(26,"div",17)(27,"div",18),t.DNE(28,nn,19,10)(29,en,2,0),t.k0s()()()),2&o&&(t.R7$(8),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(7),t.Y8G("subscriptSizing","dynamic"),t.R7$(),t.Y8G("svgIcon","mat_solid:search"),t.R7$(),t.Y8G("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),t.R7$(2),t.Y8G("svgIcon","mat_solid:add"),t.R7$(5),t.vxM(28,i.bankAccounts.length>0?28:29))},dependencies:[f.QX,a.YN,a.me,a.BC,k.Hl,k.$z,g.RG,g.rl,g.JW,l.m_,l.An,I.fS,I.fg,D.Ou,D.iy,R.D6,R.LG,_.mV,_.sG,E.NQ,E.B4,E.aE,f.YU,a.X1,a.l_,b.Wk],styles:[".bank-accounts-grid{grid-template-columns:200px 200px auto 200px 100px 100px 100px}\n"],encapsulation:2,changeDetection:0})}return e})();const rt=e=>e.transactions,V=((0,T.Mz)(rt,e=>e.transaction),(0,T.Mz)(rt,e=>e.transactions));var W=r(25084),et=r(96697),P=r(88141),X=r(73512),J=r(14958);const an=X.J1`
    mutation CreateTransaction($createTransactionInput: CreateTransactionInput!) {
        createTransaction(createTransactionInput: $createTransactionInput) {
            ok,
            message,

            transaction {
                id
                userId
                merchantId
                no
                type
                description
                amount
                fromBankAccountId
                toBankAccountId
                isAccounted
                date
                conceptId
                documentId
                documentType
                concept {
                    name
                }
                toBankAccount{
                    name
                    no
                }
                fromBankAccount{
                    name
                    no
                }
            }
        }
    }
`,sn=X.J1`
    query FindAllTransactions($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllTransactions(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            transactions {
                id
                userId
                merchantId
                no
                type
                description
                amount
                fromBankAccountId
                toBankAccountId
                isAccounted
                date
                conceptId
                documentId
                documentType
                concept {
                    name
                }
                toBankAccount{
                    name
                    no
                }
                fromBankAccount{
                    name
                    no
                }
            }
        }
    }
`,cn=X.J1`
    mutation UpdateTransaction($updateTransactionInput: UpdateTransactionInput!) {
        updateTransaction(updateTransactionInput: $updateTransactionInput) {
            ok,
            message,

            transaction {
                id
                userId
                merchantId
                no
                type
                description
                amount
                fromBankAccountId
                toBankAccountId
                isAccounted
                date
                conceptId
                documentId
                documentType
                concept {
                    name
                }
                toBankAccount{
                    name
                    no
                }
                fromBankAccount{
                    name
                    no
                }
            }
        }
    }
`,rn=X.J1`
    mutation RemoveTransaction($transactionId: String!) {
        removeTransaction(id: $transactionId) {
            ok,
            message,
        }
    }
`;var ln=r(98216);let ot=(()=>{class e{#t;#n=(0,t.WQX)(X.Ic);#e=(0,t.WQX)(T.il);constructor(){this.#t=this.#n.use("BALANC")}createTransaction(n){return this.#e.select(V).pipe((0,et.s)(1),(0,G.n)(o=>this.#t.mutate({mutation:an,variables:{createTransactionInput:n},errorPolicy:"all"}).pipe((0,P.M)(({data:i})=>{let s=structuredClone(o);s.push(i.createTransaction.transaction),this.#e.dispatch((0,J.As)({transactions:s}))}))))}findTransactions(n=0,o=20,i="code",s="asc",F=""){return this.#t.query({query:sn,errorPolicy:"all",variables:{page:n,size:o,sort:i,order:s,search:F}}).pipe((0,P.M)(({data:N})=>{this.#e.dispatch((0,ln.Bp)({pagination:N.findAllTransactions.pagination})),this.#e.dispatch((0,J.As)({transactions:N.findAllTransactions.transactions}))}))}updateTransaction(n){return this.#e.select(V).pipe((0,et.s)(1),(0,G.n)(o=>this.#t.mutate({mutation:cn,variables:{updateTransactionInput:n},errorPolicy:"all"}).pipe((0,P.M)(({data:i})=>{const s=structuredClone(o),F=s.findIndex(N=>N.id==N.id);s[F]=i.updateTransaction.transaction,this.#e.dispatch((0,J.As)({transactions:s}))}))))}removeTransaction(n){return this.#e.select(V).pipe((0,et.s)(1),(0,G.n)(o=>this.#t.mutate({mutation:rn,variables:{transactionId:n},errorPolicy:"all"}).pipe((0,P.M)(()=>{const i=structuredClone(o),s=o.findIndex(F=>F.id===n);i.splice(s,1),this.#e.dispatch((0,J.As)({transactions:i}))}))))}static#o=this.\u0275fac=function(o){return new(o||e)};static#c=this.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const U=(e,c)=>c.id;function dn(e,c){if(1&e&&(t.j41(0,"mat-option",21),t.EFF(1),t.k0s()),2&e){const n=c.$implicit;t.Y8G("value",n.id),t.R7$(),t.JRh(n.name)}}function mn(e,c){if(1&e&&t.Z7z(0,dn,2,2,"mat-option",21,U),2&e){const n=t.XpG(2);t.Dyx(n.expenseAccounts)}}function un(e,c){if(1&e&&(t.j41(0,"mat-option",21),t.EFF(1),t.k0s()),2&e){const n=c.$implicit;t.Y8G("value",n.id),t.R7$(),t.JRh(n.name)}}function pn(e,c){if(1&e&&t.Z7z(0,un,2,2,"mat-option",21,U),2&e){const n=t.XpG(2);t.Dyx(n.incomeAccounts)}}function hn(e,c){if(1&e&&(t.j41(0,"mat-form-field",8)(1,"mat-label"),t.EFF(2,"Concepto"),t.k0s(),t.j41(3,"mat-select",20),t.DNE(4,mn,2,0)(5,pn,2,0),t.k0s()()),2&e){const n=t.XpG();t.R7$(3),t.Y8G("formControlName","conceptId")("required",n.requireConcept)("placeholder","Seleccione el concepto"),t.R7$(),t.vxM(4,"gasto"===n.transactionForm.get("type").value?4:-1),t.R7$(),t.vxM(5,"ingreso"===n.transactionForm.get("type").value?5:-1)}}function gn(e,c){if(1&e&&(t.j41(0,"mat-option",21),t.EFF(1),t.k0s()),2&e){const n=c.$implicit;t.Y8G("value",n.id),t.R7$(),t.JRh(n.name)}}function fn(e,c){if(1&e&&(t.j41(0,"mat-form-field",8)(1,"mat-label"),t.EFF(2,"Cuenta de Origen"),t.k0s(),t.j41(3,"mat-select",22),t.Z7z(4,gn,2,2,"mat-option",21,U),t.k0s()()),2&e){const n=t.XpG();t.R7$(3),t.Y8G("formControlName","fromBankAccountId")("placeholder","Seleccione una cuenta")("required",n.requireFromBankAccountId),t.R7$(),t.Dyx(n.bankAccounts)}}function kn(e,c){if(1&e&&(t.j41(0,"mat-option",21),t.EFF(1),t.k0s()),2&e){const n=c.$implicit;t.Y8G("value",n.id),t.R7$(),t.JRh(n.name)}}function bn(e,c){if(1&e&&(t.j41(0,"mat-form-field",8)(1,"mat-label"),t.EFF(2,"Cuenta de Destino"),t.k0s(),t.j41(3,"mat-select",22),t.Z7z(4,kn,2,2,"mat-option",21,U),t.k0s()()),2&e){const n=t.XpG();t.R7$(3),t.Y8G("formControlName","toBankAccountId")("placeholder","Seleccione una cuenta")("required",n.requireToBankAccountId),t.R7$(),t.Dyx(n.bankAccounts)}}function vn(e,c){if(1&e){const n=t.RV6();t.j41(0,"button",23),t.bIt("click",function(){t.eBV(n);const i=t.XpG();return t.Njj(i.updateTransaction())}),t.EFF(1," Actualizar "),t.k0s()}if(2&e){const n=t.XpG();t.Y8G("color","primary")("disabled",n.transactionForm.invalid)}}function xn(e,c){if(1&e){const n=t.RV6();t.j41(0,"button",23),t.bIt("click",function(){t.eBV(n);const i=t.XpG();return t.Njj(i.createTransaction())}),t.EFF(1," Agregar "),t.k0s()}if(2&e){const n=t.XpG();t.Y8G("color","primary")("disabled",n.transactionForm.invalid)}}let Cn=(()=>{class e{#t;#n;#e;#o;#c;#a;#i;#s;#r;constructor(n){this.data=n,this.dialogMode="add",this.requireConcept=!1,this.requireFromBankAccountId=!1,this.requireToBankAccountId=!0,this.#t=(0,t.WQX)(t.gRc),this.#n=(0,t.WQX)(t.abz),this.#e=(0,t.WQX)(x.CP),this.#o=(0,t.WQX)(a.ok),this.#c=(0,t.WQX)(d.G),this.#a=(0,t.WQX)($.UG),this.#i=(0,t.WQX)(T.il),this.#s=(0,t.WQX)(ot),this.#r=new Y.B,this.dialogMode=n.dialogMode,this.transaction=n.transaction}ngOnInit(){this.transactionForm=this.#o.group({id:new a.MJ(null),date:new a.MJ(null,[a.k0.required]),type:new a.MJ("ingreso",[a.k0.required]),conceptId:new a.MJ(null),description:new a.MJ(null,[a.k0.required,a.k0.maxLength(255)]),amount:new a.MJ(0,[a.k0.required,a.k0.min(0),a.k0.maxLength(20)]),fromBankAccountId:new a.MJ(null),toBankAccountId:new a.MJ(null)}),this.#i.select(st.b4).pipe((0,m.pQ)(this.#n)).subscribe(n=>{this.bankAccounts=n,this.fromBankAccounts=n,this.toBankAccounts=n,this.#t.markForCheck()}),this.#i.select(z.a_).pipe((0,m.pQ)(this.#n)).subscribe(({expenseAccounts:n,incomeAccounts:o})=>{this.expenseAccounts=n,this.incomeAccounts=o,this.#t.markForCheck()}),"edit"===this.dialogMode&&this.transactionForm.patchValue(this.transaction),this.transactionForm.get("type").valueChanges.pipe((0,m.pQ)(this.#n)).subscribe(n=>{this.toBankAccounts=this.bankAccounts,this.fromBankAccounts=this.bankAccounts,this.transactionForm.get("conceptId").reset(),this.transactionForm.get("fromBankAccountId").reset(),this.transactionForm.get("toBankAccountId").reset(),"transferencia"===n&&(this.requireConcept=!1,this.requireFromBankAccountId=!0,this.requireToBankAccountId=!0),"ingreso"===n&&(this.requireConcept=!0,this.requireFromBankAccountId=!1,this.requireToBankAccountId=!0),"gasto"===n&&(this.requireConcept=!0,this.requireFromBankAccountId=!0,this.requireToBankAccountId=!1),this.#t.markForCheck()}),this.transactionForm.get("fromBankAccountId").valueChanges.pipe((0,m.pQ)(this.#n)).subscribe(n=>{this.toBankAccounts=this.bankAccounts.filter(o=>o.id!==n),this.#t.markForCheck()}),this.transactionForm.get("toBankAccountId").valueChanges.pipe((0,m.pQ)(this.#n)).subscribe(n=>{this.fromBankAccounts=this.bankAccounts.filter(o=>o.id!==n),this.#t.markForCheck()})}ngOnDestroy(){this.#r.next(null),this.#r.complete()}closeDialog(){this.#e.close()}createTransaction(){const n=this.transactionForm.getRawValue();delete n.id,this.#c.open({title:"Crear transacci\xf3n",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,m.pQ)(this.#n)).subscribe(i=>{"confirmed"===i&&this.#s.createTransaction(n).pipe((0,m.pQ)(this.#n)).subscribe(({data:s})=>{s&&this.#a.openFromComponent(u.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.createTransaction.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#t.markForCheck(),this.#e.close()})})}updateTransaction(){const n=this.transactionForm.getRawValue();delete n.slug,this.#c.open({title:"Actualizar transacci\xf3n",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this.#s.updateTransaction(n).pipe((0,m.pQ)(this.#n)).subscribe(({data:s})=>{s&&(this.#a.openFromComponent(u.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.updateTransaction.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#t.markForCheck(),this.#e.close())}),this.#t.markForCheck()})}static#l=this.\u0275fac=function(o){return new(o||e)(t.rXU(x.Vh))};static#d=this.\u0275cmp=t.VBU({type:e,selectors:[["accounting-transaction-dialog"]],standalone:!0,features:[t.aNF],decls:43,vars:16,consts:[["picker",""],[1,"relative","flex","flex-col","w-full","max-h-screenl"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],[1,"text-2xl","text-gray-400"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],[1,"w-full","overflow-hidden"],[1,"flex","flex-col","pt-3"],[1,"grid","w-full","grid-cols-1","gap-3","sm:grid-cols-2",3,"formGroup","autocomplete"],[1,"fuse-mat-dense"],["matInput","","required","",3,"matDatepicker","formControlName"],["matIconSuffix","",3,"for"],["required","",3,"formControlName"],["value","ingreso"],["value","gasto"],["value","transferencia"],["matInput","","type","text","required","","maxlength","250",3,"formControlName","placeholder"],["matInput","","type","number","required","","maxlength","20",3,"formControlName"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-between","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","disabled"],[3,"formControlName","required","placeholder"],[3,"value"],[3,"formControlName","placeholder","required"],["mat-flat-button","",3,"click","color","disabled"]],template:function(o,i){if(1&o&&(t.j41(0,"div",1)(1,"div",2)(2,"h2",3),t.EFF(3),t.k0s()(),t.j41(4,"div",4)(5,"div",5)(6,"div",6)(7,"form",7)(8,"mat-form-field",8)(9,"mat-label"),t.EFF(10,"Fecha"),t.k0s(),t.nrm(11,"input",9),t.j41(12,"mat-hint"),t.EFF(13,"DD/MM/YYYY"),t.k0s(),t.nrm(14,"mat-datepicker-toggle",10)(15,"mat-datepicker",null,0),t.k0s(),t.j41(17,"mat-form-field",8)(18,"mat-label"),t.EFF(19,"Tipo"),t.k0s(),t.j41(20,"mat-select",11)(21,"mat-option",12),t.EFF(22,"Ingreso"),t.k0s(),t.j41(23,"mat-option",13),t.EFF(24,"Gasto"),t.k0s(),t.j41(25,"mat-option",14),t.EFF(26,"Transferencia"),t.k0s()()(),t.DNE(27,hn,6,5,"mat-form-field",8),t.j41(28,"mat-form-field",8)(29,"mat-label"),t.EFF(30,"Descripci\xf3n"),t.k0s(),t.nrm(31,"input",15),t.k0s(),t.j41(32,"mat-form-field",8)(33,"mat-label"),t.EFF(34,"Importe"),t.k0s(),t.nrm(35,"input",16),t.k0s(),t.DNE(36,fn,6,3,"mat-form-field",8)(37,bn,6,3,"mat-form-field",8),t.k0s()()()(),t.j41(38,"div",17)(39,"button",18),t.EFF(40," Cancelar "),t.k0s(),t.DNE(41,vn,2,2,"button",19)(42,xn,2,2,"button",19),t.k0s()()),2&o){const s=t.sdS(16);t.R7$(3),t.SpI(" ","add"===i.data.dialogMode?"Agregar":"Editar"," Transacci\xf3n "),t.R7$(4),t.Y8G("formGroup",i.transactionForm)("autocomplete","off"),t.R7$(4),t.Y8G("matDatepicker",s)("formControlName","date"),t.R7$(3),t.Y8G("for",s),t.R7$(6),t.Y8G("formControlName","type"),t.R7$(7),t.vxM(27,"transferencia"!==i.transactionForm.get("type").value?27:-1),t.R7$(4),t.Y8G("formControlName","description")("placeholder","Descripci\xf3n de la transacci\xf3n"),t.R7$(4),t.Y8G("formControlName","amount"),t.R7$(),t.vxM(36,"gasto"===i.transactionForm.get("type").value||"transferencia"===i.transactionForm.get("type").value?36:-1),t.R7$(),t.vxM(37,"ingreso"===i.transactionForm.get("type").value||"transferencia"===i.transactionForm.get("type").value?37:-1),t.R7$(2),t.Y8G("matDialogClose","cancelled"),t.R7$(2),t.vxM(41,"edit"===i.data.dialogMode?41:-1),t.R7$(),t.vxM(42,"add"===i.data.dialogMode?42:-1)}},dependencies:[k.Hl,k.$z,W.X6,W.Vh,W.bZ,W.bU,x.tx,g.RG,g.rl,g.nJ,g.MV,g.yw,l.m_,I.fS,I.fg,C.Ve,C.VO,S.wT,a.X1,a.qT,a.me,a.Q0,a.BC,a.cb,a.YS,a.tU,a.j4,a.JD],encapsulation:2})}return e})();const _n=(e,c)=>c.id,An=e=>({"pointer-events-none":e}),Fn=()=>[5,10,25,100],yn=(e,c,n)=>({"bg-green-600 text-black":e,"bg-red-600":c,"bg-blue-600":n});function In(e,c){if(1&e){const n=t.RV6();t.j41(0,"div",25)(1,"div",22),t.EFF(2),t.nI1(3,"date"),t.k0s(),t.j41(4,"div",24),t.EFF(5),t.k0s(),t.j41(6,"div",22)(7,"span",27),t.EFF(8),t.nI1(9,"uppercase"),t.k0s()(),t.j41(10,"div",24),t.EFF(11),t.k0s(),t.j41(12,"div",22),t.EFF(13),t.nI1(14,"number"),t.k0s(),t.j41(15,"div",28),t.EFF(16),t.k0s(),t.j41(17,"div",29)(18,"button",30),t.bIt("click",function(){const i=t.eBV(n).$implicit,s=t.XpG(2);return t.Njj(s.updateTransaction(i))}),t.nrm(19,"mat-icon",31),t.k0s(),t.j41(20,"button",32),t.bIt("click",function(){const i=t.eBV(n).$implicit,s=t.XpG(2);return t.Njj(s.deleteTransaction(i))}),t.nrm(21,"mat-icon",31),t.k0s()()()}if(2&e){const n=c.$implicit;t.R7$(2),t.SpI(" ",t.i5U(3,9,n.date,"dd/MM/yyyy")," "),t.R7$(3),t.SpI(" ",n.no," "),t.R7$(2),t.Y8G("ngClass",t.sMw(17,yn,"ingreso"===n.type,"gasto"===n.type,"transferencia"===n.type)),t.R7$(),t.SpI(" ",t.bMT(9,12,n.type)," "),t.R7$(3),t.SpI(" ",(null==n.concept?null:n.concept.name)||""," "),t.R7$(2),t.SpI(" ",t.i5U(14,14,n.amount,"1.2-2")," "),t.R7$(3),t.SpI(" ",n.description||""," "),t.R7$(3),t.Y8G("svgIcon","mat_solid:edit"),t.R7$(2),t.Y8G("svgIcon","mat_solid:delete")}}function Tn(e,c){if(1&e&&(t.j41(0,"div",19)(1,"div",20)(2,"div",21),t.EFF(3," Fecha "),t.k0s(),t.j41(4,"div",21),t.EFF(5," N\xfamero "),t.k0s(),t.j41(6,"div",22),t.EFF(7," Tipo "),t.k0s(),t.j41(8,"div",23),t.EFF(9," Concepto "),t.k0s(),t.j41(10,"div",22),t.EFF(11," Importe "),t.k0s(),t.j41(12,"div",23),t.EFF(13," Descripci\xf3n "),t.k0s(),t.j41(14,"div",24),t.EFF(15,"Acciones"),t.k0s()(),t.Z7z(16,In,22,21,"div",25,_n),t.k0s(),t.nrm(18,"mat-paginator",26)),2&e){const n=t.XpG();t.R7$(2),t.Y8G("mat-sort-header","date"),t.R7$(2),t.Y8G("mat-sort-header","no"),t.R7$(12),t.Dyx(n.transactions),t.R7$(2),t.Y8G("ngClass",t.eq3(8,An,n.isLoading))("length",n.pagination.length)("pageIndex",n.pagination.page)("pageSize",n.pagination.size)("pageSizeOptions",t.lJ4(10,Fn))("showFirstLastButtons",!0)}}function Bn(e,c){1&e&&(t.j41(0,"div",33),t.EFF(1," \xa1No se ha creado ninguna transacci\xf3n! "),t.k0s())}let jn=(()=>{class e{constructor(){this.transactions=[],this.isLoading=!1,this.isSlideLoading=!1,this.searchInputControl=new a.MJ,this.selectedSlide=null,this.#t=new Y.B,this.#n=(0,t.WQX)(ot),this.#e=(0,t.WQX)(d.G),this.#o=(0,t.WQX)(t.gRc),this.#c=(0,t.WQX)(x.bZ),this.#a=(0,t.WQX)($.UG),this.store=(0,t.WQX)(T.il)}#t;#n;#e;#o;#c;#a;ngOnInit(){this.store.select(V).pipe((0,h.Q)(this.#t)).subscribe(n=>{this.transactions=n,this.#o.markForCheck()}),this.store.select(ct.D).pipe((0,h.Q)(this.#t)).subscribe(n=>{this.pagination=n,this.#o.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,h.Q)(this.#t),(0,tt.B)(300),(0,G.n)(n=>(this.isLoading=!0,this.#n.findTransactions(this.pagination.page,this.pagination.size,this.sort.active,this.sort.direction,n))),(0,M.T)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this.sort&&this.paginator&&(this.sort.sort({id:"name",start:"asc",disableClear:!0}),this.#o.markForCheck(),this.sort.sortChange.pipe((0,h.Q)(this.#t)).subscribe(()=>{this.paginator.pageIndex=0}),(0,at.h)(this.sort.sortChange,this.paginator.page).pipe((0,G.n)(()=>(this.isLoading=!0,this.#n.findTransactions(this.paginator.pageIndex,this.paginator.pageSize,this.sort.active,this.sort.direction))),(0,M.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this.#t.next(null),this.#t.complete()}createTransaction(){this.#i(null,"add")}updateTransaction(n){this.#i(n,"edit")}deleteTransaction(n){this.#e.open({title:"Cuidado",message:`\xbfEst\xe1 seguro que desea eliminar la transacci\xf3n: ${n.no}?`,icon:{show:!0,name:"mat_solid:question_mark",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,h.Q)(this.#t)).subscribe(i=>{"confirmed"===i&&this.#n.removeTransaction(n.id).pipe((0,h.Q)(this.#t)).subscribe(({data:s})=>{s&&(this.#a.openFromComponent(u.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.removeTransaction.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#o.markForCheck())})})}#i(n,o){this.#c.open(Cn,{data:{transaction:n,dialogMode:o},panelClass:"ath-dialog-panel",disableClose:!0})}static#s=this.\u0275fac=function(o){return new(o||e)};static#r=this.\u0275cmp=t.VBU({type:e,selectors:[["accounting-Transaction-accounts"]],viewQuery:function(o,i){if(1&o&&(t.GBs(D.iy,5),t.GBs(E.B4,5)),2&o){let s;t.mGM(s=t.lsd())&&(i.paginator=s.first),t.mGM(s=t.lsd())&&(i.sort=s.first)}},standalone:!0,features:[t.aNF],decls:30,vars:9,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-800","hover:bg-gradient-to-bl",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","transactions-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[3,"mat-sort-header"],[1,"text-center"],[1,"text-left"],[1,""],[1,"grid","items-center","gap-4","px-6","py-3","border-b","transactions-grid","md:px-8"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"px-2.5","py-1","rounded-full","text-xs","font-semibold","tracking-wide",3,"ngClass"],[1,"line-clamp-3"],[1,"flex","flex-row","justify-end","gap-2"],["mat-stroked-button","",1,"flex","flex-row","px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(o,i){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),t.EFF(6,"Inicio"),t.k0s()(),t.j41(7,"div",5),t.nrm(8,"mat-icon",6),t.j41(9,"a",7),t.EFF(10,"Contabilidad"),t.k0s()(),t.j41(11,"div",5),t.nrm(12,"mat-icon",6),t.j41(13,"a",7),t.EFF(14,"Transacciones"),t.k0s()()(),t.j41(15,"div",8)(16,"h2",9),t.EFF(17," Transacciones "),t.k0s()()(),t.j41(18,"div",10)(19,"mat-form-field",11),t.nrm(20,"mat-icon",12)(21,"input",13),t.k0s(),t.j41(22,"button",14),t.bIt("click",function(){return i.createTransaction()}),t.nrm(23,"mat-icon",15),t.j41(24,"span",16),t.EFF(25,"Agregar"),t.k0s()()()(),t.j41(26,"div",17)(27,"div",18),t.DNE(28,Tn,19,11)(29,Bn,2,0),t.k0s()()()),2&o&&(t.R7$(8),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(7),t.Y8G("subscriptSizing","dynamic"),t.R7$(),t.Y8G("svgIcon","mat_solid:search"),t.R7$(),t.Y8G("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),t.R7$(2),t.Y8G("svgIcon","mat_solid:add"),t.R7$(5),t.vxM(28,i.transactions.length>0?28:29))},dependencies:[f.vh,f.QX,a.YN,a.me,a.BC,k.Hl,k.$z,g.RG,g.rl,g.JW,l.m_,l.An,I.fS,I.fg,D.Ou,D.iy,R.D6,_.mV,E.NQ,E.B4,E.aE,f.YU,a.X1,a.l_,b.Wk,f.Pc],styles:[".transactions-grid{grid-template-columns:75px 120px 120px 250px 100px auto 100px}\n"],encapsulation:2,changeDetection:0})}return e})(),$n=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#n=this.\u0275cmp=t.VBU({type:e,selectors:[["accounting-panel"]],standalone:!0,features:[t.aNF],decls:2,vars:0,template:function(o,i){1&o&&(t.j41(0,"p"),t.EFF(1,"panel works!"),t.k0s())},encapsulation:2})}return e})();var Nn=r(90377),Sn=r(23301);const Xn=[{path:"",component:j,children:[{path:"panel",component:$n,resolve:{}},{path:"accounts",component:Et,resolve:{accounts:(e,c)=>(0,t.WQX)(w.u).findAccountsNodes()}},{path:"bank-accounts",component:on,resolve:{accounts:(e,c)=>(0,t.WQX)(w.u).findBankCashAccounts(),bankAccounts:(e,c)=>(0,t.WQX)(L.S).getBankAccounts(),banks:Nn._,currencies:Sn.I}},{path:"transactions",component:jn,resolve:{bankAccounts:(e,c)=>(0,t.WQX)(L.S).findActiveBankAccounts(),transactions:(e,c)=>(0,t.WQX)(ot).findTransactions(),concepts:(e,c)=>(0,t.WQX)(w.u).findConceptsAccounts()}}]}]},19669:(O,B,r)=>{r.d(B,{N8:()=>f,a_:()=>k});var b=r(59640);const t=l=>l.accounts,f=((0,b.Mz)(t,l=>l.account),(0,b.Mz)(t,l=>({accounts:l.accounts,accountsNodes:l.accountsNodes}))),k=((0,b.Mz)(t,l=>l.accountsNodes),(0,b.Mz)(t,l=>({expenseAccounts:l.expenseAccounts,incomeAccounts:l.incomeAccounts})))},25941:(O,B,r)=>{r.d(B,{_S:()=>f});var b=r(59640);const t=v=>v.banks,f=((0,b.Mz)(t,v=>v.bank),(0,b.Mz)(t,v=>v.banks))},98872:(O,B,r)=>{r.d(B,{n:()=>$});var b=r(54438),t=r(73512),j=r(96697),f=r(25558),v=r(88141),k=r(59640),l=r(58600),R=r(98216),_=r(25941);const Q=t.J1`
    mutation CreateBank($createBankInput: CreateBankInput!) {
        createBank(createBankInput: $createBankInput) {

            ok
            message

            bank {
                id
                active
                name
                abbr
                slug
                logo
                description
                createdAt
                updatedAt
                address
                country
                city
                state
                zip
            }

        }
    }
`,y=t.J1`
    mutation UpdateBank($updateBankInput: UpdateBankInput!) {
        updateBank(updateBankInput: $updateBankInput) {
            ok
            message

            bank {
                id
                active
                name
                abbr
                slug
                logo
                description
                createdAt
                updatedAt
                address
                country
                city
                state
                zip
            }
        }
    }
`,q=t.J1`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateBankStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }

    }
`,Z=t.J1`
    mutation RemoveBank($removeBankId: String!) {
        removeBank(id: $removeBankId) {
            ok
            message
        }
    }
`,H=t.J1`
    query FindAllBanks($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllBanks(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            banks {
                id
                active
                name
                description
                slug
            }
        }
    }
`,K=t.J1`
    query FindActiveBanks($search: String!, $size: Int!) {
        findActiveBanks(search: $search, size: $size) {
            ok
            message

            banks {
                id
                name
                slug
            }
        }
    }
`,x=t.J1`
    query FindBankById($findBankByIdId: String!) {
        findBankById(id: $findBankByIdId) {
            ok
            message

            bank {
                id
                active
                name
                abbr
                slug
                logo
                description
                createdAt
                updatedAt
                address
                country
                city
                state
                zip
            }
        }
    }
`;let $=(()=>{class m{constructor(){this.apolloProvider=(0,b.WQX)(t.Ic),this.store=(0,b.WQX)(k.il),this._apollo=this.apolloProvider.use("BALANC")}createBank(d){return this.store.select(_._S).pipe((0,j.s)(1),(0,f.n)(p=>this._apollo.mutate({mutation:Q,variables:{createBankInput:d},errorPolicy:"all"}).pipe((0,v.M)(({data:u})=>{const a=structuredClone(p);a.push(u.createBank.bank),this.store.dispatch((0,l.Sn)({banks:a}))}))))}getBanks(d=0,p=20,u="code",a="asc",A=""){return this._apollo.query({query:H,errorPolicy:"all",variables:{page:d,size:p,sort:u,order:a,search:A}}).pipe((0,v.M)(({data:C})=>{this.store.dispatch((0,R.Bp)({pagination:C.findAllBanks.pagination})),this.store.dispatch((0,l.Sn)({banks:C.findAllBanks.banks}))}))}findActiveBanks(d="",p=50){return this._apollo.query({query:K,errorPolicy:"all",variables:{search:d,size:p}}).pipe((0,v.M)(({data:u})=>{this.store.dispatch((0,l.Sn)({banks:u.findActiveBanks.banks}))}))}getBankById(d){return this._apollo.query({query:x,variables:{findBankByIdId:d},errorPolicy:"all"}).pipe((0,v.M)(({data:p})=>{this.store.dispatch((0,l.Vk)({bank:p.findBankById.bank}))}))}updateBank(d){return this.store.select(_._S).pipe((0,j.s)(1),(0,f.n)(p=>this._apollo.mutate({mutation:y,variables:{updateBankInput:d},errorPolicy:"all"}).pipe((0,v.M)(({data:u})=>{const a=structuredClone(p);a[p.findIndex(C=>C.id===d.id)]=u.updateBank.bank,this.store.dispatch((0,l.Sn)({banks:a}))}))))}updateBankStatus(d){return this.store.select(_._S).pipe((0,j.s)(1),(0,f.n)(p=>this._apollo.mutate({mutation:q,variables:{updateEntityStatusInput:d},errorPolicy:"all"}).pipe((0,v.M)(()=>{const u=structuredClone(p);u[p.findIndex(A=>A.id===d.id)].active=d.active,this.store.dispatch((0,l.Sn)({banks:u}))}))))}removeBank(d){return this.store.select(_._S).pipe((0,j.s)(1),(0,f.n)(p=>this._apollo.mutate({mutation:Z,variables:{removeBankId:d},errorPolicy:"all"}).pipe((0,v.M)(({})=>{const a=structuredClone(p),A=p.findIndex(C=>C.id===d);a.splice(A,1),this.store.dispatch((0,l.Sn)({banks:a}))}))))}static#t=this.\u0275fac=function(p){return new(p||m)};static#n=this.\u0275prov=b.jDH({token:m,factory:m.\u0275fac,providedIn:"root"})}return m})()}}]);