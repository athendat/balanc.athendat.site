(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[6966],{68824:(P,T,s)=>{"use strict";s.d(T,{f:()=>f});var _=s(2578),F=s(62288),b=s(17705);const v="application/vnd.openxmlformats-officedocument.spreadsheet.sheet;charset=UTF-8",j="text/plain;charset=utf-8";let f=(()=>{class y{constructor(){}exportAsExcelFile(g,I,E=[[]],M=[]){const a=F.Wp.json_to_sheet(g);let l={fill:{fgColor:{rgb:"27086f"}},font:{color:{rgb:"FFFFFF"}}};E[0].length>0&&(F.Wp.sheet_add_aoa(a,E),E[0].forEach((k,h)=>{let $=F.Wp.encode_cell({c:h,r:0});a[$].s=l})),M.length>0&&(a["!cols"]=M);const c=F.M9({Sheets:{data:a},SheetNames:["data"]},{bookType:"xlsx",type:"array"});this._saveAsFile(c,I,".xlsx",v)}exportAsCsvFile(g,I){const M={Sheets:{data:F.Wp.json_to_sheet(g)},SheetNames:["data"]},a=F.M9(M,{bookType:"csv",type:"array"});this._saveAsFile(a,I,".csv",v)}exportAsFacFile(g,I,E,M){const a="Factura_"+g.no,l=`Numero=${g.no}\nMC=CUBAN PESO\nOM=${g.currency.namev}\nFecha=${Number(g.billDate)}\nEntidad=${g.customer.code}\nConcepto=${g.concept}\nComercial=${g.commercial.name} ${g.commercial.lastname1} ${g.commercial.lastname2}\nCtaBancoMC=${E}\nCtaBancoOM=${M}\nForma=${g.paymentMethod.name}\nOperacion=${g.operationType.name}\nObservacion=${g.obs}\nMA=\nCtoArancel=\nPorcientoAra=0\nTalon=001\nContrato=\nVtaCadena=0\nNomHecho=${I.fullname}\nCargoHecho=${I.title}\nCIHecho=\nNomJA=\nCIJA=\nNomTra=\nChapa=\nLicTra=\nCITra=\nNomCliente=${g.customer.name}\nCargoCliente=\nCICliente=${g.customer.nit}\n[Propiedades]\n\n[Detalle]\n${this._versatInvoiceGenerator(g.productsInBill)}\n\n[PieFirma]\n        `;this._saveAsFile(l,a,".fac",j)}exportAsJsonFile(g){encodeURIComponent(g),this._saveAsFile(g,"data.json",".json",j)}_saveAsFile(g,I,E,M){const a=new Blob([g],{type:M});_.saveAs(a,I+"_export_"+(new Date).getTime()+E)}_versatInvoiceGenerator(g){let I="";return g.forEach(E=>{I+=`0002|002|993449|${E.uom}|1111111|0|0|0|0|0|${E.price}||0|0\n`}),I}static#e=this.\u0275fac=function(I){return new(I||y)};static#t=this.\u0275prov=b.jDH({token:y,factory:y.\u0275fac,providedIn:"root"})}return y})()},47413:(P,T,s)=>{"use strict";s.d(T,{Dz:()=>F,Lx:()=>b});var _=s(59640);const e=v=>v.pagination,F=(0,_.Mz)(e,v=>v.pagination),b=(0,_.Mz)(e,v=>v.secondaryPagination)},11781:(P,T,s)=>{"use strict";s.d(T,{BF:()=>b,UA:()=>F});var _=s(59640);const e=v=>v.locations,F=(0,_.Mz)(e,v=>v.location),b=(0,_.Mz)(e,v=>v.locations)},49098:(P,T,s)=>{"use strict";s.d(T,{O:()=>I});var _=s(88141),e=s(96354),F=s(24984),b=s(98216),v=s(53473);const j=v.J1`
    mutation CreateLocation($createLocationInput: CreateLocationInput!) {
        createLocation(createLocationInput: $createLocationInput) {

            ok
            message

            location {
                id
                active
                managerId
                # manager {
                #     name
                # }
                name
                slug
                phone
                address
                country
                state
                city
                zip
            }

        }
    }
`,n=v.J1`
    mutation UpdateLocation($updateLocationInput: UpdateLocationInput!) {
        updateLocation(updateLocationInput: $updateLocationInput) {
            ok
            message

            location {
                id
                active
                managerId
                # manager {
                #     name
                # }
                name
                slug
                phone
                address
                country
                state
                city
                zip
            }
        }
    }
`,C=v.J1`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateLocationStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }

    }
`,x=v.J1`
    mutation RemoveLocation($removeLocationId: String!) {
        removeLocation(id: $removeLocationId) {
            ok
            message
        }
    }
`,p=v.J1`
    query FindAllLocations($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllLocations(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length,
                size,
                page,
                lastPage,
                startIndex,
                endIndex
            },

            locations {
                id
                active
                managerId
                manager {
                    id
                    name
                    lastname1
                    lastname2
                    fullname
                }
                name
                slug
                phone
                address
                country
                state
                city
                zip
            }
        }
    }
`,f=v.J1`
    query findActiveLocations($search: String!, $size: Int!) {
        findActiveLocations(search: $search, size: $size) {
            id
            active
            managerId
            name
            slug
            phone
            address
            country
            state
            city
            zip
        }
    }
`,y=v.J1`
    query FindLocationById($findLocationByIdId: String!) {
        findLocationById(id: $findLocationByIdId) {
            ok
            message

            location {
                id
                active
                managerId
                # manager {
                #     name
                # }
                name
                slug
                phone
                address
                country
                state
                city
                zip
            }
        }
    }
`;var R=s(17705),g=s(59640);let I=(()=>{class E{constructor(a,l){this.apolloProvider=a,this.store=l,this._apollo=this.apolloProvider.use("BALANC")}createLocation(a){return this._apollo.mutate({mutation:j,variables:{createLocationInput:a},errorPolicy:"all"}).pipe((0,_.M)(({data:l})=>{l&&(this.store.dispatch((0,F.yJ)({location:l.createLocation.location})),this.store.dispatch((0,F.Og)({location:l.createLocation.location})))}))}getLocations(a=0,l=25,m="name",c="asc",k=""){return this._apollo.query({query:p,errorPolicy:"all",variables:{page:a,size:l,sort:m,order:c,search:k}}).pipe((0,_.M)(({data:h})=>{h&&(this.store.dispatch((0,b.Bp)({pagination:h.findAllLocations.pagination})),this.store.dispatch((0,F.xu)({locations:h.findAllLocations.locations})))}))}findActiveLocations(a="",l=25){return this._apollo.query({query:f,variables:{search:a,size:l},errorPolicy:"all"}).pipe((0,e.T)(({data:m})=>m?m.findActiveLocations:[]),(0,_.M)(m=>{m&&this.store.dispatch((0,F.xu)({locations:m}))}))}getLocationById(a){return this._apollo.query({query:y,variables:{findLocationByIdId:a},errorPolicy:"all"}).pipe((0,_.M)(({data:l})=>{l&&this.store.dispatch((0,F.Og)({location:l.findLocationById.location}))}))}updateLocation(a){return this._apollo.mutate({mutation:n,variables:{updateLocationInput:a},errorPolicy:"all"}).pipe((0,_.M)(({data:l})=>{l&&(this.store.dispatch((0,F.Nt)({location:l.updateLocation.location})),this.store.dispatch((0,F.Og)({location:l.updateLocation.location})))}))}updateLocationStatus(a){return this._apollo.mutate({mutation:C,variables:{updateEntityStatusInput:a},errorPolicy:"all"}).pipe((0,_.M)(({data:l})=>{l&&this.store.dispatch((0,F.jr)({id:a.id,active:a.active}))}))}removeLocation(a){return this._apollo.mutate({mutation:x,variables:{removeLocationId:a},errorPolicy:"all"}).pipe((0,_.M)(({data:l})=>{l&&this.store.dispatch((0,F.q$)({id:a}))}))}static#e=this.\u0275fac=function(l){return new(l||E)(R.KVO(v.Ic),R.KVO(g.il))};static#t=this.\u0275prov=R.jDH({token:E,factory:E.\u0275fac,providedIn:"root"})}return E})()},23301:(P,T,s)=>{"use strict";s.d(T,{I:()=>b,p:()=>F});var _=s(17705),e=s(92581);const F=(v,j)=>(0,_.WQX)(e.v).getCurrencies(),b=(v,j)=>(0,_.WQX)(e.v).getActiveCurrency()},91401:(P,T,s)=>{"use strict";s.d(T,{y$:()=>b});var _=s(59640);const e=v=>v.currencies,b=((0,_.Mz)(e,v=>v.currency),(0,_.Mz)(e,v=>v.currencies))},92581:(P,T,s)=>{"use strict";s.d(T,{v:()=>M});var _=s(17705),e=s(96697),F=s(25558),b=s(88141),v=s(53473),j=s(59640),n=s(98216),C=s(54588),x=s(91401);const p=v.J1`
    mutation CreateCurrency($createCurrencyInput: CreateCurrencyInput!) {
        createCurrency(createCurrencyInput: $createCurrencyInput) {

            ok
            message

            currency {
                id
                active
                name
                iso
                symbol
            }

        }
    }
`,f=v.J1`
mutation UpdateCurrency($updateCurrencyInput: UpdateCurrencyInput!) {
    updateCurrency(updateCurrencyInput: $updateCurrencyInput) {
        ok
        message

        currency {
            id
            active
            name
            iso
            symbol
        }
    }
}
`,y=v.J1`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateCurrencyStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }
    }
`,R=v.J1`
mutation RemoveCurrency($removeCurrencyId: String!) {
    removeCurrency(id: $removeCurrencyId) {
        ok,
        message
    }
}
`,g=v.J1`
    query FindAllCurrencies($offset: Int, $limit: Int, $sort: String, $order: Order, $search: String) {
        findAllCurrencies(offset: $offset, limit: $limit, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            currencies {
                id
                active
                name
                iso
                symbol
            }
        }
    }
`,I=v.J1`
    query FindAllActiveCurrencies {
        findAllActiveCurrencies {
            ok
            message

            currencies {
                id
                name
                iso
            }
        }
    }
`,E=v.J1`
    query FindCurrencyById($findCurrencyByIdId: String!) {
        findCurrencyById(id: $findCurrencyByIdId) {
            ok
            message

            currency {
                id
                active
                name
                iso
                symbol
            }
        }
    }
`;let M=(()=>{class a{constructor(){this.apolloProvider=(0,_.WQX)(v.Ic),this.store=(0,_.WQX)(j.il),this._apollo=this.apolloProvider.use("BALANC")}createCurrency(m){return this.store.select(x.y$).pipe((0,e.s)(1),(0,F.n)(c=>this._apollo.mutate({mutation:p,variables:{createCurrencyInput:m},errorPolicy:"all"}).pipe((0,b.M)(({data:k})=>{const h=structuredClone(c);h.push(k.createCurrency.currency),this.store.dispatch((0,C.Ih)({currencies:h}))}))))}getCurrencies(m=1,c=20,k="name",h="asc",D=""){return this._apollo.query({query:g,variables:{offset:c*(m-1),limit:c,sort:k,order:h,search:D},errorPolicy:"all"}).pipe((0,b.M)(({data:$})=>{this.store.dispatch((0,n.Bp)({pagination:$.findAllCurrencies.pagination})),this.store.dispatch((0,C.Ih)({currencies:$.findAllCurrencies.currencies}))}))}getActiveCurrency(){return this._apollo.query({query:I,errorPolicy:"all"}).pipe((0,b.M)(({data:m})=>{m&&this.store.dispatch((0,C.Ih)({currencies:m.findAllActiveCurrencies.currencies}))}))}getCurrencyById(m){return this._apollo.query({query:E,variables:{findCurrencyByIdId:m},errorPolicy:"all"}).pipe((0,b.M)(({data:c})=>{this.store.dispatch((0,C.MN)({currency:c.findCurrencyById.currency}))}))}updateCurrency(m){return this.store.select(x.y$).pipe((0,e.s)(1),(0,F.n)(c=>this._apollo.mutate({mutation:f,variables:{updateCurrencyInput:m},errorPolicy:"all"}).pipe((0,b.M)(({data:k})=>{const h=structuredClone(c);h[c.findIndex($=>$.id===m.id)]=k.updateCurrency.currency,this.store.dispatch((0,C.Ih)({currencies:h}))}))))}updateCurrencyStatus(m){return this.store.select(x.y$).pipe((0,e.s)(1),(0,F.n)(c=>this._apollo.mutate({mutation:y,variables:{updateEntityStatusInput:m},errorPolicy:"all"}).pipe((0,b.M)(({})=>{const h=structuredClone(c);h[c.findIndex($=>$.id===m.id)].active=m.active,this.store.dispatch((0,C.Ih)({currencies:h}))}))))}removeCurrency(m){return this.store.select(x.y$).pipe((0,e.s)(1),(0,F.n)(c=>this._apollo.mutate({mutation:R,variables:{removeCurrencyId:m},errorPolicy:"all"}).pipe((0,b.M)(({})=>{const h=structuredClone(c),D=c.findIndex($=>$.id===m);h.splice(D,1),this.store.dispatch((0,C.Ih)({currencies:h}))}))))}static#e=this.\u0275fac=function(c){return new(c||a)};static#t=this.\u0275prov=_.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})()},22419:(P,T,s)=>{"use strict";s.r(T),s.d(T,{default:()=>Dt});var _=s(51188),e=s(17705);let F=(()=>{class i{static#e=this.\u0275fac=function(r){return new(r||i)};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["module-restaurant"]],standalone:!0,features:[e.aNF],decls:1,vars:0,template:function(r,o){1&r&&e.nrm(0,"router-outlet")},dependencies:[_.iI,_.n3],encapsulation:2})}return i})(),b=(()=>{class i{static#e=this.\u0275fac=function(r){return new(r||i)};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["restaurant-menu"]],standalone:!0,features:[e.aNF],decls:2,vars:0,template:function(r,o){1&r&&(e.j41(0,"p"),e.EFF(1,"menu works!"),e.k0s())},encapsulation:2})}return i})(),v=(()=>{class i{static#e=this.\u0275fac=function(r){return new(r||i)};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["restaurant-panel"]],standalone:!0,features:[e.aNF],decls:2,vars:0,template:function(r,o){1&r&&(e.j41(0,"p"),e.EFF(1,"restaurant-panel works!"),e.k0s())},encapsulation:2})}return i})();var j=s(10467),n=s(89417),C=s(88834),x=s(53719),p=s(99213),f=s(59042),y=s(96695),R=s(9183),g=s(30450),I=s(95416),E=s(2042),M=s(60177),a=s(21413),l=s(7673),m=s(57786),c=s(56977),k=s(70152),h=s(99172),D=s(25558),$=s(96354),W=s(70980),w=s(59640),X=s(70388),z=s(47413),V=s(11825),Q=s(70819),J=s(63729),ne=s(87122),U=s(46601),L=s(94794),re=s(68824),K=s(98049),H=s(71525),se=s(56730),ae=s(64193);const ce=(i,d)=>d.id,le=()=>({wheelPropagation:!1}),me=i=>({"cursor-progress":i}),de=()=>["/modules/restaurant/receipts/receipt/new"],pe=(i,d)=>({"pointer-events-none":i,hidden:d}),ue=()=>[25,50,100],he=i=>["/modules/restaurant/receipts/receipt",i];function fe(i,d){if(1&i&&e.nrm(0,"img",32),2&i){const t=e.XpG().$implicit;e.Y8G("alt","receipt thumbnail image")("ngSrc",t.thumbnail)}}function ge(i,d){1&i&&(e.j41(0,"div",33),e.EFF(1," SIN IMAGEN "),e.k0s())}function _e(i,d){if(1&i){const t=e.RV6();e.j41(0,"mat-slide-toggle",46),e.bIt("change",function(o){e.eBV(t);const u=e.XpG(),A=u.$implicit,S=u.$index,B=e.XpG(2);return e.Njj(B.updateReceiptStatus(o,A,S))}),e.k0s()}if(2&i){const t=e.XpG().$implicit;e.Y8G("checked",t.active)("color","primary")}}function ve(i,d){1&i&&e.nrm(0,"mat-spinner",41),2&i&&e.Y8G("diameter",20)("color","primary")}function be(i,d){if(1&i){const t=e.RV6();e.j41(0,"div",26)(1,"div",28)(2,"div",29)(3,"input",30),e.bIt("change",function(o){const u=e.eBV(t).$implicit,A=e.XpG(2);return e.Njj(A.selectFiles(o,u))}),e.k0s(),e.nrm(4,"label",31),e.DNE(5,fe,1,2,"img",32)(6,ge,2,0,"div",33),e.k0s()(),e.j41(7,"div",34),e.EFF(8),e.k0s(),e.j41(9,"div",35)(10,"span",36),e.EFF(11),e.nI1(12,"number"),e.k0s(),e.j41(13,"span",37),e.EFF(14),e.k0s()(),e.j41(15,"div",35)(16,"span",36),e.EFF(17),e.nI1(18,"number"),e.k0s(),e.j41(19,"span",37),e.EFF(20),e.k0s()(),e.j41(21,"div",38),e.EFF(22),e.k0s(),e.j41(23,"div",39),e.DNE(24,_e,1,2,"mat-slide-toggle",40)(25,ve,1,2,"mat-spinner",41),e.k0s(),e.j41(26,"div",42)(27,"button",43),e.bIt("click",function(){const o=e.eBV(t).$implicit,u=e.XpG(2);return e.Njj(u.generateReceiptDataSheetDocument(o))}),e.nrm(28,"mat-icon",44),e.k0s(),e.j41(29,"button",45),e.nrm(30,"mat-icon",44),e.k0s(),e.j41(31,"button",43),e.bIt("click",function(){const o=e.eBV(t).$implicit,u=e.XpG(2);return e.Njj(u.deleteReceipt(o.id))}),e.nrm(32,"mat-icon",44),e.k0s()()()}if(2&i){const t=d.$implicit,r=d.$index,o=e.XpG(2);e.R7$(3),e.Y8G("id",t.id)("multiple",!1)("accept","image/png, image/webp, image/jpeg, image/png"),e.R7$(),e.Y8G("for",t.id),e.R7$(),e.vxM(t.thumbnail?5:-1),e.R7$(),e.vxM(t.thumbnail?-1:6),e.R7$(2),e.SpI(" ",t.name," "),e.R7$(3),e.JRh(e.i5U(12,18,t.cost,"1.2-2")),e.R7$(3),e.JRh(t.currency.iso),e.R7$(3),e.JRh(e.i5U(18,21,t.price,"1.2-2")),e.R7$(3),e.JRh(t.currency.iso),e.R7$(2),e.SpI(" ",t.salesQuantity," "),e.R7$(2),e.vxM(o.isLoading&&o.selectedSlide===r?-1:24),e.R7$(),e.vxM(o.isLoading&&o.selectedSlide===r?25:-1),e.R7$(3),e.Y8G("svgIcon","mat_solid:description"),e.R7$(),e.Y8G("routerLink",e.eq3(24,he,t.id)),e.R7$(),e.Y8G("svgIcon","mat_solid:edit"),e.R7$(2),e.Y8G("svgIcon","mat_solid:delete")}}function Ce(i,d){if(1&i&&(e.j41(0,"div",19)(1,"div",21),e.nrm(2,"div"),e.j41(3,"div",22),e.EFF(4," Nombre "),e.k0s(),e.j41(5,"div",23),e.EFF(6," Costo "),e.k0s(),e.j41(7,"div",23),e.EFF(8," Precio "),e.k0s(),e.j41(9,"div",24),e.EFF(10," U.Vendidas "),e.k0s(),e.j41(11,"div",23),e.EFF(12," Activo "),e.k0s(),e.j41(13,"div",25),e.EFF(14,"Acciones"),e.k0s()(),e.Z7z(15,be,33,26,"div",26,ce),e.nrm(17,"mat-paginator",27),e.k0s()),2&i){const t=e.XpG();e.R7$(3),e.Y8G("mat-sort-header","name"),e.R7$(2),e.Y8G("mat-sort-header","cost"),e.R7$(2),e.Y8G("mat-sort-header","price"),e.R7$(2),e.Y8G("mat-sort-header","salesQuantity"),e.R7$(2),e.Y8G("mat-sort-header","active"),e.R7$(4),e.Dyx(t.receipts),e.R7$(2),e.Y8G("ngClass",e.l_i(11,pe,t.isLoading,t.pagination.length<10&&t.pagination.page<1))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.lJ4(14,ue))("showFirstLastButtons",!0)}}function Fe(i,d){1&i&&(e.j41(0,"div",20),e.EFF(1," \xa1No se ha creado ning\xfan trago o receta! "),e.k0s())}let xe=(()=>{class i{constructor(){this.flashMessage=null,this.isLoading=!1,this.receipts=[],this.searchInputControl=new n.MJ(null),this.user=null,this.merchant=null,this.selectedSlide=null,this._changeDetectorRef=(0,e.WQX)(e.gRc),this._fileSaverService=(0,e.WQX)(re.f),this._fuseConfirmationService=(0,e.WQX)(U.G),this._documentsService=(0,e.WQX)(se.Q),this._imagesService=(0,e.WQX)(K.M),this._receiptsService=(0,e.WQX)(H.B),this._router=(0,e.WQX)(_.Ix),this._snackBar=(0,e.WQX)(I.UG),this._unsubscribeAll=new a.B,this.store=(0,e.WQX)(w.il)}ngOnInit(){this.store.select(J.SW).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(Q.Xb).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(z.Dz).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.store.select(V.Kw).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(t=>{this.receipts=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,c.Q)(this._unsubscribeAll),(0,k.B)(300),(0,h.Z)(null),(0,D.n)(t=>null!==t?(this.isLoading=!0,this._receiptsService.findAllReceipts(0,25,"name","asc",t)):(0,l.of)()),(0,$.T)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._waitForPaginatorLoad().then(t=>{this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,c.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,m.h)(this._sort.sortChange,this._paginator.page).pipe((0,D.n)(()=>(this.isLoading=!0,this._receiptsService.findAllReceipts(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,$.T)(()=>{this.isLoading=!1})).subscribe())})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this.store.dispatch((0,X.xx)())}selectFiles(t,r){if(0===t.target.files.length)return;const o=t.target.files[0];this._imagesService.validMaxMBSize(o,4)&&this._imagesService.validImageType(o)&&this._uploadFile(t,r)}updateReceiptStatus(t,r,o){this.isLoading=!0,this.selectedSlide=o,this._receiptsService.updateReceiptStatus({id:r.id,active:t.checked}).pipe((0,c.Q)(this._unsubscribeAll),(0,W.j)(()=>{this.isLoading=!1,this.selectedSlide=-1,this._changeDetectorRef.markForCheck()})).subscribe(({data:u})=>{u&&this._snackBar.openFromComponent(L.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:u.updateReceiptStatus.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}})})}deleteReceipt(t){this._fuseConfirmationService.open({title:"Eliminar Producto",message:"\xbfEsta seguro que desea eliminar el producto?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(o=>{"confirmed"===o&&this._receiptsService.removeReceipt(t).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(({data:u})=>{this._snackBar.openFromComponent(L.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:u.removeReceipt.message,type:"success",svgIcon:"mat_solid:done"}})}),this._changeDetectorRef.markForCheck()})}generateReceiptDataSheetDocument(t){this._documentsService.generateReceiptDataSheetDocument(t,this.merchant,this.user)}_uploadFile(t,r){this._imagesService.openCropperDialog(t,!1).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(o=>{o&&this._imagesService.uploadImage("receipts",o).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(u=>{this._receiptsService.updateReceiptImages(r.id,u.public_id,r.images).subscribe(A=>{this._snackBar.openFromComponent(L.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:A.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()})})})}_waitForPaginatorLoad(){var t=this;return(0,j.A)(function*(){for(;!t._paginator||void 0===t._paginator;)yield new Promise(r=>{setTimeout(r,200)});return t._paginator})()}static#e=this.\u0275fac=function(r){return new(r||i)};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["receipt"]],viewQuery:function(r,o){if(1&r&&(e.GBs(y.iy,5),e.GBs(E.B4,5)),2&r){let u;e.mGM(u=e.lsd())&&(o._paginator=u.first),e.mGM(u=e.lsd())&&(o._sort=u.first)}},standalone:!0,features:[e.aNF],decls:30,vars:16,consts:[["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent",3,"fuseScrollbarOptions","ngClass"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","flex-wrap","items-center","gap-2","mt-6","md:fixed","right-8","shrink-0","lg:mt-0","lg:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","","routerLinkActive","router-link-active",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"routerLink"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-col","justify-between","flex-auto"],[1,"relative","grid"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","receipt-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"flex","items-center","justify-start",3,"mat-sort-header"],[1,"flex","items-center","justify-center",3,"mat-sort-header"],["matTooltip","Unidades Vendidas",1,"flex","items-center","justify-center",3,"mat-sort-header"],[1,"pr-4","text-right"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","receipt-grid","md:px-8"],[1,"z-10","border-b","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-gray-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"flex","items-center"],[1,"relative","flex","items-center","justify-center","w-12","h-12","mr-6","overflow-hidden","border","rounded","flex-0"],["type","file",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"change","id","multiple","accept"],[1,"absolute","w-full","h-full","cursor-pointer",3,"for"],["for","thumbnail-file-input","width","46","height","46",1,"w-full","m-0.5","rounded",3,"alt","ngSrc"],[1,"flex","items-center","justify-center","w-full","h-full","text-xs","font-semibold","leading-none","text-center","uppercase"],[1,"truncate"],[1,"flex","flex-row","justify-center","space-x-1"],[1,"font-mono"],[1,"text-xs","text-secondary"],[1,"block","text-center"],[1,"flex","justify-center","mr-3","text-center"],[3,"checked","color"],[3,"diameter","color"],[1,"flex","flex-row","justify-end","gap-2"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[3,"change","checked","color"]],template:function(r,o){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",5),e.nrm(8,"mat-icon",6),e.j41(9,"a",7),e.EFF(10,"Restaurante"),e.k0s()(),e.j41(11,"div",5),e.nrm(12,"mat-icon",6),e.j41(13,"a",7),e.EFF(14,"Recetas"),e.k0s()()(),e.j41(15,"div",8)(16,"h2",9),e.EFF(17," Listado de Recetas "),e.k0s()()(),e.j41(18,"div",10)(19,"mat-form-field",11),e.nrm(20,"mat-icon",12)(21,"input",13),e.k0s(),e.j41(22,"button",14),e.nrm(23,"mat-icon",15),e.j41(24,"span",16),e.EFF(25,"Agregar"),e.k0s()()()(),e.j41(26,"div",17)(27,"div",18),e.DNE(28,Ce,18,15,"div",19)(29,Fe,2,0,"div",20),e.k0s()()()),2&r&&(e.Y8G("fuseScrollbarOptions",e.lJ4(12,le))("ngClass",e.eq3(13,me,o.isLoading)),e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",o.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),e.R7$(),e.Y8G("routerLink",e.lJ4(15,de)),e.R7$(),e.Y8G("svgIcon","mat_solid:add"),e.R7$(5),e.vxM(o.receipts.length>0?28:29))},dependencies:[M.QX,C.Hl,C.$z,x.RG,x.rl,x.JW,p.m_,p.An,f.fS,f.fg,y.Ou,y.iy,g.mV,g.sG,R.D6,R.LG,E.NQ,E.B4,E.aE,M.YU,n.X1,n.me,n.BC,n.l_,_.Wk,ae.p,M.kt],encapsulation:2,data:{animation:ne.X},changeDetection:0})}return i})();var G=s(75351),Re=s(79124),ye=s(76049),Ee=s(11781),Z=s(72522),N=s(82798),O=s(86600);function ke(i,d){1&i&&(e.j41(0,"h2",2),e.EFF(1," Agregar Mesa "),e.k0s())}function Ie(i,d){1&i&&(e.j41(0,"h2",2),e.EFF(1," Editar Mesa "),e.k0s())}function Te(i,d){if(1&i&&(e.j41(0,"div",4)(1,"div",7)(2,"div",8)(3,"div",9)(4,"div",10)(5,"h6",11),e.EFF(6,"Nombre"),e.k0s(),e.j41(7,"span",12),e.EFF(8),e.k0s()()()()()()),2&i){const t=e.XpG();e.R7$(8),e.SpI(" ",t.data.table.name||"Sin nombre"," ")}}function je(i,d){if(1&i&&(e.j41(0,"mat-option",19),e.EFF(1),e.k0s()),2&i){const t=d.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function Me(i,d){if(1&i&&(e.j41(0,"div",5)(1,"form",13)(2,"mat-form-field",14)(3,"mat-label"),e.EFF(4,"Nombre"),e.k0s(),e.nrm(5,"input",15),e.k0s(),e.j41(6,"mat-form-field",16)(7,"mat-label"),e.EFF(8,"Capacidad"),e.k0s(),e.nrm(9,"input",17),e.k0s(),e.j41(10,"mat-form-field",16)(11,"mat-label"),e.EFF(12,"Ubicaci\xf3n"),e.k0s(),e.j41(13,"mat-select",18),e.Z7z(14,je,2,2,"mat-option",19,e.fX1),e.k0s()()()()),2&i){const t=e.XpG();e.R7$(),e.Y8G("formGroup",t.tableForm)("autocomplete","off"),e.R7$(4),e.Y8G("formControlName","name")("placeholder","Nombre del mesa"),e.R7$(4),e.Y8G("formControlName","capacity"),e.R7$(4),e.Y8G("formControlName","locationId")("required",!0),e.R7$(),e.Dyx(t.locations)}}function $e(i,d){if(1&i){const t=e.RV6();e.j41(0,"button",22),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.updateTable())}),e.EFF(1," Actualizar "),e.k0s()}if(2&i){const t=e.XpG(2);e.Y8G("color","primary")("disabled",t.tableForm.invalid)("matDialogClose","confirmed")}}function Ae(i,d){if(1&i){const t=e.RV6();e.j41(0,"button",22),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.createTable())}),e.EFF(1," Agregar "),e.k0s()}if(2&i){const t=e.XpG(2);e.Y8G("color","primary")("disabled",t.tableForm.invalid)("matDialogClose","confirmed")}}function De(i,d){if(1&i&&(e.j41(0,"div",6)(1,"button",20),e.EFF(2," Cancelar "),e.k0s(),e.DNE(3,$e,2,3,"button",21)(4,Ae,2,3,"button",21),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("matDialogClose","cancelled"),e.R7$(2),e.vxM("edit"===t.data.dialogMode?3:-1),e.R7$(),e.vxM("add"===t.data.dialogMode?4:-1)}}let Pe=(()=>{class i{constructor(t){this.data=t,this.croppedImage="",this.dialogMode="view",this.imageChangedEvent="",this.locations=[],this._changeDetectorRef=(0,e.WQX)(e.gRc),this._dialogRef=(0,e.WQX)(G.CP),this._formBuilder=(0,e.WQX)(n.ok),this._fuseConfirmationService=(0,e.WQX)(U.G),this._snackBar=(0,e.WQX)(I.UG),this._tablesService=(0,e.WQX)(Z.T),this._unsubscribeAll=new a.B,this.store=(0,e.WQX)(w.il),this.dialogMode=t.dialogMode,this.table=t.table}ngOnInit(){this.tableForm=this._formBuilder.group({id:[null],name:[null,[n.k0.required,n.k0.minLength(3),n.k0.maxLength(255)]],capacity:[1,[n.k0.min(1),n.k0.max(24)]],locationId:[null,[n.k0.pattern("^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$")]]}),"edit"===this.dialogMode&&this.tableForm.patchValue(this.table),this.store.select(Ee.BF).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(t=>{this.locations=t,this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}createTable(){let t=this.tableForm.getRawValue();delete t.id,this._fuseConfirmationService.open({title:"Crear Mesa",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(o=>{"confirmed"===o&&this._tablesService.createTable(t).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(({data:u})=>{this._snackBar.openFromComponent(L.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:u.createTable.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._dialogRef.close()}),this._changeDetectorRef.markForCheck()})}updateTable(){const t=this.tableForm.getRawValue();this._fuseConfirmationService.open({title:"Actualizar Mesa",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(o=>{"confirmed"===o&&this._tablesService.updateTable(t).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(({data:u})=>{this._snackBar.openFromComponent(L.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:u.updateTable.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._dialogRef.close()}),this._changeDetectorRef.markForCheck()})}static#e=this.\u0275fac=function(r){return new(r||i)(e.rXU(G.Vh))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["restaurant-table-dialog"]],standalone:!0,features:[e.aNF],decls:8,vars:5,consts:[[1,"relative","flex","flex-col","w-full","max-h-screenl"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],[1,"text-2xl","text-gray-400"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],[1,"flex-auto"],[1,"w-full","overflow-hidden"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black/10"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"grid","sm:grid-cols-2","w-full","mt-1","gap-5",3,"formGroup","autocomplete"],[1,"w-full","fuse-mat-dense","sm:col-span-2"],["matInput","","type","text","required","","maxlength","250",3,"formControlName","placeholder"],[1,"w-full","fuse-mat-dense"],["matInput","","type","number","required","","min","0","max","24",3,"formControlName"],[3,"formControlName","required"],[3,"value"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","disabled","matDialogClose"],["mat-flat-button","",3,"click","color","disabled","matDialogClose"]],template:function(r,o){1&r&&(e.j41(0,"div",0)(1,"div",1),e.DNE(2,ke,2,0,"h2",2)(3,Ie,2,0,"h2",2),e.k0s(),e.j41(4,"div",3),e.DNE(5,Te,9,1,"div",4)(6,Me,16,7,"div",5),e.k0s(),e.DNE(7,De,5,3,"div",6),e.k0s()),2&r&&(e.R7$(2),e.vxM("add"===o.data.dialogMode?2:-1),e.R7$(),e.vxM("edit"===o.data.dialogMode?3:-1),e.R7$(2),e.vxM("view"===o.data.dialogMode?5:-1),e.R7$(),e.vxM(6),e.R7$(),e.vxM("view"!==o.data.dialogMode?7:-1))},dependencies:[C.Hl,C.$z,p.m_,f.fS,f.fg,x.rl,x.nJ,x.RG,N.Ve,N.VO,O.wT,n.X1,n.qT,n.me,n.Q0,n.BC,n.cb,n.YS,n.tU,n.VZ,n.zX,n.j4,n.JD,G.hM,G.tx],encapsulation:2})}return i})();const Se=i=>({"pointer-events-none":i}),Le=()=>[5,10,25,100];function Ge(i,d){if(1&i){const t=e.RV6();e.j41(0,"mat-slide-toggle",36),e.bIt("change",function(o){e.eBV(t);const u=e.XpG(),A=u.$implicit,S=u.$index,B=e.XpG(2);return e.Njj(B.updateTableStatus(o,A,S))}),e.k0s()}if(2&i){const t=e.XpG().$implicit;e.Y8G("checked",t.active)("color","primary")}}function Be(i,d){1&i&&e.nrm(0,"mat-spinner",32),2&i&&e.Y8G("diameter",20)("color","primary")}function we(i,d){if(1&i){const t=e.RV6();e.j41(0,"div",26)(1,"div",28),e.EFF(2),e.k0s(),e.j41(3,"div",29),e.EFF(4),e.k0s(),e.j41(5,"div",30),e.EFF(6),e.k0s(),e.j41(7,"div",29),e.EFF(8),e.k0s(),e.j41(9,"div",23),e.DNE(10,Ge,1,2,"mat-slide-toggle",31)(11,Be,1,2,"mat-spinner",32),e.k0s(),e.j41(12,"div",33)(13,"button",34),e.bIt("click",function(){const o=e.eBV(t).$implicit,u=e.XpG(2);return e.Njj(u.openTableDialog("edit",o))}),e.nrm(14,"mat-icon",35),e.k0s(),e.j41(15,"button",34),e.bIt("click",function(){const o=e.eBV(t).$implicit,u=e.XpG(2);return e.Njj(u.deleteTable(o))}),e.nrm(16,"mat-icon",35),e.k0s()()()}if(2&i){const t=d.$implicit,r=d.$index,o=e.XpG(2);e.R7$(2),e.SpI(" ",r+1," "),e.R7$(2),e.SpI(" ",t.name," "),e.R7$(2),e.SpI(" ",t.capacity," "),e.R7$(2),e.SpI(" ",t.location.name," "),e.R7$(2),e.vxM(o.isSlideLoading&&o.selectedSlide===r?-1:10),e.R7$(),e.vxM(o.isSlideLoading&&o.selectedSlide===r?11:-1),e.R7$(3),e.Y8G("svgIcon","mat_solid:edit"),e.R7$(2),e.Y8G("svgIcon","mat_solid:delete")}}function Ne(i,d){if(1&i&&(e.j41(0,"div",20)(1,"div",21),e.nrm(2,"div"),e.j41(3,"div",22),e.EFF(4," Nombre "),e.k0s(),e.j41(5,"div",23)(6,"div",22),e.EFF(7," Capacidad "),e.k0s()(),e.j41(8,"div"),e.EFF(9," Ubicaci\xf3n "),e.k0s(),e.j41(10,"div",24),e.EFF(11," Activo "),e.k0s(),e.j41(12,"div",25),e.EFF(13," Detalles "),e.k0s()(),e.Z7z(14,we,17,8,"div",26,e.BUC().trackByFn,!0),e.k0s(),e.nrm(16,"mat-paginator",27)),2&i){const t=e.XpG();e.R7$(3),e.Y8G("mat-sort-header","name"),e.R7$(3),e.Y8G("mat-sort-header","capacity"),e.R7$(8),e.Dyx(t.tables),e.R7$(2),e.Y8G("ngClass",e.eq3(8,Se,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.lJ4(10,Le))("showFirstLastButtons",!0)}}function Oe(i,d){1&i&&(e.j41(0,"div",19),e.EFF(1," \xa1No se ha creado ninguna mesa para el restaurante! "),e.k0s())}let Xe=(()=>{class i{constructor(){this.flashMessage=null,this.isLoading=!1,this.isSlideLoading=!1,this.merchant=null,this.merchantInputControl=new n.MJ,this.searchInputControl=new n.MJ,this.selectedSlide=null,this.tables=[],this.user=null,this._changeDetectorRef=(0,e.WQX)(e.gRc),this._dialog=(0,e.WQX)(G.bZ),this._fuseConfirmationService=(0,e.WQX)(U.G),this._snackBar=(0,e.WQX)(I.UG),this._tablesService=(0,e.WQX)(Z.T),this._unsubscribeAll=new a.B,this.store=(0,e.WQX)(w.il)}ngOnInit(){this.store.select(J.SW).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(Q.Xb).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(ye.e).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(t=>{this.tables=t,this._changeDetectorRef.markForCheck()}),this.store.select(z.Dz).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,c.Q)(this._unsubscribeAll),(0,k.B)(300),(0,D.n)(t=>(this.isLoading=!0,this._tablesService.getTables(this._paginator.pageIndex+1,this._paginator.pageSize,this._sort.active,this._sort.direction,t))),(0,$.T)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,c.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,m.h)(this._sort.sortChange,this._paginator.page).pipe((0,D.n)(()=>(this.isLoading=!0,this._tablesService.getTables(this._paginator.pageIndex+1,this._paginator.pageSize,this._sort.active,this._sort.direction))),(0,$.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this.store.dispatch((0,Re.n4)())}updateTableStatus(t,r,o){this.isSlideLoading=!0,this.selectedSlide=o,this._tablesService.updateTableStatus({id:r.id,active:t.checked}).subscribe(({data:u})=>{this._snackBar.openFromComponent(L.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:u.updateTableStatus.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.isSlideLoading=!1,this.selectedSlide=null,this._changeDetectorRef.markForCheck()})}deleteTable(t){this._fuseConfirmationService.open({title:"Eliminar mesa",message:`\xbfEst\xe1s seguro de que deseas eliminar la mesa ${t.name}? Esta acci\xf3n no se puede deshacer.`,actions:{confirm:{label:"Eliminar",color:"warn"}}}).afterClosed().pipe((0,c.Q)(this._unsubscribeAll)).subscribe(o=>{"confirmed"===o&&this._tablesService.removeTable(t.id).subscribe(({data:u})=>{this._snackBar.openFromComponent(L.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:u.removeTable.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()})})}trackByFn(t,r){return t||r.id}openTableDialog(t="add",r=null){this._dialog.open(Pe,{data:{table:r,dialogMode:t},panelClass:"ath-dialog-panel",disableClose:!0})}static#e=this.\u0275fac=function(r){return new(r||i)};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["restaurant-tables"]],viewQuery:function(r,o){if(1&r&&(e.GBs(y.iy,5),e.GBs(E.B4,5)),2&r){let u;e.mGM(u=e.lsd())&&(o._paginator=u.first),e.mGM(u=e.lsd())&&(o._sort=u.first)}},standalone:!0,features:[e.aNF],decls:30,vars:9,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","items-center","mt-6","shrink-0","lg:mt-0","lg:ml-4","gap-2"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","tables-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[3,"mat-sort-header"],[1,"flex","items-center","justify-center"],[1,"hidden","sm:block","text-center"],[1,"hidden","sm:block"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","tables-grid","md:px-8"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"flex","items-center"],[1,"truncate"],[1,"text-center"],[3,"checked","color"],[3,"diameter","color"],[1,"flex","flex-row","flex-wrap","gap-2"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[3,"change","checked","color"]],template:function(r,o){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",5),e.nrm(8,"mat-icon",6),e.j41(9,"a",7),e.EFF(10,"Restaurante"),e.k0s()(),e.j41(11,"div",5),e.nrm(12,"mat-icon",6),e.j41(13,"a",7),e.EFF(14,"Mesas"),e.k0s()()(),e.j41(15,"div",8)(16,"h2",9),e.EFF(17," Listado de Mesas "),e.k0s()()(),e.j41(18,"div",10)(19,"mat-form-field",11),e.nrm(20,"mat-icon",12)(21,"input",13),e.k0s(),e.j41(22,"button",14),e.bIt("click",function(){return o.openTableDialog()}),e.nrm(23,"mat-icon",15),e.j41(24,"span",16),e.EFF(25,"Agregar"),e.k0s()()()(),e.j41(26,"div",17)(27,"div",18),e.DNE(28,Ne,17,11)(29,Oe,2,0,"div",19),e.k0s()()()),2&r&&(e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",o.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),e.R7$(2),e.Y8G("svgIcon","mat_solid:add"),e.R7$(5),e.vxM(o.tables.length>0?28:29))},dependencies:[C.Hl,C.$z,x.RG,x.rl,x.JW,p.m_,p.An,f.fS,f.fg,y.Ou,y.iy,g.mV,g.sG,R.D6,R.LG,E.NQ,E.B4,E.aE,M.YU,n.X1,n.me,n.BC,n.l_],encapsulation:2,changeDetection:0})}return i})();var Ue=s(24121),We=s(31933),q=s(79197),ee=s(67336),te=s(82765),Ye=s(96697);const ze=[{name:"Altramuces",checked:!1},{name:"Apio",checked:!1},{name:"Cacahuetes",checked:!1},{name:"Crust\xe1ceos",checked:!1},{name:"Frutos de secos",checked:!1},{name:"Gluten",checked:!1},{name:"Huevos",checked:!1},{name:"L\xe1cteos",checked:!1},{name:"Moluscos",checked:!1},{name:"Mostaza",checked:!1},{name:"Pescado",checked:!1},{name:"S\xe9samo",checked:!1},{name:"Soja",checked:!1},{name:"Sulfitos",checked:!1}];var Ve=s(91401),ie=s(13189),Qe=s(36296),Y=s(60850);function Je(i,d){if(1&i&&(e.j41(0,"mat-option",9),e.EFF(1),e.k0s()),2&i){const t=d.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.abbr," ")}}s(52002);let Ke=(()=>{class i{constructor(t){this.product=t,this.uoms=[],this._dialogRef=(0,e.WQX)(G.CP)}ngOnInit(){this.ingredientForm=new n.gE({productId:new n.MJ("",[n.k0.required,n.k0.pattern("^[a-f0-9]{8}-[a-f0-9]{4}-4{1}[a-f0-9]{3}-[89ab]{1}[a-f0-9]{3}-[a-f0-9]{12}$")]),quantity:new n.MJ(null,[n.k0.required,n.k0.min(0)]),uomId:new n.MJ("d1fdf6c2-bbfc-4135-9106-c1fe3a63c119",[n.k0.required,n.k0.pattern("^[a-f0-9]{8}-[a-f0-9]{4}-4{1}[a-f0-9]{3}-[89ab]{1}[a-f0-9]{3}-[a-f0-9]{12}$")])}),this.ingredientForm.get("productId").setValue(this.product.id)}addIngredient(){const t=this.ingredientForm.getRawValue();this._dialogRef.close(t)}static#e=this.\u0275fac=function(r){return new(r||i)(e.rXU(G.Vh))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["receipt-ingredient-dialog"]],standalone:!0,features:[e.aNF],decls:19,vars:9,consts:[[1,"relative","flex","flex-col","w-full","max-h-screenl"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],[1,"text-2xl","text-gray-400"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],[1,"w-full","overflow-hidden"],[1,"grid","w-full","gap-5","p-1","mt-4",3,"formGroup","autocomplete"],[1,"w-full","fuse-mat-dense"],["matInput","","type","number","required","","min","0","max","99999999",3,"formControlName"],["matPrefix","",3,"formControlName"],[3,"value"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black/10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"click","color","disabled","matDialogClose"]],template:function(r,o){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"h2",2),e.EFF(3),e.k0s()(),e.j41(4,"div",3)(5,"div",4)(6,"form",5)(7,"mat-form-field",6)(8,"mat-label"),e.EFF(9,"Cantidad"),e.k0s(),e.nrm(10,"input",7),e.j41(11,"mat-select",8),e.Z7z(12,Je,2,2,"mat-option",9,e.fX1),e.k0s()()()()(),e.j41(14,"div",10)(15,"button",11),e.EFF(16," Cancelar "),e.k0s(),e.j41(17,"button",12),e.bIt("click",function(){return o.addIngredient()}),e.EFF(18," Agregar "),e.k0s()()()),2&r&&(e.R7$(3),e.SpI(" Definir la cantidad de ",o.product.name," "),e.R7$(3),e.Y8G("formGroup",o.ingredientForm)("autocomplete","off"),e.R7$(4),e.Y8G("formControlName","quantity"),e.R7$(),e.Y8G("formControlName","uomId"),e.R7$(),e.Dyx(o.uoms),e.R7$(3),e.Y8G("matDialogClose","cancelled"),e.R7$(2),e.Y8G("color","primary")("disabled",o.ingredientForm.invalid)("matDialogClose","confirmed"))},dependencies:[C.Hl,C.$z,G.hM,G.tx,f.fS,f.fg,x.rl,x.nJ,x.JW,x.RG,N.Ve,N.VO,O.wT,n.X1,n.qT,n.me,n.Q0,n.BC,n.cb,n.YS,n.VZ,n.zX,n.j4,n.JD],encapsulation:2})}return i})();var He=s(65478);const oe=i=>({"cursor-not-allowed":i});function Ze(i,d){if(1&i){const t=e.RV6();e.j41(0,"button",53),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.createReceipt())}),e.nrm(1,"mat-icon",54),e.j41(2,"span",55),e.EFF(3,"Guardar"),e.k0s()()}if(2&i){const t=e.XpG();e.Y8G("disabled",t.receiptForm.invalid)("ngClass",e.eq3(3,oe,t.receiptForm.invalid)),e.R7$(),e.Y8G("svgIcon","mat_solid:save")}}function qe(i,d){if(1&i){const t=e.RV6();e.j41(0,"button",53),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.updateReceipt())}),e.nrm(1,"mat-icon",54),e.j41(2,"span",55),e.EFF(3,"Actualizar"),e.k0s()()}if(2&i){const t=e.XpG();e.Y8G("disabled",t.receiptForm.invalid)("ngClass",e.eq3(3,oe,t.receiptForm.invalid)),e.R7$(),e.Y8G("svgIcon","mat_solid:refresh")}}function et(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El nombre del producto es obligatorio. "),e.k0s())}function tt(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El nombre del producto debe contener entre 3 y 255 caracteres. "),e.k0s())}function it(i,d){if(1&i&&(e.j41(0,"mat-option",29),e.EFF(1),e.k0s()),2&i){const t=d.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.abbr," ")}}function ot(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El valor m\xednimo del tama\xf1o de la porci\xf3n del producto debe ser 0. "),e.k0s())}function nt(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El valor m\xednimo del tama\xf1o de la porci\xf3n del producto debe ser 999999999. "),e.k0s())}function rt(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El valor m\xednimo del tiempo de preparaci\xf3n del producto debe ser 0. "),e.k0s())}function st(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El valor m\xednimo del tiempo de preparaci\xf3n del producto debe ser 999999999. "),e.k0s())}function at(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El valor m\xednimo del tiempo de cocci\xf3n del producto debe ser 0. "),e.k0s())}function ct(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El valor m\xednimo del tiempo de cocci\xf3n del producto debe ser 999999999. "),e.k0s())}function lt(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El valor m\xednimo del temperatura del producto debe ser 0. "),e.k0s())}function mt(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El valor m\xednimo del temperatura del producto debe ser 999999999. "),e.k0s())}function dt(i,d){if(1&i&&(e.j41(0,"mat-option",29),e.EFF(1),e.k0s()),2&i){const t=d.$implicit;e.Y8G("value",t),e.R7$(),e.SpI(" ",t," ")}}function pt(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," Debe seleccionar una Moneda. "),e.k0s())}function ut(i,d){if(1&i&&(e.j41(0,"mat-option",29),e.EFF(1),e.k0s()),2&i){const t=d.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.iso," ")}}function ht(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," Debe seleccionar una Moneda. "),e.k0s())}function ft(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El costo del producto es obligatorio. "),e.k0s())}function gt(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El valor m\xednimo del costo del producto debe ser 0. "),e.k0s())}function _t(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El valor m\xednimo del costo del producto debe ser 999999999. "),e.k0s())}function vt(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El precio del producto es obligatorio. "),e.k0s())}function bt(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El valor m\xednimo del precio del producto debe ser 0. "),e.k0s())}function Ct(i,d){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El valor m\xednimo del precio del producto debe ser 999999999. "),e.k0s())}function Ft(i,d){if(1&i){const t=e.RV6();e.j41(0,"mat-option",56),e.bIt("click",function(o){const u=e.eBV(t).$implicit;return e.XpG().addIngredient(u),e.Njj(o.stopPropagation())}),e.EFF(1),e.k0s()}if(2&i){const t=d.$implicit;e.R7$(),e.SpI(" ",t.name," ")}}function xt(i,d){if(1&i){const t=e.RV6();e.j41(0,"li",57),e.EFF(1),e.j41(2,"button",58),e.bIt("click",function(){const o=e.eBV(t).$implicit,u=e.XpG(2);return e.Njj(u.removeIngredient(o))}),e.nrm(3,"mat-icon",59),e.k0s()()}if(2&i){const t=d.$implicit,r=e.XpG(2);e.R7$(),e.E5c(" ",r.getProductName(t.productId)," - ",t.quantity," ",r.getUomAbbr(t.uomId)," "),e.R7$(2),e.Y8G("svgIcon","mat_solid:delete")}}function Rt(i,d){if(1&i&&(e.j41(0,"ol",46),e.Z7z(1,xt,4,4,"li",57,e.fX1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Dyx(t.ingredients)}}function yt(i,d){1&i&&(e.j41(0,"div",47),e.EFF(1," \xa1Debe seleccionar un ingrediente! "),e.k0s())}function Et(i,d){if(1&i){const t=e.RV6();e.j41(0,"div")(1,"input",66,5),e.bIt("change",function(o){e.eBV(t);const u=e.XpG(2);return e.Njj(u.selectFiles(o,"thumbnail"))}),e.k0s(),e.j41(3,"label",67),e.nrm(4,"mat-icon",68),e.k0s()()}2&i&&(e.R7$(),e.Y8G("multiple",!1)("accept","image/png, image/webp, image/jpeg, image/png"),e.R7$(3),e.Y8G("svgIcon","mat_solid:photo_camera"))}function kt(i,d){if(1&i){const t=e.RV6();e.j41(0,"div")(1,"button",58),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.removeImage("thumbnail"))}),e.nrm(2,"mat-icon",68),e.k0s()()}2&i&&(e.R7$(2),e.Y8G("svgIcon","mat_solid:delete"))}function It(i,d){if(1&i&&e.nrm(0,"img",64),2&i){const t=e.XpG(2);e.Y8G("ngSrc",t.receiptForm.get("thumbnail").value)}}function Tt(i,d){if(1&i&&(e.j41(0,"div",22),e.EFF(1," Imagen "),e.k0s(),e.j41(2,"div",60)(3,"div",61),e.nrm(4,"div",62),e.j41(5,"div",63),e.DNE(6,Et,5,3,"div")(7,kt,3,1,"div"),e.k0s(),e.DNE(8,It,1,1,"img",64),e.k0s()(),e.j41(9,"div",22),e.EFF(10," Opciones "),e.k0s(),e.j41(11,"mat-slide-toggle",65),e.EFF(12,"\xbfEst\xe1 activo?"),e.k0s()),2&i){const t=e.XpG();e.R7$(6),e.vxM(t.receiptForm.get("thumbnail").value?-1:6),e.R7$(),e.vxM(t.receiptForm.get("thumbnail").value?7:-1),e.R7$(),e.vxM(t.receiptForm.get("thumbnail").value?8:-1),e.R7$(3),e.Y8G("color","primary")("formControlName","active")}}function jt(i,d){if(1&i){const t=e.RV6();e.j41(0,"mat-checkbox",69),e.bIt("change",function(){const o=e.eBV(t).$implicit,u=e.XpG();return e.Njj(u.toggleReceiptAllergen(o.name))}),e.EFF(1),e.k0s()}if(2&i){const t=d.$implicit,r=e.XpG();e.Y8G("color","primary")("checked",r.allergens.includes(t.name)),e.R7$(),e.SpI(" ",t.name," ")}}let Mt=(()=>{class i{constructor(){this.addOnBlur=!0,this.allergensList=ze,this.allergens=[],this.classifications=["Agregos","Bebidas","Ensaladas","Entrantes","Guarniciones","Panes","Pastas","Pizzas","Platos fuertes","Postres","Sopas"],this.currencies=[],this.editMode=!1,this.flashMessage=null,this.images=[],this.isLoading=!1,this.products=[],this.ingredients=[],this.filteredProducts=[],this.receiptId=null,this.searchProductControl=new n.MJ(null),this.selectedReceipt=null,this.separatorKeysCodes=[ee.Fm,ee.KE],this.tagsEditMode=!1,this.thumbnail="",this.uoms=[],this._unsubscribeAll=new a.B,this._activatedRoute=(0,e.WQX)(_.nX),this._changeDetectorRef=(0,e.WQX)(e.gRc),this._dialog=(0,e.WQX)(G.bZ),this._formBuilder=(0,e.WQX)(n.ok),this._fuseConfirmationService=(0,e.WQX)(U.G),this._imagesService=(0,e.WQX)(K.M),this._productsService=(0,e.WQX)(Qe.g),this._receiptsService=(0,e.WQX)(H.B),this._router=(0,e.WQX)(_.Ix),this._snackBar=(0,e.WQX)(I.UG),this.store=(0,e.WQX)(w.il)}ngOnInit(){this.receiptForm=this._formBuilder.group({id:new n.MJ(""),name:new n.MJ("",[n.k0.required,n.k0.minLength(3),n.k0.maxLength(255)]),uomId:new n.MJ("d1fdf6c2-bbfc-4135-9106-c1fe3a63c119",[n.k0.required]),thumbnail:new n.MJ(""),active:new n.MJ(!0),tags:new n.MJ([]),cost:new n.MJ(0,[n.k0.required,n.k0.min(0),n.k0.max(999999999),n.k0.maxLength(9)]),price:new n.MJ(0,[n.k0.required,n.k0.min(0),n.k0.max(999999999),n.k0.maxLength(9)]),portionSize:new n.MJ(null,[n.k0.min(0),n.k0.max(999999999),n.k0.maxLength(9)]),preparationTime:new n.MJ(null,[n.k0.min(0),n.k0.max(999999999),n.k0.maxLength(9)]),temperature:new n.MJ(null,[n.k0.min(0),n.k0.max(9999),n.k0.maxLength(4)]),cookingTime:new n.MJ(null,[n.k0.min(0),n.k0.max(9999),n.k0.maxLength(4)]),allergens:new n.Yp([]),classification:new n.MJ(""),description:new n.MJ("",[n.k0.maxLength(1e4)]),elaboration:new n.MJ("",[n.k0.maxLength(1e4)]),presentation:new n.MJ("",[n.k0.maxLength(1e4)]),equipments:new n.MJ("",[n.k0.maxLength(1e4)]),currencyId:new n.MJ("",[n.k0.required]),images:new n.MJ([]),ingredients:new n.Yp([])}),this._activatedRoute.params.pipe((0,c.Q)(this._unsubscribeAll)).subscribe(({receiptId:t})=>{this.receiptId=t,"new"!==this.receiptId&&(this.editMode=!0,this.store.select(V.bW).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(r=>{this.receiptForm.patchValue(r),this.images=r.images,this.selectedReceipt=r,this.ingredients=r.ingredients})),this._changeDetectorRef.markForCheck()}),this.store.select(Ve.y$).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(t=>{this.currencies=t,this._changeDetectorRef.markForCheck()}),this.store.select(ie.VW).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(t=>{this.products=t,this.filteredProducts=t,this._changeDetectorRef.markForCheck()}),this.store.select(ie.O).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(t=>{this.tags=structuredClone(t),this.filteredTags=structuredClone(t),this._changeDetectorRef.markForCheck()}),this.searchProductControl.valueChanges.pipe((0,c.Q)(this._unsubscribeAll),(0,k.B)(200)).subscribe(t=>{this.filteredProducts=this.products.filter(r=>r.name.toLowerCase().includes(t.toLowerCase())),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this.store.dispatch((0,X.md)())}toggleReceiptAllergen(t){""!==t&&(this.allergens.includes(t)?this.allergens.splice(this.allergens.indexOf(t),1):this.allergens.push(t),this._changeDetectorRef.markForCheck())}addIngredient(t){this._dialog.open(Ke,{data:t,panelClass:"ath-dialog-panel",maxWidth:"300px",disableClose:!0}).afterClosed().pipe((0,Ye.s)(1)).subscribe(r=>{r&&(this.ingredients.push(r),this._changeDetectorRef.markForCheck())})}removeIngredient(t){this.ingredients.splice(this.ingredients.indexOf(t),1),this._changeDetectorRef.markForCheck()}getProductName(t){const r=this.products.find(o=>o.id===t);return r?r.name:""}getUomAbbr(t){const r=this.uoms.find(o=>o.id===t);return r?r.abbr:""}toggleTagsEditMode(){this.tagsEditMode=!this.tagsEditMode}filterTags(t){const r=t.target.value.toLowerCase();this.filteredTags=this.tags.filter(o=>o.name.toLowerCase().includes(r))}filterTagsInputKeyDown(t){if("Enter"!==t.key)return;if(0===this.filteredTags.length)return this.createTag(t.target.value),void(t.target.value="");const r=this.filteredTags[0];this.selectedReceipt.tags.find(u=>u===r.id)?this.removeTagFromProduct(r):this.addTagToProduct(r)}createTag(t){this._productsService.createTag({active:!0,name:t}).subscribe(({data:o})=>{this.addTagToProduct(o.createTag.tag),this._changeDetectorRef.markForCheck()})}updateTagName(t,r){t.name=r.target.value,delete t.__typename,setTimeout(()=>{this._productsService.updateTag(t).pipe((0,k.B)(300)).subscribe(()=>{this._changeDetectorRef.markForCheck()})},1e3)}deleteTag(t){this._productsService.deleteTag(t.id).subscribe(),this._changeDetectorRef.markForCheck()}addTagToProduct(t){const r=structuredClone(this.selectedReceipt);r.tags.unshift(t.id),this.receiptForm.get("tags").patchValue(r.tags),this._changeDetectorRef.markForCheck()}removeTagFromProduct(t){const r=this.receiptForm.getRawValue();r.tags.splice(r.tags.findIndex(o=>o===t.id),1),this.receiptForm.get("tags").patchValue(r.tags),this._changeDetectorRef.markForCheck()}toggleProductTag(t,r){r.checked?this.addTagToProduct(t):this.removeTagFromProduct(t)}shouldShowCreateTagButton(t){return!(""===t||this.tags.findIndex(r=>r.name.toLowerCase()===t.toLowerCase())>-1)}createReceipt(){const t=this.receiptForm.getRawValue();delete t.id,delete t.active,t.ingredients=this.ingredients,t.allergens=this.allergens,this._fuseConfirmationService.open({title:"Crear producto ",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(o=>{"confirmed"===o&&this._receiptsService.createReceipt(t).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(({data:u})=>{this._snackBar.openFromComponent(L.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:u.createReceipt.message,type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/modules/restaurant/receipts")}),this._changeDetectorRef.markForCheck()})}updateReceipt(){const t=this.receiptForm.getRawValue();t.ingredients=this.ingredients,t.allergens=this.allergens,this._fuseConfirmationService.open({title:"Actualizar Producto",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(o=>{"confirmed"===o&&this._receiptsService.updateReceipt(t).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(({data:u})=>{this._snackBar.openFromComponent(L.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:u.updateReceipt.message,type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/modules/restaurant/receipts")}),this._changeDetectorRef.markForCheck()})}selectFiles(t,r){if(0===t.target.files.length)return;const o=t.target.files[0];this._imagesService.validMaxMBSize(o,4)&&this._imagesService.validImageType(o)&&this._uploadFile(t,r)}removeImage(t){this._fuseConfirmationService.open({title:"Cuidado",message:"\xbfEst\xe1 seguro que desea eliminar esta imagen?",icon:{show:!0,name:"mat_solid:question_mark",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,c.Q)(this._unsubscribeAll)).subscribe(o=>{if("confirmed"===o){const u=this.receiptForm.get(t).value;this._imagesService.removeImage(u).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(A=>{switch(t){case"images":this.receiptForm.get(t).setValue([]);break;case"thumbnail":this.receiptForm.get(t).setValue(null)}const S=this.receiptForm.getRawValue();this.editMode&&this._receiptsService.updateReceiptImages(S.id,S.thumbnail,S.images).subscribe(B=>{this._snackBar.openFromComponent(L.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:B.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}})},B=>{this.receiptForm.get(t).setValue(u)}),this._changeDetectorRef.markForCheck()})}})}displayFn(t){return t&&t.name?t.name:""}_uploadFile(t,r){this._imagesService.openCropperDialog(t,!1).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(o=>{o&&this._imagesService.uploadImage("receipts",o).pipe((0,c.Q)(this._unsubscribeAll)).subscribe(u=>{this.receiptForm.get(r).setValue(u.public_id);const A=this.receiptForm.getRawValue();this.editMode&&this._receiptsService.updateReceiptImages(A.id,A.thumbnail,A.images).subscribe(S=>{this._snackBar.openFromComponent(L.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:S.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()},S=>{this.receiptForm.get(r).setValue(null)}),this._changeDetectorRef.markForCheck()})})}_mapChecked(t){return t.pipe((0,$.T)(r=>r.map(o=>this.receiptForm.get("ingredients").getRawValue().some(A=>A.id===o.id)?{...structuredClone(o),checked:!0}:{...structuredClone(o),checked:!1})))}static#e=this.\u0275fac=function(r){return new(r||i)};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["receipt-form"]],standalone:!0,features:[e.aNF],decls:147,vars:52,consts:[["descriptionLength",""],["elaborationLength",""],["presentationLength",""],["equipmentsLength",""],["productsAutocomplete","matAutocomplete"],["thumbnailFileInput",""],["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","gap-5","p-3","overflow-y-auto","bg-cover","sm:absolute","sm:inset-0","dark:bg-transparent"],[1,"z-20","flex","flex-col","bg-transparent","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:px-5"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/restaurant/dashboard",1,"ml-1","text-primary-500"],["routerLink","/modules/restaurant/receipts",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","items-center","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-600",3,"disabled","ngClass"],[1,"flex","flex-auto"],[1,"w-full",3,"formGroup","autocomplete"],[1,"grid","grid-cols-1","gap-3","sm:grid-cols-4"],[1,"flex","flex-col","gap-3","p-3","rounded-md","shadow-md","sm:col-span-3","bg-card"],[1,"text-xl","font-semibold"],[1,"grid","grid-cols-1","gap-3","mt-5","sm:grid-cols-2","lg:grid-cols-4"],[1,"w-full","sm:col-span-4","fuse-mat-dense"],["matInput","","type","text","minlength","3","maxlength","255","required","",3,"formControlName"],[1,"w-full","fuse-mat-dense"],["matInput","","type","number","formControlName","portionSize","min","0"],["matSuffix","",3,"value","formControlName"],[3,"value"],["matPrefix","",1,"pr-1"],["matInput","","type","number","formControlName","preparationTime","min","0"],["matInput","","type","number","formControlName","cookingTime","min","0"],["matInput","","type","number","formControlName","temperature","min","0"],[3,"formControlName","required"],["matInput","","type","number","formControlName","cost","min","0"],["matInput","","type","number","formControlName","price","min","0"],[1,"w-full","sm:col-span-4"],["matInput","","matTextareaAutoSize","","maxlength","10000",3,"formControlName","rows"],[1,"w-full","text-right"],["appearance","fill",1,"w-full","sm:col-span-4","fuse-mat-dense"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete",3,"closed","displayWith"],[1,"w-full"],[1,"flex","flex-col","w-full","space-y-4","sm:col-span-4"],[1,"list-decimal"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"],[1,"flex","flex-col","gap-3","p-3","rounded-md","shadow-md","bg-card"],[1,"flex","flex-col","mt-5"],[1,"mb-px","text-xl","font-semibold","leading-tight"],[1,"flex","flex-col","items-start","mt-1.5","rounded-md"],[1,"flex","items-center","h-10","min-h-8",3,"color","checked"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-600",3,"click","disabled","ngClass"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"w-full",3,"click"],[1,"flex","items-center","space-x-2"],["mat-icon-button","",3,"click"],[1,"text-white","icon-size-5",3,"svgIcon"],[1,"flex","items-center","justify-center","flex-auto","max-h-40"],[1,"relative","flex","items-center","justify-center","w-32","h-32","overflow-hidden","rounded-md","ring-4","ring-bg-card"],[1,"absolute","inset-0","z-10","bg-opacity-50","bg-slate-300"],[1,"absolute","inset-0","z-20","flex","items-center","justify-center"],["height","800","width","800",1,"object-cover","w-full","h-full",3,"ngSrc"],[3,"color","formControlName"],["id","thumbnail-file-input","type","file",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"change","multiple","accept"],["for","thumbnail-file-input","matRipple","",1,"flex","items-center","justify-center","w-10","h-10","rounded-full","cursor-pointer","hover:bg-hover"],[1,"text-white",3,"svgIcon"],[1,"flex","items-center","h-10","min-h-8",3,"change","color","checked"]],template:function(r,o){if(1&r){const u=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div",8)(3,"div")(4,"div",9)(5,"div")(6,"a",10),e.EFF(7,"Inicio"),e.k0s()(),e.j41(8,"div",11),e.nrm(9,"mat-icon",12),e.j41(10,"a",13),e.EFF(11,"Restaurante"),e.k0s()(),e.j41(12,"div",11),e.nrm(13,"mat-icon",12),e.j41(14,"a",14),e.EFF(15,"Recetas"),e.k0s()(),e.j41(16,"div",11),e.nrm(17,"mat-icon",12),e.j41(18,"a",15),e.EFF(19),e.k0s()()()()(),e.j41(20,"div",16),e.DNE(21,Ze,4,5,"button",17)(22,qe,4,5,"button",17),e.k0s()(),e.j41(23,"div",18)(24,"form",19)(25,"div",20)(26,"div",21)(27,"div",22),e.EFF(28," Informaci\xf3n General "),e.k0s(),e.j41(29,"div",23)(30,"mat-form-field",24)(31,"mat-label"),e.EFF(32,"Nombre"),e.k0s(),e.nrm(33,"input",25),e.DNE(34,et,2,0,"mat-error")(35,tt,2,0,"mat-error"),e.k0s(),e.j41(36,"mat-form-field",26)(37,"mat-label"),e.EFF(38,"Tama\xf1o de la porci\xf3n "),e.k0s(),e.nrm(39,"input",27),e.j41(40,"mat-select",28),e.Z7z(41,it,2,2,"mat-option",29,e.fX1),e.k0s(),e.DNE(43,ot,2,0,"mat-error")(44,nt,2,0,"mat-error"),e.k0s(),e.j41(45,"mat-form-field",26)(46,"mat-label"),e.EFF(47,"Tiempo de preparaci\xf3n "),e.k0s(),e.j41(48,"span",30),e.EFF(49,"Minutos: "),e.k0s(),e.nrm(50,"input",31),e.DNE(51,rt,2,0,"mat-error")(52,st,2,0,"mat-error"),e.k0s(),e.j41(53,"mat-form-field",26)(54,"mat-label"),e.EFF(55,"Tiempo de cocci\xf3n "),e.k0s(),e.j41(56,"span",30),e.EFF(57,"Minutos: "),e.k0s(),e.nrm(58,"input",32),e.DNE(59,at,2,0,"mat-error")(60,ct,2,0,"mat-error"),e.k0s(),e.j41(61,"mat-form-field",26)(62,"mat-label"),e.EFF(63,"Temperatura "),e.k0s(),e.j41(64,"span",30),e.EFF(65,"\xbaC: "),e.k0s(),e.nrm(66,"input",33),e.DNE(67,lt,2,0,"mat-error")(68,mt,2,0,"mat-error"),e.k0s(),e.j41(69,"mat-form-field",26)(70,"mat-label"),e.EFF(71,"Clasificaci\xf3n"),e.k0s(),e.j41(72,"mat-select",34),e.Z7z(73,dt,2,2,"mat-option",29,e.fX1),e.k0s(),e.DNE(75,pt,2,0,"mat-error"),e.k0s(),e.j41(76,"mat-form-field",26)(77,"mat-label"),e.EFF(78,"Moneda"),e.k0s(),e.j41(79,"mat-select",34),e.Z7z(80,ut,2,2,"mat-option",29,e.fX1),e.k0s(),e.DNE(82,ht,2,0,"mat-error"),e.k0s(),e.j41(83,"mat-form-field",26)(84,"mat-label"),e.EFF(85,"Costo "),e.k0s(),e.nrm(86,"input",35),e.DNE(87,ft,2,0,"mat-error")(88,gt,2,0,"mat-error")(89,_t,2,0,"mat-error"),e.k0s(),e.j41(90,"mat-form-field",26)(91,"mat-label"),e.EFF(92,"Precio "),e.k0s(),e.nrm(93,"input",36),e.DNE(94,vt,2,0,"mat-error")(95,bt,2,0,"mat-error")(96,Ct,2,0,"mat-error"),e.k0s(),e.j41(97,"mat-form-field",37)(98,"mat-label"),e.EFF(99,"Descripci\xf3n"),e.k0s(),e.nrm(100,"textarea",38,0),e.j41(102,"mat-hint",39),e.EFF(103),e.k0s()(),e.j41(104,"mat-form-field",37)(105,"mat-label"),e.EFF(106,"Elaboraci\xf3n"),e.k0s(),e.nrm(107,"textarea",38,1),e.j41(109,"mat-hint",39),e.EFF(110),e.k0s()(),e.j41(111,"mat-form-field",37)(112,"mat-label"),e.EFF(113,"Presentaci\xf3n"),e.k0s(),e.nrm(114,"textarea",38,2),e.j41(116,"mat-hint",39),e.EFF(117),e.k0s()(),e.j41(118,"mat-form-field",37)(119,"mat-label"),e.EFF(120,"Equipos Necesarios"),e.k0s(),e.nrm(121,"textarea",38,3),e.j41(123,"mat-hint",39),e.EFF(124),e.k0s()(),e.j41(125,"mat-form-field",40)(126,"mat-label"),e.EFF(127,"Ingredientes"),e.k0s(),e.nrm(128,"mat-icon",41)(129,"input",42),e.j41(130,"mat-autocomplete",43,4),e.bIt("closed",function(){return e.eBV(u),e.Njj(o.searchProductControl.reset())}),e.Z7z(132,Ft,2,1,"mat-option",44,e.fX1),e.k0s()(),e.j41(134,"div",45)(135,"div",22),e.EFF(136," Lista de ingredientes "),e.k0s(),e.DNE(137,Rt,3,0,"ol",46)(138,yt,2,0,"div",47),e.k0s()()(),e.j41(139,"div",48),e.DNE(140,Tt,13,5),e.j41(141,"div",49)(142,"span",50),e.EFF(143,"Al\xe9rgenos"),e.k0s(),e.j41(144,"div",51),e.Z7z(145,jt,2,3,"mat-checkbox",52,e.fX1),e.k0s()()()()()()()}if(2&r){const u=e.sdS(101),A=e.sdS(108),S=e.sdS(115),B=e.sdS(122),Pt=e.sdS(131);e.R7$(9),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(2),e.SpI(" ","new"===o.receiptId?"Crear":"Editar"," "),e.R7$(2),e.vxM(o.editMode?-1:21),e.R7$(),e.vxM(o.editMode?22:-1),e.R7$(2),e.Y8G("formGroup",o.receiptForm)("autocomplete","off"),e.R7$(9),e.Y8G("formControlName","name"),e.R7$(),e.vxM(o.receiptForm.get("name").hasError("required")?34:-1),e.R7$(),e.vxM(o.receiptForm.get("name").hasError("minlength")||o.receiptForm.get("name").hasError("maxlength")?35:-1),e.R7$(5),e.Y8G("value","kg")("formControlName","uomId"),e.R7$(),e.Dyx(o.uoms),e.R7$(2),e.vxM(o.receiptForm.get("portionSize").hasError("min")?43:-1),e.R7$(),e.vxM(o.receiptForm.get("portionSize").hasError("max")?44:-1),e.R7$(7),e.vxM(o.receiptForm.get("preparationTime").hasError("min")?51:-1),e.R7$(),e.vxM(o.receiptForm.get("preparationTime").hasError("max")?52:-1),e.R7$(7),e.vxM(o.receiptForm.get("cookingTime").hasError("min")?59:-1),e.R7$(),e.vxM(o.receiptForm.get("cookingTime").hasError("max")?60:-1),e.R7$(7),e.vxM(o.receiptForm.get("temperature").hasError("min")?67:-1),e.R7$(),e.vxM(o.receiptForm.get("temperature").hasError("max")?68:-1),e.R7$(4),e.Y8G("formControlName","classification")("required",!0),e.R7$(),e.Dyx(o.classifications),e.R7$(2),e.vxM(o.receiptForm.get("classification").hasError("required")?75:-1),e.R7$(4),e.Y8G("formControlName","currencyId")("required",!0),e.R7$(),e.Dyx(o.currencies),e.R7$(2),e.vxM(o.receiptForm.get("currencyId").hasError("required")?82:-1),e.R7$(5),e.vxM(o.receiptForm.get("cost").hasError("required")?87:-1),e.R7$(),e.vxM(o.receiptForm.get("cost").hasError("min")?88:-1),e.R7$(),e.vxM(o.receiptForm.get("cost").hasError("max")?89:-1),e.R7$(5),e.vxM(o.receiptForm.get("price").hasError("required")?94:-1),e.R7$(),e.vxM(o.receiptForm.get("price").hasError("min")?95:-1),e.R7$(),e.vxM(o.receiptForm.get("price").hasError("max")?96:-1),e.R7$(4),e.Y8G("formControlName","description")("rows",2),e.R7$(3),e.SpI(" Total de caracteres ",u.value.length," /10000 "),e.R7$(4),e.Y8G("formControlName","elaboration")("rows",2),e.R7$(3),e.SpI(" Total de caracteres ",A.value.length," /10000 "),e.R7$(4),e.Y8G("formControlName","presentation")("rows",2),e.R7$(3),e.SpI(" Total de caracteres ",S.value.length," /10000 "),e.R7$(4),e.Y8G("formControlName","equipments")("rows",2),e.R7$(3),e.SpI(" Total de caracteres ",B.value.length," /10000 "),e.R7$(4),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",o.searchProductControl)("matAutocomplete",Pt)("placeholder","Buscar ingredientes"),e.R7$(),e.Y8G("displayWith",o.displayFn),e.R7$(2),e.Dyx(o.products),e.R7$(5),e.vxM(o.ingredients.length>0?137:138),e.R7$(3),e.vxM(o.editMode?140:-1),e.R7$(5),e.Dyx(o.allergensList)}},dependencies:[Y.jL,He.uv,Y.$3,O.wT,Y.pN,C.Hl,C.$z,C.iY,te.g7,te.So,x.RG,x.rl,x.nJ,x.MV,x.TL,x.JW,x.yw,p.m_,p.An,f.fS,f.fg,y.Ou,O.pZ,O.r6,N.Ve,N.VO,g.mV,g.sG,R.D6,E.NQ,M.YU,n.X1,n.qT,n.me,n.Q0,n.BC,n.cb,n.YS,n.xh,n.tU,n.VZ,n.l_,n.j4,n.JD,_.Wk,M.kt],encapsulation:2,changeDetection:0})}return i})();var $t=s(23301),At=s(43801);const Dt=[{path:"",component:F,children:[{path:"",pathMatch:"full",redirectTo:"dashboard"},{path:"dashboard",component:v},{path:"menu",component:b,resolve:{}},{path:"tables",component:Xe,resolve:{locations:Ue.FH,tables:We.g}},{path:"receipts",component:xe,resolve:{receipts:q.W9}},{path:"receipts/receipt/:receiptId",component:Mt,resolve:{currencies:$t.I,products:At.Tn,receipt:q.dg}},{path:"**",redirectTo:"dashboard"}]}]},43801:(P,T,s)=>{"use strict";s.d(T,{Bj:()=>v,N4:()=>x,Tn:()=>C,bN:()=>j,eX:()=>b});var _=s(17705),e=s(36296),F=s(4840);const b=(f,y)=>{const R=f.params.productId;return R&&"new"!==R?(0,_.WQX)(e.g).getProductById(R):{}},v=(f,y)=>(0,_.WQX)(e.g).getProducts(),j=(f,y)=>(0,_.WQX)(e.g).findActiveProducts(),C=(f,y)=>(0,_.WQX)(e.g).findIngredients(),x=(f,y)=>(0,_.WQX)(F.t).getProductsInStockAvailable()},36296:(P,T,s)=>{"use strict";s.d(T,{g:()=>I});var _=s(33446),e=s(96697),F=s(25558),b=s(88141),v=s(96354),j=s(62288),n=s(98216),C=s(39928),x=s(13189),p=s(84342),f=s(5864),y=s(17705),R=s(53473),g=s(59640);let I=(()=>{class E{constructor(a,l){this.apolloProvider=a,this.store=l,this._apollo=this.apolloProvider.use("BALANC")}createProduct(a){return this.store.select(x.VW).pipe((0,e.s)(1),(0,F.n)(l=>this._apollo.mutate({mutation:p.xq,variables:{createProductInput:a},errorPolicy:"all"}).pipe((0,b.M)(({data:m})=>{const c=(0,_.A)(l);c.push(m.createProduct.product),this.store.dispatch((0,C.d9)({products:c}))}))))}importProductsFromTemplateFile(a,l){return this._apollo.mutate({mutation:p.YV,variables:{importProductsTemplateFileInput:{products:a,depotId:l}},errorPolicy:"all"}).pipe((0,b.M)(({data:m})=>{this.store.dispatch((0,C.d9)({products:m.importProductsFromTemplateFile.products})),this.store.dispatch((0,n.Bp)({pagination:m.importProductsFromTemplateFile.pagination}))}))}getProducts(a=0,l=50,m="name",c="asc",k=""){return this._apollo.query({query:p.oH,errorPolicy:"all",variables:{page:a,size:l,sort:m,order:c,search:k}}).pipe((0,b.M)(({data:h})=>{this.store.dispatch((0,C.d9)({products:h.findAllProducts.products})),this.store.dispatch((0,n.Bp)({pagination:h.findAllProducts.pagination}))}))}findProductsToList(){return this._apollo.query({query:p.pg,errorPolicy:"all"}).pipe((0,b.M)(({data:a})=>{this.store.dispatch((0,C.d9)({products:a.findProductsToList.products}))}))}findIngredients(){return this._apollo.query({query:p.Cm,errorPolicy:"all"}).pipe((0,b.M)(({data:a})=>{this.store.dispatch((0,C.d9)({products:a.findIngredients.products}))}))}getProductsByMerchant(a=1,l=50,m="name",c="asc",k=""){return this._apollo.query({query:p.zb,errorPolicy:"all",variables:{offset:l*(a-1),limit:l,sort:m,order:c,search:k}}).pipe((0,b.M)(({data:h})=>{this.store.dispatch((0,C.d9)({products:h.findAllProductsByMerchant.products})),this.store.dispatch((0,n.Bp)({pagination:h.findAllProductsByMerchant.pagination}))}))}getProductsActive(){return this._apollo.query({query:p.r,errorPolicy:"all"}).pipe((0,b.M)(({})=>{}))}findActiveProducts(a="",l=10){return this._apollo.query({query:p.LS,variables:{search:a,size:l},errorPolicy:"all"}).pipe((0,v.T)(({data:m})=>m?m.findActiveProducts:[]),(0,b.M)(m=>{m&&this.store.dispatch((0,C.d9)({products:m}))}))}findProductsByUpcS(a=[]){return this._apollo.query({query:p.hE,variables:{upcS:a},errorPolicy:"all"}).pipe((0,v.T)(({data:l})=>l?l.findProductsByUpcS:[]))}getProductsInactive(){return this._apollo.query({query:p.Ax,errorPolicy:"all"}).pipe((0,b.M)(({})=>{}))}getProductsExhausted(){return this._apollo.query({query:p.mU,errorPolicy:"all"}).pipe((0,b.M)(({})=>{}))}getProductById(a){return this._apollo.query({query:p.De,variables:{productId:a},errorPolicy:"all"}).pipe((0,b.M)(({data:l})=>{this.store.dispatch((0,C.yz)({product:l.findProductById.product}))}))}updateProduct(a){return this.store.select(x.VW).pipe((0,e.s)(1),(0,F.n)(l=>this._apollo.mutate({mutation:p.q,variables:{updateProductInput:a},errorPolicy:"all"}).pipe((0,b.M)(({data:m})=>{const c=(0,_.A)(l);c[l.findIndex(h=>h.id===a.id)]=m.updateProduct.product,this.store.dispatch((0,C.d9)({products:c})),this.store.dispatch((0,C.yz)({product:m.updateProduct.product}))}))))}updateProductStatus(a){return this.store.select(x.VW).pipe((0,e.s)(1),(0,F.n)(l=>this._apollo.mutate({mutation:p.bM,variables:{updateEntityStatusInput:a},errorPolicy:"all"}).pipe((0,b.M)(({data:m})=>{if(m){const c=(0,_.A)(l);c[l.findIndex(h=>h.id===a.id)].active=a.active,this.store.dispatch((0,C.d9)({products:c}))}}))))}updateProductImages(a,l,m){return this._apollo.mutate({mutation:p.B9,variables:{updateProductById:a,thumbnail:l,images:m},errorPolicy:"all"}).pipe((0,v.T)(({data:c})=>c?c.updateProductImages:null),(0,b.M)(c=>{c&&this.store.dispatch((0,C.NM)({id:c.product.id,thumbnail:c.product.thumbnail,images:c.product.images}))}))}removeProduct(a){return this.store.select(x.VW).pipe((0,e.s)(1),(0,F.n)(l=>this._apollo.mutate({mutation:p.Fu,variables:{removeProductId:a},errorPolicy:"all"}).pipe((0,b.M)(({data:m})=>{if(m){const c=(0,_.A)(l),k=l.findIndex(h=>h.id===a);c.splice(k,1),this.store.dispatch((0,C.d9)({products:c}))}}))))}getTags(a=1,l=50,m="name",c="asc",k=""){return this._apollo.query({query:p.J,errorPolicy:"all",variables:{offset:l*(a-1),limit:l,sort:m,order:c,search:k}}).pipe((0,b.M)(({data:h})=>{this.store.dispatch((0,C.Wt)({tags:h.findAllTags.tags}))}))}createTag(a){return this.store.select(x.O).pipe((0,e.s)(1),(0,F.n)(l=>this._apollo.mutate({mutation:p.Op,variables:{createTagInput:a},errorPolicy:"all"}).pipe((0,b.M)(({data:m})=>{const c=(0,_.A)(l);c.push(m.createTag.tag),this.store.dispatch((0,C.Wt)({tags:c}))}))))}updateTag(a){return this.store.select(x.O).pipe((0,e.s)(1),(0,F.n)(l=>this._apollo.mutate({mutation:p.zk,variables:{updateTagInput:a},errorPolicy:"all"}).pipe((0,b.M)(({data:m})=>{const c=(0,_.A)(l);c[l.findIndex(h=>h.id===a.id)]=m.updateTag.tag,this.store.dispatch((0,C.Wt)({tags:c}))}))))}deleteTag(a){return this.store.select(x.O).pipe((0,e.s)(1),(0,F.n)(l=>this._apollo.mutate({mutation:p.GR,variables:{removeTagId:a},errorPolicy:"all"}).pipe((0,b.M)(()=>{const m=(0,_.A)(l),c=l.findIndex(k=>k.id===a);m.splice(c,1),this.store.dispatch((0,C.Wt)({tags:m}))}))))}getProductsAvailable(){return this._apollo.query({query:p.my,errorPolicy:"all"}).pipe((0,b.M)(({})=>{}))}importStockFormTemplateFile(a){let l;function m(h){return{upc:h.UPC?h.UPC.toString():null,sku:h.SKU?h.SKU.toString():null,bCode:h.C\u00f3digo?h.C\u00f3digo.toString():null,name:h.Nombre,description:f.H.IsNullOrEmpty(h.Descripci\u00f3n)?"":h.Descripci\u00f3n,uom:h["Unidad de Medida"],quantity:h.Cantidad,cost:h.Costo,price:h.Precio,brand:h.Marca,weight:h.Peso,width:h.Ancho,length:h.Largo,height:h.Altura,volume:h.Volumen,isPerishable:!!h["N\xfamero de Lote"],lotNumber:h["N\xfamero de Lote"]?h["N\xfamero de Lote"].toString().trim():null,dueDate:f.H.isValidDate(h["Fecha de Vencimiento"])?new Date(h["Fecha de Vencimiento"]):null}}const c=a.target,k=new FileReader;k.onload=h=>{const $=j.LF(h.target.result,{type:"binary"});l=j.Wp.sheet_to_json($.Sheets[$.SheetNames[0]]);const X=l.map(m);this.store.dispatch((0,C.GQ)({products:X}))},k.readAsBinaryString(c.files[0])}static#e=this.\u0275fac=function(l){return new(l||E)(y.KVO(R.Ic),y.KVO(g.il))};static#t=this.\u0275prov=y.jDH({token:E,factory:E.\u0275fac,providedIn:"root"})}return E})()},2578:function(P,T){var s,e;void 0!==(e="function"==typeof(s=function(){"use strict";function b(p,f,y){var R=new XMLHttpRequest;R.open("GET",p),R.responseType="blob",R.onload=function(){x(R.response,f,y)},R.onerror=function(){console.error("could not download file")},R.send()}function v(p){var f=new XMLHttpRequest;f.open("HEAD",p,!1);try{f.send()}catch{}return 200<=f.status&&299>=f.status}function j(p){try{p.dispatchEvent(new MouseEvent("click"))}catch{var f=document.createEvent("MouseEvents");f.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),p.dispatchEvent(f)}}var n="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,C=n.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),x=n.saveAs||("object"!=typeof window||window!==n?function(){}:"download"in HTMLAnchorElement.prototype&&!C?function(p,f,y){var R=n.URL||n.webkitURL,g=document.createElement("a");g.download=f=f||p.name||"download",g.rel="noopener","string"==typeof p?(g.href=p,g.origin===location.origin?j(g):v(g.href)?b(p,f,y):j(g,g.target="_blank")):(g.href=R.createObjectURL(p),setTimeout(function(){R.revokeObjectURL(g.href)},4e4),setTimeout(function(){j(g)},0))}:"msSaveOrOpenBlob"in navigator?function(p,f,y){if(f=f||p.name||"download","string"!=typeof p)navigator.msSaveOrOpenBlob(function F(p,f){return typeof f>"u"?f={autoBom:!1}:"object"!=typeof f&&(console.warn("Deprecated: Expected third argument to be a object"),f={autoBom:!f}),f.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(p.type)?new Blob(["\ufeff",p],{type:p.type}):p}(p,y),f);else if(v(p))b(p,f,y);else{var R=document.createElement("a");R.href=p,R.target="_blank",setTimeout(function(){j(R)})}}:function(p,f,y,R){if((R=R||open("","_blank"))&&(R.document.title=R.document.body.innerText="downloading..."),"string"==typeof p)return b(p,f,y);var g="application/octet-stream"===p.type,I=/constructor/i.test(n.HTMLElement)||n.safari,E=/CriOS\/[\d]+/.test(navigator.userAgent);if((E||g&&I||C)&&typeof FileReader<"u"){var M=new FileReader;M.onloadend=function(){var m=M.result;m=E?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),R?R.location.href=m:location=m,R=null},M.readAsDataURL(p)}else{var a=n.URL||n.webkitURL,l=a.createObjectURL(p);R?R.location=l:location.href=l,R=null,setTimeout(function(){a.revokeObjectURL(l)},4e4)}});n.saveAs=x.saveAs=x,P.exports=x})?s.apply(T,[]):s)&&(P.exports=e)},33446:(P,T,s)=>{"use strict";s.d(T,{A:()=>v});var _=s(71252);const v=function b(j){return(0,_.A)(j,5)}}}]);