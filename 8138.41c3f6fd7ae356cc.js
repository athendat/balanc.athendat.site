"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[8138],{9427:(J,q,s)=>{s.d(q,{t:()=>m,x:()=>T});var v=s(19212),e=s(46482);const T=(n,I)=>(0,v.f3M)(e.t).getCurrencies(),m=(n,I)=>(0,v.f3M)(e.t).getActiveCurrency()},21510:(J,q,s)=>{s.d(q,{zd:()=>m});var v=s(84221);const e=n=>n.currencies,m=((0,v.P1)(e,n=>n.currency),(0,v.P1)(e,n=>n.currencies))},46482:(J,q,s)=>{s.d(q,{t:()=>D});var v=s(19212),e=s(48180),T=s(94664),m=s(99397),n=s(50967),I=s(84221),F=s(97214),A=s(20997),y=s(21510);const P=n.Ps`
    mutation CreateCurrency($createCurrencyInput: CreateCurrencyInput!) {
        createCurrency(createCurrencyInput: $createCurrencyInput) {

            ok
            message

            currency {
                id
                active
                name
                iso
                symbol
            }

        }
    }
`,R=n.Ps`
mutation UpdateCurrency($updateCurrencyInput: UpdateCurrencyInput!) {
    updateCurrency(updateCurrencyInput: $updateCurrencyInput) {
        ok
        message

        currency {
            id
            active
            name
            iso
            symbol
        }
    }
}
`,M=n.Ps`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateCurrencyStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }
    }
`,E=n.Ps`
mutation RemoveCurrency($removeCurrencyId: String!) {
    removeCurrency(id: $removeCurrencyId) {
        ok,
        message
    }
}
`,N=n.Ps`
    query FindAllCurrencies($offset: Int, $limit: Int, $sort: String, $order: Order, $search: String) {
        findAllCurrencies(offset: $offset, limit: $limit, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            currencies {
                id
                active
                name
                iso
                symbol
            }
        }
    }
`,U=n.Ps`
    query FindAllActiveCurrencies {
        findAllActiveCurrencies {
            ok
            message

            currencies {
                id
                name
                iso
            }
        }
    }
`,w=n.Ps`
    query FindCurrencyById($findCurrencyByIdId: String!) {
        findCurrencyById(id: $findCurrencyByIdId) {
            ok
            message

            currency {
                id
                active
                name
                iso
                symbol
            }
        }
    }
`;let D=(()=>{class g{constructor(){this.apolloProvider=(0,v.f3M)(n._M),this.store=(0,v.f3M)(I.yh),this._apollo=this.apolloProvider.use("BALANC")}createCurrency(C){return this.store.select(y.zd).pipe((0,e.q)(1),(0,T.w)(h=>this._apollo.mutate({mutation:P,variables:{createCurrencyInput:C},errorPolicy:"all"}).pipe((0,m.b)(({data:d})=>{const p=structuredClone(h);p.push(d.createCurrency.currency),this.store.dispatch((0,A.HC)({currencies:p}))}))))}getCurrencies(C=1,h=20,d="name",p="asc",f=""){return this._apollo.query({query:N,variables:{offset:h*(C-1),limit:h,sort:d,order:p,search:f},errorPolicy:"all"}).pipe((0,m.b)(({data:_})=>{this.store.dispatch((0,F.Jr)({pagination:_.findAllCurrencies.pagination})),this.store.dispatch((0,A.HC)({currencies:_.findAllCurrencies.currencies}))}))}getActiveCurrency(){return this._apollo.query({query:U,errorPolicy:"all"}).pipe((0,m.b)(({data:C})=>{C&&this.store.dispatch((0,A.HC)({currencies:C.findAllActiveCurrencies.currencies}))}))}getCurrencyById(C){return this._apollo.query({query:w,variables:{findCurrencyByIdId:C},errorPolicy:"all"}).pipe((0,m.b)(({data:h})=>{this.store.dispatch((0,A.NW)({currency:h.findCurrencyById.currency}))}))}updateCurrency(C){return this.store.select(y.zd).pipe((0,e.q)(1),(0,T.w)(h=>this._apollo.mutate({mutation:R,variables:{updateCurrencyInput:C},errorPolicy:"all"}).pipe((0,m.b)(({data:d})=>{const p=structuredClone(h);p[h.findIndex(_=>_.id===C.id)]=d.updateCurrency.currency,this.store.dispatch((0,A.HC)({currencies:p}))}))))}updateCurrencyStatus(C){return this.store.select(y.zd).pipe((0,e.q)(1),(0,T.w)(h=>this._apollo.mutate({mutation:M,variables:{updateEntityStatusInput:C},errorPolicy:"all"}).pipe((0,m.b)(({})=>{const p=structuredClone(h);p[h.findIndex(_=>_.id===C.id)].active=C.active,this.store.dispatch((0,A.HC)({currencies:p}))}))))}removeCurrency(C){return this.store.select(y.zd).pipe((0,e.q)(1),(0,T.w)(h=>this._apollo.mutate({mutation:E,variables:{removeCurrencyId:C},errorPolicy:"all"}).pipe((0,m.b)(({})=>{const p=structuredClone(h),f=h.findIndex(_=>_.id===C);p.splice(f,1),this.store.dispatch((0,A.HC)({currencies:p}))}))))}static#e=this.\u0275fac=function(h){return new(h||g)};static#t=this.\u0275prov=v.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"})}return g})()},6514:(J,q,s)=>{s.d(q,{u:()=>T});var v=s(19212),e=s(865);const T=(m,n)=>(0,v.f3M)(e.o).getPaymentMethods()},302:(J,q,s)=>{s.d(q,{VS:()=>m});var v=s(84221);const e=n=>n.paymentMethods,m=((0,v.P1)(e,n=>n.paymentMethod),(0,v.P1)(e,n=>n.paymentMethods))},865:(J,q,s)=>{s.d(q,{o:()=>g});var v=s(19212),e=s(48180),T=s(94664),m=s(99397),n=s(50967),I=s(84221),F=s(97214),A=s(72435),y=s(302),P=s(42090);const R=n.Ps`
   query FindAllPaymentMethods($offset: Int, $limit: Int, $sort: String, $order: Order, $search: String) {
        findAllPaymentMethods(offset: $offset, limit: $limit, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            paymentMethods {
                id
                active
                name
            }
        }
    }
`,M=n.Ps`
    query FindPaymentMethodById($findPaymentMethodById: String!) {
        findPaymentMethodById(id: $findPaymentMethodById) {
            ok
            message

            paymentMethod {
                id
                active
                name
            }
        }
    }
`,E=n.Ps`
    mutation CreatePaymentMethod($createPaymentMethodInput: CreatePaymentMethodInput!) {
        createPaymentMethod(createPaymentMethodInput: $createPaymentMethodInput) {
            ok
            message

            paymentMethod {
                id
                active
                name
            }
        }
    }
`,N=n.Ps`
    mutation UpdatePaymentMethod($updatePaymentMethodInput: UpdatePaymentMethodInput!) {
        updatePaymentMethod(updatePaymentMethodInput: $updatePaymentMethodInput) {
            ok
            message

            paymentMethod {
                id
                active
                name
            }
        }
    }
`,U=n.Ps`
    mutation RemovePaymentMethod($removePaymentMethodId: String!) {
        removePaymentMethod(id: $removePaymentMethodId) {
            ok
            message
        }
    }
`,w=n.Ps`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updatePaymentMethodStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }
    }
`;var D=s(22939);let g=(()=>{class k{constructor(h){this._snackBar=h,this.apolloProvider=(0,v.f3M)(n._M),this.store=(0,v.f3M)(I.yh),this._apollo=this.apolloProvider.use("BALANC")}createPaymentMethod(h){return this.store.select(y.VS).pipe((0,e.q)(1),(0,T.w)(d=>this._apollo.mutate({mutation:E,variables:{createPaymentMethodInput:h},errorPolicy:"all"}).pipe((0,m.b)(({errors:p,data:f})=>{if(p){let x="";p.forEach(Z=>x+=`\n ${Z.message}.`),this._snackBar.openFromComponent(P.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:x,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const _=structuredClone(d);_.push(f.createPaymentMethod.paymentMethod),this.store.dispatch((0,A.DA)({paymentMethods:_}))}))))}getPaymentMethods(h=1,d=500,p="name",f="asc",_=""){return this._apollo.query({query:R,errorPolicy:"all",variables:{offset:d*(h-1),limit:d,sort:p,order:f,search:_}}).pipe((0,m.b)(({errors:x,data:Z})=>{if(x){let $="";x.forEach(ne=>$+=`\n ${ne.message}.`),this._snackBar.openFromComponent(P.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:$,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,A.DA)({paymentMethods:Z.findAllPaymentMethods.paymentMethods})),this.store.dispatch((0,F.Jr)({pagination:Z.findAllPaymentMethods.pagination}))}))}getPaymentMethodById(h){return this._apollo.query({query:M,variables:{findPaymentMethodByIdId:h},errorPolicy:"all"}).pipe((0,m.b)(({errors:d,data:p})=>{if(d){let f="";d.forEach(_=>f+=`\n ${_.message}.`),this._snackBar.openFromComponent(P.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:f,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,A.$P)({paymentMethod:p.findPaymentMethodById.paymentMethod}))}))}updatePaymentMethod(h){return this.store.select(y.VS).pipe((0,e.q)(1),(0,T.w)(d=>this._apollo.mutate({mutation:N,variables:{updatePaymentMethodInput:h},errorPolicy:"all"}).pipe((0,m.b)(({errors:p,data:f})=>{if(p){let Z="";p.forEach($=>Z+=`\n ${$.message}.`),this._snackBar.openFromComponent(P.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:Z,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const _=structuredClone(d);_[d.findIndex(Z=>Z.id===h.id)]=f.updatePaymentMethod.paymentMethod,this.store.dispatch((0,A.DA)({paymentMethods:_}))}))))}updatePaymentMethodStatus(h){return this.store.select(y.VS).pipe((0,e.q)(1),(0,T.w)(d=>this._apollo.mutate({mutation:w,variables:{updateEntityStatusInput:h},errorPolicy:"all"}).pipe((0,m.b)(({errors:p})=>{if(p){let x="";p.forEach(Z=>x+=`\n ${Z.message}.`),this._snackBar.openFromComponent(P.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:x,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const f=structuredClone(d);f[d.findIndex(x=>x.id===h.id)].active=h.active,this.store.dispatch((0,A.DA)({paymentMethods:f}))}))))}removePaymentMethod(h){return this.store.select(y.VS).pipe((0,e.q)(1),(0,T.w)(d=>this._apollo.mutate({mutation:U,variables:{removePaymentMethodId:h},errorPolicy:"all"}).pipe((0,m.b)(({errors:p})=>{if(p){let x="";p.forEach(Z=>x+=`\n ${Z.message}.`),this._snackBar.openFromComponent(P.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:x,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const f=structuredClone(d),_=d.findIndex(x=>x.id===h);f.splice(_,1),this.store.dispatch((0,A.DA)({paymentMethods:f}))}))))}static#e=this.\u0275fac=function(d){return new(d||k)(v.LFG(D.ux))};static#t=this.\u0275prov=v.Yz7({token:k,factory:k.\u0275fac,providedIn:"root"})}return k})()},10959:(J,q,s)=>{s.d(q,{I:()=>T});const T=(0,s(84221).P1)(m=>m.rates,m=>m.rates)},66330:(J,q,s)=>{s.d(q,{m:()=>k});var v=s(19212),e=s(48180),T=s(94664),m=s(99397),n=s(37398),I=s(50967),F=s(84221),A=s(97214),y=s(65413),P=s(10959);const R=I.Ps`
    mutation CreateRate($createRateInput: CreateRateInput!) {
        createRate(createRateInput: $createRateInput) {

            ok
            message

            rate {
                id
                active
                userId
                date
                name
                value

                currencyRefId
                currencyRef {
                    id
                    name
                    iso
                }

                currencyBaseId
                currencyBase {
                    id
                    name
                    iso
                }
            }

        }
    }
`,M=I.Ps`
    mutation UpdateRate($updateRateInput: UpdateRateInput!) {
        updateRate(updateRateInput: $updateRateInput) {
            ok
            message

            rate {
                id
                active
                userId
                date
                name
                value

                currencyRefId
                currencyRef {
                    id
                    name
                    iso
                }

                currencyBaseId
                currencyBase {
                    id
                    name
                    iso
                }
            }
        }
    }
`,E=I.Ps`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateRateStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }

    }
`,N=I.Ps`
    mutation RemoveRate($removeRateId: String!) {
        removeRate(id: $removeRateId) {
            ok
            message
        }
    }
`,U=I.Ps`
    query FindAllRates($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllRates(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length,
                size,
                page,
                lastPage,
                startIndex,
                endIndex
            }

            rates {
                id
                active
                userId
                date
                name
                value

                currencyRefId
                currencyRef {
                    id
                    name
                    iso
                }

                currencyBaseId
                currencyBase {
                    id
                    name
                    iso
                }
            }
        }
    }
`,w=I.Ps`
    query FindActiveByBaseId($currencyBaseId: String!) {
        findActiveByBaseId(currencyBaseId: $currencyBaseId) {
            id
            active
            date
            name
            value
            currencyRefId

            currencyRef {
                id
                iso
            }

            currencyBaseId

            currencyBase {
                id
                iso
            }
        }
    }
`,D=I.Ps`
    query FindActiveRateByBaseIdForAthendatPlatform($currencyBaseId: String!) {
        getActiveRateByBaseIdForAthendatPlatform(currencyBaseId: $currencyBaseId) {
            id
            active
            date
            name
            value
            currencyRefId

            currencyRef {
                id
                iso
            }

            currencyBaseId

            currencyBase {
                id
                iso
            }
        }
    }
`,g=I.Ps`
    query FindRateById($findRateByIdId: String!) {
        findRateById(id: $findRateByIdId) {
            ok
            message

            rate {
                id
                active
                userId
                date
                name
                value

                currencyRefId
                currencyRef {
                    id
                    name
                    iso
                }

                currencyBaseId
                currencyBase {
                    id
                    name
                    iso
                }
            }
        }
    }
`;let k=(()=>{class C{constructor(){this.apolloProvider=(0,v.f3M)(I._M),this.store=(0,v.f3M)(F.yh),this._apollo=this.apolloProvider.use("BALANC")}createRate(d){return this.store.select(P.I).pipe((0,e.q)(1),(0,T.w)(p=>this._apollo.mutate({mutation:R,variables:{createRateInput:d},errorPolicy:"all"}).pipe((0,m.b)(({data:f})=>{const _=structuredClone(p);_.push(f.createRate.rate),this.store.dispatch((0,y.jM)({rates:_}))}))))}getRates(d=0,p=10,f="name",_="asc",x=""){return this._apollo.query({query:U,errorPolicy:"all",variables:{page:d,size:p,sort:f,order:_,search:x}}).pipe((0,m.b)(({data:Z})=>{this.store.dispatch((0,A.Jr)({pagination:Z.findAllRates.pagination})),this.store.dispatch((0,y.jM)({rates:Z.findAllRates.rates}))}))}findActiveByBaseId(d){return this._apollo.query({query:w,variables:{currencyBaseId:d},errorPolicy:"all"}).pipe((0,n.U)(({data:p})=>p?p.findActiveByBaseId:[]),(0,m.b)(p=>{p&&this.store.dispatch((0,y.jM)({rates:p}))}))}getActiveRateByBaseIdForAthendatPlatform(d){return this._apollo.query({query:D,variables:{currencyBaseId:d},errorPolicy:"all"}).pipe((0,n.U)(({data:p})=>p?p.getActiveRateByBaseIdForAthendatPlatform:null),(0,m.b)(p=>{p&&this.store.dispatch((0,y.FY)({rate:p}))}))}getRateById(d){return this._apollo.query({query:g,variables:{findRateByIdId:d},errorPolicy:"all"}).pipe((0,m.b)(({data:p})=>{this.store.dispatch((0,y.FY)({rate:p.findRateById.rate}))}))}updateRate(d){return this.store.select(P.I).pipe((0,e.q)(1),(0,T.w)(p=>this._apollo.mutate({mutation:M,variables:{updateRateInput:d},errorPolicy:"all"}).pipe((0,m.b)(({data:f})=>{const _=structuredClone(p);_[p.findIndex(Z=>Z.id===d.id)]=f.updateRate.rate,this.store.dispatch((0,y.jM)({rates:_}))}))))}updateRateStatus(d){return this.store.select(P.I).pipe((0,e.q)(1),(0,T.w)(p=>this._apollo.mutate({mutation:E,variables:{updateEntityStatusInput:d},errorPolicy:"all"}).pipe((0,m.b)(({})=>{const _=structuredClone(p);_[p.findIndex(Z=>Z.id===d.id)].active=d.active,this.store.dispatch((0,y.jM)({rates:_}))}))))}removeRate(d){return this.store.select(P.I).pipe((0,e.q)(1),(0,T.w)(p=>this._apollo.mutate({mutation:N,variables:{removeRateId:d},errorPolicy:"all"}).pipe((0,m.b)(({data:f})=>{if(f){const _=structuredClone(p),x=p.findIndex(Z=>Z.id===d);_.splice(x,1),this.store.dispatch((0,y.jM)({rates:_}))}}))))}static#e=this.\u0275fac=function(p){return new(p||C)};static#t=this.\u0275prov=v.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"})}return C})()},98138:(J,q,s)=>{s.r(q),s.d(q,{default:()=>Wr});var v=s(64190),e=s(19212);let T=(()=>{class r{static#e=this.\u0275fac=function(o){return new(o||r)};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["trade-purchases"]],standalone:!0,features:[e.jDz],decls:1,vars:0,template:function(o,i){1&o&&e._UZ(0,"router-outlet")},dependencies:[v.lC],encapsulation:2})}return r})();var m=s(96814),n=s(56223),I=s(32296),F=s(64170),A=s(30617),y=s(24516),P=s(21476),R=s(55940),M=s(82599),E=s(22939),N=s(13566),U=s(22096),w=s(78645),D=s(63019),g=s(59773),k=s(83620),C=s(27921),h=s(64716),d=s(21631),p=s(94664),f=s(37398),_=s(83604),x=s(23435),Z=s(302),$=s(29643),ne=s(53374),Ce=s(58578),xe=s(57270),W=s(62660),X=s(48180),B=s(99397),ve=s(97214),V=s(84221);const pe=r=>r.suppliers,G=((0,V.P1)(pe,r=>r.supplier),(0,V.P1)(pe,r=>r.suppliers));var L=s(12956),Q=s(50967);const ye=Q.Ps`
    mutation CreateSupplier($createSupplierInput: CreateSupplierInput!) {
        createSupplier(createSupplierInput: $createSupplierInput) {
            ok
            message

            supplier {
                id
                active
                code
                email
                name
                nit
                phone
            }
        }
    }
`,be=Q.Ps`
    mutation UpdateSupplier($updateSupplierInput: UpdateSupplierInput!) {
        updateSupplier(updateSupplierInput: $updateSupplierInput) {
            ok
            message

            supplier {
                id
                active
                code
                email
                name
                nit
                phone
            }
        }
    }
`,Ie=Q.Ps`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateSupplierStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }
    }
`,Ze=Q.Ps`
    mutation RemoveSupplier($removeSupplierId: String!) {
        removeSupplier(id: $removeSupplierId) {
            ok
            message
        }
    }
`,Te=Q.Ps`
    query FindAllSuppliers($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllSuppliers(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length,
                size,
                page,
                lastPage,
                startIndex,
                endIndex
            }

            suppliers {
                id
                active
                code
                email
                name
                nit
                phone
            }
        }
    }
`,Fe=Q.Ps`
    query FindActiveSuppliers($search: String!, $size: Int!) {
        findActiveSuppliers(search: $search, size: $size) {
            id
            active
            code
            email
            name
            nit
            phone
        }
    }
`,Ae=Q.Ps`
    query FindSupplierById($findSupplierById: String!) {
        findSupplierById(id: $findSupplierById) {
            ok
            message

            supplier {
                id
                active
                code
                email
                name
                nit
                phone
            }
        }
    }
`;let Y=(()=>{class r{constructor(t,o){this.apolloProvider=t,this.store=o,this._apollo=this.apolloProvider.use("BALANC")}createSupplier(t){return this.store.select(G).pipe((0,X.q)(1),(0,p.w)(o=>this._apollo.mutate({mutation:ye,variables:{createSupplierInput:t},errorPolicy:"all"}).pipe((0,B.b)(({data:i})=>{if(i){const a=(0,W.Z)(o);a.push(i.createSupplier.supplier),this.store.dispatch((0,L.bz)({suppliers:a}))}}))))}getSuppliers(t=0,o=25,i="name",a="asc",c=""){return this._apollo.query({query:Te,errorPolicy:"all",variables:{page:t,size:o,sort:i,order:a,search:c}}).pipe((0,B.b)(({data:u})=>{u&&(this.store.dispatch((0,L.bz)({suppliers:u.findAllSuppliers.suppliers})),this.store.dispatch((0,ve.Jr)({pagination:u.findAllSuppliers.pagination})))}))}findActiveSuppliers(t="",o=10){return this._apollo.query({query:Fe,variables:{search:t,size:o},errorPolicy:"all"}).pipe((0,f.U)(({data:i})=>i?i.findActiveSuppliers:[]),(0,B.b)(i=>{i&&this.store.dispatch((0,L.bz)({suppliers:i}))}))}getSupplierById(t){return this._apollo.query({query:Ae,variables:{findSupplierByIdId:t},errorPolicy:"all"}).pipe((0,B.b)(({data:o})=>{o&&this.store.dispatch((0,L.n2)({supplier:o.findSupplierById.supplier}))}))}updateSupplier(t){return this.store.select(G).pipe((0,X.q)(1),(0,p.w)(o=>this._apollo.mutate({mutation:be,variables:{updateSupplierInput:t},errorPolicy:"all"}).pipe((0,B.b)(({data:i})=>{if(i){const a=(0,W.Z)(o);a[o.findIndex(u=>u.id===t.id)]=i.updateSupplier.supplier,this.store.dispatch((0,L.bz)({suppliers:a}))}}))))}updatesSupplierStatus(t){return this.store.select(G).pipe((0,X.q)(1),(0,p.w)(o=>this._apollo.mutate({mutation:Ie,variables:{updateEntityStatusInput:t},errorPolicy:"all"}).pipe((0,B.b)(({data:i})=>{if(i){const a=(0,W.Z)(o);a[o.findIndex(u=>u.id===t.id)].active=t.active,this.store.dispatch((0,L.bz)({suppliers:a}))}}))))}removeSupplier(t){return this.store.select(G).pipe((0,X.q)(1),(0,p.w)(o=>this._apollo.mutate({mutation:Ze,variables:{removeSupplierId:t},errorPolicy:"all"}).pipe((0,B.b)(({data:i})=>{if(i){const a=(0,W.Z)(o),c=o.findIndex(u=>u.id===t);a.splice(c,1),this.store.dispatch((0,L.bz)({suppliers:a}))}}))))}static#e=this.\u0275fac=function(o){return new(o||r)(e.LFG(Q._M),e.LFG(V.yh))};static#t=this.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var O=s(42090),Pe=s(64610),ae=s(75986),ee=s(77988),se=s(74595),te=s(56278),de=s(15608);const Se=["voucherFilter"],qe=["voucherDateFilter"],Ue=["supplierFilter"],ke=["paymentMethodFilter"],Ne=["statusFilter"],Ee=["paymentStatusFilter"];function we(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"button",45),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.clearTableFilters())}),e.TgZ(1,"span",46),e._uU(2," filter_list_off "),e.qZA()()}}function Re(r,l){1&r&&e._UZ(0,"mat-icon",58),2&r&&e.Q6J("svgIcon","mat_solid:done")}function Me(r,l){1&r&&e._UZ(0,"mat-icon",58),2&r&&e.Q6J("svgIcon","mat_solid:done")}function Je(r,l){1&r&&e._UZ(0,"mat-icon",58),2&r&&e.Q6J("svgIcon","mat_solid:done")}const De=(r,l,t,o)=>({"bg-amber-50 text-amber-700":r,"text-blue-700 bg-blue-50":l,"text-red-700 bg-red-50":t,"text-orange-700 bg-orange-50":o}),$e=(r,l)=>({"text-primary-700 bg-primary-50":r,"text-green-700 bg-green-50":l});function Qe(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",47)(1,"div",48),e._uU(2),e.qZA(),e.TgZ(3,"div",49),e._uU(4),e.qZA(),e.TgZ(5,"div",49),e._uU(6),e.qZA(),e.TgZ(7,"div",50),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"div",51),e._uU(11),e.qZA(),e.TgZ(12,"div",49),e._uU(13),e.qZA(),e.TgZ(14,"div",52)(15,"span"),e._uU(16),e.ALo(17,"number"),e.qZA(),e.TgZ(18,"span",53),e._uU(19),e.qZA()(),e.TgZ(20,"div",54)(21,"span",55),e._uU(22),e.ALo(23,"uppercase"),e.qZA()(),e.TgZ(24,"div",54)(25,"span",55),e._uU(26),e.ALo(27,"uppercase"),e.qZA()(),e.TgZ(28,"div",56)(29,"button",57),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.viewPurchaseReport(a))}),e._UZ(30,"mat-icon",58),e.qZA(),e.TgZ(31,"div")(32,"button",59),e._UZ(33,"mat-icon",58),e.qZA(),e.TgZ(34,"mat-menu",null,60)(36,"div",61),e._uU(37," Actualizar Estado "),e.qZA(),e.TgZ(38,"button",62),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.updatePurchaseStatus(a.id,null,"pagada"))}),e.TgZ(39,"div",63),e.YNc(40,Re,1,1,"mat-icon",64),e.qZA(),e.TgZ(41,"span",65),e._uU(42,"Pagada"),e.qZA()(),e.TgZ(43,"button",62),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.updatePurchaseStatus(a.id,"cancelada"))}),e.TgZ(44,"div",63),e.YNc(45,Me,1,1,"mat-icon",64),e.qZA(),e.TgZ(46,"span",65),e._uU(47,"Cancelada"),e.qZA()(),e.TgZ(48,"button",62),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.updatePurchaseStatus(a.id,"rechazada"))}),e.TgZ(49,"div",63),e.YNc(50,Je,1,1,"mat-icon",64),e.qZA(),e.TgZ(51,"span",65),e._uU(52,"Rechazada"),e.qZA()()()()()()}if(2&r){const t=l.$implicit,o=e.MAs(35);e.xp6(2),e.hij(" ",t.code," "),e.xp6(2),e.hij(" ",t.voucher.name," "),e.xp6(2),e.hij(" ",t.voucherNo," "),e.xp6(2),e.hij(" ",e.xi3(9,22,t.voucherDate,"dd/MM/yyyy")," "),e.xp6(3),e.hij(" ",t.supplier.name," "),e.xp6(2),e.hij(" ",t.paymentMethod.name," "),e.xp6(3),e.Oqu(e.xi3(17,25,t.total,"1.2-2")),e.xp6(3),e.Oqu(t.currency.iso),e.xp6(),e.Q6J("ngClass",e.l5B(32,De,"nueva"===t.status,"recibida"===t.status,"cancelada"===t.status,"rechazada"===t.status)),e.xp6(2),e.hij(" ",e.lcZ(23,28,t.status)," "),e.xp6(2),e.Q6J("ngClass",e.WLB(37,$e,"pendiente"===t.paymentStatus,"pagada"===t.paymentStatus)),e.xp6(2),e.hij(" ",e.lcZ(27,30,t.paymentStatus)," "),e.xp6(4),e.Q6J("svgIcon","mat_solid:print"),e.xp6(2),e.Q6J("matMenuTriggerFor",o)("disabled",t.status.includes("cancelada")||t.status.includes("rechazada")),e.xp6(),e.Q6J("svgIcon","mat_solid:update"),e.xp6(5),e.Q6J("disabled",t.paymentStatus.includes("pagada")||t.status.includes("cancelada")||t.status.includes("rechazada")),e.xp6(2),e.um2(40,t.paymentStatus.includes("pagada")?40:-1),e.xp6(3),e.Q6J("disabled",t.paymentStatus.includes("pagada")||t.status.includes("rechazada")||t.status.includes("cancelada")),e.xp6(2),e.um2(45,t.status.includes("cancelada")?45:-1),e.xp6(3),e.Q6J("disabled",t.paymentStatus.includes("pagada")||t.status.includes("cancelada")||t.status.includes("rechazada")),e.xp6(2),e.um2(50,t.status.includes("rechazada")?50:-1)}}function Be(r,l){if(1&r&&e.SjG(0,Qe,53,40,"div",66,e.QCX().trackByFn),2&r){const t=e.oxw();e.wJu(t)}}function Le(r,l){1&r&&(e.TgZ(0,"div",67),e._uU(1," \xa1No se ha registrado ninguna compra! "),e.qZA())}const ze=()=>["nueva","recibida","cancelada","rechazada"],Ve=()=>["pendiente","pagada"],Ge=r=>({"mr-0":r}),Ye=(r,l)=>({"pointer-events-none":r,hidden:l}),Oe=()=>[10,25,50,100];function je(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",20)(1,"div",21)(2,"div",22),e._uU(3," N\xfamero "),e.qZA(),e.TgZ(4,"div",23)(5,"span",24),e._uU(6,"T.Comprob..."),e.qZA(),e.TgZ(7,"table-filter",25,26),e.NdJ("dataChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.addVoucher(i))}),e.ALo(9,"async"),e.qZA()(),e.TgZ(10,"div",27)(11,"span"),e._uU(12,"No.Comprob..."),e.qZA()(),e.TgZ(13,"div",28)(14,"span",29),e._uU(15,"F.Comprob..."),e.qZA(),e.TgZ(16,"table-filter",30,31),e.NdJ("dataChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.addDate(i))}),e.qZA()(),e.TgZ(18,"div",32)(19,"span"),e._uU(20,"Proveedor"),e.qZA(),e.TgZ(21,"table-filter",33,34),e.NdJ("dataChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.addSupplier(i))}),e.qZA()(),e.TgZ(23,"div",23)(24,"span",35),e._uU(25,"M.Pago"),e.qZA(),e.TgZ(26,"table-filter",25,36),e.NdJ("dataChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.addPaymentMethod(i))}),e.ALo(28,"async"),e.qZA()(),e.TgZ(29,"div",37)(30,"span"),e._uU(31,"Importe"),e.qZA()(),e.TgZ(32,"div",23)(33,"span",29),e._uU(34,"Estado"),e.qZA(),e.TgZ(35,"table-filter",38,39),e.NdJ("dataChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.addStatus(i))}),e.qZA()(),e.TgZ(37,"div",23)(38,"span",40),e._uU(39,"E.Pago"),e.qZA(),e.TgZ(40,"table-filter",38,41),e.NdJ("dataChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.addPaymentStatus(i))}),e.qZA()(),e.TgZ(42,"div",42)(43,"span"),e._uU(44,"Acciones"),e.qZA(),e.YNc(45,we,3,0,"button",43),e.qZA()(),e.YNc(46,Be,2,0)(47,Le,2,0),e._UZ(48,"mat-paginator",44),e.qZA()}if(2&r){const t=e.oxw();e.xp6(2),e.Q6J("mat-sort-header","code"),e.xp6(5),e.Q6J("filterType","multiSelectEntity")("entityPropertyName","name")("useUpperCase",!1)("data",e.lcZ(9,31,t.vouchers$)),e.xp6(3),e.Q6J("mat-sort-header","voucherNo"),e.xp6(4),e.Q6J("mat-sort-header","voucherDate"),e.xp6(2),e.Q6J("filterType","date"),e.xp6(5),e.Q6J("filterType","filterEntity")("searchEntityControl",t.searchSuppliersControl)("entitiesFiltered",t.suppliersFiltered),e.xp6(5),e.Q6J("filterType","multiSelectEntity")("entityPropertyName","name")("useUpperCase",!1)("data",e.lcZ(28,33,t.paymentMethods$)),e.xp6(3),e.Q6J("mat-sort-header","total"),e.xp6(4),e.Q6J("mat-sort-header","status"),e.xp6(2),e.Q6J("filterType","multiSelect")("data",e.DdM(35,ze)),e.xp6(3),e.Q6J("mat-sort-header","paymentStatus"),e.xp6(2),e.Q6J("filterType","multiSelect")("data",e.DdM(36,Ve)),e.xp6(2),e.Q6J("ngClass",e.VKq(37,Ge,t.existTableFilter())),e.xp6(3),e.um2(45,t.existTableFilter()?45:-1),e.xp6(),e.um2(46,l.length>0?46:47),e.xp6(2),e.Q6J("ngClass",e.WLB(39,Ye,t.isLoading,t.pagination.length<10&&t.pagination.page<1))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(42,Oe))("showFirstLastButtons",!0)}}let He=(()=>{class r{constructor(t,o,i,a){this._changeDetectorRef=t,this._fuseConfirmationService=o,this._purchasesService=i,this.store=a,this.isLoading=!1,this.purchases$=(0,U.of)([]),this.searchInputControl=new n.NI(null),this.selectedSupplier=null,this.searchSuppliersControl=new n.NI(null),this.filterInputControl=new n.NI,this.selectedVouchersId=[],this.selectedPaymentMethodsId=[],this.selectedDate=null,this.selectedStatus=[],this.selectedPaymentStatus=[],this.vouchers$=(0,U.of)([]),this.paymentMethods$=(0,U.of)([]),this.merchant=null,this.user=null,this._snackBar=(0,e.f3M)(E.ux),this._suppliersService=(0,e.f3M)(Y),this._unsubscribeAll=new w.x,this._documentsService=(0,e.f3M)(xe.S)}ngOnInit(){this.store.select(ne.rk).pipe((0,g.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select($.Qs).pipe((0,g.R)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(_.B).pipe((0,g.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.vouchers$=this.store.select(x.a),this.paymentMethods$=this.store.select(Z.VS),this.purchases$=this.store.select(Ce.pk),this.suppliersFiltered=this.searchSuppliersControl.valueChanges.pipe((0,k.b)(200),(0,C.O)(null),(0,h.x)(()=>{this.isLoading=!1}),(0,d.z)(t=>null!==t&&"string"==typeof t&&(this.selectedSupplier&&t!==this.selectedSupplier.name||!this.selectedSupplier)?(this.isLoading=!0,this._suppliersService.findActiveSuppliers(t.trim())):(0,U.of)())),this.searchInputControl.valueChanges.pipe((0,g.R)(this._unsubscribeAll),(0,h.x)(()=>{this.isLoading=!1}),(0,k.b)(300),(0,p.w)(t=>{if(null!==t)return this.isLoading=!0,this._purchasesService.getPurchases(0,25,"code","desc",t,this.selectedSupplier?this.selectedSupplier.id:null,this.selectedVouchersId,this.selectedPaymentMethodsId,this.selectedStatus,this.selectedPaymentStatus,this.selectedDate)}),(0,f.U)(()=>{this.isLoading=!1})).subscribe(),this.filterInputControl.valueChanges.pipe((0,g.R)(this._unsubscribeAll),(0,k.b)(300),(0,p.w)(t=>(this.isLoading=!0,this._purchasesService.getPurchases(0,25,"code","desc",this.searchInputControl.value,this.selectedSupplier?this.selectedSupplier.id:null,this.selectedVouchersId,this.selectedPaymentMethodsId,this.selectedStatus,this.selectedPaymentStatus,this.selectedDate))),(0,f.U)(()=>{this.isLoading=!1})).subscribe(),this.suppliersFiltered=this.searchSuppliersControl.valueChanges.pipe((0,k.b)(200),(0,C.O)(null),(0,h.x)(()=>{this.isLoading=!1}),(0,d.z)(t=>null!==t&&"string"==typeof t&&(this.selectedSupplier&&t!==this.selectedSupplier.name||!this.selectedSupplier)?(this.isLoading=!0,this._suppliersService.findActiveSuppliers(t.trim())):(0,U.of)()))}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"code",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,g.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,D.T)(this._sort.sortChange,this._paginator.page).pipe((0,p.w)(()=>(this.isLoading=!0,this._purchasesService.getPurchases(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,f.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}resetSupplier(){this.selectedSupplier=null,this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addSupplier(t){this.selectedSupplier=t,this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addVoucher(t){this.selectedVouchersId=t.map(o=>o.id),this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addPaymentMethod(t){this.selectedPaymentMethodsId=t.map(o=>o.id),this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addDate(t){this.selectedDate=t,this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addStatus(t){this.selectedStatus=t,this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addPaymentStatus(t){this.selectedPaymentStatus=t,this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}updatePurchaseStatus(t,o,i){this._fuseConfirmationService.open({title:"Actualizar Estado de la Compra",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(c=>{"confirmed"===c&&this._purchasesService.updatePurchaseStatus(t,o,i).pipe((0,g.R)(this._unsubscribeAll)).subscribe(({data:u})=>{this._snackBar.openFromComponent(O.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:u.updatePurchaseStatus.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}})}),this._changeDetectorRef.markForCheck()})}trackByFn(t,o){return o.id||t}viewPurchaseReport(t){this._documentsService.generatePurchaseDocument(t,this.merchant,this.user)}existTableFilter(){return this.voucherFilter?.hasFilter||this.voucherDateFilter?.hasFilter||this.supplierFilter?.hasFilter||this.paymentMethodDateFilter?.hasFilter||this.statusFilter?.hasFilter||this.paymentStatusFilter?.hasFilter}clearTableFilters(){this.voucherFilter?.hasFilter&&this.voucherFilter.clearFilter(),this.voucherDateFilter?.hasFilter&&this.voucherDateFilter.clearFilter(),this.supplierFilter?.hasFilter&&this.supplierFilter.clearFilter(),this.paymentMethodDateFilter?.hasFilter&&this.paymentMethodDateFilter.clearFilter(),this.statusFilter?.hasFilter&&this.statusFilter.clearFilter(),this.paymentStatusFilter?.hasFilter&&this.paymentStatusFilter.clearFilter()}static#e=this.\u0275fac=function(o){return new(o||r)(e.Y36(e.sBO),e.Y36(te.R),e.Y36(de.F),e.Y36(V.yh))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["purchases-list"]],viewQuery:function(o,i){if(1&o&&(e.Gf(P.NW,5),e.Gf(N.YE,5),e.Gf(Se,5),e.Gf(qe,5),e.Gf(Ue,5),e.Gf(ke,5),e.Gf(Ne,5),e.Gf(Ee,5)),2&o){let a;e.iGM(a=e.CRH())&&(i._paginator=a.first),e.iGM(a=e.CRH())&&(i._sort=a.first),e.iGM(a=e.CRH())&&(i.voucherFilter=a.first),e.iGM(a=e.CRH())&&(i.voucherDateFilter=a.first),e.iGM(a=e.CRH())&&(i.supplierFilter=a.first),e.iGM(a=e.CRH())&&(i.paymentMethodDateFilter=a.first),e.iGM(a=e.CRH())&&(i.statusFilter=a.first),e.iGM(a=e.CRH())&&(i.paymentStatusFilter=a.first)}},standalone:!0,features:[e.jDz],decls:26,vars:10,consts:[["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","flex-wrap","items-center","w-full","gap-2","mt-6","md:fixed","right-8","shrink-0","lg:mt-0","lg:ml-4","lg:w-auto","sm:w-1/2"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","","routerLink","/modules/trade/purchases/form",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto"],[1,"z-10","flex","flex-col","flex-auto","bg-white","dark:bg-default"],["class","relative grid border-t"],[1,"relative","grid","border-t"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","purchase-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"",3,"mat-sort-header"],[1,"flex","items-center","justify-center"],["matTooltip","Tipo de Comprobante"],[3,"filterType","entityPropertyName","useUpperCase","data","dataChange"],["voucherFilter",""],["matTooltip","N\xfamero de Comprobante",1,"flex","justify-center",3,"mat-sort-header"],["matTooltip","Fecha de Comprobante",1,"flex","justify-center"],[3,"mat-sort-header"],[3,"filterType","dataChange"],["voucherDateFilter",""],[1,"flex","items-center","justify-start"],[3,"filterType","searchEntityControl","entitiesFiltered","dataChange"],["supplierFilter",""],["matTooltip","M\xe9todo de pago"],["paymentMethodFilter",""],[1,"flex","justify-end",3,"mat-sort-header"],[3,"filterType","data","dataChange"],["statusFilter",""],["matTooltip","Estado del pago",3,"mat-sort-header"],["paymentStatusFilter",""],[1,"flex","items-center","justify-end","mr-6",3,"ngClass"],["color","warn","class","w-6 h-6 min-h-6 min-w-6","mat-icon-button","","matTooltip","Limpiar filtros"],[1,"border-b","first-letter:z-10","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-gray-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],["color","warn","mat-icon-button","","matTooltip","Limpiar filtros",1,"w-6","h-6","min-h-6","min-w-6",3,"click"],[1,"material-icons","icon-size-4"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","border-b","purchase-grid","md:px-8"],[1,"font-mono"],[1,"text-center"],[1,"font-mono","text-center"],[1,"truncate"],[1,"flex","flex-row","justify-center","space-x-1","font-mono"],[1,"text-xs","text-secondary"],[1,"flex","items-center","justify-center","mr-4","text-center","truncate","delay-100","rounded-full","h-7","lock","dark:bg-white","dark:bg-opacity-5",3,"ngClass"],[1,"w-full","px-2","text-sm","font-medium","text-center"],[1,"flex","flex-row","justify-end","gap-2","mr-2"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","","matTooltip","Actualizar estado de la compra",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matMenuTriggerFor","disabled"],["listStatusMenu","matMenu"],[1,"w-full","p-2","text-lg","font-semibold","text-center","text-secondary"],["mat-menu-item","",1,"grid","w-full","grid-cols-4",3,"disabled","click"],[1,"col-span-1"],["class","icon-size-5",3,"svgIcon"],[1,"col-span-3","text-center"],["class","z-0 grid items-center gap-4 px-6 py-3 border-b purchase-grid md:px-8"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(o,i){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Compras"),e.qZA()()(),e.TgZ(11,"div",8)(12,"h2",9),e._uU(13," Facturas de Compras "),e.qZA()()(),e.TgZ(14,"div",10)(15,"mat-form-field",11),e._UZ(16,"mat-icon",12)(17,"input",13),e.qZA(),e.TgZ(18,"button",14),e._UZ(19,"mat-icon",15),e.TgZ(20,"span",16),e._uU(21,"Registrar"),e.qZA()()()(),e.TgZ(22,"div",17)(23,"div",18),e.YNc(24,je,49,43,"div",19),e.ALo(25,"async"),e.qZA()()()),2&o){let a;e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(7),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Escriba para buscar"),e.xp6(2),e.Q6J("svgIcon","mat_solid:add"),e.xp6(5),e.um2(24,(a=e.lcZ(25,8,i.purchases$))?24:-1,a)}},dependencies:[m.Ov,m.uU,m.JJ,se.H,I.ot,I.lW,I.RK,ae.p9,F.lN,F.KE,F.qo,A.Ps,A.Hw,y.c,y.Nt,ee.Tx,ee.VK,ee.OP,ee.p6,P.TU,P.NW,R.Cq,M.rP,N.JX,N.YE,N.nU,m.mk,n.UX,n.Fj,n.JJ,n.oH,v.rH,Pe.q,m.gd],styles:[".purchase-grid{grid-template-columns:130px 150px 110px 130px 150px 100px 130px 100px 100px auto}@media (min-width: 1280px){.purchase-grid{grid-template-columns:120px 150px 110px 130px 150px 100px 100px 100px 100px auto}}\n"],encapsulation:2,changeDetection:0})}return r})(),Ke=(()=>{class r{static#e=this.\u0275fac=function(o){return new(o||r)};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-purchase-details"]],standalone:!0,features:[e.jDz],decls:2,vars:0,template:function(o,i){1&o&&(e.TgZ(0,"p"),e._uU(1,"purchase-details works!"),e.qZA())},encapsulation:2})}return r})();var ce=s(98525),le=s(24630),me=s(92596),re=s(38034),oe=s(17700),We=s(21510),he=s(12936),Xe=s(78501),et=s(33355),tt=s(44565),rt=s(66330),ot=s(24234),it=s(27627),nt=s(98246),ue=s(88458),z=s(55568),at=s(23680);const st=["stockTemplateFile"];function ct(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"mat-option",57),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.selectSupplier(a))}),e._uU(1),e.qZA()}if(2&r){const t=l.$implicit;e.Q6J("value",t),e.xp6(),e.hij(" ",t.name," ")}}function lt(r,l){if(1&r&&(e.TgZ(0,"mat-option",58),e._uU(1),e.qZA()),2&r){const t=l.$implicit;e.Q6J("value",t.id),e.xp6(),e.hij(" ",t.name," ")}}function ut(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El tipo de comprobante es obligatorio "),e.qZA())}function pt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El n\xfamero del comprobante es obligatorio "),e.qZA())}function dt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," La fecha del comprobante es obligatoria "),e.qZA())}function mt(r,l){if(1&r&&(e.TgZ(0,"mat-option",58),e._uU(1),e.qZA()),2&r){const t=l.$implicit;e.Q6J("value",t.id),e.xp6(),e.hij(" ",t.name," ")}}function ht(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El tipo de comprobante es obligatorio "),e.qZA())}function gt(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"mat-option",57),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.selectedCurrencyIso=a.iso)}),e._uU(1),e.qZA()}if(2&r){const t=l.$implicit;e.Q6J("value",t.id),e.xp6(),e.hij(" ",t.iso," ")}}function ft(r,l){if(1&r&&(e.TgZ(0,"span",59),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(),e.AsE(" (+ ",2===(null==t.purchaseForm.get("rates").value?null:t.purchaseForm.get("rates").value.length)?"otro":"otros"," ",t.purchaseForm.get("rates").value.length>2?t.purchaseForm.get("rates").value.length-1:"",") ")}}function _t(r,l){if(1&r&&(e.TgZ(0,"mat-option",58)(1,"span",60),e._uU(2),e.ALo(3,"number"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA()()),2&r){const t=l.$implicit;e.Q6J("value",t),e.xp6(2),e.Oqu(e.xi3(3,3,t.value,"1.4-4")),e.xp6(3),e.hij(" ",t.name,"")}}function Ct(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Las tasas de cambio son requeridas "),e.qZA())}function xt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El costo de FOB es obligatorio "),e.qZA())}function vt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El costo de FOB debe ser mayor que 0 "),e.qZA())}function yt(r,l){if(1&r&&(e.TgZ(0,"div",34)(1,"mat-form-field",61)(2,"mat-label"),e._uU(3,"Costos FOB"),e.qZA(),e._UZ(4,"input",62),e.YNc(5,xt,2,0,"mat-error")(6,vt,2,0,"mat-error"),e.qZA()()),2&r){const t=e.oxw();e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","fobCosts"),e.xp6(),e.um2(5,t.purchaseForm.get("indirectCost").get("fobCosts").hasError("required")?5:-1),e.xp6(),e.um2(6,t.purchaseForm.get("indirectCost").get("fobCosts").hasError("min")?6:-1)}}function bt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El flete es obligatorio "),e.qZA())}function It(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El flete debe ser mayor que 0 "),e.qZA())}function Zt(r,l){if(1&r&&(e.TgZ(0,"div",34)(1,"mat-form-field",61)(2,"mat-label"),e._uU(3,"Flete"),e.qZA(),e._UZ(4,"input",62),e.YNc(5,bt,2,0,"mat-error")(6,It,2,0,"mat-error"),e.qZA()()),2&r){const t=e.oxw();e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","freight"),e.xp6(),e.um2(5,t.purchaseForm.get("indirectCost").get("freight").hasError("required")?5:-1),e.xp6(),e.um2(6,t.purchaseForm.get("indirectCost").get("freight").hasError("min")?6:-1)}}function Tt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Los aranceles son obligatorios "),e.qZA())}function Ft(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Los aranceles deben ser mayores que 0 "),e.qZA())}function At(r,l){if(1&r&&(e.TgZ(0,"div",34)(1,"mat-form-field",61)(2,"mat-label"),e._uU(3,"Aranceles"),e.qZA(),e._UZ(4,"input",62),e.YNc(5,Tt,2,0,"mat-error")(6,Ft,2,0,"mat-error"),e.qZA()()),2&r){const t=e.oxw();e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","customsDuties"),e.xp6(),e.um2(5,t.purchaseForm.get("indirectCost").get("customsDuties").hasError("required")?5:-1),e.xp6(),e.um2(6,t.purchaseForm.get("indirectCost").get("customsDuties").hasError("min")?6:-1)}}function Pt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Los servicios aduanales son obligatorios "),e.qZA())}function St(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Los servicios aduanales deben ser mayores que 0 "),e.qZA())}function qt(r,l){if(1&r&&(e.TgZ(0,"div",34)(1,"mat-form-field",61)(2,"mat-label"),e._uU(3,"Servicios Aduanales"),e.qZA(),e._UZ(4,"input",62),e.YNc(5,Pt,2,0,"mat-error")(6,St,2,0,"mat-error"),e.qZA()()),2&r){const t=e.oxw();e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","customsServices"),e.xp6(),e.um2(5,t.purchaseForm.get("indirectCost").get("customsServices").hasError("required")?5:-1),e.xp6(),e.um2(6,t.purchaseForm.get("indirectCost").get("customsServices").hasError("min")?6:-1)}}function Ut(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El seguro es obligatorio "),e.qZA())}function kt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El seguro debe ser mayor que 0 "),e.qZA())}function Nt(r,l){if(1&r&&(e.TgZ(0,"div",34)(1,"mat-form-field",61)(2,"mat-label"),e._uU(3,"Seguro"),e.qZA(),e._UZ(4,"input",62),e.YNc(5,Ut,2,0,"mat-error")(6,kt,2,0,"mat-error"),e.qZA()()),2&r){const t=e.oxw();e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","insurance"),e.xp6(),e.um2(5,t.purchaseForm.get("indirectCost").get("insurance").hasError("required")?5:-1),e.xp6(),e.um2(6,t.purchaseForm.get("indirectCost").get("insurance").hasError("min")?6:-1)}}function Et(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," La transportaci\xf3n es obligatoria "),e.qZA())}function wt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," La transportaci\xf3n debe ser mayor que 0 "),e.qZA())}function Rt(r,l){if(1&r&&(e.TgZ(0,"div",34)(1,"mat-form-field",61)(2,"mat-label"),e._uU(3,"Transportaci\xf3n"),e.qZA(),e._UZ(4,"input",62),e.YNc(5,Et,2,0,"mat-error")(6,wt,2,0,"mat-error"),e.qZA()()),2&r){const t=e.oxw();e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","transportation"),e.xp6(),e.um2(5,t.purchaseForm.get("indirectCost").get("transportation").hasError("required")?5:-1),e.xp6(),e.um2(6,t.purchaseForm.get("indirectCost").get("transportation").hasError("min")?6:-1)}}function Mt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," La descarga es obligatoria "),e.qZA())}function Jt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," La descarga debe ser mayor que 0 "),e.qZA())}function Dt(r,l){if(1&r&&(e.TgZ(0,"div",34)(1,"mat-form-field",61)(2,"mat-label"),e._uU(3,"Descarga"),e.qZA(),e._UZ(4,"input",62),e.YNc(5,Mt,2,0,"mat-error")(6,Jt,2,0,"mat-error"),e.qZA()()),2&r){const t=e.oxw();e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","unloading"),e.xp6(),e.um2(5,t.purchaseForm.get("indirectCost").get("unloading").hasError("required")?5:-1),e.xp6(),e.um2(6,t.purchaseForm.get("indirectCost").get("unloading").hasError("min")?6:-1)}}function $t(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Otros Gastos son obligatorios "),e.qZA())}function Qt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Otros Gastos deben ser mayores que 0 "),e.qZA())}function Bt(r,l){if(1&r&&(e.TgZ(0,"div",34)(1,"mat-form-field",61)(2,"mat-label"),e._uU(3,"Otros Gastos"),e.qZA(),e._UZ(4,"input",62),e.YNc(5,$t,2,0,"mat-error")(6,Qt,2,0,"mat-error"),e.qZA()()),2&r){const t=e.oxw();e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","otherCosts"),e.xp6(),e.um2(5,t.purchaseForm.get("indirectCost").get("otherCosts").hasError("required")?5:-1),e.xp6(),e.um2(6,t.purchaseForm.get("indirectCost").get("otherCosts").hasError("min")?6:-1)}}function Lt(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"mat-option",63),e.NdJ("click",function(i){const c=e.CHM(t).$implicit;return e.oxw().addProductToPurchase(c),e.KtG(i.stopPropagation())}),e.TgZ(1,"div",64),e.NdJ("click",function(i){const c=e.CHM(t).$implicit;return e.oxw().addProductToPurchase(c),e.KtG(i.stopPropagation())}),e.TgZ(2,"span",65),e._UZ(3,"mat-checkbox",66),e._uU(4),e.qZA(),e.TgZ(5,"span",67),e._uU(6),e.qZA(),e.TgZ(7,"span",67),e._uU(8),e.qZA()()()}if(2&r){const t=l.$implicit;e.Q6J("value",t),e.xp6(3),e.Q6J("checked",t.checked),e.xp6(),e.hij(" ",t.name," "),e.xp6(2),e.Oqu(t.currency.iso),e.xp6(2),e.Oqu(t.uom.abbr)}}const zt=(r,l)=>l.id;function Vt(r,l){1&r&&(e.TgZ(0,"span",92),e._uU(1,"Sin nombre"),e.qZA())}function Gt(r,l){1&r&&(e.TgZ(0,"mat-error",93),e._uU(1," Valor m\xednimo 0.1 "),e.qZA())}function Yt(r,l){1&r&&(e.TgZ(0,"mat-error",93),e._uU(1," Valor requerido "),e.qZA())}function Ot(r,l){1&r&&(e.TgZ(0,"mat-error",93),e._uU(1," Patr\xf3n no v\xe1lido "),e.qZA())}function jt(r,l){1&r&&(e.TgZ(0,"mat-error",93),e._uU(1," Valor m\xednimo 0 "),e.qZA())}function Ht(r,l){1&r&&(e.TgZ(0,"mat-error",93),e._uU(1," Valor requerido "),e.qZA())}function Kt(r,l){1&r&&(e.TgZ(0,"mat-error",93),e._uU(1," Valor m\xednimo 0 "),e.qZA())}function Wt(r,l){1&r&&(e.TgZ(0,"mat-error",93),e._uU(1," Valor requerido "),e.qZA())}function Xt(r,l){1&r&&e.GkF(0)}const er=r=>({$implicit:r});function tr(r,l){if(1&r&&e.YNc(0,Xt,1,0,"ng-container",94),2&r){const t=e.oxw().$implicit;e.oxw(2);const o=e.MAs(128);e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(2,er,t))}}const rr=(r,l)=>({"bg-gray-50 dark:bg-primary dark:bg-opacity-5":r,"bg-white dark:bg-transparent":l}),or=r=>({"text-warn":r}),ir=()=>["$"];function nr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",76)(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"div",77),e._uU(4),e.YNc(5,Vt,2,0,"span",78),e.qZA(),e.TgZ(6,"div",79),e._uU(7),e.qZA(),e.TgZ(8,"div",71),e._uU(9),e.qZA(),e.TgZ(10,"div",80)(11,"div",81)(12,"button",82),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.decrementProductQty(a))}),e._UZ(13,"mat-icon",45),e.qZA(),e.TgZ(14,"mat-form-field",83),e._UZ(15,"input",84),e.qZA(),e.TgZ(16,"button",82),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.incrementProductQty(a))}),e._UZ(17,"mat-icon",45),e.qZA()(),e.YNc(18,Gt,2,0,"mat-error",85)(19,Yt,2,0,"mat-error",85)(20,Ot,2,0,"mat-error",85),e.qZA(),e.TgZ(21,"div",86)(22,"mat-form-field",83),e._UZ(23,"input",87),e.qZA(),e.YNc(24,jt,2,0,"mat-error",85)(25,Ht,2,0,"mat-error",85),e.qZA(),e.TgZ(26,"div",71),e._uU(27),e.ALo(28,"number"),e.qZA(),e.TgZ(29,"div",88),e._uU(30),e.ALo(31,"currency"),e.qZA(),e.TgZ(32,"div",86)(33,"mat-form-field",83),e._UZ(34,"input",87),e.qZA(),e.YNc(35,Kt,2,0,"mat-error",85)(36,Wt,2,0,"mat-error",85),e.qZA(),e.TgZ(37,"div",89)(38,"button",90),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,c=i.$index,u=e.oxw(2);return e.KtG(u.toggleProductDetail(a,c))}),e._UZ(39,"mat-icon",45),e.qZA(),e.TgZ(40,"button",91),e.NdJ("click",function(){const a=e.CHM(t).$index,c=e.oxw(2);return e.KtG(c.removeProductToPurchase(a))}),e._UZ(41,"mat-icon",45),e.qZA()()(),e.TgZ(42,"div",68),e.YNc(43,tr,1,4,"ng-container"),e.qZA()}if(2&r){const t=l.$implicit,o=l.$index,i=e.oxw(2);e.Q6J("ngClass",e.WLB(43,rr,i.selectedProductIndex===o,i.selectedProductIndex!==o)),e.xp6(2),e.hij(" ",o+1," "),e.xp6(),e.Q6J("matTooltip",t.get("name").value),e.xp6(),e.hij(" ",t.get("name").value," "),e.xp6(),e.um2(5,t.get("name").value?-1:5),e.xp6(),e.Q6J("ngClass",e.VKq(46,or,!t.get("rate").value)),e.xp6(),e.hij(" ",t.get("rate").value?i.selectedCurrencyIso:t.get("currency").value," "),e.xp6(2),e.hij(" ",t.get("uom").value," "),e.xp6(3),e.Q6J("disabled",t.get("quantity").value<=.1||t.get("quantity").hasError("pattern")),e.xp6(),e.Q6J("svgIcon","mat_solid:remove"),e.xp6(),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("min",.1)("formControl",t.get("quantity")),e.xp6(),e.Q6J("disabled",t.get("quantity").hasError("pattern")),e.xp6(),e.Q6J("svgIcon","mat_solid:add"),e.xp6(),e.um2(18,t.get("quantity").hasError("min")?18:-1),e.xp6(),e.um2(19,t.get("quantity").hasError("required")?19:-1),e.xp6(),e.um2(20,t.get("quantity").hasError("pattern")&&!t.get("quantity").hasError("min")?20:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("min",0)("max",99999)("formControl",t.get("cost")),e.xp6(),e.um2(24,t.get("cost").hasError("min")?24:-1),e.xp6(),e.um2(25,t.get("cost").hasError("required")?25:-1),e.xp6(2),e.hij(" ",e.xi3(28,37,t.get("cui").value,"1.2-2")," "),e.xp6(3),e.hij(" ",e.xi3(31,40,t.get("ct").value,e.DdM(48,ir))," "),e.xp6(3),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("min",0)("max",9999999)("formControl",t.get("price")),e.xp6(),e.um2(35,t.get("price").hasError("min")?35:-1),e.xp6(),e.um2(36,t.get("price").hasError("required")?36:-1),e.xp6(2),e.Q6J("color",t.invalid&&!t.get("productId").value?"warn":"")("disabled",t.get("productId").value),e.xp6(),e.Q6J("svgIcon",i.selectedProductIndex===o?"mat_solid:expand_more":"mat_solid:expand_less"),e.xp6(2),e.Q6J("svgIcon","mat_solid:close"),e.xp6(2),e.um2(43,i.selectedProductIndex===o?43:-1)}}function ar(r,l){if(1&r&&(e.TgZ(0,"div",68)(1,"div",69),e._UZ(2,"div"),e.TgZ(3,"div",70),e._uU(4," Producto "),e.qZA(),e.TgZ(5,"div",71),e._uU(6," Moneda "),e.qZA(),e.TgZ(7,"div",71),e._uU(8," UM "),e.qZA(),e.TgZ(9,"div",71),e._uU(10," Cantidad "),e.qZA(),e.TgZ(11,"div",72),e._uU(12," Costo "),e.qZA(),e.TgZ(13,"div",73),e._uU(14," Costo Indirecto "),e.qZA(),e.TgZ(15,"div",74),e._uU(16," Costo Total "),e.qZA(),e.TgZ(17,"div",71),e._uU(18," Precio "),e.qZA(),e.TgZ(19,"div",75),e._uU(20," Acciones "),e.qZA()(),e.SjG(21,nr,44,49,null,null,zt),e.qZA()),2&r){const t=e.oxw();e.xp6(21),e.wJu(t.purchaseForm.get("products").controls)}}function sr(r,l){1&r&&(e.TgZ(0,"div",95),e._uU(1," \xa1No ha seleccionado ning\xfan producto a\xfan! "),e.qZA())}function cr(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El c\xf3digo de barras es obligatorio "),e.qZA())}function lr(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Valor entre 3 y 255 caracteres. "),e.qZA())}function ur(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Valor entre 3 y 255 caracteres. "),e.qZA())}function pr(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Valor entre 3 y 255 caracteres. "),e.qZA())}function dr(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre es obligatorio "),e.qZA())}function mr(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Valor entre 3 y 255 caracteres. "),e.qZA())}function hr(r,l){if(1&r&&(e.TgZ(0,"mat-option",58),e._uU(1),e.qZA()),2&r){const t=l.$implicit;e.Q6J("value",t.abbr),e.xp6(),e.hij(" ",t.abbr," ")}}function gr(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El peso debe ser mayor que 0 "),e.qZA())}function fr(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El ancho debe ser mayor que 0 "),e.qZA())}function _r(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El largo debe ser mayor que 0 "),e.qZA())}function Cr(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," La altura debe ser mayor que 0 "),e.qZA())}function xr(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El volumen debe ser mayor que 0 "),e.qZA())}function vr(r,l){if(1&r&&(e.TgZ(0,"div",96)(1,"form",97)(2,"div",98)(3,"mat-form-field",99)(4,"mat-label"),e._uU(5,"UPC"),e.qZA(),e._UZ(6,"input",100),e.YNc(7,cr,2,0,"mat-error")(8,lr,2,0,"mat-error"),e.qZA()(),e.TgZ(9,"div",98)(10,"mat-form-field",61)(11,"mat-label"),e._uU(12,"SKU"),e.qZA(),e._UZ(13,"input",101),e.YNc(14,ur,2,0,"mat-error"),e.qZA()(),e.TgZ(15,"div",98)(16,"mat-form-field",61)(17,"mat-label"),e._uU(18,"C\xf3digo"),e.qZA(),e._UZ(19,"input",101),e.YNc(20,pr,2,0,"mat-error"),e.qZA()(),e.TgZ(21,"div",98)(22,"mat-form-field",61)(23,"mat-label"),e._uU(24,"Nombre"),e.qZA(),e._UZ(25,"input",100),e.YNc(26,dr,2,0,"mat-error")(27,mr,2,0,"mat-error"),e.qZA()(),e.TgZ(28,"div"),e.ynx(29),e.TgZ(30,"mat-form-field",61)(31,"mat-label"),e._uU(32,"Unidad de Medida"),e.qZA(),e.TgZ(33,"mat-select",102),e.SjG(34,hr,2,2,"mat-option",58,e.x6l),e.ALo(36,"async"),e.qZA()(),e.BQk(),e.qZA(),e.TgZ(37,"div",98)(38,"mat-form-field",61)(39,"mat-label"),e._uU(40,"Marca"),e.qZA(),e._UZ(41,"input",103),e.qZA()(),e.TgZ(42,"div")(43,"mat-form-field",61)(44,"mat-label"),e._uU(45,"Peso"),e.qZA(),e._UZ(46,"mat-icon",104)(47,"input",105),e.YNc(48,gr,2,0,"mat-error"),e.qZA()(),e.TgZ(49,"div")(50,"mat-form-field",61)(51,"mat-label"),e._uU(52,"Ancho"),e.qZA(),e._UZ(53,"mat-icon",106)(54,"input",105),e.YNc(55,fr,2,0,"mat-error"),e.qZA()(),e.TgZ(56,"div")(57,"mat-form-field",61)(58,"mat-label"),e._uU(59,"Largo"),e.qZA(),e._UZ(60,"mat-icon",106)(61,"input",105),e.YNc(62,_r,2,0,"mat-error"),e.qZA()(),e.TgZ(63,"div")(64,"mat-form-field",61)(65,"mat-label"),e._uU(66,"Altura"),e.qZA(),e._UZ(67,"mat-icon",106)(68,"input",105),e.YNc(69,Cr,2,0,"mat-error"),e.qZA()(),e.TgZ(70,"div")(71,"mat-form-field",61)(72,"mat-label"),e._uU(73,"Volumen"),e.qZA(),e._UZ(74,"mat-icon",106)(75,"input",105),e.YNc(76,xr,2,0,"mat-error"),e.qZA()(),e.TgZ(77,"div",107)(78,"mat-form-field",61)(79,"mat-label"),e._uU(80,"Descripci\xf3n"),e.qZA(),e._UZ(81,"textarea",108,109),e.qZA(),e.TgZ(83,"span",110),e._uU(84),e.qZA()()()()),2&r){const t=e.MAs(82),o=e.oxw();e.xp6(),e.Q6J("formGroup",o.selectedProductForm),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","upc"),e.xp6(),e.um2(7,o.selectedProductForm.get("upc").hasError("required")?7:-1),e.xp6(),e.um2(8,o.selectedProductForm.get("upc").hasError("minlength")||o.selectedProductForm.get("upc").hasError("maxlength")?8:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","sku"),e.xp6(),e.um2(14,o.selectedProductForm.get("sku").hasError("minlength")||o.selectedProductForm.get("sku").hasError("maxlength")?14:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","bCode"),e.xp6(),e.um2(20,o.selectedProductForm.get("bCode").hasError("minlength")||o.selectedProductForm.get("bCode").hasError("maxlength")?20:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","name"),e.xp6(),e.um2(26,o.selectedProductForm.get("name").hasError("required")?26:-1),e.xp6(),e.um2(27,o.selectedProductForm.get("name").hasError("minlength")||o.selectedProductForm.get("name").hasError("maxlength")?27:-1),e.xp6(3),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","uom"),e.xp6(),e.wJu(e.lcZ(36,38,o.uoms$)),e.xp6(4),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","brand"),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(4),e.Q6J("formControlName","weight"),e.xp6(),e.um2(48,o.selectedProductForm.get("weight").hasError("min")?48:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(4),e.Q6J("formControlName","width"),e.xp6(),e.um2(55,o.selectedProductForm.get("width").hasError("min")?55:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(4),e.Q6J("formControlName","length"),e.xp6(),e.um2(62,o.selectedProductForm.get("length").hasError("min")?62:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(4),e.Q6J("formControlName","height"),e.xp6(),e.um2(69,o.selectedProductForm.get("height").hasError("min")?69:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(4),e.Q6J("formControlName","volume"),e.xp6(),e.um2(76,o.selectedProductForm.get("volume").hasError("min")?76:-1),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","description")("rows",1),e.xp6(3),e.hij("",t.value.length," / 10000")}}const yr=()=>({suppressScrollX:!0}),br=()=>({suppressScrollY:!0}),Ir=r=>({"cursor-pointer shadow":r});let Zr=(()=>{class r{constructor(){this.currencies=[],this.currencies$=(0,U.of)([]),this.maxDate=new Date,this.merchant=null,this.paymentMethods$=(0,U.of)([]),this.previewsProductsFormData=[],this.rates=[],this.searchProductControl=new n.NI(null),this.searchSupplierControl=new n.NI(null),this.selectedCurrencyIso="",this.selectedProductForm=null,this.selectedProductIndex=-1,this.selectedSupplierName="",this.stayHere=!1,this.total=0,this.uoms$=(0,U.of)([]),this.vouchers=[],this.vouchers$=(0,U.of)([]),this._changeDetectorRef=(0,e.f3M)(e.sBO),this._dialog=(0,e.f3M)(oe.uw),this._fileSaverService=(0,e.f3M)(it.m),this._formBuilder=(0,e.f3M)(n.qu),this._fuseConfirmationService=(0,e.f3M)(te.R),this._productsService=(0,e.f3M)(ot.s),this._purchasesService=(0,e.f3M)(de.F),this._ratesService=(0,e.f3M)(rt.m),this._router=(0,e.f3M)(v.F0),this._snackBar=(0,e.f3M)(E.ux),this._suppliersService=(0,e.f3M)(Y),this._unsubscribeAll=new w.x,this.store=(0,e.f3M)(V.yh)}ngOnInit(){this.purchaseForm=this._formBuilder.group({currencyId:new n.NI(null,[n.kI.required]),supplierId:new n.NI(null,[n.kI.required]),voucherTypeId:new n.NI(null,[n.kI.required]),voucherNo:new n.NI(null,[n.kI.required]),voucherDate:new n.NI(new Date,[n.kI.required]),paymentMethodId:new n.NI(null,[n.kI.required]),rates:new n.NI([],[n.kI.required]),products:new n.Oe([]),indirectCost:this._formBuilder.group({fobCosts:new n.NI(0,[n.kI.required,n.kI.min(0)]),freight:new n.NI(0,[n.kI.required,n.kI.min(0)]),insurance:new n.NI(0,[n.kI.required,n.kI.min(0)]),customsDuties:new n.NI(0,[n.kI.required,n.kI.min(0)]),customsServices:new n.NI(0,[n.kI.required,n.kI.min(0)]),transportation:new n.NI(0,[n.kI.required,n.kI.min(0)]),unloading:new n.NI(0,[n.kI.required,n.kI.min(0)]),otherCosts:new n.NI(0,[n.kI.required,n.kI.min(0)])})}),this.store.select($.Qs).pipe((0,g.R)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.purchaseForm.get("voucherTypeId").valueChanges.pipe((0,g.R)(this._unsubscribeAll)).subscribe(t=>{const o=this.vouchers.find(i=>i.id===t);o&&"compra-sin-factura"===o.slug?this.purchaseForm.get("voucherNo").clearValidators():this.purchaseForm.get("voucherNo").addValidators([n.kI.required]),this.purchaseForm.get("voucherNo").reset()}),this.purchaseForm.get("indirectCost").valueChanges.pipe((0,g.R)(this._unsubscribeAll)).subscribe(t=>{this.calcAllIndirectCost()}),this.purchaseForm.get("products").valueChanges.pipe((0,g.R)(this._unsubscribeAll),(0,k.b)(100)).subscribe(t=>{const o=this.verifyUpcChanges(t,this.previewsProductsFormData);o&&o.upc&&this.findProductsByUpcSAndRefreshForm([o.upc.toString()]),this.verificarCambios(t,this.previewsProductsFormData)&&this.calcAllIndirectCost(),this.previewsProductsFormData=[...t],this._calculatePurchaseTotal(),this._changeDetectorRef.markForCheck()}),this.currencies$=this.store.select(We.zd),this.currencies$.pipe((0,g.R)(this._unsubscribeAll)).subscribe(t=>{this.currencies=t,z.W.IsNullOrEmpty(t)||setTimeout(()=>{const o=t.find(i=>i.id===this.merchant.currencyId);this.purchaseForm.get("currencyId").setValue(o.id)},500),this._changeDetectorRef.markForCheck()}),this.store.select(he.Wy).pipe((0,g.R)(this._unsubscribeAll)).subscribe(t=>{if(t&&t.length>0&&this.currencies.length>0){this.closeFormDetail();const o=[],i=this.purchaseForm.get("products").getRawValue();for(const c of t)i.some(u=>u.upc===c.upc)||o.push(c);o.map(c=>this.createProductFormGroup(c)).forEach(c=>{this.purchaseForm.get("products").push(c)}),this._changeDetectorRef.markForCheck(),this.findProductsByUpcSAndRefreshForm(o.filter(c=>c.upc).map(c=>c.upc.toString()))}}),this.suppliers$=this.store.select(G),this.paymentMethods$=this.store.select(Z.VS),this.paymentMethods$.pipe((0,g.R)(this._unsubscribeAll)).subscribe(t=>{if(!z.W.IsNullOrEmpty(t)){const o=t.find(i=>"Efectivo"===i.name);this.purchaseForm.get("paymentMethodId").setValue(o?o.id:t[0].id)}this._changeDetectorRef.markForCheck()}),this.vouchers$=this.store.select(x.a),this.vouchers$.pipe((0,g.R)(this._unsubscribeAll)).subscribe(t=>{if(this.vouchers=t,!z.W.IsNullOrEmpty(t)){const o=t.find(i=>"Factura"===i.name);this.purchaseForm.get("voucherTypeId").setValue(o?o.id:t[0].id)}this._changeDetectorRef.markForCheck()}),this.products$=this.store.select(he.nR),this.uoms$=this.store.select(et.av),this.ratesFiltered=this.purchaseForm.get("currencyId").valueChanges.pipe((0,C.O)(null),(0,d.z)(t=>{if(t){const o=this.currencies.find(i=>i.id===t);return this.selectedCurrencyIso=o.iso,this._ratesService.findActiveByBaseId(t)}return(0,U.of)([])})),this.ratesFiltered.pipe((0,g.R)(this._unsubscribeAll)).subscribe(t=>{this.rates=t,this.resetSelectedProductsRates(),this.updateSelectedRates()}),this.purchaseForm.get("rates").valueChanges.pipe((0,g.R)(this._unsubscribeAll),(0,k.b)(500)).subscribe(t=>{this.resetSelectedProductsRates()}),this.productsFiltered=this.searchProductControl.valueChanges.pipe((0,k.b)(200),(0,C.O)(null),(0,d.z)(t=>this._mapChecked(null!==t&&"string"==typeof t?this._productsService.findActiveProducts(t.trim(),10):this.products$))),this.suppliersFiltered=this.searchSupplierControl.valueChanges.pipe((0,k.b)(200),(0,C.O)(null),(0,d.z)(t=>null!==t&&"string"==typeof t&&t!==this.selectedSupplierName?this._suppliersService.findActiveSuppliers(t.trim()):this.suppliers$))}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this.store.dispatch((0,Xe.vp)())}voucherNoHasValidator(){return this.purchaseForm.get("voucherNo").hasValidator(n.kI.required)}displayFn(t){return t&&t.name?t.name:""}selectSupplier(t){this.purchaseForm.get("supplierId").setValue(t.id),this.selectedSupplierName=t.name}addPurchaseProduct(t){const o=this.getProductFrom(t);this.purchaseForm.get("products").push(o),this.updateSelectedRates(),this._changeDetectorRef.markForCheck()}removePurchaseProduct(t){this.purchaseForm.get("products").removeAt(t),t===this.selectedProductIndex&&this.closeFormDetail(),this.updateSelectedRates(),this._changeDetectorRef.markForCheck()}addProductToPurchase(t){const o=this.purchaseForm.get("products").getRawValue().findIndex(i=>i.productId===t.id);t.checked?(this.removePurchaseProduct(o),t.checked=!1):t.checked=!0,!(o>-1)&&this.addPurchaseProduct(t)}addNewProduct(){this.purchaseForm.get("products").push(this.createEmptyProductFormGroup())}incrementProductQty(t){const o=t.get("quantity").value;t.get("quantity").setValue(Number(o)+1)}decrementProductQty(t){const o=t.get("quantity").value;t.get("quantity").setValue(Number(o)-1)}removeProductToPurchase(t){this.removePurchaseProduct(t),this.searchProductControl.reset()}selectDepot(){this.openDialog().afterClosed().pipe((0,g.R)(this._unsubscribeAll)).subscribe(o=>{o&&!z.W.IsNullOrEmpty(o.depot)&&this.createPurchase(o.depot.id)})}createPurchase(t=""){if(this.purchaseForm.invalid||0===this.purchaseForm.get("products").controls.length)return;const o=this.purchaseForm.getRawValue();o.ratesId=o.products.map(a=>a.rateId).filter((a,c,u)=>u.indexOf(a)===c),o.products=o.products.map(a=>new nt.Jw(a)),o.total=this._calculatePurchaseTotal(),delete o.rates,this._fuseConfirmationService.open({title:"Registrar compra",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,g.R)(this._unsubscribeAll)).subscribe(a=>{"confirmed"===a&&this._purchasesService.createPurchase(o).pipe((0,g.R)(this._unsubscribeAll)).subscribe(({data:c})=>{c&&(this._snackBar.openFromComponent(O.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:"Factura de compra creada correctamente",title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this.stayHere?this.restoreForm():this._router.navigateByUrl("/modules/trade/purchases/list")),this._changeDetectorRef.markForCheck()})})}toggleProductDetail(t,o){if(this.selectedProductIndex===o)return this.closeFormDetail(),void this._changeDetectorRef.markForCheck();this.selectedProductIndex=o,this.selectedProductForm=t,this._changeDetectorRef.markForCheck()}importStockFormTemplateFile(t){const o=t.target;this.isExcelFile=!!o.files[0].name.match(/(.xls|.xlsx)/),o.files.length>1&&(this.stockTemplateFile.nativeElement.value=""),this.isExcelFile?this._productsService.importStockFormTemplateFile(t):this.stockTemplateFile.nativeElement.value=""}exportProductsTemplate(t){const i=t.getRawValue().map(u=>({upc:u.upc,sku:u.sku,bCode:u.bCode,name:u.name,description:u.description,uom:u.uom,quantity:1,cost:u.cost,price:u.price,brand:u.brand,weight:u.weight,width:u.width,length:u.length,height:u.height,volume:u.volume}));this._fileSaverService.exportAsExcelFile(i,"Plantilla de productos",[["UPC","SKU","C\xf3digo","Nombre","Descripci\xf3n","Unidad de Medida","Cantidad","Costo","Precio","Marca","Peso","Ancho","Largo","Altura","Volumen"]],[{wch:20},{wch:20},{wch:20},{wch:30},{wch:70},{wch:16}])}restoreForm(){const t=this.purchaseForm.get("paymentMethodId").value,o=this.purchaseForm.get("voucherTypeId").value;if(this.purchaseForm.get("products").clear(),this.searchSupplierControl.reset(),this.purchaseForm.reset(),this.total=0,this.selectedSupplierName="",this.searchProductControl.setValue(""),this.purchaseForm.get("paymentMethodId").setValue(t),this.purchaseForm.get("voucherTypeId").setValue(o),this.purchaseForm.get("voucherDate").setValue(new Date),this.purchaseForm.get("indirectCost").get("fobCosts").setValue(0),this.purchaseForm.get("indirectCost").get("freight").setValue(0),this.purchaseForm.get("indirectCost").get("insurance").setValue(0),this.purchaseForm.get("indirectCost").get("customsDuties").setValue(0),this.purchaseForm.get("indirectCost").get("customsServices").setValue(0),this.purchaseForm.get("indirectCost").get("transportation").setValue(0),this.purchaseForm.get("indirectCost").get("unloading").setValue(0),this.purchaseForm.get("indirectCost").get("otherCosts").setValue(0),!z.W.IsNullOrEmpty(this.currencies)){const i=this.currencies.find(a=>a.id===this.merchant.currencyId);this.purchaseForm.get("currencyId").setValue(i.id)}}_calculatePurchaseTotal(){const t=this.total=this.purchaseForm.get("products").getRawValue().map(o=>o.ct).reduce((o,i)=>o+i,0);return this.total=Number(t.toFixed(2)),this.total}_mapChecked(t){return t.pipe((0,f.U)(o=>o.map(i=>this.purchaseForm.get("products").getRawValue().some(c=>c.productId===i.id)?{...structuredClone(i),checked:!0}:{...structuredClone(i),checked:!1})))}resetSelectedProductsRates(){const t=this.purchaseForm.get("currencyId").value,i=this.purchaseForm.get("products").getRawValue().reduce((a,c)=>a+Number(c.quantity)*c.cost,0);for(const a of this.purchaseForm.get("products").controls){const c=a.getRawValue(),u=structuredClone(this.purchaseForm.get("rates").value);let b=u.find(j=>j.currencyBaseId===t&&j.currencyRefId===c.currencyId);!b&&t!==c.currencyId&&(b=u.find(j=>j.currencyRefId===t&&j.currencyRefId!==j.currencyBaseId),b&&(b.value=1/b.value));let S=b?b.value:null;const H=a.get("cost").value,ie=a.get("price").value;let K=a.get("rate").value?a.get("rate").value:1;K&&S===K&&(K=1,S=1),a.patchValue({...c,cost:S?H*S:1*H/K,price:S?ie*S:1*ie/K,rate:b?b.value:null,rateId:b?b.id:null}),this.calcIndirectCost(a,i)}this._changeDetectorRef.markForCheck()}calcAllIndirectCost(){const t=this.purchaseForm.get("products").getRawValue();this.previewsProductsFormData=[...t];const o=t.reduce((i,a)=>i+Number(a.quantity)*a.cost,0);for(const i of this.purchaseForm.get("products").controls)this.calcIndirectCost(i,o)}calcIndirectCost(t,o){const i=this.purchaseForm.get("indirectCost").getRawValue(),a=i.fobCosts+i.freight+i.insurance+i.customsDuties+i.customsServices+i.transportation+i.unloading+i.otherCosts,c=t.getRawValue(),b=Number(c.quantity)*c.cost/o*a,S=Number((b/Number(c.quantity)).toFixed(2)),H=c.cost+S,ie=Number((c.quantity*H).toFixed(2));t.patchValue({...c,cui:S,cut:H,ct:ie})}createProductFormGroup(t){if(this.currencies.length>0){const o=this.currencies.find(u=>u.id===this.merchant.currencyId),i=this.purchaseForm.get("currencyId").value,c=structuredClone(this.purchaseForm.get("rates").value).find(u=>u.currencyBaseId===i&&u.currencyRefId===o.id);return this._formBuilder.group({upc:[t.upc,[n.kI.required]],sku:[t.sku],bCode:[t.bCode],name:[t.name,[n.kI.required]],description:[t.description,[n.kI.maxLength(1e4)]],uom:[t.uom?t.uom:"U",[n.kI.required]],quantity:[Number(t.quantity),[ue.L.onlyNumbersPattern(),n.kI.required,n.kI.min(.1)]],cost:new n.NI((c?c.value:1)*t.cost,[n.kI.required,n.kI.min(0),n.kI.max(99999999)]),cui:new n.NI(0),cut:new n.NI(0),ct:new n.NI(0),price:[t.price,[n.kI.required,n.kI.min(0),n.kI.max(9999999)]],brand:[t.brand],weight:[t.weight,[n.kI.min(0)]],width:[t.width,[n.kI.min(0)]],length:[t.length,[n.kI.min(0)]],height:[t.height,[n.kI.min(0)]],volume:[t.volume,[n.kI.min(0)]],currencyId:new n.NI(o.id,[n.kI.required]),currency:new n.NI(o.iso,[n.kI.required]),rate:new n.NI(c?c.value:null,[n.kI.required]),rateId:new n.NI(c?c.id:null),productId:[null]})}return null}createEmptyProductFormGroup(){if(this.currencies.length>0){const t=this.currencies.find(c=>c.id===this.merchant.currencyId),o=this.purchaseForm.get("currencyId").value,a=structuredClone(this.purchaseForm.get("rates").value).find(c=>c.currencyBaseId===o&&c.currencyRefId===t.id);return this._formBuilder.group({upc:[null,[n.kI.required]],sku:[null],bCode:[null],name:[null,[n.kI.required]],description:[null,[n.kI.maxLength(1e4)]],uom:["U",[n.kI.required]],quantity:[1,[ue.L.onlyNumbersPattern(),n.kI.required,n.kI.min(.1)]],cost:new n.NI(0,[n.kI.required,n.kI.min(0),n.kI.max(99999999)]),cui:new n.NI(0),cut:new n.NI(0),ct:new n.NI(0),price:[0,[n.kI.required,n.kI.min(0),n.kI.max(9999999)]],brand:[""],weight:[0,[n.kI.min(0)]],width:[0,[n.kI.min(0)]],length:[0,[n.kI.min(0)]],height:[0,[n.kI.min(0)]],volume:[0,[n.kI.min(0)]],currencyId:new n.NI(t.id,[n.kI.required]),currency:new n.NI(t.iso,[n.kI.required]),rate:new n.NI(a?a.value:null,[n.kI.required]),rateId:new n.NI(a?a.id:null),productId:[null]})}return null}verificarCambios(t,o){for(let i=0;i<t.length;i++)if(t.length!==o.length||t[i].cost!==o[i].cost||Number(t[i].quantity)!==Number(o[i].quantity))return!0;return!1}verifyUpcChanges(t,o){for(let i=0;i<t.length;i++){const a=o[i]?structuredClone(o[i]):null;if(a&&t[i].upc!==a.upc&&z.W.IsNullOrEmpty(t[i].productId))return t[i];if(t.length!==o.length&&t.length>0&&z.W.IsNullOrEmpty(t[i].productId))return t[t.length-1]}return null}findProductsByUpcSAndRefreshForm(t){this._productsService.findProductsByUpcS(t).pipe((0,g.R)(this._unsubscribeAll)).subscribe(o=>{const i=this.purchaseForm.get("products").getRawValue();for(const a of this.purchaseForm.get("products").controls){const c=a.getRawValue(),u=o.findIndex(b=>b.upc===c.upc);-1!==u&&(!c.productId&&i.some(b=>b.upc===c.upc&&b.productId===o[u].id)?a.get("upc").reset():(a.patchValue({...this.getProductFrom({...o[u]}).getRawValue(),quantity:Number(c.quantity),price:c.price,cost:c.cost}),this.closeFormDetail()))}this.updateSelectedRates()})}getProductFrom(t){const o=this.purchaseForm.get("currencyId").value,i=structuredClone(this.purchaseForm.get("rates").value);let a=i.find(u=>u.currencyBaseId===o&&u.currencyRefId===t.currencyId);return a||(a=i.find(u=>u.currencyRefId===o&&u.currencyRefId!==u.currencyBaseId),a&&(a.value=1/a.value)),this._formBuilder.group({productId:new n.NI(t.id,[n.kI.required]),currencyId:new n.NI(t.currencyId,[n.kI.required]),name:new n.NI(t.name,[n.kI.required]),cost:new n.NI((a?a.value:1)*t.cost,[n.kI.required,n.kI.min(0),n.kI.max(99999999)]),cui:new n.NI(0),cut:new n.NI(0),ct:new n.NI(0),price:new n.NI((a?a.value:1)*t.price,[n.kI.required,n.kI.min(0),n.kI.max(99999999)]),uom:new n.NI(t.uom.abbr,[n.kI.required]),currency:new n.NI(t.currency.iso,[n.kI.required]),rateId:new n.NI(a?a.id:null,[n.kI.required]),rate:new n.NI(a?a.value:null,[n.kI.required]),quantity:new n.NI(1,[ue.L.onlyNumbersPattern(),n.kI.required,n.kI.min(.1)]),upc:[t.upc,[n.kI.required]],sku:[t.sku],bCode:[t.bCode],description:[t.description,[n.kI.maxLength(1e4)]],brand:[t.brand.name],weight:[t.weight,[n.kI.min(0)]],width:[t.width,[n.kI.min(0)]],length:[t.length,[n.kI.min(0)]],height:[t.height,[n.kI.min(0)]],volume:[t.volume,[n.kI.min(0)]]})}updateSelectedRates(){const t=this.purchaseForm.get("currencyId").value,o=this.purchaseForm.get("products").getRawValue();let i=[];for(const c of o)i=[...this.rates.filter(S=>S.currencyBaseId===t&&S.currencyRefId===c.currencyId),...this.rates.filter(S=>S.currencyBaseId===c.currencyId&&S.currencyRefId===t&&S.currencyRefId!==S.currencyBaseId),...i];const a=i.reduce((c,u)=>(c.find(S=>S.id===u.id&&S.name===u.name)||c.push(u),c),[]);this.purchaseForm.get("rates").setValue(a)}closeFormDetail(){this.selectedProductIndex=-1,this.selectedProductForm=null}openDialog(){return this._dialog.open(tt.v,{data:{},panelClass:"ath-dialog-panel",disableClose:!0})}static#e=this.\u0275fac=function(o){return new(o||r)};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["purchase-form"]],viewQuery:function(o,i){if(1&o&&e.Gf(st,5),2&o){let a;e.iGM(a=e.CRH())&&(i.stockTemplateFile=a.first)}},standalone:!0,features:[e.jDz],decls:132,vars:77,consts:[["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0",3,"fuseScrollbarOptions"],[1,"relative","flex","flex-col","px-6","py-8","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["color","primary",3,"ngModel","ngModelChange"],["mat-flat-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"disabled","click"],[1,"flex","flex-col","px-4","mt-4","mb-12","gap-y-8","sm:px-8"],[1,"col-span-2","shadow","rounded-2xl","bg-card"],[1,"grid","gap-4","p-10","sm:grid-cols-4","lg:grid-cols-5",3,"formGroup"],["purchaseNgForm","ngForm"],["appearance","fill",1,"w-full","md:col-span-2","fuse-mat-dense"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder","required"],[1,"ath-autocomplete",3,"displayWith"],["supplierAutocomplete","matAutocomplete"],[1,"w-full","fuse-mat-dense"],[3,"formControlName","required"],["matInput","","maxlength","50",3,"type","formControlName","required"],["matInput","",3,"matDatepicker","formControlName","max","required"],["matIconSuffix","",3,"for"],["voucherDate",""],[3,"formControlName","required","placeholder"],["multiple","",3,"formControlName","required","placeholder"],["class","text-sm opacity-75"],["indirectCost",""],["value","importation"],["value","national"],["formGroupName","indirectCost"],[1,"col-span-4","shadow","rounded-2xl","bg-card"],[1,"p-6","pb-0"],[1,"flex","flex-col-reverse","justify-between","sm:flex-row"],["appearance","fill",1,"w-full","md:mr-8","fuse-mat-dense",3,"subscriptSizing"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete",3,"displayWith","closed"],["productsAutocomplete","matAutocomplete"],[1,"w-full","bg-default",3,"click"],[1,"flex","items-center","justify-center","w-full",3,"click"],[1,"inline-flex","items-center","rounded","cursor-pointer"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2","font-medium","text-secondary","group-hover:underline"],[1,"flex","items-center","self-end","sm:w-20","sm:space-x-2","sm:justify-evenly"],["mat-icon-button","","matTooltip","Importar Plantilla",1,"rounded-full","cursor-pointer","hover:bg-hover"],["for","template-file-input",1,"flex","items-center","cursor-pointer","p-2.5"],["id","template-file-input","type","file","accept",".xls, .xlsx",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"change"],["templateFile",""],["mat-icon-button","","matTooltip","Descargar Plantilla",3,"click"],["fuseScrollbar","",1,"flex","flex-col","flex-auto","pb-3","mt-2","min-h-72",3,"fuseScrollbarOptions"],["class","grid"],["rowDetailsTemplate",""],[1,"flex","items-center","justify-center","w-full","gap-2","p-2","font-mono","text-3xl","font-semibold","leading-7","text-white","rounded-b-2xl","bg-gradient-to-r","from-primary-500","to-primary-700",3,"ngClass","click"],[3,"value","click"],[3,"value"],[1,"text-sm","opacity-75"],[1,"w-18"],[1,"w-full","fuse-mat-dense",3,"subscriptSizing"],["matInput","","type","number","min","0",3,"formControlName"],[1,"w-full",3,"value","click"],[1,"grid","w-full","grid-cols-6",3,"click"],[1,"flex","flex-row","items-center","col-span-5","truncate","md:col-span-3"],["color","primary",3,"checked"],[1,"flex","items-center","text-center"],[1,"grid"],[1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","purchase-products-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-primary","dark:bg-opacity-5"],[1,"text-left"],[1,"text-center"],["matTooltip","Costo Unitario Directo",1,"text-center"],["matTooltip","Costo Unitario Indirecto",1,"text-center"],["matTooltip","Costo Total = (Costo + CUI) x Cantidad",1,"text-right"],[1,"mr-2","text-right"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","purchase-products-grid","md:px-8",3,"ngClass"],[1,"truncate",3,"matTooltip"],["class","text-warn"],[1,"text-center",3,"ngClass"],[1,"flex","flex-col","justify-center"],[1,"flex","flex-row","items-center","justify-center","gap-2"],["mat-stroked-button","",1,"p-2","leading-6","min-w-7","min-h-7","h-7",3,"disabled","click"],[1,"fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],["matInput","","type","text","name","quantity",1,"font-mono","font-semibold","text-center",3,"min","formControl"],["class","w-full text-sm text-center"],[1,"flex","flex-col","items-center","justify-center"],["matInput","","type","number",1,"font-mono","font-semibold","text-center",3,"min","max","formControl"],[1,"font-mono","text-right"],[1,"flex","justify-end","gap-2"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"color","disabled","click"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"text-warn"],[1,"w-full","text-sm","text-center"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-30"],[1,"p-6","mb-4","overflow-hidden","shadow-lg"],[1,"grid","grid-cols-8","gap-4",3,"formGroup"],[1,"col-span-2"],["matTooltip","C\xf3digo de barras",1,"w-full","fuse-mat-dense",3,"subscriptSizing"],["matInput","","type","text","minlength","3","maxlength","255","required","",3,"formControlName"],["matInput","","type","text","minlength","3","maxlength","255",3,"formControlName"],["required","",3,"formControlName"],["matInput","","type","text","minlength","1","maxlength","255",3,"formControlName"],["matPrefix","","svgIcon","mat_solid:scale"],["matInput","","type","number","min","0","max","999999999","maxlength","9",3,"formControlName"],["matPrefix","","svgIcon","mat_solid:square_foot"],[1,"flex","flex-col","justify-end","col-span-5"],["matInput","","matInput","","matTextareaAutoSize","","maxlength","10000",3,"formControlName","rows"],["descriptionLength",""],["matSuffix","",1,"ml-2"],["class","w-full",3,"value"]],template:function(o,i){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Compras"),e.qZA()()(),e.TgZ(11,"div",8)(12,"h2",9),e._uU(13," Registrar Factura de Compra "),e.qZA()()(),e.TgZ(14,"div",10)(15,"mat-checkbox",11),e.NdJ("ngModelChange",function(c){return i.stayHere=c}),e._uU(16,"Permanecer aqu\xed"),e.qZA(),e.TgZ(17,"button",12),e.NdJ("click",function(){return i.createPurchase()}),e._uU(18," Registrar "),e.qZA()()(),e.TgZ(19,"div",13)(20,"div",14)(21,"form",15,16)(23,"mat-form-field",17)(24,"mat-label"),e._uU(25,"Proveedor"),e.qZA(),e._UZ(26,"mat-icon",18)(27,"input",19),e.TgZ(28,"mat-autocomplete",20,21),e.SjG(30,ct,2,2,"mat-option",58,e.x6l),e.ALo(32,"async"),e.qZA()(),e.TgZ(33,"mat-form-field",22)(34,"mat-label"),e._uU(35,"Tipo de comprobante"),e.qZA(),e.TgZ(36,"mat-select",23),e.SjG(37,lt,2,2,"mat-option",58,e.x6l),e.ALo(39,"async"),e.qZA(),e.YNc(40,ut,2,0,"mat-error"),e.qZA(),e.TgZ(41,"mat-form-field",22)(42,"mat-label"),e._uU(43,"N\xfamero del comprobante"),e.qZA(),e._UZ(44,"input",24),e.YNc(45,pt,2,0,"mat-error"),e.qZA(),e.TgZ(46,"mat-form-field",22)(47,"mat-label"),e._uU(48,"Fecha del comprobante"),e.qZA(),e._UZ(49,"input",25),e.TgZ(50,"mat-hint"),e._uU(51,"DD/MM/YYYY"),e.qZA(),e._UZ(52,"mat-datepicker-toggle",26)(53,"mat-datepicker",null,27),e.YNc(55,dt,2,0,"mat-error"),e.qZA(),e.TgZ(56,"mat-form-field",22)(57,"mat-label"),e._uU(58,"M\xe9todo de pago"),e.qZA(),e.TgZ(59,"mat-select",23),e.SjG(60,mt,2,2,"mat-option",58,e.x6l),e.ALo(62,"async"),e.qZA(),e.YNc(63,ht,2,0,"mat-error"),e.qZA(),e.TgZ(64,"mat-form-field",22)(65,"mat-label"),e._uU(66,"Moneda"),e.qZA(),e.TgZ(67,"mat-select",28),e.SjG(68,gt,2,2,"mat-option",58,e.x6l),e.ALo(70,"async"),e.qZA()(),e.TgZ(71,"mat-form-field",22)(72,"mat-label"),e._uU(73,"Tasa de Cambio"),e.qZA(),e.TgZ(74,"mat-select",29)(75,"mat-select-trigger"),e._uU(76),e.YNc(77,ft,2,2,"span",30),e.qZA(),e.SjG(78,_t,6,6,"mat-option",58,e.x6l),e.ALo(80,"async"),e.qZA(),e.YNc(81,Ct,2,0,"mat-error"),e.qZA(),e.TgZ(82,"mat-form-field",22)(83,"mat-label"),e._uU(84,"Tipo de Compra"),e.qZA(),e.TgZ(85,"mat-select",null,31)(87,"mat-option",32),e._uU(88,"Importaci\xf3n"),e.qZA(),e.TgZ(89,"mat-option",33),e._uU(90,"En Plaza"),e.qZA()()(),e.YNc(91,yt,7,4,"div",34)(92,Zt,7,4,"div",34)(93,At,7,4,"div",34)(94,qt,7,4,"div",34)(95,Nt,7,4,"div",34)(96,Rt,7,4,"div",34)(97,Dt,7,4,"div",34)(98,Bt,7,4,"div",34),e.qZA()(),e.TgZ(99,"div",35)(100,"div",36)(101,"div",37)(102,"mat-form-field",38),e._UZ(103,"mat-icon",18)(104,"input",39),e.TgZ(105,"mat-autocomplete",40,41),e.NdJ("closed",function(){return i.searchProductControl.reset()}),e.TgZ(107,"mat-option",42),e.NdJ("click",function(c){return i.addNewProduct(),c.stopPropagation()}),e.TgZ(108,"div",43),e.NdJ("click",function(c){return i.addNewProduct(),c.stopPropagation()}),e.TgZ(109,"div",44),e._UZ(110,"mat-icon",45),e.TgZ(111,"span",46),e._uU(112," Agregar Producto "),e.qZA()()()(),e.SjG(113,Lt,9,5,"mat-option",111,e.x6l),e.ALo(115,"async"),e.qZA()(),e.TgZ(116,"div",47)(117,"div",48)(118,"label",49),e._UZ(119,"mat-icon",45),e.qZA(),e.TgZ(120,"input",50,51),e.NdJ("change",function(c){return i.importStockFormTemplateFile(c)}),e.qZA()(),e.TgZ(122,"button",52),e.NdJ("click",function(){return i.exportProductsTemplate(i.purchaseForm.get("products"))}),e._UZ(123,"mat-icon",45),e.qZA()()(),e.TgZ(124,"div",53),e.YNc(125,ar,23,0,"div",54)(126,sr,2,0)(127,vr,85,40,"ng-template",null,55,e.W1O),e.qZA()(),e.TgZ(129,"div",56),e.NdJ("click",function(){return i.createPurchase()}),e._uU(130),e.ALo(131,"number"),e.qZA()()()()),2&o){const a=e.MAs(29),c=e.MAs(54),u=e.MAs(86),b=e.MAs(106);e.Q6J("fuseScrollbarOptions",e.DdM(73,yr)),e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(7),e.Q6J("ngModel",i.stayHere),e.xp6(2),e.Q6J("disabled",i.purchaseForm.invalid||0===i.purchaseForm.get("products").controls.length),e.xp6(4),e.Q6J("formGroup",i.purchaseForm),e.xp6(5),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",i.searchSupplierControl)("matAutocomplete",a)("placeholder","Buscar proveedor")("required",!0),e.xp6(),e.Q6J("displayWith",i.displayFn),e.xp6(2),e.wJu(e.lcZ(32,58,i.suppliersFiltered)),e.xp6(6),e.Q6J("formControlName","voucherTypeId")("required",!0),e.xp6(),e.wJu(e.lcZ(39,60,i.vouchers$)),e.xp6(3),e.um2(40,i.purchaseForm.get("voucherTypeId").hasError("required")?40:-1),e.xp6(4),e.Q6J("type","text")("formControlName","voucherNo")("required",i.voucherNoHasValidator()),e.xp6(),e.um2(45,i.purchaseForm.get("voucherNo").hasError("required")?45:-1),e.xp6(4),e.Q6J("matDatepicker",c)("formControlName","voucherDate")("max",i.maxDate)("required",!0),e.xp6(3),e.Q6J("for",c),e.xp6(3),e.um2(55,i.purchaseForm.get("voucherDate").hasError("required")?55:-1),e.xp6(4),e.Q6J("formControlName","paymentMethodId")("required",!0),e.xp6(),e.wJu(e.lcZ(62,62,i.paymentMethods$)),e.xp6(3),e.um2(63,i.purchaseForm.get("paymentMethodId").hasError("required")?63:-1),e.xp6(4),e.Q6J("formControlName","currencyId")("required",!0)("placeholder","Moneda"),e.xp6(),e.wJu(e.lcZ(70,64,i.currencies$)),e.xp6(6),e.Q6J("formControlName","rates")("required",!0)("placeholder","Tasa de cambio"),e.xp6(2),e.hij(" ",(null==i.purchaseForm.get("rates").value||null==i.purchaseForm.get("rates").value[0]?null:i.purchaseForm.get("rates").value[0].name)||""," "),e.xp6(),e.um2(77,((null==i.purchaseForm.get("rates").value?null:i.purchaseForm.get("rates").value.length)||0)>1?77:-1),e.xp6(),e.wJu(e.lcZ(80,66,i.ratesFiltered)),e.xp6(3),e.um2(81,i.purchaseForm.get("rates").hasError("required")?81:-1),e.xp6(10),e.um2(91,"importation"===u.value?91:-1),e.xp6(),e.um2(92,"importation"===u.value?92:-1),e.xp6(),e.um2(93,"importation"===u.value?93:-1),e.xp6(),e.um2(94,"importation"===u.value?94:-1),e.xp6(),e.um2(95,"importation"===u.value||"national"===u.value?95:-1),e.xp6(),e.um2(96,"importation"===u.value||"national"===u.value?96:-1),e.xp6(),e.um2(97,"importation"===u.value||"national"===u.value?97:-1),e.xp6(),e.um2(98,"importation"===u.value||"national"===u.value?98:-1),e.xp6(4),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",i.searchProductControl)("matAutocomplete",b)("placeholder","Buscar productos"),e.xp6(),e.Q6J("displayWith",i.displayFn),e.xp6(5),e.Q6J("svgIcon","mat_solid:add_circle"),e.xp6(3),e.wJu(e.lcZ(115,68,i.productsFiltered)),e.xp6(6),e.Q6J("svgIcon","mat_solid:upload"),e.xp6(4),e.Q6J("svgIcon","mat_solid:download"),e.xp6(),e.Q6J("fuseScrollbarOptions",e.DdM(74,br)),e.xp6(),e.um2(125,i.purchaseForm.get("products").controls.length>0?125:126),e.xp6(4),e.Q6J("ngClass",e.VKq(75,Ir,i.purchaseForm.valid&&i.purchaseForm.get("products").controls.length>0)),e.xp6(),e.AsE(" ",e.xi3(131,70,i.total,"1.2-2")," ",i.selectedCurrencyIso," ")}},dependencies:[m.Ov,m.H9,m.JJ,n.u5,n._Y,n.Fj,n.wV,n.JJ,n.JL,n.Q7,n.wO,n.nD,n.qQ,n.Fd,n.On,se.H,le.Bb,le.XC,at.ey,le.ZL,I.ot,I.lW,I.RK,ae.p9,ae.oG,re.FA,re.Mq,re.hl,re.nW,F.lN,F.KE,F.hX,F.bx,F.TO,F.qo,F.R9,A.Ps,A.Hw,y.c,y.Nt,ce.LD,ce.gD,ce.$L,me.AV,me.gM,m.mk,n.UX,n.oH,n.sg,n.u,n.x0],encapsulation:2,changeDetection:0})}return r})();var Tr=s(94748);class Fr{}var Ar=s(6990);function Pr(r,l){1&r&&(e.TgZ(0,"h2",2),e._uU(1,"Agregar Proveedor"),e.qZA())}function Sr(r,l){1&r&&(e.TgZ(0,"h2",2),e._uU(1,"Editar Proveedor"),e.qZA())}function qr(r,l){if(1&r&&(e.TgZ(0,"div",6)(1,"div",7)(2,"form",8)(3,"div",9)(4,"mat-form-field",10)(5,"mat-label"),e._uU(6,"Nombre"),e.qZA(),e._UZ(7,"input",11),e.qZA(),e.TgZ(8,"mat-form-field",10)(9,"mat-label"),e._uU(10,"N\xfamero de identificaci\xf3n tributaria"),e.qZA(),e._UZ(11,"input",11),e.qZA(),e.TgZ(12,"mat-form-field",10)(13,"mat-label"),e._uU(14,"Correo electr\xf3nico"),e.qZA(),e._UZ(15,"input",12),e.qZA(),e.TgZ(16,"mat-form-field",10)(17,"mat-label"),e._uU(18,"Tel\xe9fono"),e.qZA(),e._UZ(19,"input",13),e.TgZ(20,"mat-hint"),e._uU(21,"Debe incluir +53 al inicio del tel\xe9fono"),e.qZA()()()()()()),2&r){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.supplierForm)("autocomplete","off"),e.xp6(5),e.Q6J("formControlName","name"),e.xp6(4),e.Q6J("formControlName","nit"),e.xp6(4),e.Q6J("formControlName","email"),e.xp6(4),e.Q6J("formControlName","phone")}}const ge=r=>({"cursor-not-allowed":r});function Ur(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.updateSupplier())}),e._uU(1,"Actualizar"),e.qZA()}if(2&r){const t=e.oxw(2);e.Q6J("disabled",t.supplierForm.invalid)("ngClass",e.VKq(3,ge,t.supplierForm.invalid))("color","primary")}}function kr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.createSupplier())}),e._uU(1,"Agregar"),e.qZA()}if(2&r){const t=e.oxw(2);e.Q6J("disabled",t.supplierForm.invalid)("ngClass",e.VKq(3,ge,t.supplierForm.invalid))("color","primary")}}function Nr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",14)(1,"button",15),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.closeDialog())}),e._uU(2,"Cancelar"),e.qZA(),e.YNc(3,Ur,2,5,"button",16)(4,kr,2,5,"button",16),e.qZA()}if(2&r){const t=e.oxw();e.xp6(),e.Q6J("color","warn"),e.xp6(2),e.um2(3,"edit"===t.data.dialogMode?3:-1),e.xp6(),e.um2(4,"add"===t.data.dialogMode?4:-1)}}let Er=(()=>{class r{constructor(t,o,i,a,c,u,b){this.data=t,this._suppliersService=o,this._changeDetectorRef=i,this._dialogRef=a,this._formBuilder=c,this._fuseConfirmationService=u,this._snackBar=b,this._unsubscribeAll=new w.x,this.dialogMode=t.dialogMode,this.supplier=this.data.supplier}ngOnInit(){this.supplierForm=this._formBuilder.group({id:new n.NI,name:new n.NI(null,[n.kI.required,n.kI.minLength(3),n.kI.maxLength(150)]),nit:new n.NI(null,[n.kI.maxLength(20)]),email:new n.NI(null,[n.kI.email]),phone:new n.NI(null,[n.kI.maxLength(15),n.kI.pattern("^((\\+53)?\\d{8})?$")])}),null!==this.supplier.name&&this.supplierForm.patchValue(this.supplier)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}createSupplier(){let t=this.supplierForm.getRawValue();t=(0,Ar.omit)(t,["id"]),this._fuseConfirmationService.open({title:"Crear categor\xeda",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,g.R)(this._unsubscribeAll)).subscribe(i=>{"confirmed"===i&&this._suppliersService.createSupplier(t).pipe((0,g.R)(this._unsubscribeAll)).subscribe(({data:a})=>{this._snackBar.openFromComponent(O.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.createSupplier.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck(),this.closeDialog()})})}updateSupplier(){const t=this.supplierForm.getRawValue();this._fuseConfirmationService.open({title:"Categor\xeda",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,g.R)(this._unsubscribeAll)).subscribe(i=>{"confirmed"===i&&this._suppliersService.updateSupplier(t).pipe((0,g.R)(this._unsubscribeAll)).subscribe(({data:a})=>{this._snackBar.openFromComponent(O.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.updateSupplier.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.closeDialog(),this._changeDetectorRef.markForCheck()})})}static#e=this.\u0275fac=function(o){return new(o||r)(e.Y36(oe.WI),e.Y36(Y),e.Y36(e.sBO),e.Y36(oe.so),e.Y36(n.qu),e.Y36(te.R),e.Y36(E.ux))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["supplier-dialog"]],standalone:!0,features:[e.jDz],decls:9,vars:4,consts:[[1,"relative","flex","flex-col","w-full","max-h-screen"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["mat-dialog-title",""],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6"],["class","w-full overflow-hidden"],["class","flex items-center justify-center px-6 py-4 space-x-3 sm:justify-end bg-gray-50 dark:bg-black dark:bg-opacity-10"],[1,"w-full","overflow-hidden"],[1,"flex","border-t"],[1,"flex","flex-col","w-full","pt-8",3,"formGroup","autocomplete"],[1,"flex","flex-col","flex-auto","gap-4"],[1,"w-full","fuse-mat-dense"],["matInput","","type","text",3,"formControlName"],["matInput","","type","email",3,"formControlName"],["matInput","","type","tel",3,"formControlName"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-button","",1,"-ml-4",3,"color","click"],["mat-flat-button","",3,"disabled","ngClass","color"],["mat-flat-button","",3,"disabled","ngClass","color","click"]],template:function(o,i){1&o&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,Pr,2,0,"h2",2)(4,Sr,2,0,"h2",2),e.qZA(),e.BQk(),e.TgZ(5,"div",3),e.ynx(6),e.YNc(7,qr,22,6,"div",4),e.BQk(),e.qZA(),e.YNc(8,Nr,5,3,"div",5),e.qZA()),2&o&&(e.xp6(3),e.um2(3,i.data.supplier.id||"add"!==i.dialogMode?-1:3),e.xp6(),e.um2(4,i.data.supplier.id&&"edit"===i.dialogMode?4:-1),e.xp6(3),e.um2(7,"view"!==i.dialogMode?7:-1),e.xp6(),e.um2(8,"view"!==i.data.dialogMode?8:-1))},dependencies:[I.ot,I.lW,F.lN,F.KE,F.hX,F.bx,y.c,y.Nt,m.mk,n.UX,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u],encapsulation:2})}return r})();function wr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"mat-slide-toggle",35),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw(),c=a.$implicit,u=a.$index,b=e.oxw(4);return e.KtG(b.updateSupplierStatus(i,c,u))}),e.qZA()}if(2&r){const t=e.oxw().$implicit;e.Q6J("checked",t.active)("color","primary")}}function Rr(r,l){1&r&&e._UZ(0,"mat-spinner",31),2&r&&e.Q6J("diameter",20)("color","primary")}function Mr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",27)(1,"div",28),e._uU(2),e.qZA(),e.TgZ(3,"div",23),e._uU(4),e.qZA(),e.TgZ(5,"div",23),e._uU(6),e.qZA(),e.TgZ(7,"div",23),e._uU(8),e.qZA(),e.TgZ(9,"div",29),e.YNc(10,wr,1,2,"mat-slide-toggle",30)(11,Rr,1,2,"mat-spinner",31),e.qZA(),e.TgZ(12,"div",32)(13,"button",33),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.openDialog(a,"edit"))}),e._UZ(14,"mat-icon",34),e.qZA(),e.TgZ(15,"button",33),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deleteSupplier(a.id))}),e._UZ(16,"mat-icon",34),e.qZA()()()}if(2&r){const t=l.$implicit,o=l.$index,i=e.oxw(4);e.xp6(2),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",t.nit," "),e.xp6(2),e.hij(" ",t.phone," "),e.xp6(2),e.hij(" ",t.email," "),e.xp6(2),e.um2(10,i.isSlideLoading&&i.selectedSlide===o?-1:10),e.xp6(),e.um2(11,i.isSlideLoading&&i.selectedSlide===o?11:-1),e.xp6(3),e.Q6J("svgIcon","mat_solid:edit"),e.xp6(2),e.Q6J("svgIcon","mat_solid:delete")}}function Jr(r,l){1&r&&e.SjG(0,Mr,17,8,"div",36,e.QCX().trackByFn),2&r&&e.wJu(l)}const Dr=(r,l)=>({"pointer-events-none":r,hidden:l}),$r=()=>[10,25,50,100];function Qr(r,l){if(1&r&&(e.TgZ(0,"div",20)(1,"div",21)(2,"div",22),e._uU(3," Nombre "),e.qZA(),e.TgZ(4,"div",23),e._uU(5," NIT "),e.qZA(),e.TgZ(6,"div",23),e._uU(7," Tel\xe9fono "),e.qZA(),e.TgZ(8,"div",23),e._uU(9," Correo "),e.qZA(),e.TgZ(10,"div",24)(11,"span"),e._uU(12,"Activo"),e.qZA()(),e.TgZ(13,"div",25),e._uU(14,"Detalles"),e.qZA()(),e.YNc(15,Jr,2,0),e.ALo(16,"async"),e._UZ(17,"mat-paginator",26),e.qZA()),2&r){const t=e.oxw(2);let o;e.xp6(2),e.Q6J("mat-sort-header","name"),e.xp6(8),e.Q6J("mat-sort-header","active"),e.xp6(5),e.um2(15,(o=e.lcZ(16,9,t.suppliers$))?15:-1,o),e.xp6(2),e.Q6J("ngClass",e.WLB(11,Dr,t.isLoading,t.pagination.length<10&&t.pagination.page<1))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(14,$r))("showFirstLastButtons",!0)}}function Br(r,l){1&r&&(e.TgZ(0,"div",37),e._uU(1," \xa1No se ha creado ning\xfan proveedor! "),e.qZA())}function Lr(r,l){1&r&&e.YNc(0,Qr,18,15,"div",19)(1,Br,2,0),2&r&&e.um2(0,l.length>0?0:1)}let zr=(()=>{class r{constructor(t,o,i,a,c,u){this._changeDetectorRef=t,this._dialog=o,this._fuseConfirmationService=i,this._snackBar=a,this._suppliersService=c,this.store=u,this.isLoading=!1,this.suppliers$=(0,U.of)([]),this.searchInputControl=new n.NI(null),this.isSlideLoading=!1,this.selectedSlide=null,this.supplier=new Fr,this._unsubscribeAll=new w.x}ngOnInit(){this.store.select(_.B).pipe((0,g.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.suppliers$=this.store.select(G),this.searchInputControl.valueChanges.pipe((0,g.R)(this._unsubscribeAll),(0,h.x)(()=>{this.isLoading=!1}),(0,k.b)(300),(0,p.w)(t=>{if(null!==t)return this.isLoading=!0,this._suppliersService.getSuppliers(0,25,"name","desc",t)})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,g.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,D.T)(this._sort.sortChange,this._paginator.page).pipe((0,p.w)(()=>(this.isLoading=!0,this._suppliersService.getSuppliers(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,f.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}updateSupplierStatus(t,o,i){this.isSlideLoading=!0,this.selectedSlide=i,this._suppliersService.updatesSupplierStatus({id:o.id,active:t.checked}).subscribe(({data:a})=>{this._snackBar.openFromComponent(O.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.updateSupplierStatus.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.isSlideLoading=!1,this.selectedSlide=null,this._changeDetectorRef.markForCheck()})}deleteSupplier(t){this._fuseConfirmationService.open({title:"Eliminar proveedor",message:"\xbfEsta seguro que desea eliminar el proveedor?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._suppliersService.removeSupplier(t).pipe((0,g.R)(this._unsubscribeAll)).subscribe(({data:a})=>{this._snackBar.openFromComponent(O.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.removeSupplier.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}})}),this._changeDetectorRef.markForCheck()})}openDialog(t,o){this._dialog.open(Er,{data:{supplier:t,dialogMode:o},panelClass:"ath-dialog-panel",disableClose:!0})}trackByFn(t,o){return o.id||t}static#e=this.\u0275fac=function(o){return new(o||r)(e.Y36(e.sBO),e.Y36(oe.uw),e.Y36(te.R),e.Y36(E.ux),e.Y36(Y),e.Y36(V.yh))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["suppliers"]],viewQuery:function(o,i){if(1&o&&(e.Gf(P.NW,5),e.Gf(N.YE,5)),2&o){let a;e.iGM(a=e.CRH())&&(i._paginator=a.first),e.iGM(a=e.CRH())&&(i._sort=a.first)}},standalone:!0,features:[e.jDz],decls:26,vars:10,consts:[["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","flex-wrap","items-center","w-full","gap-2","mt-6","md:fixed","right-8","shrink-0","lg:mt-0","lg:ml-4","lg:w-auto","sm:w-1/2"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto"],[1,"z-10","flex","flex-col","flex-auto","bg-white","dark:bg-default"],["class","relative grid"],[1,"relative","grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","supplier-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"flex","justify-start",3,"mat-sort-header"],[1,"text-center"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"mr-7","text-end"],[1,"border-b","first-letter:z-10","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-gray-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","border-b","supplier-grid","md:px-8"],[1,"truncate"],[1,"flex","justify-center"],[3,"checked","color"],[3,"diameter","color"],[1,"flex","flex-row","justify-end","gap-3","mr-2"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[3,"checked","color","change"],["class","z-0 grid items-center gap-4 px-6 py-3 border-b supplier-grid md:px-8"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(o,i){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Proveedores"),e.qZA()()(),e.TgZ(11,"div",8)(12,"h2",9),e._uU(13," Proveedores "),e.qZA()()(),e.TgZ(14,"div",10)(15,"mat-form-field",11),e._UZ(16,"mat-icon",12)(17,"input",13),e.qZA(),e.TgZ(18,"button",14),e.NdJ("click",function(){return i.openDialog(i.supplier,"add")}),e._UZ(19,"mat-icon",15),e.TgZ(20,"span",16),e._uU(21,"Agregar"),e.qZA()()()(),e.TgZ(22,"div",17)(23,"div",18),e.YNc(24,Lr,2,1),e.ALo(25,"async"),e.qZA()()()),2&o){let a;e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(7),e.Q6J("subscriptSizing","dynamic"),e.xp6(),e.Q6J("svgIcon","mat_solid:search"),e.xp6(),e.Q6J("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Buscar proveedores"),e.xp6(2),e.Q6J("svgIcon","mat_solid:add"),e.xp6(5),e.um2(24,(a=e.lcZ(25,8,i.suppliers$))?24:-1,a)}},dependencies:[m.Ov,n.u5,n.Fj,n.JJ,I.ot,I.lW,F.lN,F.KE,F.qo,A.Ps,A.Hw,y.c,y.Nt,P.TU,P.NW,R.Cq,R.Ou,M.rP,M.Rr,N.JX,N.YE,N.nU,m.mk,n.UX,n.oH,v.rH,se.H],encapsulation:2,data:{animation:Tr.L},changeDetection:0})}return r})();var Vr=s(53308),Gr=s(21189),jr=s(9427),fe=s(6514),_e=s(24554),Hr=s(85194),Kr=s(8382);const Wr=[{path:"suppliers",component:zr,resolve:{suppliers:(r,l)=>(0,e.f3M)(Y).getSuppliers()}},{path:"purchases",component:T,children:[{path:"list",component:He,resolve:{vouchers:_e.p,paymentMethods:fe.u,purchases:Gr.qT}},{path:"form",component:Zr,resolve:{currencies:jr.t,paymentMethods:fe.u,products:Vr.Tx,suppliers:(r,l)=>(0,e.f3M)(Y).findActiveSuppliers(),vouchers:_e.p,uoms:Hr.y,depots:Kr._u}},{path:"details",component:Ke}]}]}}]);