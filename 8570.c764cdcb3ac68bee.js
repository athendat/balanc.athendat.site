"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[8570],{23301:(Nt,tt,l)=>{l.d(tt,{I:()=>c,p:()=>H});var E=l(17705),t=l(92581);const H=(y,P)=>(0,E.WQX)(t.v).getCurrencies(),c=(y,P)=>(0,E.WQX)(t.v).getActiveCurrency()},91401:(Nt,tt,l)=>{l.d(tt,{y$:()=>c});var E=l(59640);const t=y=>y.currencies,c=((0,E.Mz)(t,y=>y.currency),(0,E.Mz)(t,y=>y.currencies))},92581:(Nt,tt,l)=>{l.d(tt,{v:()=>S});var E=l(17705),t=l(96697),H=l(25558),c=l(88141),y=l(53473),P=l(59640),at=l(98216),h=l(54588),x=l(91401);const T=y.J1`
    mutation CreateCurrency($createCurrencyInput: CreateCurrencyInput!) {
        createCurrency(createCurrencyInput: $createCurrencyInput) {

            ok
            message

            currency {
                id
                active
                name
                iso
                symbol
            }

        }
    }
`,q=y.J1`
mutation UpdateCurrency($updateCurrencyInput: UpdateCurrencyInput!) {
    updateCurrency(updateCurrencyInput: $updateCurrencyInput) {
        ok
        message

        currency {
            id
            active
            name
            iso
            symbol
        }
    }
}
`,nt=y.J1`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateCurrencyStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }
    }
`,et=y.J1`
mutation RemoveCurrency($removeCurrencyId: String!) {
    removeCurrency(id: $removeCurrencyId) {
        ok,
        message
    }
}
`,ct=y.J1`
    query FindAllCurrencies($offset: Int, $limit: Int, $sort: String, $order: Order, $search: String) {
        findAllCurrencies(offset: $offset, limit: $limit, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            currencies {
                id
                active
                name
                iso
                symbol
            }
        }
    }
`,rt=y.J1`
    query FindAllActiveCurrencies {
        findAllActiveCurrencies {
            ok
            message

            currencies {
                id
                name
                iso
            }
        }
    }
`,X=y.J1`
    query FindCurrencyById($findCurrencyByIdId: String!) {
        findCurrencyById(id: $findCurrencyByIdId) {
            ok
            message

            currency {
                id
                active
                name
                iso
                symbol
            }
        }
    }
`;let S=(()=>{class R{constructor(){this.apolloProvider=(0,E.WQX)(y.Ic),this.store=(0,E.WQX)(P.il),this._apollo=this.apolloProvider.use("BALANC")}createCurrency(_){return this.store.select(x.y$).pipe((0,t.s)(1),(0,H.n)(F=>this._apollo.mutate({mutation:T,variables:{createCurrencyInput:_},errorPolicy:"all"}).pipe((0,c.M)(({data:f})=>{const g=structuredClone(F);g.push(f.createCurrency.currency),this.store.dispatch((0,h.Ih)({currencies:g}))}))))}getCurrencies(_=1,F=20,f="name",g="asc",A=""){return this._apollo.query({query:ct,variables:{offset:F*(_-1),limit:F,sort:f,order:g,search:A},errorPolicy:"all"}).pipe((0,c.M)(({data:k})=>{this.store.dispatch((0,at.Bp)({pagination:k.findAllCurrencies.pagination})),this.store.dispatch((0,h.Ih)({currencies:k.findAllCurrencies.currencies}))}))}getActiveCurrency(){return this._apollo.query({query:rt,errorPolicy:"all"}).pipe((0,c.M)(({data:_})=>{_&&this.store.dispatch((0,h.Ih)({currencies:_.findAllActiveCurrencies.currencies}))}))}getCurrencyById(_){return this._apollo.query({query:X,variables:{findCurrencyByIdId:_},errorPolicy:"all"}).pipe((0,c.M)(({data:F})=>{this.store.dispatch((0,h.MN)({currency:F.findCurrencyById.currency}))}))}updateCurrency(_){return this.store.select(x.y$).pipe((0,t.s)(1),(0,H.n)(F=>this._apollo.mutate({mutation:q,variables:{updateCurrencyInput:_},errorPolicy:"all"}).pipe((0,c.M)(({data:f})=>{const g=structuredClone(F);g[F.findIndex(k=>k.id===_.id)]=f.updateCurrency.currency,this.store.dispatch((0,h.Ih)({currencies:g}))}))))}updateCurrencyStatus(_){return this.store.select(x.y$).pipe((0,t.s)(1),(0,H.n)(F=>this._apollo.mutate({mutation:nt,variables:{updateEntityStatusInput:_},errorPolicy:"all"}).pipe((0,c.M)(({})=>{const g=structuredClone(F);g[F.findIndex(k=>k.id===_.id)].active=_.active,this.store.dispatch((0,h.Ih)({currencies:g}))}))))}removeCurrency(_){return this.store.select(x.y$).pipe((0,t.s)(1),(0,H.n)(F=>this._apollo.mutate({mutation:et,variables:{removeCurrencyId:_},errorPolicy:"all"}).pipe((0,c.M)(({})=>{const g=structuredClone(F),A=F.findIndex(k=>k.id===_);g.splice(A,1),this.store.dispatch((0,h.Ih)({currencies:g}))}))))}static#t=this.\u0275fac=function(F){return new(F||R)};static#i=this.\u0275prov=E.jDH({token:R,factory:R.\u0275fac,providedIn:"root"})}return R})()},28570:(Nt,tt,l)=>{l.r(tt),l.d(tt,{default:()=>ts});var E=l(51188),t=l(17705);let H=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#i=this.\u0275cmp=t.VBU({type:i,selectors:[["production"]],standalone:!0,features:[t.aNF],decls:1,vars:0,template:function(o,r){1&o&&t.nrm(0,"router-outlet")},dependencies:[E.n3],encapsulation:2,changeDetection:0})}return i})();var c=l(89417),y=l(67336),P=l(88834),at=l(82765),h=l(53719),x=l(99213),T=l(59042),q=l(96695),nt=l(9183),et=l(86600),ct=l(82798),rt=l(30450),X=l(95416),S=l(2042),R=l(60177),Q=l(60850),_=l(75351),F=l(7673),f=l(21413),g=l(56977),A=l(99172),k=l(96354),dt=l(70152),it=l(59640),We=l(91401),Gt=l(13189),ot=l(46601),I=l(94794),Ht=l(98049),v=l(53473),D=l(88141);const Je=v.J1`
    mutation CreateProductionDataSheet($createProductionDataSheetInput: CreateProductionDataSheetInput!) {
        createProductionDataSheet(createProductionDataSheetInput: $createProductionDataSheetInput) {

            ok
            message

            productionDataSheet {
                active
                productId
                allergens
                cookingTime
                totalCost
                tax
                margin
                portions
                portionCost
                portionSize
                currency {
                    iso
                    name
                }
                currencyId
                categoryId
                category {
                    name
                }
                description
                elaboration
                equipments
                id
                images
                ingredients {
                    quantity
                    cost
                    productId
                    product {
                        name
                        cost
                    }
                    uomId
                    uom {
                        abbr
                        name
                        type
                    }
                }
                merchant {
                    name
                }
                merchantId
                name
                portionSize
                preparationTime
                presentation
                price
                producedQuantity
                slug
                temperature
                thumbnail
                uom {
                    abbr
                    name
                }
                uomId
            }

        }
    }
`,He=v.J1`
    mutation UpdateProductionDataSheet($updateProductionDataSheetInput: UpdateProductionDataSheetInput!) {
        updateProductionDataSheet(updateProductionDataSheetInput: $updateProductionDataSheetInput) {
            ok
            message

            productionDataSheet {
                active
                productId
                allergens
                cookingTime
                totalCost
                tax
                margin
                portions
                portionCost
                portionSize
                currency {
                    iso
                    name
                }
                currencyId
                categoryId
                category {
                    name
                }
                description
                elaboration
                equipments
                id
                images
                ingredients {
                    quantity
                    cost
                    productId
                    product {
                        name
                        cost
                    }
                    uomId
                    uom {
                        abbr
                        name
                        type
                    }
                }
                merchant {
                    name
                }
                merchantId
                name
                portionSize
                preparationTime
                presentation
                price
                producedQuantity
                slug
                temperature
                thumbnail
                uom {
                    abbr
                    name
                }
                uomId
            }
        }
    }
`,Ze=v.J1`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateProductionDataSheetStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }

    }
`,Ke=v.J1`
    mutation RemoveProductionDataSheet($productionDataSheetId: String!) {
        removeProductionDataSheet(id: $productionDataSheetId) {
            ok
            message
        }
    }
`,ti=v.J1`
    mutation LinkProductToProductionDataSheet($productionDataSheetId: String!, $productId: String!) {
        linkProductToProductionDataSheet(id: $productionDataSheetId, productId: $productId) {
            ok
            message
        }
    }
`,ei=v.J1`
    query FindAllProductionDataSheets($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllProductionDataSheets(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            productionDataSheets {
                active
                productId
                allergens
                cookingTime
                totalCost
                tax
                margin
                portions
                portionCost
                portionSize
                currency {
                    iso
                    name
                }
                currencyId
                categoryId
                category {
                    name
                }
                description
                elaboration
                equipments
                id
                images
                ingredients {
                    quantity
                    cost
                    productId
                    product {
                        name
                        cost
                    }
                    uomId
                    uom {
                        abbr
                        name
                        type
                    }
                }
                merchant {
                    name
                }
                merchantId
                name
                portionSize
                preparationTime
                presentation
                price
                producedQuantity
                slug
                temperature
                thumbnail
                uom {
                    abbr
                    name
                }
                uomId
            }
        }
    }
`,ii=v.J1`
    query FindAllProductionDataSheetsActive {
        findAllProductionDataSheetsActive {
            ok
            message

            productionDataSheets {
                id
                name
                price
            }
        }
    }
`,oi=v.J1`
    query FindProductionDataSheetById($productionDataSheetId: String!) {
        findProductionDataSheetById(id: $productionDataSheetId) {
            ok
            message

            productionDataSheet {
                active
                productId
                allergens
                cookingTime
                totalCost
                tax
                margin
                portions
                portionCost
                portionSize
                currency {
                    iso
                    name
                }
                currencyId
                categoryId
                category {
                    name
                }
                description
                elaboration
                equipments
                id
                images
                ingredients {
                    quantity
                    cost
                    productId
                    product {
                        name
                        cost
                    }
                    uomId
                    uom {
                        abbr
                        name
                        type
                    }
                }
                merchant {
                    name
                }
                merchantId
                name
                portionSize
                preparationTime
                presentation
                price
                producedQuantity
                slug
                temperature
                thumbnail
                uom {
                    abbr
                    name
                }
                uomId
            }
        }
    }
`;var Ct=l(45312),ni=l(13488);const Lt=new WeakMap,$=Symbol("STATE_SOURCE");function G(i,...n){i[$].update(e=>n.reduce((o,r)=>({...o,..."function"==typeof r?r(o):r}),e)),function si(i){const n=function Mt(i){return Lt.get(i[$][ni.bh])||[]}(i);for(const e of n)e((0,t.O8t)(()=>Zt(i)))}(i)}function Zt(i){return i[$]()}function At(i){const n=(0,t.O8t)(()=>i());return function di(i){return i?.constructor===Object}(n)?new Proxy(i,{get:(e,o)=>o in n?((0,t.Hps)(e[o])||Object.defineProperty(e,o,{value:(0,t.EWP)(()=>e()[o]),configurable:!0}),At(e[o])):e[o]}):i}function pt(...i){const n=[...i],e="function"==typeof n[0]?{}:n.shift(),o=n;return(()=>{class s{constructor(){const d=o.reduce((V,M)=>M(V),function li(){return{[$]:(0,t.vPA)({}),stateSignals:{},computedSignals:{},methods:{},hooks:{}}}()),{stateSignals:u,computedSignals:m,methods:p,hooks:b}=d,w={...u,...m,...p};this[$]=!1===e.protectedState?d[$]:d[$].asReadonly();for(const V in w)this[V]=w[V];const{onInit:Y,onDestroy:J}=b;Y&&Y(),J&&(0,t.WQX)(t.abz).onDestroy(J)}static \u0275fac=function(u){return new(u||s)};static \u0275prov=t.jDH({token:s,factory:s.\u0275fac,providedIn:e.providedIn||null})}return s})()}function Kt(i){return n=>{const e=i({...n.stateSignals,...n.computedSignals});return Object.keys(e),{...n,computedSignals:{...n.computedSignals,...e}}}}function ht(i){return n=>{const e=i({[$]:n[$],...n.stateSignals,...n.computedSignals,...n.methods});return Object.keys(e),{...n,methods:{...n.methods,...e}}}}function gt(i){return n=>{const e="function"==typeof i?i():i,o=Object.keys(e);n[$].update(s=>({...s,...e}));const r=o.reduce((s,a)=>{const d=(0,t.EWP)(()=>n[$]()[a]);return{...s,[a]:At(d)}},{});return{...n,stateSignals:{...n.stateSignals,...r}}}}const Rt=pt({providedIn:"root",protectedState:!1},gt({pagination:null,productionDataSheet:null,productionDataSheets:[]}),ht(i=>({setProductionDataSheetsList(n,e){G(i,{productionDataSheets:n,pagination:e})},setProductionDataSheets(n){G(i,{productionDataSheets:n})},setProductionDataSheet(n){G(i,{productionDataSheet:n})}})));let lt=(()=>{class i{#t;#i=(0,t.WQX)(v.Ic);#e=(0,t.WQX)(Rt);constructor(){this.#t=this.#i.use(Ct.c.GRAPHQL_PROVIDER)}createProductionDataSheet(e){return this.#t.mutate({mutation:Je,variables:{createProductionDataSheetInput:e},errorPolicy:"all"}).pipe((0,D.M)(({data:o})=>{const r=structuredClone(this.#e.productionDataSheets());r.push(o.createProductionDataSheet.productionDataSheet),this.#e.setProductionDataSheets(r)}))}findAllProductionDataSheets(e=0,o=20,r="name",s="asc",a=""){return this.#t.query({query:ei,errorPolicy:"all",variables:{page:e,size:o,sort:r,order:s,search:a}}).pipe((0,D.M)(({data:d})=>{this.#e.setProductionDataSheetsList(d.findAllProductionDataSheets.productionDataSheets,d.findAllProductionDataSheets.pagination)}))}findActiveProductionDataSheets(){return this.#t.query({query:ii,errorPolicy:"all"}).pipe((0,D.M)(({data:e})=>{this.#e.setProductionDataSheets(e.findAllProductionDataSheetsActive.productionDataSheets)}))}findProductionDataSheetById(e){return this.#t.query({query:oi,variables:{productionDataSheetId:e},errorPolicy:"all"}).pipe((0,D.M)(({data:o})=>{this.#e.setProductionDataSheet(o.findProductionDataSheetById.productionDataSheet)}))}updateProductionDataSheet(e){return this.#t.mutate({mutation:He,variables:{updateProductionDataSheetInput:e},errorPolicy:"all"}).pipe((0,D.M)(({data:o})=>{const r=structuredClone(this.#e.productionDataSheets()),s=r.findIndex(a=>a.id===e.id);r[s]=o.updateProductionDataSheet.productionDataSheet,this.#e.setProductionDataSheets(r)}))}updateProductionDataSheetStatus(e){return this.#t.mutate({mutation:Ze,variables:{updateEntityStatusInput:e},errorPolicy:"all"}).pipe((0,D.M)(()=>{const o=structuredClone(this.#e.productionDataSheets()),r=o.findIndex(a=>a.id===e.id),s=o[r];s.active=e.active,o[r]=s,this.#e.setProductionDataSheets(o)}))}linkProductToProductionDataSheet(e,o){return this.#t.mutate({mutation:ti,variables:{productionDataSheetId:e,productId:o},errorPolicy:"all"}).pipe((0,D.M)(()=>{const r=structuredClone(this.#e.productionDataSheets()),s=r.findIndex(d=>d.id===e),a=r[s];a.productId=o,r[s]=a,this.#e.setProductionDataSheets(r)}))}removeProductionDataSheet(e){return this.#t.mutate({mutation:Ke,variables:{productionDataSheetId:e},errorPolicy:"all"}).pipe((0,D.M)(()=>{const o=structuredClone(this.#e.productionDataSheets()),r=o.findIndex(s=>s.id===e);o.splice(r,1),this.#e.setProductionDataSheets(o)}))}static#o=this.\u0275fac=function(o){return new(o||i)};static#n=this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var te=l(36296);const ui=[{name:"Altramuces",checked:!1},{name:"Apio",checked:!1},{name:"Cacahuetes",checked:!1},{name:"Crust\xe1ceos",checked:!1},{name:"Frutos de secos",checked:!1},{name:"Gluten",checked:!1},{name:"Huevos",checked:!1},{name:"L\xe1cteos",checked:!1},{name:"Moluscos",checked:!1},{name:"Mostaza",checked:!1},{name:"Pescado",checked:!1},{name:"S\xe9samo",checked:!1},{name:"Soja",checked:!1},{name:"Sulfitos",checked:!1}],mi=[{id:"d1fdf6c2-bbfc-4135-9106-c1fe3a63c119",active:!0,name:"Gramo",abbr:"g",type:"peso"},{id:"a357b446-8ce7-4389-b960-b8cc40179bd1",active:!0,name:"Mililitro",abbr:"ml",type:"volumen"}];var pi=l(5864),Bt=l(73779),ee=l(64193),xt=l(65478);const hi=(i,n)=>n.id,gi=()=>({suppressScrollY:!0}),ie=i=>({"cursor-not-allowed":i});function fi(i,n){if(1&i){const e=t.RV6();t.j41(0,"button",61),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.createProductionDataSheet())}),t.nrm(1,"mat-icon",62),t.j41(2,"span",63),t.EFF(3,"Guardar"),t.k0s()()}if(2&i){const e=t.XpG();t.Y8G("disabled",e.productionDataSheetForm.invalid)("ngClass",t.eq3(3,ie,e.productionDataSheetForm.invalid)),t.R7$(),t.Y8G("svgIcon","mat_solid:save")}}function _i(i,n){if(1&i){const e=t.RV6();t.j41(0,"button",61),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.updateProductionDataSheet())}),t.nrm(1,"mat-icon",62),t.j41(2,"span",63),t.EFF(3,"Actualizar"),t.k0s()()}if(2&i){const e=t.XpG();t.Y8G("disabled",e.productionDataSheetForm.invalid)("ngClass",t.eq3(3,ie,e.productionDataSheetForm.invalid)),t.R7$(),t.Y8G("svgIcon","mat_solid:refresh")}}function vi(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El nombre del producto es obligatorio. "),t.k0s())}function bi(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El nombre del producto debe contener entre 3 y 255 caracteres. "),t.k0s())}function Pi(i,n){if(1&i&&(t.j41(0,"mat-option",35),t.EFF(1),t.k0s()),2&i){const e=n.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function Di(i,n){if(1&i&&(t.j41(0,"mat-optgroup",64),t.Z7z(1,Pi,2,2,"mat-option",35,t.fX1),t.k0s()),2&i){const e=t.XpG().$implicit;t.Y8G("label",e.name)("disabled",!e.active),t.R7$(),t.Dyx(e.children)}}function Ci(i,n){if(1&i&&(t.j41(0,"mat-option",35),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function Ri(i,n){if(1&i&&t.DNE(0,Di,3,2,"mat-optgroup",64)(1,Ci,2,2,"mat-option",35),2&i){const e=n.$implicit;t.vxM(e.children.length>0?0:-1),t.R7$(),t.vxM(0===e.children.length?1:-1)}}function xi(i,n){if(1&i){const e=t.RV6();t.j41(0,"mat-icon",65),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.resetCategoryField())}),t.k0s()}}function Si(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," Debe seleccionar una categor\xeda. "),t.k0s())}function Ei(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El valor m\xednimo del tiempo de preparaci\xf3n del producto debe ser 0. "),t.k0s())}function yi(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El valor m\xednimo del tiempo de preparaci\xf3n del producto debe ser 999999999. "),t.k0s())}function Fi(i,n){if(1&i&&(t.j41(0,"mat-option",35),t.EFF(1),t.k0s()),2&i){const e=n.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.iso," ")}}function Ii(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," Debe seleccionar una Moneda. "),t.k0s())}function ki(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El margen es obligatorio. "),t.k0s())}function wi(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El valor m\xednimo del margen debe ser 0. "),t.k0s())}function Ti(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El valor m\xednimo del margen debe ser 999999999. "),t.k0s())}function $i(i,n){if(1&i&&(t.j41(0,"mat-option",35),t.EFF(1),t.k0s()),2&i){const e=n.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.abbr," ")}}function Oi(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El valor m\xednimo del tama\xf1o de la porci\xf3n del producto debe ser 0. "),t.k0s())}function ji(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El valor m\xednimo del tama\xf1o de la porci\xf3n del producto debe ser 999999999. "),t.k0s())}function qi(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El valor m\xednimo del tiempo de cocci\xf3n del producto debe ser 0. "),t.k0s())}function Ni(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El valor m\xednimo del tiempo de cocci\xf3n del producto debe ser 999999999. "),t.k0s())}function Gi(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El impuesto es obligatorio. "),t.k0s())}function Li(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El valor m\xednimo del impuesto debe ser 0. "),t.k0s())}function Mi(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El valor m\xednimo del impuesto debe ser 999999999. "),t.k0s())}function Ai(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El valor m\xednimo de la cantidad de porciones debe ser 1. "),t.k0s())}function Bi(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El valor m\xe1ximo del tama\xf1o de la porci\xf3n del producto debe ser 999999999. "),t.k0s())}function Yi(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El valor m\xednimo del temperatura del producto debe ser 0. "),t.k0s())}function zi(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El valor m\xednimo del temperatura del producto debe ser 999999999. "),t.k0s())}function Vi(i,n){if(1&i){const e=t.RV6();t.j41(0,"mat-option",66),t.bIt("click",function(r){const s=t.eBV(e).$implicit;return t.XpG().addOrRemoveIngredient(s),t.Njj(r.stopPropagation())}),t.j41(1,"div",67),t.bIt("click",function(r){const s=t.eBV(e).$implicit;return t.XpG().addOrRemoveIngredient(s),t.Njj(r.stopPropagation())}),t.j41(2,"span",68),t.nrm(3,"mat-checkbox",69),t.EFF(4),t.k0s(),t.j41(5,"span",70),t.EFF(6),t.nI1(7,"number"),t.k0s()()()}if(2&i){const e=n.$implicit;t.Y8G("value",e),t.R7$(3),t.Y8G("checked",e.checked),t.R7$(),t.SpI(" ",e.name," "),t.R7$(2),t.Lme("",t.i5U(7,5,e.stock,"1.2-2")," ",e.uom.abbr,"")}}function Xi(i,n){if(1&i){const e=t.RV6();t.j41(0,"div",74)(1,"div",75)(2,"div"),t.EFF(3),t.k0s(),t.j41(4,"div",76),t.EFF(5),t.k0s(),t.j41(6,"mat-form-field",77)(7,"span",78),t.EFF(8),t.k0s(),t.nrm(9,"input",79),t.k0s(),t.j41(10,"div",80),t.EFF(11),t.k0s(),t.j41(12,"div",80),t.EFF(13),t.nI1(14,"number"),t.k0s(),t.j41(15,"div",81)(16,"button",82),t.bIt("click",function(){const r=t.eBV(e).$index,s=t.XpG(2);return t.Njj(s.removeIngredient(r))}),t.nrm(17,"mat-icon",83),t.k0s()()()()}if(2&i){const e=n.$implicit,o=n.$index,r=t.XpG(2);t.R7$(),t.Y8G("formGroupName",o),t.R7$(2),t.JRh(o+1),t.R7$(2),t.SpI("",r.getProductName(e.get("productId").value)," "),t.R7$(),t.Y8G("subscriptSizing","dynamic"),t.R7$(2),t.SpI(" ",r.getUnit(e.get("productId").value),""),t.R7$(),t.Y8G("min",1)("formControl",e.get("quantity")),t.R7$(2),t.SpI(" ",r.getCost(e.get("productId").value)," "),t.R7$(2),t.SpI(" ",t.i5U(14,10,r.getCost(e.get("productId").value)*e.get("quantity").value,"1.2-2")," "),t.R7$(4),t.Y8G("svgIcon","mat_solid:close")}}function Qi(i,n){if(1&i&&(t.j41(0,"div",55)(1,"div",71),t.nrm(2,"div"),t.j41(3,"div",72),t.EFF(4," Ingrediente "),t.k0s(),t.j41(5,"div",73),t.EFF(6," Cantidad "),t.k0s(),t.j41(7,"div",73),t.EFF(8," Costo Unitario "),t.k0s(),t.j41(9,"div",73),t.EFF(10," Costo Total "),t.k0s(),t.j41(11,"div",73),t.EFF(12," Quitar "),t.k0s()(),t.Z7z(13,Xi,18,13,"div",74,t.fX1),t.k0s()),2&i){const e=t.XpG();t.R7$(13),t.Dyx(e.productionDataSheetForm.get("ingredients").controls)}}function Ui(i,n){if(1&i){const e=t.RV6();t.j41(0,"div")(1,"input",89,6),t.bIt("change",function(r){t.eBV(e);const s=t.XpG(2);return t.Njj(s.selectFiles(r,"thumbnail"))}),t.k0s(),t.j41(3,"label",90),t.nrm(4,"mat-icon",91),t.k0s()()}2&i&&(t.R7$(),t.Y8G("multiple",!1)("accept","image/png, image/webp, image/jpeg, image/png"),t.R7$(3),t.Y8G("svgIcon","mat_solid:photo_camera"))}function Wi(i,n){if(1&i){const e=t.RV6();t.j41(0,"div")(1,"button",92),t.bIt("click",function(){t.eBV(e);const r=t.XpG(2);return t.Njj(r.removeImage("thumbnail"))}),t.nrm(2,"mat-icon",91),t.k0s()()}2&i&&(t.R7$(2),t.Y8G("svgIcon","mat_solid:delete"))}function Ji(i,n){if(1&i&&t.nrm(0,"img",88),2&i){const e=t.XpG(2);t.Y8G("src",e.productionDataSheetForm.get("thumbnail").value,t.B4B)}}function Hi(i,n){if(1&i&&(t.j41(0,"div",23),t.EFF(1," Imagen "),t.k0s(),t.j41(2,"div",84)(3,"div",85),t.nrm(4,"div",86),t.j41(5,"div",87),t.DNE(6,Ui,5,3,"div")(7,Wi,3,1,"div"),t.k0s(),t.DNE(8,Ji,1,1,"img",88),t.k0s()()),2&i){const e=t.XpG();t.R7$(6),t.vxM(e.productionDataSheetForm.get("thumbnail").value?-1:6),t.R7$(),t.vxM(e.productionDataSheetForm.get("thumbnail").value?7:-1),t.R7$(),t.vxM(e.productionDataSheetForm.get("thumbnail").value?8:-1)}}function Zi(i,n){if(1&i){const e=t.RV6();t.j41(0,"mat-checkbox",93),t.bIt("change",function(){const r=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.toggleProductionDataSheetAllergen(r.name))}),t.EFF(1),t.k0s()}if(2&i){const e=n.$implicit,o=t.XpG();t.Y8G("color","primary")("checked",o.allergens.includes(e.name)),t.R7$(),t.SpI(" ",e.name," ")}}let Ki=(()=>{class i{constructor(){this.addOnBlur=!0,this.allergensList=ui,this.allergens=[],this.currencies=[],this.editMode=!1,this.flashMessage=null,this.images=[],this.isLoading=!1,this.products=[],this.categories=[],this.ingredients=[],this.filteredProducts=[],this.searchProductControl=new c.MJ(null),this.selectedProductionDataSheet=null,this.separatorKeysCodes=[y.Fm,y.KE],this.thumbnail="",this.uoms=mi,this.productionDataSheetsStore=(0,t.WQX)(Rt),this.productionDataSheetId=t.hFB.required(),this.categoriesFiltered$=(0,F.of)([]),this.#t=new f.B,this.#i=(0,t.WQX)(t.gRc),this.#e=(0,t.WQX)(_.bZ),this.#o=(0,t.WQX)(c.ok),this.#n=(0,t.WQX)(ot.G),this.#r=(0,t.WQX)(Ht.M),this.#s=(0,t.WQX)(te.g),this.#a=(0,t.WQX)(lt),this.#c=(0,t.WQX)(E.Ix),this.#d=(0,t.WQX)(X.UG),this.#l=(0,t.WQX)(it.il),this.#u=(e,o)=>{const r=o.toLowerCase();return e?e.filter(s=>s.name.toLowerCase().trim().includes(r)):[]}}#t;#i;#e;#o;#n;#r;#s;#a;#c;#d;#l;ngOnInit(){if(this.productionDataSheetForm=this.#o.group({id:new c.MJ(""),name:new c.MJ(null,[c.k0.required,c.k0.minLength(3),c.k0.maxLength(255)]),currencyId:new c.MJ(null,[c.k0.required]),uomId:new c.MJ("d1fdf6c2-bbfc-4135-9106-c1fe3a63c119",[c.k0.required]),thumbnail:new c.MJ(""),totalCost:new c.MJ({value:0,disabled:!0},[c.k0.required,c.k0.min(0),c.k0.max(999999999),c.k0.maxLength(9)]),portionCost:new c.MJ({value:0,disabled:!0},[c.k0.required,c.k0.min(0),c.k0.max(999999999),c.k0.maxLength(9)]),margin:new c.MJ(30,[c.k0.required,c.k0.min(0),c.k0.max(999999999),c.k0.maxLength(9)]),tax:new c.MJ(10,[c.k0.required,c.k0.min(0),c.k0.max(999999999),c.k0.maxLength(9)]),price:new c.MJ({value:0,disabled:!0},[c.k0.required,c.k0.min(0),c.k0.max(999999999),c.k0.maxLength(9)]),portionSize:new c.MJ(null,[c.k0.min(0),c.k0.max(999999999),c.k0.maxLength(9)]),portions:new c.MJ(1,[c.k0.min(1),c.k0.max(999999999),c.k0.maxLength(9)]),preparationTime:new c.MJ(null,[c.k0.min(0),c.k0.max(999999999),c.k0.maxLength(9)]),temperature:new c.MJ(null,[c.k0.min(0),c.k0.max(9999),c.k0.maxLength(4)]),cookingTime:new c.MJ(null,[c.k0.min(0),c.k0.max(9999),c.k0.maxLength(4)]),allergens:new c.Yp([]),categoryId:new c.MJ("",[c.k0.required]),description:new c.MJ("",[c.k0.maxLength(1e4)]),elaboration:new c.MJ("",[c.k0.maxLength(1e4)]),presentation:new c.MJ("",[c.k0.maxLength(1e4)]),equipments:new c.MJ("",[c.k0.maxLength(1e4)]),images:new c.MJ([]),ingredients:new c.Yp([],[c.k0.required])}),this.productionDataSheetForm.get("ingredients").valueChanges.pipe((0,g.Q)(this.#t)).subscribe(()=>{const e=this.productionDataSheetForm.get("ingredients");this.calculateCosts(e),this.#i.markForCheck()}),this.productionDataSheetForm.get("portions").valueChanges.pipe((0,g.Q)(this.#t)).subscribe(()=>{const e=this.productionDataSheetForm.get("ingredients");0!==e.length&&(this.calculateCosts(e),this.#i.markForCheck())}),this.productionDataSheetForm.get("margin").valueChanges.pipe((0,g.Q)(this.#t)).subscribe(()=>{const e=this.productionDataSheetForm.get("ingredients");0!==e.length&&(this.calculateCosts(e),this.#i.markForCheck())}),this.productionDataSheetForm.get("tax").valueChanges.pipe((0,g.Q)(this.#t)).subscribe(()=>{const e=this.productionDataSheetForm.get("ingredients");0!==e.length&&(this.calculateCosts(e),this.#i.markForCheck())}),"new"!==this.productionDataSheetId()){this.editMode=!0;const e=this.productionDataSheetsStore.productionDataSheet();this.productionDataSheetForm.patchValue(e),this.images=e.images,this.selectedProductionDataSheet=e,this.productionDataSheetForm.setControl("ingredients",this.#o.array(e.ingredients.map(o=>this.#o.group(o))))}this.categoriesFiltered$=this.#l.select(Bt.J),this.#l.select(Bt.J).pipe((0,g.Q)(this.#t)).subscribe(e=>{this.categories=e,this.#i.markForCheck()}),this.categoriesFiltered$=this.productionDataSheetForm.get("categoryId").valueChanges.pipe((0,A.Z)(""),(0,k.T)(e=>this.#m(e||""))),this.#l.select(We.y$).pipe((0,g.Q)(this.#t)).subscribe(e=>{this.currencies=e;const o=e.find(r=>"CUP"===r.iso).id;this.productionDataSheetForm.get("currencyId").value||this.productionDataSheetForm.get("currencyId").setValue(o),this.#i.markForCheck()}),this.#l.select(Gt.VW).pipe((0,g.Q)(this.#t)).subscribe(e=>{this.products=e,this.products=this.products.map(o=>({...o,checked:!1})),this.filteredProducts=this.products,this.#i.markForCheck()}),this.searchProductControl.valueChanges.pipe((0,g.Q)(this.#t),(0,dt.B)(200)).subscribe(e=>{""===e||null==e||(this.filteredProducts=this.products.filter(o=>o.name.toLowerCase().includes(e.toLowerCase())),this.#i.markForCheck())})}ngOnDestroy(){this.#t.next(null),this.#t.complete()}toggleProductionDataSheetAllergen(e){""!==e&&(this.allergens.includes(e)?this.allergens.splice(this.allergens.indexOf(e),1):this.allergens.push(e),this.#i.markForCheck())}addOrRemoveIngredient(e){const o=this.productionDataSheetForm.get("ingredients"),r=o.value.findIndex(s=>s.productId===e.id);-1===r?(o.push(this.#o.group({productId:e.id,uomId:this.getUnitId(e.id),quantity:new c.MJ(1,[c.k0.required,c.k0.min(1)]),cost:this.getCost(e.id)})),this.filteredProducts=this.filteredProducts.map(s=>s.id===e.id?{...s,checked:!0}:s)):(o.removeAt(r),this.filteredProducts=this.filteredProducts.map(s=>s.id===e.id?{...s,checked:!1}:s)),this.calculateCosts(o),this.#i.markForCheck()}removeIngredient(e){this.productionDataSheetForm.get("ingredients").removeAt(e)}calculateCosts(e){let o=0;e.controls.forEach(b=>{const w=b.get("quantity")?.value||0,Y=this.getCost(b.get("productId")?.value)||0;o+=w*Y}),o=parseFloat(o.toFixed(2)),this.productionDataSheetForm.get("totalCost").setValue(o);const r=this.productionDataSheetForm.get("portions").value||1,a=parseFloat((o/r).toFixed(2));this.productionDataSheetForm.get("portionCost").setValue(a);const d=this.productionDataSheetForm.get("margin").value||0,u=this.productionDataSheetForm.get("tax").value||0,p=parseFloat((a+a*d/100+a*u/100).toFixed(2));this.productionDataSheetForm.get("price").setValue(p)}getProductName(e){const o=this.products.find(r=>r.id===e);return o?o.name:""}getUomAbbr(e){const o=this.uoms.find(r=>r.id===e);return o?o.abbr:""}createProductionDataSheet(){const e=this.productionDataSheetForm.getRawValue();delete e.id,delete e.active,e.allergens=this.allergens,this.#n.open({title:"Crear producto ",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this.#a.createProductionDataSheet(e).pipe((0,g.Q)(this.#t)).subscribe(({data:s})=>{this.#d.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:s.createProductionDataSheet.message,type:"success",svgIcon:"mat_solid:done"}}),this.#c.navigateByUrl("/modules/production/data-sheets")}),this.#i.markForCheck()})}updateProductionDataSheet(){const e=this.productionDataSheetForm.getRawValue();e.ingredients=e.ingredients.map(r=>(delete r.product,delete r.uom,r)),e.allergens=this.allergens,this.#n.open({title:"Actualizar Producto",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this.#a.updateProductionDataSheet(e).pipe((0,g.Q)(this.#t)).subscribe(({data:s})=>{this.#d.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:s.updateProductionDataSheet.message,type:"success",svgIcon:"mat_solid:done"}}),this.#c.navigateByUrl("/modules/production/data-sheets")}),this.#i.markForCheck()})}selectFiles(e,o){if(0===e.target.files.length)return;const r=e.target.files[0];!this.#r.validMaxMBSize(r,2)||["image/jpeg","image/jpg","image/webp","image/png"].includes(r.type)}removeImage(e){this.#n.open({title:"Cuidado",message:"\xbfEst\xe1 seguro que desea eliminar esta imagen?",icon:{show:!0,name:"mat_solid:question_mark",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,g.Q)(this.#t)).subscribe(r=>{if("confirmed"===r){const s=this.productionDataSheetForm.get(e).value;switch(e){case"images":this.productionDataSheetForm.get(e).setValue([]);break;case"thumbnail":this.productionDataSheetForm.get(e).setValue(null)}const a=this.productionDataSheetForm.getRawValue();this.editMode&&this.#s.updateProductImages(a.id,a.thumbnail,a.images).subscribe(d=>{this.#d.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:d.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}})},d=>{this.productionDataSheetForm.get(e).setValue(s)}),this.#i.markForCheck()}})}displayFn(e){return e&&e.name?e.name:""}displayFnCategory(e){if(""===e)return;let o="";const r=this.categories.find(s=>s.id===e&&0===s.children.length);if(r)return r.name;for(const s of this.categories){const a=s.children.find(d=>d.id===e);if(a){o=a.name;break}}return o}resetCategoryField(){this.productionDataSheetForm.get("categoryId").reset(),this.categoriesFiltered$=this.#l.select(Bt.J)}getUnit(e){return"peso"===this.products.find(r=>r.id===e).uom.type?"g":"ml"}getUnitId(e){return"peso"===this.products.find(r=>r.id===e).uom.type?"d1fdf6c2-bbfc-4135-9106-c1fe3a63c119":"a357b446-8ce7-4389-b960-b8cc40179bd1"}getCost(e){const o=this.products.find(r=>r.id===e);return pi.H.convertCostToBaseUnit(o.cost,o.uom.abbr,o.uom.type)}#u;#m(e){return e?this.categories.map(o=>({id:o.id,active:o.active,name:o.name,children:this.#u(o.children,e)})).filter(o=>o.children.length>0||o.name.toLowerCase().trim().includes(e.toLocaleLowerCase())):this.categories}_uploadFile(e,o){this.#r.openCropperDialog(e,!0).pipe((0,g.Q)(this.#t)).subscribe(r=>{if(!r)return;this.productionDataSheetForm.get(o).setValue(r);const s=this.productionDataSheetForm.getRawValue();this.editMode&&this.#s.updateProductImages(s.id,s.thumbnail,s.images).subscribe(a=>{this.#d.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#i.markForCheck()},a=>{this.productionDataSheetForm.get(o).setValue(null)})})}_mapChecked(e){return e.pipe((0,k.T)(o=>o.map(r=>this.productionDataSheetForm.get("ingredients").getRawValue().some(a=>a.id===r.id)?{...structuredClone(r),checked:!0}:{...structuredClone(r),checked:!1})))}static#p=this.\u0275fac=function(o){return new(o||i)};static#h=this.\u0275cmp=t.VBU({type:i,selectors:[["production-data-sheet"]],inputs:{productionDataSheetId:[1,"productionDataSheetId"]},standalone:!0,features:[t.aNF],decls:177,vars:73,consts:[["categoriesGroup","matAutocomplete"],["descriptionLength",""],["elaborationLength",""],["presentationLength",""],["equipmentsLength",""],["productsAutocomplete","matAutocomplete"],["thumbnailFileInput",""],["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","gap-5","p-3","overflow-y-auto","bg-cover","sm:absolute","sm:inset-0","dark:bg-transparent"],[1,"z-20","flex","flex-col","bg-transparent","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:px-5"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/production/dashboard",1,"ml-1","text-primary-500"],["routerLink","/modules/production/data-sheets",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","items-center","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-600",3,"disabled","ngClass"],[1,"flex","flex-auto"],[1,"w-full",3,"formGroup","autocomplete"],[1,"grid","grid-cols-1","gap-3","sm:grid-cols-4"],[1,"flex","flex-col","gap-3","p-3","rounded-md","shadow-md","sm:col-span-3","bg-card"],[1,"text-xl","font-semibold"],[1,"grid","grid-cols-1","gap-3","mt-5","sm:grid-cols-2","lg:grid-cols-4"],[1,"w-full","sm:col-span-4","fuse-mat-dense"],["matInput","","type","text","minlength","3","maxlength","255","required","",3,"formControlName"],[1,"w-full","fuse-mat-dense"],["svgIcon","mat_solid:search","matPrefix",""],["type","text","matInput","","required","",3,"formControlName","matAutocomplete"],[3,"displayWith"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer"],["matPrefix","",1,"pr-1"],["matInput","","type","number","formControlName","preparationTime","min","0"],[3,"formControlName","required"],[3,"value"],["matInput","","type","number","formControlName","margin","min","0"],["matInput","","type","number","formControlName","portionSize","min","0"],["matSuffix","",3,"value","formControlName"],["matInput","","type","number","formControlName","cookingTime","min","0"],[1,"flex-col","w-full"],[1,"font-medium"],[1,"mt-4","text-lg","text-center"],["matInput","","type","number","formControlName","tax","min","0"],["matInput","","type","number","formControlName","portions","min","1","maxlength","9"],["matInput","","type","number","formControlName","temperature","min","0"],[1,"w-full","sm:col-span-4"],["matInput","","matTextareaAutoSize","","maxlength","10000",3,"formControlName","rows"],[1,"w-full","text-right"],["appearance","fill",1,"w-full","sm:col-span-4","fuse-mat-densee",3,"subscriptSizing"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete",3,"closed","displayWith"],[1,"w-full",3,"value"],["fuseScrollbar","",1,"flex","flex-col","flex-auto","pb-2","mt-2","sm:col-span-4","min-h-36",3,"fuseScrollbarOptions"],[1,"grid"],[1,"flex","flex-col","gap-3","p-3","rounded-md","shadow-md","bg-card"],[1,"flex","flex-col","mt-5"],[1,"mb-px","text-xl","font-semibold","leading-tight"],[1,"flex","flex-wrap","items-start","mt-1.5","rounded-md"],[1,"flex","items-center","h-10","min-h-8",3,"color","checked"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-600",3,"click","disabled","ngClass"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[3,"label","disabled"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer",3,"click"],[1,"w-full",3,"click","value"],[1,"grid","w-full","grid-cols-6",3,"click"],[1,"flex","flex-row","items-center","col-span-5","truncate","md:col-span-4"],["color","primary",3,"checked"],[1,"flex","items-center","text-center"],[1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","ingredients-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-primary","dark:bg-opacity-5"],[1,"text-left"],[1,"text-center"],["formArrayName","ingredients"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","ingredients-grid","md:px-8",3,"formGroupName"],[1,"truncate"],[1,"fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],["matTextSuffix","",1,"px-2"],["matInput","","type","number",1,"font-mono","font-semibold","text-center",3,"min","formControl"],[1,"text-lg","text-center"],[1,"flex","justify-center"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"flex","items-center","justify-center","flex-auto","max-h-40"],[1,"relative","flex","items-center","justify-center","w-32","h-32","overflow-hidden","rounded-md","ring-4","ring-bg-card"],[1,"absolute","inset-0","z-10","bg-opacity-50","bg-slate-300"],[1,"absolute","inset-0","z-20","flex","items-center","justify-center"],[1,"object-cover","w-full","h-full",3,"src"],["id","thumbnail-file-input","type","file",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"change","multiple","accept"],["for","thumbnail-file-input","matRipple","",1,"flex","items-center","justify-center","w-10","h-10","rounded-full","cursor-pointer","hover:bg-hover"],[1,"text-white",3,"svgIcon"],["mat-icon-button","",3,"click"],[1,"flex","items-center","h-10","min-h-8",3,"change","color","checked"]],template:function(o,r){if(1&o){const s=t.RV6();t.j41(0,"div",7)(1,"div",8)(2,"div",9)(3,"div")(4,"div",10)(5,"div")(6,"a",11),t.EFF(7,"Inicio"),t.k0s()(),t.j41(8,"div",12),t.nrm(9,"mat-icon",13),t.j41(10,"a",14),t.EFF(11,"Producci\xf3n"),t.k0s()(),t.j41(12,"div",12),t.nrm(13,"mat-icon",13),t.j41(14,"a",15),t.EFF(15,"Fichas T\xe9cnicas"),t.k0s()(),t.j41(16,"div",12),t.nrm(17,"mat-icon",13),t.j41(18,"a",16),t.EFF(19),t.k0s()()()()(),t.j41(20,"div",17),t.DNE(21,fi,4,5,"button",18)(22,_i,4,5,"button",18),t.k0s()(),t.j41(23,"div",19)(24,"form",20)(25,"div",21)(26,"div",22)(27,"div",23),t.EFF(28," Informaci\xf3n General "),t.k0s(),t.j41(29,"div",24)(30,"mat-form-field",25)(31,"mat-label"),t.EFF(32,"Nombre"),t.k0s(),t.nrm(33,"input",26),t.DNE(34,vi,2,0,"mat-error")(35,bi,2,0,"mat-error"),t.k0s(),t.j41(36,"mat-form-field",27)(37,"mat-label"),t.EFF(38,"Categor\xeda"),t.k0s(),t.nrm(39,"mat-icon",28)(40,"input",29),t.j41(41,"mat-autocomplete",30,0),t.Z7z(43,Ri,2,2,null,null,t.fX1),t.nI1(45,"async"),t.k0s(),t.DNE(46,xi,1,0,"mat-icon",31)(47,Si,2,0,"mat-error"),t.k0s(),t.j41(48,"mat-form-field",27)(49,"mat-label"),t.EFF(50,"Tiempo de preparaci\xf3n "),t.k0s(),t.j41(51,"span",32),t.EFF(52,"Minutos: "),t.k0s(),t.nrm(53,"input",33),t.DNE(54,Ei,2,0,"mat-error")(55,yi,2,0,"mat-error"),t.k0s(),t.j41(56,"mat-form-field",27)(57,"mat-label"),t.EFF(58,"Moneda"),t.k0s(),t.j41(59,"mat-select",34),t.Z7z(60,Fi,2,2,"mat-option",35,t.fX1),t.k0s(),t.DNE(62,Ii,2,0,"mat-error"),t.k0s(),t.j41(63,"mat-form-field",27)(64,"mat-label"),t.EFF(65,"Margen de ganancia"),t.k0s(),t.j41(66,"span",32),t.EFF(67,"% "),t.k0s(),t.nrm(68,"input",36),t.DNE(69,ki,2,0,"mat-error")(70,wi,2,0,"mat-error")(71,Ti,2,0,"mat-error"),t.k0s(),t.j41(72,"mat-form-field",27)(73,"mat-label"),t.EFF(74,"Tama\xf1o de la porci\xf3n "),t.k0s(),t.nrm(75,"input",37),t.j41(76,"mat-select",38),t.Z7z(77,$i,2,2,"mat-option",35,t.fX1),t.k0s(),t.DNE(79,Oi,2,0,"mat-error")(80,ji,2,0,"mat-error"),t.k0s(),t.j41(81,"mat-form-field",27)(82,"mat-label"),t.EFF(83,"Tiempo de cocci\xf3n "),t.k0s(),t.j41(84,"span",32),t.EFF(85,"Minutos: "),t.k0s(),t.nrm(86,"input",39),t.DNE(87,qi,2,0,"mat-error")(88,Ni,2,0,"mat-error"),t.k0s(),t.j41(89,"div",40)(90,"mat-label",41),t.EFF(91,"Costo Total"),t.k0s(),t.j41(92,"div",42),t.EFF(93),t.nI1(94,"number"),t.k0s()(),t.j41(95,"mat-form-field",27)(96,"mat-label"),t.EFF(97,"Impuesto"),t.k0s(),t.j41(98,"span",32),t.EFF(99,"% "),t.k0s(),t.nrm(100,"input",43),t.DNE(101,Gi,2,0,"mat-error")(102,Li,2,0,"mat-error")(103,Mi,2,0,"mat-error"),t.k0s(),t.j41(104,"mat-form-field",27)(105,"mat-label"),t.EFF(106,"Cantidad de porciones "),t.k0s(),t.nrm(107,"input",44),t.DNE(108,Ai,2,0,"mat-error")(109,Bi,2,0,"mat-error"),t.k0s(),t.j41(110,"mat-form-field",27)(111,"mat-label"),t.EFF(112,"Temperatura de servicio"),t.k0s(),t.j41(113,"span",32),t.EFF(114,"\xbaC: "),t.k0s(),t.nrm(115,"input",45),t.DNE(116,Yi,2,0,"mat-error")(117,zi,2,0,"mat-error"),t.k0s(),t.j41(118,"div",40)(119,"mat-label",41),t.EFF(120,"Costo de la Porci\xf3n"),t.k0s(),t.j41(121,"div",42),t.EFF(122),t.nI1(123,"number"),t.k0s()(),t.j41(124,"div",40)(125,"mat-label",41),t.EFF(126,"Precio de Venta"),t.k0s(),t.j41(127,"div",42),t.EFF(128),t.nI1(129,"number"),t.k0s()(),t.j41(130,"mat-form-field",46)(131,"mat-label"),t.EFF(132,"Descripci\xf3n"),t.k0s(),t.nrm(133,"textarea",47,1),t.j41(135,"mat-hint",48),t.EFF(136),t.k0s()(),t.j41(137,"mat-form-field",46)(138,"mat-label"),t.EFF(139,"Elaboraci\xf3n"),t.k0s(),t.nrm(140,"textarea",47,2),t.j41(142,"mat-hint",48),t.EFF(143),t.k0s()(),t.j41(144,"mat-form-field",46)(145,"mat-label"),t.EFF(146,"Presentaci\xf3n"),t.k0s(),t.nrm(147,"textarea",47,3),t.j41(149,"mat-hint",48),t.EFF(150),t.k0s()(),t.j41(151,"mat-form-field",46)(152,"mat-label"),t.EFF(153,"Equipos Necesarios"),t.k0s(),t.nrm(154,"textarea",47,4),t.j41(156,"mat-hint",48),t.EFF(157),t.k0s()(),t.j41(158,"mat-form-field",49)(159,"mat-label"),t.EFF(160,"Ingredientes"),t.k0s(),t.nrm(161,"mat-icon",50)(162,"input",51),t.j41(163,"mat-autocomplete",52,5),t.bIt("closed",function(){return t.eBV(s),t.Njj(r.searchProductControl.reset())}),t.Z7z(165,Vi,8,8,"mat-option",53,hi),t.k0s()(),t.j41(167,"div",54),t.DNE(168,Qi,15,0,"div",55),t.k0s()()(),t.j41(169,"div",56),t.DNE(170,Hi,9,3),t.j41(171,"div",57)(172,"span",58),t.EFF(173,"Al\xe9rgenos"),t.k0s(),t.j41(174,"div",59),t.Z7z(175,Zi,2,3,"mat-checkbox",60,t.fX1),t.k0s()()()()()()()}if(2&o){const s=t.sdS(42),a=t.sdS(134),d=t.sdS(141),u=t.sdS(148),m=t.sdS(155),p=t.sdS(164);t.R7$(9),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(2),t.SpI(" ","new"===r.productionDataSheetId()?"Crear":"Editar"," "),t.R7$(2),t.vxM(r.editMode?-1:21),t.R7$(),t.vxM(r.editMode?22:-1),t.R7$(2),t.Y8G("formGroup",r.productionDataSheetForm)("autocomplete","off"),t.R7$(9),t.Y8G("formControlName","name"),t.R7$(),t.vxM(r.productionDataSheetForm.get("name").hasError("required")?34:-1),t.R7$(),t.vxM(r.productionDataSheetForm.get("name").hasError("minlength")||r.productionDataSheetForm.get("name").hasError("maxlength")?35:-1),t.R7$(5),t.Y8G("formControlName","categoryId")("matAutocomplete",s),t.R7$(),t.Y8G("displayWith",r.displayFnCategory.bind(r)),t.R7$(2),t.Dyx(t.bMT(45,61,r.categoriesFiltered$)),t.R7$(3),t.vxM(r.productionDataSheetForm.get("categoryId").value?46:-1),t.R7$(),t.vxM(r.productionDataSheetForm.get("categoryId").hasError("required")?47:-1),t.R7$(7),t.vxM(r.productionDataSheetForm.get("preparationTime").hasError("min")?54:-1),t.R7$(),t.vxM(r.productionDataSheetForm.get("preparationTime").hasError("max")?55:-1),t.R7$(4),t.Y8G("formControlName","currencyId")("required",!0),t.R7$(),t.Dyx(r.currencies),t.R7$(2),t.vxM(r.productionDataSheetForm.get("currencyId").hasError("required")?62:-1),t.R7$(7),t.vxM(r.productionDataSheetForm.get("margin").hasError("required")?69:-1),t.R7$(),t.vxM(r.productionDataSheetForm.get("margin").hasError("min")?70:-1),t.R7$(),t.vxM(r.productionDataSheetForm.get("margin").hasError("max")?71:-1),t.R7$(5),t.Y8G("value","d1fdf6c2-bbfc-4135-9106-c1fe3a63c119")("formControlName","uomId"),t.R7$(),t.Dyx(r.uoms),t.R7$(2),t.vxM(r.productionDataSheetForm.get("portionSize").hasError("min")?79:-1),t.R7$(),t.vxM(r.productionDataSheetForm.get("portionSize").hasError("max")?80:-1),t.R7$(7),t.vxM(r.productionDataSheetForm.get("cookingTime").hasError("min")?87:-1),t.R7$(),t.vxM(r.productionDataSheetForm.get("cookingTime").hasError("max")?88:-1),t.R7$(5),t.SpI(" ",t.i5U(94,63,r.productionDataSheetForm.get("totalCost").value,"1.2-2")," "),t.R7$(8),t.vxM(r.productionDataSheetForm.get("tax").hasError("required")?101:-1),t.R7$(),t.vxM(r.productionDataSheetForm.get("tax").hasError("min")?102:-1),t.R7$(),t.vxM(r.productionDataSheetForm.get("tax").hasError("max")?103:-1),t.R7$(5),t.vxM(r.productionDataSheetForm.get("portions").hasError("min")?108:-1),t.R7$(),t.vxM(r.productionDataSheetForm.get("portions").hasError("max")?109:-1),t.R7$(7),t.vxM(r.productionDataSheetForm.get("temperature").hasError("min")?116:-1),t.R7$(),t.vxM(r.productionDataSheetForm.get("temperature").hasError("max")?117:-1),t.R7$(5),t.SpI(" ",t.i5U(123,66,r.productionDataSheetForm.get("portionCost").value,"1.2-2")," "),t.R7$(6),t.SpI(" ",t.i5U(129,69,r.productionDataSheetForm.get("price").value,"1.2-2")," "),t.R7$(5),t.Y8G("formControlName","description")("rows",2),t.R7$(3),t.SpI(" Total de caracteres ",a.value.length," /10000 "),t.R7$(4),t.Y8G("formControlName","elaboration")("rows",2),t.R7$(3),t.SpI(" Total de caracteres ",d.value.length," /10000 "),t.R7$(4),t.Y8G("formControlName","presentation")("rows",2),t.R7$(3),t.SpI(" Total de caracteres ",u.value.length," /10000 "),t.R7$(4),t.Y8G("formControlName","equipments")("rows",2),t.R7$(3),t.SpI(" Total de caracteres ",m.value.length," /10000 "),t.R7$(),t.Y8G("subscriptSizing","dynamic"),t.R7$(3),t.Y8G("svgIcon","mat_solid:search"),t.R7$(),t.Y8G("formControl",r.searchProductControl)("matAutocomplete",p)("placeholder","Buscar ingredientes"),t.R7$(),t.Y8G("displayWith",r.displayFn),t.R7$(2),t.Dyx(r.filteredProducts),t.R7$(2),t.Y8G("fuseScrollbarOptions",t.lJ4(72,gi)),t.R7$(),t.vxM(r.productionDataSheetForm.get("ingredients").controls.length>0?168:-1),t.R7$(2),t.vxM(r.editMode?170:-1),t.R7$(5),t.Dyx(r.allergensList)}},dependencies:[R.Jj,Q.jL,xt.uv,Q.$3,et.wT,et.D7,Q.pN,P.Hl,P.$z,P.iY,at.g7,at.So,h.RG,h.rl,h.nJ,h.MV,h.TL,h.JW,h.yw,x.m_,x.An,T.fS,T.fg,q.Ou,et.pZ,et.r6,ct.Ve,ct.VO,rt.mV,nt.D6,S.NQ,R.YU,c.X1,c.qT,c.me,c.Q0,c.BC,c.cb,c.YS,c.xh,c.tU,c.VZ,c.l_,c.j4,c.JD,c.$R,c.v8,c.YN,E.Wk,ee.p,R.QX],styles:[".ingredients-grid[_ngcontent-%COMP%]{grid-template-columns:10px auto 150px 150px 150px 50px}"],changeDetection:0})}return i})();var ut=l(57786),st=l(25558),Z=l(14823),St=l(56730),Et=l(63729),C=l(89079),oe=l(31397);const to=(i,n)=>n.id;function eo(i,n){if(1&i&&(t.j41(0,"mat-option",11),t.EFF(1),t.k0s()),2&i){const e=n.$implicit;t.Y8G("value",e),t.R7$(),t.SpI(" ",e.name," ")}}let io=(()=>{class i{#t;#i;#e;#o;#n;#r;#s;#a;constructor(e){this.data=e,this.productControl=new c.MJ("",c.k0.required),this.products=[],this.#t=(0,t.WQX)(t.gRc),this.#i=(0,t.WQX)(t.abz),this.#e=(0,t.WQX)(_.CP),this.#o=(0,t.WQX)(ot.G),this.#n=(0,t.WQX)(lt),this.#r=(0,t.WQX)(X.UG),this.#s=(0,t.WQX)(it.il),this.#a=(0,t.WQX)(te.g),this.productionDataSheetId=e.productionDataSheetId}ngOnInit(){this.productsFiltered$=this.#s.select(Gt.VW),this.#s.select(Gt.VW).pipe((0,C.pQ)(this.#i)).subscribe(e=>{this.products=e,this.#t.markForCheck()}),this.productsFiltered$=this.productControl.valueChanges.pipe((0,dt.B)(300),(0,A.Z)(""),(0,oe.Z)(e=>""!==e&&"string"==typeof e?this.#a.findActiveProducts(e,10):this.productsFiltered$))}linkProductToProductionDataSheet(){this.#o.open({title:"Vincular producto a la ficha t\xe9cnica de producci\xf3n",message:"\xbfEsta seguro que desea vincular el producto a la ficha t\xe9cnica de producci\xf3n?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(o=>{"confirmed"===o&&this.#n.linkProductToProductionDataSheet(this.productionDataSheetId,this.productControl.value.id).subscribe(({data:r})=>{this.#r.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:r.linkProductToProductionDataSheet.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#e.close(!0)})})}displayFn(e){return e&&e.name?e.name:""}static#c=this.\u0275fac=function(o){return new(o||i)(t.rXU(_.Vh))};static#d=this.\u0275cmp=t.VBU({type:i,selectors:[["production-data-sheet-link-product-dialog"]],standalone:!0,features:[t.aNF],decls:20,vars:11,consts:[["auto","matAutocomplete"],[1,"relative","flex","flex-col","w-full","max-h-screenl"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],[1,"text-2xl","text-gray-400"],[1,"flex","flex-col","items-center","flex-auto","mt-8","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],[1,"w-full","overflow-hidden"],[1,"flex","flex-col"],["appearance","fill",1,"w-full","fuse-mat-dense",3,"subscriptSizing"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete",3,"displayWith"],[1,"w-full",3,"value"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-between","bg-gray-50","dark:bg-black/10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"click","color","disabled"]],template:function(o,r){if(1&o){const s=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"h2",3),t.EFF(3," Vincular producto "),t.k0s()(),t.j41(4,"div",4)(5,"div",5)(6,"div",6)(7,"mat-form-field",7),t.nrm(8,"mat-icon",8)(9,"input",9),t.j41(10,"mat-autocomplete",10,0),t.Z7z(12,eo,2,2,"mat-option",11,to),t.nI1(14,"async"),t.k0s()()()()(),t.j41(15,"div",12)(16,"button",13),t.EFF(17," Cancelar "),t.k0s(),t.j41(18,"button",14),t.bIt("click",function(){return t.eBV(s),t.Njj(r.linkProductToProductionDataSheet())}),t.EFF(19," Vincular "),t.k0s()()()}if(2&o){const s=t.sdS(11);t.R7$(7),t.Y8G("subscriptSizing","dynamic"),t.R7$(),t.Y8G("svgIcon","mat_solid:search"),t.R7$(),t.Y8G("formControl",r.productControl)("matAutocomplete",s)("placeholder","Escriba para buscar..."),t.R7$(),t.Y8G("displayWith",r.displayFn),t.R7$(2),t.Dyx(t.bMT(14,9,r.productsFiltered$)),t.R7$(4),t.Y8G("matDialogClose","cancelled"),t.R7$(2),t.Y8G("color","primary")("disabled",r.productControl.invalid)}},dependencies:[R.Jj,Q.jL,Q.$3,et.wT,Q.pN,P.Hl,P.$z,_.tx,h.RG,h.rl,h.JW,x.m_,x.An,T.fS,T.fg,c.X1,c.me,c.BC,c.l_],encapsulation:2,changeDetection:0})}return i})();const oo=(i,n)=>n.id,no=i=>({"pointer-events-none":i}),ro=()=>[5,10,25,100],so=i=>["/modules/production/data-sheets",i];function ao(i,n){if(1&i&&t.nrm(0,"img",33),2&i){const e=t.XpG().$implicit;t.Y8G("alt","dataSheet thumbnail image")("src",e.thumbnail,t.B4B)}}function co(i,n){1&i&&(t.j41(0,"div",34),t.EFF(1," SIN IMAGEN "),t.k0s())}function lo(i,n){if(1&i){const e=t.RV6();t.j41(0,"mat-slide-toggle",49),t.bIt("change",function(r){t.eBV(e);const s=t.XpG(),a=s.$implicit,d=s.$index,u=t.XpG(2);return t.Njj(u.updateProductionDataSheetStatus(r,a,d))}),t.k0s()}if(2&i){const e=t.XpG().$implicit;t.Y8G("checked",e.active)("color","primary")}}function uo(i,n){1&i&&t.nrm(0,"mat-spinner",42),2&i&&t.Y8G("diameter",20)("color","primary")}function mo(i,n){if(1&i){const e=t.RV6();t.j41(0,"div",27)(1,"div",29)(2,"div",30)(3,"input",31),t.bIt("change",function(r){const s=t.eBV(e).$implicit,a=t.XpG(2);return t.Njj(a.selectFiles(r,s))}),t.k0s(),t.nrm(4,"label",32),t.DNE(5,ao,1,2,"img",33)(6,co,2,0,"div",34),t.k0s()(),t.j41(7,"div",35),t.EFF(8),t.k0s(),t.j41(9,"div",36)(10,"span",37),t.EFF(11),t.nI1(12,"number"),t.k0s(),t.j41(13,"span",38),t.EFF(14),t.k0s()(),t.j41(15,"div",36)(16,"span",37),t.EFF(17),t.nI1(18,"number"),t.k0s(),t.j41(19,"span",38),t.EFF(20),t.k0s()(),t.j41(21,"div",39),t.EFF(22),t.k0s(),t.j41(23,"div",40),t.DNE(24,lo,1,2,"mat-slide-toggle",41)(25,uo,1,2,"mat-spinner",42),t.k0s(),t.j41(26,"div",43)(27,"button",44),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.linkProductToProductionDataSheet(r))}),t.nrm(28,"mat-icon",45),t.k0s(),t.j41(29,"button",46),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.generateProductionDataSheetDataSheetDocument(r))}),t.nrm(30,"mat-icon",45),t.k0s(),t.j41(31,"button",47),t.nrm(32,"mat-icon",45),t.k0s(),t.j41(33,"button",48),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.deleteProductionDataSheet(r))}),t.nrm(34,"mat-icon",45),t.k0s()()()}if(2&i){const e=n.$implicit,o=n.$index,r=t.XpG(2);t.R7$(3),t.Y8G("id",e.id)("multiple",!1)("accept","image/png, image/webp, image/jpeg, image/png"),t.R7$(),t.Y8G("for",e.id),t.R7$(),t.vxM(e.thumbnail?5:-1),t.R7$(),t.vxM(e.thumbnail?-1:6),t.R7$(2),t.SpI(" ",e.name," "),t.R7$(3),t.JRh(t.i5U(12,19,e.totalCost/e.portions,"1.2-2")),t.R7$(3),t.JRh(e.currency.iso),t.R7$(3),t.JRh(t.i5U(18,22,e.price,"1.2-2")),t.R7$(3),t.JRh(e.currency.iso),t.R7$(2),t.SpI(" ",e.producedQuantity," "),t.R7$(2),t.vxM(r.isLoading&&r.selectedSlide===o?-1:24),t.R7$(),t.vxM(r.isLoading&&r.selectedSlide===o?25:-1),t.R7$(3),t.Y8G("svgIcon","mat_solid:link"),t.R7$(2),t.Y8G("svgIcon","mat_solid:description"),t.R7$(),t.Y8G("routerLink",t.eq3(25,so,e.id)),t.R7$(),t.Y8G("svgIcon","mat_solid:edit"),t.R7$(2),t.Y8G("svgIcon","mat_solid:delete")}}function po(i,n){if(1&i&&(t.j41(0,"div",21)(1,"div",22),t.nrm(2,"div"),t.j41(3,"div",23),t.EFF(4," Nombre "),t.k0s(),t.j41(5,"div",24),t.EFF(6," Costo "),t.k0s(),t.j41(7,"div",24),t.EFF(8," Precio "),t.k0s(),t.j41(9,"div",25),t.EFF(10," U.Producidas "),t.k0s(),t.j41(11,"div",24),t.EFF(12," Activo "),t.k0s(),t.j41(13,"div",26),t.EFF(14,"Acciones"),t.k0s()(),t.Z7z(15,mo,35,27,"div",27,oo),t.k0s(),t.nrm(17,"mat-paginator",28)),2&i){const e=t.XpG();t.R7$(3),t.Y8G("mat-sort-header","name"),t.R7$(2),t.Y8G("mat-sort-header","cost"),t.R7$(2),t.Y8G("mat-sort-header","price"),t.R7$(2),t.Y8G("mat-sort-header","salesQuantity"),t.R7$(2),t.Y8G("mat-sort-header","active"),t.R7$(4),t.Dyx(e.productionDataSheetsStore.productionDataSheets()),t.R7$(2),t.Y8G("ngClass",t.eq3(11,no,e.isLoading))("length",e.productionDataSheetsStore.pagination().length)("pageIndex",e.productionDataSheetsStore.pagination().page)("pageSize",e.productionDataSheetsStore.pagination().size)("pageSizeOptions",t.lJ4(13,ro))("showFirstLastButtons",!0)}}function ho(i,n){1&i&&(t.j41(0,"div",20),t.EFF(1," \xa1No se ha registrado ninguna ficha t\xe9cnica! "),t.k0s())}let go=(()=>{class i{constructor(){this.isLoading=!1,this.paginator=(0,t.ebz)(q.iy),this.productionDataSheetsStore=(0,t.WQX)(Rt),this.searchInputControl=new c.MJ,this.selectedSlide=null,this.sort=(0,t.ebz)(S.B4),this.user=null,this.#t=(0,t.WQX)(t.gRc),this.#i=(0,t.WQX)(_.bZ),this.#e=(0,t.WQX)(t.abz),this.#o=(0,t.WQX)(St.Q),this.#n=(0,t.WQX)(ot.G),this.#r=(0,t.WQX)(Ht.M),this.#s=(0,t.WQX)(lt),this.#a=(0,t.WQX)(X.UG),this.#c=new f.B,this.#d=(0,t.WQX)(it.il)}#t;#i;#e;#o;#n;#r;#s;#a;#c;#d;ngOnInit(){this.searchInputControl.valueChanges.pipe((0,g.Q)(this.#c),(0,dt.B)(300),(0,st.n)(e=>(this.isLoading=!0,this.#s.findAllProductionDataSheets(this.productionDataSheetsStore.pagination().page,this.productionDataSheetsStore.pagination().size,this.sort().active,this.sort().direction,e))),(0,k.T)(()=>{this.isLoading=!1})).subscribe(),this.#d.select(Et.SW).pipe((0,C.pQ)(this.#e)).subscribe(e=>{this.user=e,this.#t.markForCheck()})}ngAfterViewInit(){this.sort()&&this.paginator()&&(this.sort().sort({id:"name",start:"asc",disableClear:!0}),this.#t.markForCheck(),this.sort().sortChange.pipe((0,g.Q)(this.#c)).subscribe(()=>{this.paginator().pageIndex=0}),(0,ut.h)(this.sort().sortChange,this.paginator().page).pipe((0,st.n)(()=>(this.isLoading=!0,this.#s.findAllProductionDataSheets(this.paginator().pageIndex,this.paginator().pageSize,this.sort().active,this.sort().direction))),(0,k.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this.#c.next(null),this.#c.complete()}selectFiles(e,o){if(0===e.target.files.length)return;const r=e.target.files[0];!this.#r.validMaxMBSize(r,2)||!["image/jpeg","image/jpg","image/webp","image/png"].includes(r.type)||this.#l(e,o)}updateProductionDataSheetStatus(e,o,r){this.isLoading=!0,this.selectedSlide=r,this.#s.updateProductionDataSheetStatus({id:o.id,active:e.checked}).subscribe(({data:s})=>{this.#a.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.updateProductionDataSheetStatus.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.isLoading=!1,this.selectedSlide=-1,this.#t.markForCheck()})}deleteProductionDataSheet(e){this.#n.open({title:"Cuidado",message:`\xbfEst\xe1 seguro que desea eliminar la ficha t\xe9cnica: ${e.name}?`,icon:{show:!0,name:"mat_solid:question_mark",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,g.Q)(this.#c)).subscribe(r=>{"confirmed"===r&&this.#s.removeProductionDataSheet(e.id).pipe((0,g.Q)(this.#c)).subscribe(({data:s})=>{s&&(this.#a.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.removeProductionDataSheet.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#t.markForCheck())})})}linkProductToProductionDataSheet(e){this.#i.open(io,{data:{productionDataSheetId:e.id},panelClass:"ath-dialog-panel",disableClose:!0})}generateProductionDataSheetDataSheetDocument(e){this.#o.generateProductionDataSheetDataSheetDocument(e,this.user)}#l(e,o){this.#r.openCropperDialog(e,!1).pipe((0,C.pQ)(this.#e)).subscribe(r=>{r&&this.#r.uploadImage("products",r).pipe((0,C.pQ)(this.#e)).subscribe(s=>{const a=o;a.thumbnail=s.secure_url,delete a.active,delete a.category,delete a.currency,delete a.merchant,delete a.merchantId,delete a.slug,delete a.producedQuantity,delete a.uom,o.ingredients=o.ingredients.map(d=>(delete d.product,delete d.uom,d)),this.#s.updateProductionDataSheet(a).subscribe(({data:d})=>{this.#a.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:d.updateProductionDataSheet.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#t.markForCheck()})})})}static#u=this.\u0275fac=function(o){return new(o||i)};static#m=this.\u0275cmp=t.VBU({type:i,selectors:[["production-data-sheets"]],viewQuery:function(o,r){1&o&&(t.wEZ(r.paginator,q.iy,5),t.wEZ(r.sort,S.B4,5)),2&o&&t.NyB(2)},standalone:!0,features:[t.aNF],decls:30,vars:9,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-3","text-secondary",3,"svgIcon"],["routerLink","/modules/production/dashboard",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","","routerLink","new",1,"mt-4","text-white","sm:mt-0","bg-gradient-to-r","from-primary-500","to-primary-600","hover:to-primary-900","hover:shadow-lg"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","production-data-sheets-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"flex","items-center","justify-start",3,"mat-sort-header"],[1,"flex","items-center","justify-center",3,"mat-sort-header"],["matTooltip","Unidades Vendidas",1,"flex","items-center","justify-center",3,"mat-sort-header"],[1,"pr-4","text-center"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","production-data-sheets-grid","md:px-8"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"flex","items-center"],[1,"relative","flex","items-center","justify-center","w-12","h-12","mr-6","overflow-hidden","border","rounded","flex-0"],["type","file",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"change","id","multiple","accept"],[1,"absolute","w-full","h-full","cursor-pointer",3,"for"],["for","thumbnail-file-input",1,"w-full","m-0.5","rounded",3,"alt","src"],[1,"flex","items-center","justify-center","w-full","h-full","text-xs","font-semibold","leading-none","text-center","uppercase"],[1,"truncate"],[1,"flex","flex-row","justify-center","space-x-1"],[1,"font-mono"],[1,"text-xs","text-secondary"],[1,"block","text-center"],[1,"flex","justify-center","mr-3","text-center"],[3,"checked","color"],[3,"diameter","color"],[1,"flex","flex-row","justify-end","gap-2"],["mat-stroked-button","","matTooltip","Asociar Producto",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","","matTooltip","Ver Documento",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],["mat-stroked-button","","matTooltip","Editar",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],["mat-stroked-button","","matTooltip","Eliminar",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[3,"change","checked","color"]],template:function(o,r){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),t.EFF(6,"Inicio"),t.k0s()(),t.j41(7,"div",5),t.nrm(8,"mat-icon",6),t.j41(9,"a",7),t.EFF(10,"Producci\xf3n"),t.k0s()(),t.j41(11,"div",5),t.nrm(12,"mat-icon",6),t.j41(13,"a",8),t.EFF(14,"Fichas T\xe9cnicas"),t.k0s()()(),t.j41(15,"div",9)(16,"h2",10),t.EFF(17," Registro Fichas T\xe9cnicas "),t.k0s()()(),t.j41(18,"div",11)(19,"mat-form-field",12),t.nrm(20,"mat-icon",13)(21,"input",14),t.k0s(),t.j41(22,"button",15),t.nrm(23,"mat-icon",16),t.j41(24,"span",17),t.EFF(25,"Agregar"),t.k0s()()()(),t.j41(26,"div",18)(27,"div",19),t.DNE(28,po,18,14)(29,ho,2,0,"div",20),t.k0s()()()),2&o&&(t.R7$(8),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(7),t.Y8G("subscriptSizing","dynamic"),t.R7$(),t.Y8G("svgIcon","mat_solid:search"),t.R7$(),t.Y8G("formControl",r.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),t.R7$(2),t.Y8G("svgIcon","mat_solid:add"),t.R7$(5),t.vxM(r.productionDataSheetsStore.productionDataSheets().length>0?28:29))},dependencies:[P.Hl,P.$z,h.RG,h.rl,h.JW,x.m_,x.An,T.fS,T.fg,q.Ou,q.iy,nt.D6,nt.LG,rt.mV,rt.sG,S.NQ,S.B4,S.aE,Z.uc,Z.oV,R.YU,c.X1,c.me,c.BC,c.l_,E.Wk,R.QX],styles:[".production-data-sheets-grid{grid-template-columns:50px auto 150px 150px 100px 150px 150px}\n"],encapsulation:2,changeDetection:0})}return i})();var ne=l(18617),U=l(14085),z=l(36860),ft=l(18359),fo=l(43236),_o=l(1807),bo=l(30536),re=l(71985),Po=l(84412),Do=l(96697),se=l(28203);function ae(i){const n=i.cloneNode(!0),e=n.querySelectorAll("[id]"),o=i.nodeName.toLowerCase();n.removeAttribute("id");for(let r=0;r<e.length;r++)e[r].removeAttribute("id");return"canvas"===o?le(i,n):("input"===o||"select"===o||"textarea"===o)&&de(i,n),ce("canvas",i,n,le),ce("input, textarea, select",i,n,de),n}function ce(i,n,e,o){const r=n.querySelectorAll(i);if(r.length){const s=e.querySelectorAll(i);for(let a=0;a<r.length;a++)o(r[a],s[a])}}let Co=0;function de(i,n){"file"!==n.type&&(n.value=i.value),"radio"===n.type&&n.name&&(n.name=`mat-clone-${n.name}-${Co++}`)}function le(i,n){const e=n.getContext("2d");if(e)try{e.drawImage(i,0,0)}catch{}}function Yt(i){const n=i.getBoundingClientRect();return{top:n.top,right:n.right,bottom:n.bottom,left:n.left,width:n.width,height:n.height,x:n.x,y:n.y}}function zt(i,n,e){const{top:o,bottom:r,left:s,right:a}=i;return e>=o&&e<=r&&n>=s&&n<=a}function _t(i,n,e){i.top+=n,i.bottom=i.top+i.height,i.left+=e,i.right=i.left+i.width}function ue(i,n,e,o){const{top:r,right:s,bottom:a,left:d,width:u,height:m}=i,p=u*n,b=m*n;return o>r-b&&o<a+b&&e>d-p&&e<s+p}class me{constructor(n){this._document=n,this.positions=new Map}clear(){this.positions.clear()}cache(n){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),n.forEach(e=>{this.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:Yt(e)})})}handleScroll(n){const e=(0,z.Fb)(n),o=this.positions.get(e);if(!o)return null;const r=o.scrollPosition;let s,a;if(e===this._document){const m=this.getViewportScrollPosition();s=m.top,a=m.left}else s=e.scrollTop,a=e.scrollLeft;const d=r.top-s,u=r.left-a;return this.positions.forEach((m,p)=>{m.clientRect&&e!==p&&e.contains(p)&&_t(m.clientRect,d,u)}),r.top=s,r.left=a,{top:d,left:u}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}}function pe(i,n){const e=i.rootNodes;if(1===e.length&&e[0].nodeType===n.ELEMENT_NODE)return e[0];const o=n.createElement("div");return e.forEach(r=>o.appendChild(r)),o}function Vt(i,n,e){for(let o in n)if(n.hasOwnProperty(o)){const r=n[o];r?i.setProperty(o,r,e?.has(o)?"important":""):i.removeProperty(o)}return i}function mt(i,n){const e=n?"":"none";Vt(i.style,{"touch-action":n?"":"none","-webkit-user-drag":n?"":"none","-webkit-tap-highlight-color":n?"":"transparent","user-select":e,"-ms-user-select":e,"-webkit-user-select":e,"-moz-user-select":e})}function he(i,n,e){Vt(i.style,{position:n?"":"fixed",top:n?"":"0",opacity:n?"":"0",left:n?"":"-999em"},e)}function yt(i,n){return n&&"none"!=n?i+" "+n:i}function ge(i,n){i.style.width=`${n.width}px`,i.style.height=`${n.height}px`,i.style.transform=Ft(n.left,n.top)}function Ft(i,n){return`translate3d(${Math.round(i)}px, ${Math.round(n)}px, 0)`}function fe(i){const n=i.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(i)*n}function Xt(i,n){return i.getPropertyValue(n).split(",").map(o=>o.trim())}const xo=new Set(["position"]);class So{get element(){return this._preview}constructor(n,e,o,r,s,a,d,u,m){this._document=n,this._rootElement=e,this._direction=o,this._initialDomRect=r,this._previewTemplate=s,this._previewClass=a,this._pickupPositionOnPage=d,this._initialTransform=u,this._zIndex=m}attach(n){this._preview=this._createPreview(),n.appendChild(this._preview),_e(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(n){this._preview.style.transform=n}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(n){this._preview.classList.add(n)}getTransitionDuration(){return function Ro(i){const n=getComputedStyle(i),e=Xt(n,"transition-property"),o=e.find(d=>"transform"===d||"all"===d);if(!o)return 0;const r=e.indexOf(o),s=Xt(n,"transition-duration"),a=Xt(n,"transition-delay");return fe(s[r])+fe(a[r])}(this._preview)}addEventListener(n,e){this._preview.addEventListener(n,e)}removeEventListener(n,e){this._preview.removeEventListener(n,e)}_createPreview(){const n=this._previewTemplate,e=this._previewClass,o=n?n.template:null;let r;if(o&&n){const s=n.matchSize?this._initialDomRect:null,a=n.viewContainer.createEmbeddedView(o,n.context);a.detectChanges(),r=pe(a,this._document),this._previewEmbeddedView=a,n.matchSize?ge(r,s):r.style.transform=Ft(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else r=ae(this._rootElement),ge(r,this._initialDomRect),this._initialTransform&&(r.style.transform=this._initialTransform);return Vt(r.style,{"pointer-events":"none",margin:_e(r)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},xo),mt(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("popover","manual"),r.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(s=>r.classList.add(s)):r.classList.add(e)),r}}function _e(i){return"showPopover"in i}const ve=(0,z.BQ)({passive:!0}),It=(0,z.BQ)({passive:!1}),be=(0,z.BQ)({passive:!1,capture:!0}),Pe=new Set(["position"]);class yo{get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(n){n!==this._disabled&&(this._disabled=n,this._toggleNativeDragInteractions(),this._handles.forEach(e=>mt(e,n)))}constructor(n,e,o,r,s,a){this._config=e,this._document=o,this._ngZone=r,this._viewportRuler=s,this._dragDropRegistry=a,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=(0,t.vPA)(!1),this._moveEvents=new f.B,this._pointerMoveSubscription=ft.yU.EMPTY,this._pointerUpSubscription=ft.yU.EMPTY,this._scrollSubscription=ft.yU.EMPTY,this._resizeSubscription=ft.yU.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this.scale=1,this._disabled=!1,this.beforeStarted=new f.B,this.started=new f.B,this.released=new f.B,this.ended=new f.B,this.entered=new f.B,this.exited=new f.B,this.dropped=new f.B,this.moved=this._moveEvents,this._pointerDown=d=>{if(this.beforeStarted.next(),this._handles.length){const u=this._getTargetHandle(d);u&&!this._disabledHandles.has(u)&&!this.disabled&&this._initializeDragSequence(u,d)}else this.disabled||this._initializeDragSequence(this._rootElement,d)},this._pointerMove=d=>{const u=this._getPointerPositionOnPage(d);if(!this._hasStartedDragging()){if(Math.abs(u.x-this._pickupPositionOnPage.x)+Math.abs(u.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const Y=Date.now()>=this._dragStartTime+this._getDragStartDelay(d),J=this._dropContainer;if(!Y)return void this._endDragSequence(d);(!J||!J.isDragging()&&!J.isReceiving())&&(d.cancelable&&d.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(d)))}return}d.cancelable&&d.preventDefault();const m=this._getConstrainedPointerPosition(u);if(this._hasMoved=!0,this._lastKnownPointerPosition=u,this._updatePointerDirectionDelta(m),this._dropContainer)this._updateActiveDropContainer(m,u);else{const p=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,b=this._activeTransform;b.x=m.x-p.x+this._passiveTransform.x,b.y=m.y-p.y+this._passiveTransform.y,this._applyRootElementTransform(b.x,b.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:m,event:d,distance:this._getDragDistance(m),delta:this._pointerDirectionDelta})})},this._pointerUp=d=>{this._endDragSequence(d)},this._nativeDragStart=d=>{if(this._handles.length){const u=this._getTargetHandle(d);u&&!this._disabledHandles.has(u)&&!this.disabled&&d.preventDefault()}else this.disabled||d.preventDefault()},this.withRootElement(n).withParent(e.parentDragRef||null),this._parentPositions=new me(o),a.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(n){this._handles=n.map(o=>(0,U.i8)(o)),this._handles.forEach(o=>mt(o,this.disabled)),this._toggleNativeDragInteractions();const e=new Set;return this._disabledHandles.forEach(o=>{this._handles.indexOf(o)>-1&&e.add(o)}),this._disabledHandles=e,this}withPreviewTemplate(n){return this._previewTemplate=n,this}withPlaceholderTemplate(n){return this._placeholderTemplate=n,this}withRootElement(n){const e=(0,U.i8)(n);return e!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{e.addEventListener("mousedown",this._pointerDown,It),e.addEventListener("touchstart",this._pointerDown,ve),e.addEventListener("dragstart",this._nativeDragStart,It)}),this._initialTransform=void 0,this._rootElement=e),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(n){return this._boundaryElement=n?(0,U.i8)(n):null,this._resizeSubscription.unsubscribe(),n&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(n){return this._parentDragRef=n,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(n){!this._disabledHandles.has(n)&&this._handles.indexOf(n)>-1&&(this._disabledHandles.add(n),mt(n,!0))}enableHandle(n){this._disabledHandles.has(n)&&(this._disabledHandles.delete(n),mt(n,this.disabled))}withDirection(n){return this._direction=n,this}_withDropContainer(n){this._dropContainer=n}getFreeDragPosition(){const n=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:n.x,y:n.y}}setFreeDragPosition(n){return this._activeTransform={x:0,y:0},this._passiveTransform.x=n.x,this._passiveTransform.y=n.y,this._dropContainer||this._applyRootElementTransform(n.x,n.y),this}withPreviewContainer(n){return this._previewContainer=n,this}_sortFromLastPointerPosition(){const n=this._lastKnownPointerPosition;n&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(n),n)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._getShadowRoot()?.removeEventListener("selectstart",Ce,be)}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(n){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging()))if(this.released.next({source:this,event:n}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(n),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const e=this._getPointerPositionOnPage(n);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(e),dropPoint:e,event:n})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(n){vt(n)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const e=this._getShadowRoot(),o=this._dropContainer;if(e&&this._ngZone.runOutsideAngular(()=>{e.addEventListener("selectstart",Ce,be)}),o){const r=this._rootElement,s=r.parentNode,a=this._placeholder=this._createPlaceholderElement(),d=this._anchor=this._anchor||this._document.createComment("");s.insertBefore(d,r),this._initialTransform=r.style.transform||"",this._preview=new So(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3),this._preview.attach(this._getPreviewInsertionPoint(s,e)),he(r,!1,Pe),this._document.body.appendChild(s.replaceChild(a,r)),this.started.next({source:this,event:n}),o.start(),this._initialContainer=o,this._initialIndex=o.getItemIndex(this)}else this.started.next({source:this,event:n}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(o?o.getScrollableParents():[])}_initializeDragSequence(n,e){this._parentDragRef&&e.stopPropagation();const o=this.isDragging(),r=vt(e),s=!r&&0!==e.button,a=this._rootElement,d=(0,z.Fb)(e),u=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),m=r?(0,ne.w6)(e):(0,ne._G)(e);if(d&&d.draggable&&"mousedown"===e.type&&e.preventDefault(),o||s||u||m)return;if(this._handles.length){const w=a.style;this._rootElementTapHighlight=w.webkitTapHighlightColor||"",w.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(w=>this._updateOnScroll(w)),this._boundaryElement&&(this._boundaryRect=Yt(this._boundaryElement));const p=this._previewTemplate;this._pickupPositionInElement=p&&p.template&&!p.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,n,e);const b=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:b.x,y:b.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(n){he(this._rootElement,!0,Pe),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const e=this._dropContainer,o=e.getItemIndex(this),r=this._getPointerPositionOnPage(n),s=this._getDragDistance(r),a=e._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:s,dropPoint:r,event:n}),this.dropped.next({item:this,currentIndex:o,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:a,distance:s,dropPoint:r,event:n}),e.drop(this,o,this._initialIndex,this._initialContainer,a,s,r,n),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:n,y:e},{x:o,y:r}){let s=this._initialContainer._getSiblingContainerFromPosition(this,n,e);!s&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(n,e)&&(s=this._initialContainer),s&&s!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=s,this._dropContainer.enter(this,n,e,s===this._initialContainer&&s.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:s,currentIndex:s.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(o,r),this._dropContainer._sortItem(this,n,e,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(n,e):this._applyPreviewTransform(n-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const n=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(n.left,n.top);const e=this._preview.getTransitionDuration();return 0===e?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(o=>{const r=a=>{(!a||this._preview&&(0,z.Fb)(a)===this._preview.element&&"transform"===a.propertyName)&&(this._preview?.removeEventListener("transitionend",r),o(),clearTimeout(s))},s=setTimeout(r,1.5*e);this._preview.addEventListener("transitionend",r)}))}_createPlaceholderElement(){const n=this._placeholderTemplate,e=n?n.template:null;let o;return e?(this._placeholderRef=n.viewContainer.createEmbeddedView(e,n.context),this._placeholderRef.detectChanges(),o=pe(this._placeholderRef,this._document)):o=ae(this._rootElement),o.style.pointerEvents="none",o.classList.add("cdk-drag-placeholder"),o}_getPointerPositionInElement(n,e,o){const r=e===this._rootElement?null:e,s=r?r.getBoundingClientRect():n,a=vt(o)?o.targetTouches[0]:o,d=this._getViewportScrollPosition();return{x:s.left-n.left+(a.pageX-s.left-d.left),y:s.top-n.top+(a.pageY-s.top-d.top)}}_getPointerPositionOnPage(n){const e=this._getViewportScrollPosition(),o=vt(n)?n.touches[0]||n.changedTouches[0]||{pageX:0,pageY:0}:n,r=o.pageX-e.left,s=o.pageY-e.top;if(this._ownerSVGElement){const a=this._ownerSVGElement.getScreenCTM();if(a){const d=this._ownerSVGElement.createSVGPoint();return d.x=r,d.y=s,d.matrixTransform(a.inverse())}}return{x:r,y:s}}_getConstrainedPointerPosition(n){const e=this._dropContainer?this._dropContainer.lockAxis:null;let{x:o,y:r}=this.constrainPosition?this.constrainPosition(n,this,this._initialDomRect,this._pickupPositionInElement):n;if("x"===this.lockAxis||"x"===e?r=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):("y"===this.lockAxis||"y"===e)&&(o=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){const{x:s,y:a}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,d=this._boundaryRect,{width:u,height:m}=this._getPreviewRect(),p=d.top+a,b=d.bottom-(m-a);o=De(o,d.left+s,d.right-(u-s)),r=De(r,p,b)}return{x:o,y:r}}_updatePointerDirectionDelta(n){const{x:e,y:o}=n,r=this._pointerDirectionDelta,s=this._pointerPositionAtLastDirectionChange,a=Math.abs(e-s.x),d=Math.abs(o-s.y);return a>this._config.pointerDirectionChangeThreshold&&(r.x=e>s.x?1:-1,s.x=e),d>this._config.pointerDirectionChangeThreshold&&(r.y=o>s.y?1:-1,s.y=o),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const n=this._handles.length>0||!this.isDragging();n!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=n,mt(this._rootElement,n))}_removeRootElementListeners(n){n.removeEventListener("mousedown",this._pointerDown,It),n.removeEventListener("touchstart",this._pointerDown,ve),n.removeEventListener("dragstart",this._nativeDragStart,It)}_applyRootElementTransform(n,e){const o=1/this.scale,r=Ft(n*o,e*o),s=this._rootElement.style;null==this._initialTransform&&(this._initialTransform=s.transform&&"none"!=s.transform?s.transform:""),s.transform=yt(r,this._initialTransform)}_applyPreviewTransform(n,e){const o=this._previewTemplate?.template?void 0:this._initialTransform,r=Ft(n,e);this._preview.setTransform(yt(r,o))}_getDragDistance(n){const e=this._pickupPositionOnPage;return e?{x:n.x-e.x,y:n.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:n,y:e}=this._passiveTransform;if(0===n&&0===e||this.isDragging()||!this._boundaryElement)return;const o=this._rootElement.getBoundingClientRect(),r=this._boundaryElement.getBoundingClientRect();if(0===r.width&&0===r.height||0===o.width&&0===o.height)return;const s=r.left-o.left,a=o.right-r.right,d=r.top-o.top,u=o.bottom-r.bottom;r.width>o.width?(s>0&&(n+=s),a>0&&(n-=a)):n=0,r.height>o.height?(d>0&&(e+=d),u>0&&(e-=u)):e=0,(n!==this._passiveTransform.x||e!==this._passiveTransform.y)&&this.setFreeDragPosition({y:e,x:n})}_getDragStartDelay(n){const e=this.dragStartDelay;return"number"==typeof e?e:vt(n)?e.touch:e?e.mouse:0}_updateOnScroll(n){const e=this._parentPositions.handleScroll(n);if(e){const o=(0,z.Fb)(n);this._boundaryRect&&o!==this._boundaryElement&&o.contains(this._boundaryElement)&&_t(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=(0,z.KT)(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(n,e){const o=this._previewContainer||"global";if("parent"===o)return n;if("global"===o){const r=this._document;return e||r.fullscreenElement||r.webkitFullscreenElement||r.mozFullScreenElement||r.msFullscreenElement||r.body}return(0,U.i8)(o)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_getTargetHandle(n){return this._handles.find(e=>n.target&&(n.target===e||e.contains(n.target)))}}function De(i,n,e){return Math.max(n,Math.min(e,i))}function vt(i){return"t"===i.type[0]}function Ce(i){i.preventDefault()}function Qt(i,n,e){const o=bt(n,i.length-1),r=bt(e,i.length-1);if(o===r)return;const s=i[o],a=r<o?-1:1;for(let d=o;d!==r;d+=a)i[d]=i[d+a];i[r]=s}function bt(i,n){return Math.max(0,Math.min(n,i))}class Re{constructor(n){this._dragDropRegistry=n,this._itemPositions=[],this.orientation="vertical",this._previousSwap={drag:null,delta:0,overlaps:!1}}start(n){this.withItems(n)}sort(n,e,o,r){const s=this._itemPositions,a=this._getItemIndexFromPointerPosition(n,e,o,r);if(-1===a&&s.length>0)return null;const d="horizontal"===this.orientation,u=s.findIndex(M=>M.drag===n),m=s[a],b=m.clientRect,w=u>a?1:-1,Y=this._getItemOffsetPx(s[u].clientRect,b,w),J=this._getSiblingOffsetPx(u,s,w),V=s.slice();return Qt(s,u,a),s.forEach((M,es)=>{if(V[es]===M)return;const Xe=M.drag===n,Jt=Xe?Y:J,Qe=Xe?n.getPlaceholderElement():M.drag.getRootElement();M.offset+=Jt;const Ue=Math.round(M.offset*(1/M.drag.scale));d?(Qe.style.transform=yt(`translate3d(${Ue}px, 0, 0)`,M.initialTransform),_t(M.clientRect,0,Jt)):(Qe.style.transform=yt(`translate3d(0, ${Ue}px, 0)`,M.initialTransform),_t(M.clientRect,Jt,0))}),this._previousSwap.overlaps=zt(b,e,o),this._previousSwap.drag=m.drag,this._previousSwap.delta=d?r.x:r.y,{previousIndex:u,currentIndex:a}}enter(n,e,o,r){const s=null==r||r<0?this._getItemIndexFromPointerPosition(n,e,o):r,a=this._activeDraggables,d=a.indexOf(n),u=n.getPlaceholderElement();let m=a[s];if(m===n&&(m=a[s+1]),!m&&(null==s||-1===s||s<a.length-1)&&this._shouldEnterAsFirstChild(e,o)&&(m=a[0]),d>-1&&a.splice(d,1),m&&!this._dragDropRegistry.isDragging(m)){const p=m.getRootElement();p.parentElement.insertBefore(u,p),a.splice(s,0,n)}else this._element.appendChild(u),a.push(n);u.style.transform="",this._cacheItemPositions()}withItems(n){this._activeDraggables=n.slice(),this._cacheItemPositions()}withSortPredicate(n){this._sortPredicate=n}reset(){this._activeDraggables?.forEach(n=>{const e=n.getRootElement();if(e){const o=this._itemPositions.find(r=>r.drag===n)?.initialTransform;e.style.transform=o||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(n){return("horizontal"===this.orientation&&"rtl"===this.direction?this._itemPositions.slice().reverse():this._itemPositions).findIndex(o=>o.drag===n)}updateOnScroll(n,e){this._itemPositions.forEach(({clientRect:o})=>{_t(o,n,e)}),this._itemPositions.forEach(({drag:o})=>{this._dragDropRegistry.isDragging(o)&&o._sortFromLastPointerPosition()})}withElementContainer(n){this._element=n}_cacheItemPositions(){const n="horizontal"===this.orientation;this._itemPositions=this._activeDraggables.map(e=>{const o=e.getVisibleElement();return{drag:e,offset:0,initialTransform:o.style.transform||"",clientRect:Yt(o)}}).sort((e,o)=>n?e.clientRect.left-o.clientRect.left:e.clientRect.top-o.clientRect.top)}_getItemOffsetPx(n,e,o){const r="horizontal"===this.orientation;let s=r?e.left-n.left:e.top-n.top;return-1===o&&(s+=r?e.width-n.width:e.height-n.height),s}_getSiblingOffsetPx(n,e,o){const r="horizontal"===this.orientation,s=e[n].clientRect,a=e[n+-1*o];let d=s[r?"width":"height"]*o;if(a){const u=r?"left":"top",m=r?"right":"bottom";-1===o?d-=a.clientRect[u]-s[m]:d+=s[u]-a.clientRect[m]}return d}_shouldEnterAsFirstChild(n,e){if(!this._activeDraggables.length)return!1;const o=this._itemPositions,r="horizontal"===this.orientation;if(o[0].drag!==this._activeDraggables[0]){const a=o[o.length-1].clientRect;return r?n>=a.right:e>=a.bottom}{const a=o[0].clientRect;return r?n<=a.left:e<=a.top}}_getItemIndexFromPointerPosition(n,e,o,r){const s="horizontal"===this.orientation,a=this._itemPositions.findIndex(({drag:d,clientRect:u})=>d!==n&&((!r||d!==this._previousSwap.drag||!this._previousSwap.overlaps||(s?r.x:r.y)!==this._previousSwap.delta)&&(s?e>=Math.floor(u.left)&&e<Math.floor(u.right):o>=Math.floor(u.top)&&o<Math.floor(u.bottom))));return-1!==a&&this._sortPredicate(a,n)?a:-1}}class Io{constructor(n,e){this._document=n,this._dragDropRegistry=e,this._previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1},this._relatedNodes=[]}start(n){const e=this._element.childNodes;this._relatedNodes=[];for(let o=0;o<e.length;o++){const r=e[o];this._relatedNodes.push([r,r.nextSibling])}this.withItems(n)}sort(n,e,o,r){const s=this._getItemIndexFromPointerPosition(n,e,o),a=this._previousSwap;if(-1===s||this._activeItems[s]===n)return null;const d=this._activeItems[s];if(a.drag===d&&a.overlaps&&a.deltaX===r.x&&a.deltaY===r.y)return null;const u=this.getItemIndex(n),m=n.getPlaceholderElement(),p=d.getRootElement();s>u?p.after(m):p.before(m),Qt(this._activeItems,u,s);const b=this._getRootNode().elementFromPoint(e,o);return a.deltaX=r.x,a.deltaY=r.y,a.drag=d,a.overlaps=p===b||p.contains(b),{previousIndex:u,currentIndex:s}}enter(n,e,o,r){let s=null==r||r<0?this._getItemIndexFromPointerPosition(n,e,o):r;-1===s&&(s=this._getClosestItemIndexToPointer(n,e,o));const a=this._activeItems[s],d=this._activeItems.indexOf(n);d>-1&&this._activeItems.splice(d,1),a&&!this._dragDropRegistry.isDragging(a)?(this._activeItems.splice(s,0,n),a.getRootElement().before(n.getPlaceholderElement())):(this._activeItems.push(n),this._element.appendChild(n.getPlaceholderElement()))}withItems(n){this._activeItems=n.slice()}withSortPredicate(n){this._sortPredicate=n}reset(){const n=this._element,e=this._previousSwap;for(let o=this._relatedNodes.length-1;o>-1;o--){const[r,s]=this._relatedNodes[o];r.parentNode===n&&r.nextSibling!==s&&(null===s?n.appendChild(r):s.parentNode===n&&n.insertBefore(r,s))}this._relatedNodes=[],this._activeItems=[],e.drag=null,e.deltaX=e.deltaY=0,e.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(n){return this._activeItems.indexOf(n)}updateOnScroll(){this._activeItems.forEach(n=>{this._dragDropRegistry.isDragging(n)&&n._sortFromLastPointerPosition()})}withElementContainer(n){n!==this._element&&(this._element=n,this._rootNode=void 0)}_getItemIndexFromPointerPosition(n,e,o){const r=this._getRootNode().elementFromPoint(Math.floor(e),Math.floor(o)),s=r?this._activeItems.findIndex(a=>{const d=a.getRootElement();return r===d||d.contains(r)}):-1;return-1!==s&&this._sortPredicate(s,n)?s:-1}_getRootNode(){return this._rootNode||(this._rootNode=(0,z.KT)(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(n,e,o){if(0===this._activeItems.length)return-1;if(1===this._activeItems.length)return 0;let r=1/0,s=-1;for(let a=0;a<this._activeItems.length;a++){const d=this._activeItems[a];if(d!==n){const{x:u,y:m}=d.getRootElement().getBoundingClientRect(),p=Math.hypot(e-u,o-m);p<r&&(r=p,s=a)}}return s}}var B=function(i){return i[i.NONE=0]="NONE",i[i.UP=1]="UP",i[i.DOWN=2]="DOWN",i}(B||{}),N=function(i){return i[i.NONE=0]="NONE",i[i.LEFT=1]="LEFT",i[i.RIGHT=2]="RIGHT",i}(N||{});class ko{constructor(n,e,o,r,s){this._dragDropRegistry=e,this._ngZone=r,this._viewportRuler=s,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new f.B,this.entered=new f.B,this.exited=new f.B,this.dropped=new f.B,this.sorted=new f.B,this.receivingStarted=new f.B,this.receivingStopped=new f.B,this._isDragging=!1,this._draggables=[],this._siblings=[],this._activeSiblings=new Set,this._viewportScrollSubscription=ft.yU.EMPTY,this._verticalScrollDirection=B.NONE,this._horizontalScrollDirection=N.NONE,this._stopScrollTimers=new f.B,this._cachedShadowRoot=null,this._scrollableElements=[],this._direction="ltr",this._startScrollInterval=()=>{this._stopScrolling(),function vo(i=0,n=fo.E){return i<0&&(i=0),(0,_o.O)(i,i,n)}(0,bo.X).pipe((0,g.Q)(this._stopScrollTimers)).subscribe(()=>{const d=this._scrollNode,u=this.autoScrollStep;this._verticalScrollDirection===B.UP?d.scrollBy(0,-u):this._verticalScrollDirection===B.DOWN&&d.scrollBy(0,u),this._horizontalScrollDirection===N.LEFT?d.scrollBy(-u,0):this._horizontalScrollDirection===N.RIGHT&&d.scrollBy(u,0)})};const a=this.element=(0,U.i8)(n);this._document=o,this.withOrientation("vertical").withElementContainer(a),e.registerDropContainer(this),this._parentPositions=new me(o)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(n,e,o,r){this._draggingStarted(),null==r&&this.sortingDisabled&&(r=this._draggables.indexOf(n)),this._sortStrategy.enter(n,e,o,r),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:n,container:this,currentIndex:this.getItemIndex(n)})}exit(n){this._reset(),this.exited.next({item:n,container:this})}drop(n,e,o,r,s,a,d,u={}){this._reset(),this.dropped.next({item:n,currentIndex:e,previousIndex:o,container:this,previousContainer:r,isPointerOverContainer:s,distance:a,dropPoint:d,event:u})}withItems(n){const e=this._draggables;return this._draggables=n,n.forEach(o=>o._withDropContainer(this)),this.isDragging()&&(e.filter(r=>r.isDragging()).every(r=>-1===n.indexOf(r))?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(n){return this._direction=n,this._sortStrategy instanceof Re&&(this._sortStrategy.direction=n),this}connectedTo(n){return this._siblings=n.slice(),this}withOrientation(n){if("mixed"===n)this._sortStrategy=new Io(this._document,this._dragDropRegistry);else{const e=new Re(this._dragDropRegistry);e.direction=this._direction,e.orientation=n,this._sortStrategy=e}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((e,o)=>this.sortPredicate(e,o,this)),this}withScrollableParents(n){const e=this._container;return this._scrollableElements=-1===n.indexOf(e)?[e,...n]:n.slice(),this}withElementContainer(n){if(n===this._container)return this;(0,U.i8)(this.element);const o=this._scrollableElements.indexOf(this._container),r=this._scrollableElements.indexOf(n);return o>-1&&this._scrollableElements.splice(o,1),r>-1&&this._scrollableElements.splice(r,1),this._sortStrategy&&this._sortStrategy.withElementContainer(n),this._cachedShadowRoot=null,this._scrollableElements.unshift(n),this._container=n,this}getScrollableParents(){return this._scrollableElements}getItemIndex(n){return this._isDragging?this._sortStrategy.getItemIndex(n):this._draggables.indexOf(n)}isReceiving(){return this._activeSiblings.size>0}_sortItem(n,e,o,r){if(this.sortingDisabled||!this._domRect||!ue(this._domRect,.05,e,o))return;const s=this._sortStrategy.sort(n,e,o,r);s&&this.sorted.next({previousIndex:s.previousIndex,currentIndex:s.currentIndex,container:this,item:n})}_startScrollingIfNecessary(n,e){if(this.autoScrollDisabled)return;let o,r=B.NONE,s=N.NONE;if(this._parentPositions.positions.forEach((a,d)=>{d===this._document||!a.clientRect||o||ue(a.clientRect,.05,n,e)&&([r,s]=function wo(i,n,e,o,r){const s=Ee(n,r),a=ye(n,o);let d=B.NONE,u=N.NONE;if(s){const m=i.scrollTop;s===B.UP?m>0&&(d=B.UP):i.scrollHeight-m>i.clientHeight&&(d=B.DOWN)}if(a){const m=i.scrollLeft;"rtl"===e?a===N.RIGHT?m<0&&(u=N.RIGHT):i.scrollWidth+m>i.clientWidth&&(u=N.LEFT):a===N.LEFT?m>0&&(u=N.LEFT):i.scrollWidth-m>i.clientWidth&&(u=N.RIGHT)}return[d,u]}(d,a.clientRect,this._direction,n,e),(r||s)&&(o=d))}),!r&&!s){const{width:a,height:d}=this._viewportRuler.getViewportSize(),u={width:a,height:d,top:0,right:a,bottom:d,left:0};r=Ee(u,e),s=ye(u,n),o=window}o&&(r!==this._verticalScrollDirection||s!==this._horizontalScrollDirection||o!==this._scrollNode)&&(this._verticalScrollDirection=r,this._horizontalScrollDirection=s,this._scrollNode=o,(r||s)&&o?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const n=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=n.msScrollSnapType||n.scrollSnapType||"",n.scrollSnapType=n.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;const n=this._container.style;n.scrollSnapType=n.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(e=>e._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_isOverContainer(n,e){return null!=this._domRect&&zt(this._domRect,n,e)}_getSiblingContainerFromPosition(n,e,o){return this._siblings.find(r=>r._canReceive(n,e,o))}_canReceive(n,e,o){if(!this._domRect||!zt(this._domRect,e,o)||!this.enterPredicate(n,this))return!1;const r=this._getShadowRoot().elementFromPoint(e,o);return!!r&&(r===this._container||this._container.contains(r))}_startReceiving(n,e){const o=this._activeSiblings;!o.has(n)&&e.every(r=>this.enterPredicate(r,this)||this._draggables.indexOf(r)>-1)&&(o.add(n),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:n,receiver:this,items:e}))}_stopReceiving(n){this._activeSiblings.delete(n),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:n,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(n=>{if(this.isDragging()){const e=this._parentPositions.handleScroll(n);e&&this._sortStrategy.updateOnScroll(e.top,e.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const n=(0,z.KT)(this._container);this._cachedShadowRoot=n||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const n=this._sortStrategy.getActiveItemsSnapshot().filter(e=>e.isDragging());this._siblings.forEach(e=>e._startReceiving(this,n))}}function Ee(i,n){const{top:e,bottom:o,height:r}=i,s=.05*r;return n>=e-s&&n<=e+s?B.UP:n>=o-s&&n<=o+s?B.DOWN:B.NONE}function ye(i,n){const{left:e,right:o,width:r}=i,s=.05*r;return n>=e-s&&n<=e+s?N.LEFT:n>=o-s&&n<=o+s?N.RIGHT:N.NONE}const kt=(0,z.BQ)({passive:!1,capture:!0}),wt=new Set;let To=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#i=this.\u0275cmp=t.VBU({type:i,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],standalone:!0,features:[t.aNF],decls:0,vars:0,template:function(o,r){},styles:["@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}"],encapsulation:2,changeDetection:0})}return i})(),$o=(()=>{class i{constructor(e,o){this._ngZone=e,this._appRef=(0,t.WQX)(t.o8S),this._environmentInjector=(0,t.WQX)(t.uvJ),this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=(0,t.vPA)([]),this._globalListeners=new Map,this._draggingPredicate=r=>r.isDragging(),this.pointerMove=new f.B,this.pointerUp=new f.B,this.scroll=new f.B,this._preventDefaultWhileDragging=r=>{this._activeDragInstances().length>0&&r.preventDefault()},this._persistentTouchmoveListener=r=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&r.preventDefault(),this.pointerMove.next(r))},this._document=o}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,kt)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,kt)}startDragging(e,o){if(!(this._activeDragInstances().indexOf(e)>-1)&&(this._loadResets(),this._activeDragInstances.update(r=>[...r,e]),1===this._activeDragInstances().length)){const r=o.type.startsWith("touch");this._globalListeners.set(r?"touchend":"mouseup",{handler:s=>this.pointerUp.next(s),options:!0}).set("scroll",{handler:s=>this.scroll.next(s),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:kt}),r||this._globalListeners.set("mousemove",{handler:s=>this.pointerMove.next(s),options:kt}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((s,a)=>{this._document.addEventListener(a,s.handler,s.options)})})}}stopDragging(e){this._activeDragInstances.update(o=>{const r=o.indexOf(e);return r>-1?(o.splice(r,1),[...o]):o}),0===this._activeDragInstances().length&&this._clearGlobalListeners()}isDragging(e){return this._activeDragInstances().indexOf(e)>-1}scrolled(e){const o=[this.scroll];return e&&e!==this._document&&o.push(new re.c(r=>this._ngZone.runOutsideAngular(()=>{const a=d=>{this._activeDragInstances().length&&r.next(d)};return e.addEventListener("scroll",a,!0),()=>{e.removeEventListener("scroll",a,!0)}}))),(0,ut.h)(...o)}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((e,o)=>{this._document.removeEventListener(o,e.handler,e.options)}),this._globalListeners.clear()}_loadResets(){if(!wt.has(this._appRef)){wt.add(this._appRef);const e=(0,t.a0P)(To,{environmentInjector:this._environmentInjector});this._appRef.onDestroy(()=>{wt.delete(this._appRef),0===wt.size&&e.destroy()})}}static#t=this.\u0275fac=function(o){return new(o||i)(t.KVO(t.SKi),t.KVO(R.qQ))};static#i=this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();const Oo={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let Fe=(()=>{class i{constructor(e,o,r,s){this._document=e,this._ngZone=o,this._viewportRuler=r,this._dragDropRegistry=s}createDrag(e,o=Oo){return new yo(e,o,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(e){return new ko(e,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static#t=this.\u0275fac=function(o){return new(o||i)(t.KVO(R.qQ),t.KVO(t.SKi),t.KVO(xt.Xj),t.KVO($o))};static#i=this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();const Pt=new t.nKC("CDK_DRAG_PARENT"),Ie=new t.nKC("CdkDragHandle");let ke=(()=>{class i{get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._stateChanges.next(this)}constructor(e,o){this.element=e,this._parentDrag=o,this._stateChanges=new f.B,this._disabled=!1,o?._addHandle(this)}ngOnDestroy(){this._parentDrag?._removeHandle(this),this._stateChanges.complete()}static#t=this.\u0275fac=function(o){return new(o||i)(t.rXU(t.aKT),t.rXU(Pt,12))};static#i=this.\u0275dir=t.FsC({type:i,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:[2,"cdkDragHandleDisabled","disabled",t.L39]},standalone:!0,features:[t.Jv_([{provide:Ie,useExisting:i}]),t.GFd]})}return i})();const we=new t.nKC("CDK_DRAG_CONFIG"),Te=new t.nKC("CdkDropList");let $e=(()=>{class i{static#t=this._dragInstances=[];get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(e){this._disabled=e,this._dragRef.disabled=this._disabled}constructor(e,o,r,s,a,d,u,m,p,b,w){this.element=e,this.dropContainer=o,this._ngZone=s,this._viewContainerRef=a,this._dir=u,this._changeDetectorRef=p,this._selfHandle=b,this._parentDrag=w,this._destroyed=new f.B,this._handles=new Po.t([]),this.scale=1,this.started=new t.bkB,this.released=new t.bkB,this.ended=new t.bkB,this.entered=new t.bkB,this.exited=new t.bkB,this.dropped=new t.bkB,this.moved=new re.c(Y=>{const J=this._dragRef.moved.pipe((0,k.T)(V=>({source:this,pointerPosition:V.pointerPosition,event:V.event,delta:V.delta,distance:V.distance}))).subscribe(Y);return()=>{J.unsubscribe()}}),this._injector=(0,t.WQX)(t.zZn),this._dragRef=m.createDrag(e,{dragStartThreshold:d&&null!=d.dragStartThreshold?d.dragStartThreshold:5,pointerDirectionChangeThreshold:d&&null!=d.pointerDirectionChangeThreshold?d.pointerDirectionChangeThreshold:5,zIndex:d?.zIndex}),this._dragRef.data=this,i._dragInstances.push(this),d&&this._assignDefaults(d),o&&(this._dragRef._withDropContainer(o._dropListRef),o.addItem(this),o._dropListRef.beforeStarted.pipe((0,g.Q)(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(e){this._dragRef.setFreeDragPosition(e)}ngAfterViewInit(){(0,t.mal)(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(e){const o=e.rootElementSelector,r=e.freeDragPosition;o&&!o.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,r&&!r.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);const e=i._dragInstances.indexOf(this);e>-1&&i._dragInstances.splice(e,1),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(e){const o=this._handles.getValue();o.push(e),this._handles.next(o)}_removeHandle(e){const o=this._handles.getValue(),r=o.indexOf(e);r>-1&&(o.splice(r,1),this._handles.next(o))}_setPreviewTemplate(e){this._previewTemplate=e}_resetPreviewTemplate(e){e===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(e){this._placeholderTemplate=e}_resetPlaceholderTemplate(e){e===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){const e=this.element.nativeElement;let o=e;this.rootElementSelector&&(o=void 0!==e.closest?e.closest(this.rootElementSelector):e.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(o||e)}_getBoundaryElement(){const e=this.boundaryElement;return e?"string"==typeof e?this.element.nativeElement.closest(e):(0,U.i8)(e):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){const o=this._dir,r=this.dragStartDelay,s=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,a=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.scale=this.scale,e.dragStartDelay="object"==typeof r&&r?r:(0,U.OE)(r),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(s).withPreviewTemplate(a).withPreviewContainer(this.previewContainer||"global"),o&&e.withDirection(o.value)}}),e.beforeStarted.pipe((0,Do.s)(1)).subscribe(()=>{if(this._parentDrag)return void e.withParent(this._parentDrag._dragRef);let o=this.element.nativeElement.parentElement;for(;o;){if(o.classList.contains("cdk-drag")){e.withParent(i._dragInstances.find(r=>r.element.nativeElement===o)?._dragRef||null);break}o=o.parentElement}})}_handleEvents(e){e.started.subscribe(o=>{this.started.emit({source:this,event:o.event}),this._changeDetectorRef.markForCheck()}),e.released.subscribe(o=>{this.released.emit({source:this,event:o.event})}),e.ended.subscribe(o=>{this.ended.emit({source:this,distance:o.distance,dropPoint:o.dropPoint,event:o.event}),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(o=>{this.entered.emit({container:o.container.data,item:this,currentIndex:o.currentIndex})}),e.exited.subscribe(o=>{this.exited.emit({container:o.container.data,item:this})}),e.dropped.subscribe(o=>{this.dropped.emit({previousIndex:o.previousIndex,currentIndex:o.currentIndex,previousContainer:o.previousContainer.data,container:o.container.data,isPointerOverContainer:o.isPointerOverContainer,item:this,distance:o.distance,dropPoint:o.dropPoint,event:o.event})})}_assignDefaults(e){const{lockAxis:o,dragStartDelay:r,constrainPosition:s,previewClass:a,boundaryElement:d,draggingDisabled:u,rootElementSelector:m,previewContainer:p}=e;this.disabled=u??!1,this.dragStartDelay=r||0,o&&(this.lockAxis=o),s&&(this.constrainPosition=s),a&&(this.previewClass=a),d&&(this.boundaryElement=d),m&&(this.rootElementSelector=m),p&&(this.previewContainer=p)}_setupHandlesListener(){this._handles.pipe((0,D.M)(e=>{const o=e.map(r=>r.element);this._selfHandle&&this.rootElementSelector&&o.push(this.element),this._dragRef.withHandles(o)}),(0,st.n)(e=>(0,ut.h)(...e.map(o=>o._stateChanges.pipe((0,A.Z)(o))))),(0,g.Q)(this._destroyed)).subscribe(e=>{const o=this._dragRef,r=e.element.nativeElement;e.disabled?o.disableHandle(r):o.enableHandle(r)})}static#i=this.\u0275fac=function(o){return new(o||i)(t.rXU(t.aKT),t.rXU(Te,12),t.rXU(R.qQ),t.rXU(t.SKi),t.rXU(t.c1b),t.rXU(we,8),t.rXU(se.dS,8),t.rXU(Fe),t.rXU(t.gRc),t.rXU(Ie,10),t.rXU(Pt,12))};static#e=this.\u0275dir=t.FsC({type:i,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(o,r){2&o&&t.AVh("cdk-drag-disabled",r.disabled)("cdk-drag-dragging",r._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",t.L39],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",t.Udg]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],standalone:!0,features:[t.Jv_([{provide:Pt,useExisting:i}]),t.GFd,t.OA$]})}return i})();const Ut=new t.nKC("CdkDropListGroup");let Oe=(()=>{class i{constructor(){this._items=new Set,this.disabled=!1}ngOnDestroy(){this._items.clear()}static#t=this.\u0275fac=function(o){return new(o||i)};static#i=this.\u0275dir=t.FsC({type:i,selectors:[["","cdkDropListGroup",""]],inputs:{disabled:[2,"cdkDropListGroupDisabled","disabled",t.L39]},exportAs:["cdkDropListGroup"],standalone:!0,features:[t.Jv_([{provide:Ut,useExisting:i}]),t.GFd]})}return i})(),qo=0,je=(()=>{class i{static#t=this._dropLists=[];get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(e){this._dropListRef.disabled=this._disabled=e}constructor(e,o,r,s,a,d,u){this.element=e,this._changeDetectorRef=r,this._scrollDispatcher=s,this._dir=a,this._group=d,this._destroyed=new f.B,this.connectedTo=[],this.id="cdk-drop-list-"+qo++,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.dropped=new t.bkB,this.entered=new t.bkB,this.exited=new t.bkB,this.sorted=new t.bkB,this._unsortedItems=new Set,this._dropListRef=o.createDropList(e),this._dropListRef.data=this,u&&this._assignDefaults(u),this._dropListRef.enterPredicate=(m,p)=>this.enterPredicate(m.data,p.data),this._dropListRef.sortPredicate=(m,p,b)=>this.sortPredicate(m,p.data,b.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),i._dropLists.push(this),d&&d._items.add(this)}addItem(e){this._unsortedItems.add(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}removeItem(e){this._unsortedItems.delete(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}getSortedItems(){return Array.from(this._unsortedItems).sort((e,o)=>e._dragRef.getVisibleElement().compareDocumentPosition(o._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){const e=i._dropLists.indexOf(this);e>-1&&i._dropLists.splice(e,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(e){this._dir&&this._dir.change.pipe((0,A.Z)(this._dir.value),(0,g.Q)(this._destroyed)).subscribe(o=>e.withDirection(o)),e.beforeStarted.subscribe(()=>{const o=(0,U.FG)(this.connectedTo).map(r=>"string"==typeof r?i._dropLists.find(a=>a.id===r):r);if(this._group&&this._group._items.forEach(r=>{-1===o.indexOf(r)&&o.push(r)}),!this._scrollableParentsResolved){const r=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(s=>s.getElementRef().nativeElement);this._dropListRef.withScrollableParents(r),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){const r=this.element.nativeElement.querySelector(this.elementContainerSelector);e.withElementContainer(r)}e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.sortingDisabled=this.sortingDisabled,e.autoScrollDisabled=this.autoScrollDisabled,e.autoScrollStep=(0,U.OE)(this.autoScrollStep,2),e.connectedTo(o.filter(r=>r&&r!==this).map(r=>r._dropListRef)).withOrientation(this.orientation)})}_handleEvents(e){e.beforeStarted.subscribe(()=>{this._syncItemsWithRef(),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(o=>{this.entered.emit({container:this,item:o.item.data,currentIndex:o.currentIndex})}),e.exited.subscribe(o=>{this.exited.emit({container:this,item:o.item.data}),this._changeDetectorRef.markForCheck()}),e.sorted.subscribe(o=>{this.sorted.emit({previousIndex:o.previousIndex,currentIndex:o.currentIndex,container:this,item:o.item.data})}),e.dropped.subscribe(o=>{this.dropped.emit({previousIndex:o.previousIndex,currentIndex:o.currentIndex,previousContainer:o.previousContainer.data,container:o.container.data,item:o.item.data,isPointerOverContainer:o.isPointerOverContainer,distance:o.distance,dropPoint:o.dropPoint,event:o.event}),this._changeDetectorRef.markForCheck()}),(0,ut.h)(e.receivingStarted,e.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(e){const{lockAxis:o,draggingDisabled:r,sortingDisabled:s,listAutoScrollDisabled:a,listOrientation:d}=e;this.disabled=r??!1,this.sortingDisabled=s??!1,this.autoScrollDisabled=a??!1,this.orientation=d||"vertical",o&&(this.lockAxis=o)}_syncItemsWithRef(){this._dropListRef.withItems(this.getSortedItems().map(e=>e._dragRef))}static#i=this.\u0275fac=function(o){return new(o||i)(t.rXU(t.aKT),t.rXU(Fe),t.rXU(t.gRc),t.rXU(xt.R),t.rXU(se.dS,8),t.rXU(Ut,12),t.rXU(we,8))};static#e=this.\u0275dir=t.FsC({type:i,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(o,r){2&o&&(t.BMQ("id",r.id),t.AVh("cdk-drop-list-disabled",r.disabled)("cdk-drop-list-dragging",r._dropListRef.isDragging())("cdk-drop-list-receiving",r._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",t.L39],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",t.L39],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",t.L39],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],standalone:!0,features:[t.Jv_([{provide:Ut,useValue:void 0},{provide:Te,useExisting:i}]),t.GFd]})}return i})();var K=l(59115),Tt=l(44549),L=function(i){return i.CREATED="CREATED",i.IN_PROCESS="IN_PROCESS",i.COMPLETED="COMPLETED",i.CANCELLED="CANCELLED",i}(L||{});const qe=pt({providedIn:"root",protectedState:!1},gt({newOrders:[],inProcessOrders:[]}),ht(i=>({setProductionOrders(n){const e=n.filter(r=>r.status===L.CREATED),o=n.filter(r=>r.status===L.IN_PROCESS);G(i,{newOrders:e,inProcessOrders:o})},updateProductionOrderLists(n){if(n.status===L.CREATED){const e=i.inProcessOrders().filter(r=>r.id!==n.id),o=[...i.newOrders(),n];G(i,{newOrders:o,inProcessOrders:e})}else{const e=i.newOrders().filter(r=>r.id!==n.id),o=[...i.inProcessOrders(),n];G(i,{newOrders:e,inProcessOrders:o})}},removeProductionOrderFromProductionLine(n){const e=i.newOrders().filter(r=>r.id!==n),o=i.inProcessOrders().filter(r=>r.id!==n);G(i,{newOrders:e,inProcessOrders:o})}}))),Mo=v.J1`
    mutation UpdateProductionOrder($updateProductionOrderInput: UpdateProductionOrderInput!) {
        updateProductionOrder(updateProductionOrderInput: $updateProductionOrderInput) {
            ok
            message

            productionOrder {
                id
                no
                userId
                merchantId
                productionRequestId
                status
                completedDate
                comments
                createdAt
                request {
                    id
                    no
                    userId
                    merchantId
                    requestedBy
                    requestedDate
                    dueDate
                    status
                    priority
                    customerId
                    products {
                        productId
                        quantity
                        price
                        product {
                            name
                            price
                        }
                    }
                    completedDate
                    comments
                    merchant {
                        name
                    }
                    customer {
                        name
                        nit
                    }
                    user {
                        name
                        lastname1
                        lastname2
                        fullname
                    }
                }
            }
        }
    }
`,Ao=v.J1`
    mutation RemoveProductionOrder($productionOrderId: String!) {
        removeProductionOrder(id: $productionOrderId) {
            ok
            message
        }
    }
`,Bo=v.J1`
    query FindAllProductionOrders($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllProductionOrders(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            productionOrders {
                id
                no
                userId
                merchantId
                productionRequestId
                status
                completedDate
                comments
                createdAt
                request {
                    id
                    no
                    userId
                    merchantId
                    requestedBy
                    requestedDate
                    dueDate
                    status
                    priority
                    customerId
                    products {
                        productId
                        quantity
                        price
                        product {
                            name
                            price
                        }
                    }
                    completedDate
                    comments
                    merchant {
                        name
                    }
                    customer {
                        name
                        nit
                    }
                    user {
                        name
                        lastname1
                        lastname2
                        fullname
                    }
                }
            }
        }
    }
`,Yo=v.J1`
    query FindProductionOrdersForProductionLine {
        findProductionOrdersForProductionLine {
            ok
            message

            productionOrders {
                id
                no
                userId
                merchantId
                productionRequestId
                status
                completedDate
                comments
                createdAt
                request {
                    id
                    no
                    userId
                    merchantId
                    requestedBy
                    requestedDate
                    dueDate
                    status
                    priority
                    customerId
                    products {
                        productId
                        quantity
                        price
                        product {
                            name
                            price
                            thumbnail
                        }
                    }
                    completedDate
                    comments
                    merchant {
                        name
                    }
                    customer {
                        name
                        nit
                    }
                    user {
                        name
                        lastname1
                        lastname2
                        fullname
                    }
                }
            }
        }
    }
`,zo=(v.J1`
    query FindActiveProductionOrders($search: String!, $size: Int!) {
        findActiveProductionOrders(search: $search, size: $size) {
            ok
            message

            name {
                id
                name
            }
        }
    }
`,v.J1`
    query FindProductionOrderById($productionOrderId: String!) {
        findProductionOrderById(id: $productionOrderId) {
            ok
            message

            productionOrder {
                id
                no
                userId
                merchantId
                productionRequestId
                status
                completedDate
                comments
                createdAt
                request {
                    id
                    no
                    userId
                    merchantId
                    requestedBy
                    requestedDate
                    dueDate
                    status
                    priority
                    customerId
                    products {
                        productId
                        quantity
                        price
                        product {
                            name
                            price
                        }
                    }
                    completedDate
                    comments
                    merchant {
                        name
                    }
                    customer {
                        name
                        nit
                    }
                    user {
                        name
                        lastname1
                        lastname2
                        fullname
                    }
                }
            }
        }
    }
`),Vo=v.J1`
    mutation ChangeProductionOrderStatus($productionOrderId: String!, $status: ProductionOrderStatusEnum!) {
        changeProductionOrderStatus(id: $productionOrderId, status: $status) {
            ok
            message

            productionOrder {
                id
                no
                userId
                merchantId
                productionRequestId
                status
                completedDate
                comments
                createdAt
                request {
                    id
                    no
                    userId
                    merchantId
                    requestedBy
                    requestedDate
                    dueDate
                    status
                    priority
                    customerId
                    products {
                        productId
                        quantity
                        price
                        product {
                            name
                            price
                            thumbnail
                        }
                    }
                    completedDate
                    comments
                    merchant {
                        name
                    }
                    customer {
                        name
                        nit
                    }
                    user {
                        name
                        lastname1
                        lastname2
                        fullname
                    }
                }
            }
        }
    }
`,Xo=v.J1`
    mutation MarkProductionOrderAsCompleted($productionOrderId: String!) {
        markProductionOrderAsCompleted(id: $productionOrderId) {
            ok
            message

            productionOrder {
                id
                no
                userId
                merchantId
                productionRequestId
                status
                completedDate
                comments
                createdAt
                request {
                    id
                    no
                    userId
                    merchantId
                    requestedBy
                    requestedDate
                    dueDate
                    status
                    priority
                    customerId
                    products {
                        productId
                        quantity
                        price
                        product {
                            name
                            price
                        }
                    }
                    completedDate
                    comments
                    merchant {
                        name
                    }
                    customer {
                        name
                        nit
                    }
                    user {
                        name
                        lastname1
                        lastname2
                        fullname
                    }
                }
            }
        }
    }
`,Wt=pt({providedIn:"root",protectedState:!1},gt({pagination:null,productionOrder:null,productionOrders:[]}),ht(i=>({setProductionOrdersList(n,e){G(i,{productionOrders:n,pagination:e})},setProductionOrders(n){G(i,{productionOrders:n})},setProductionOrder(n){G(i,{productionOrder:n})}})),Kt(({productionOrders:i})=>({count:(0,t.EWP)(()=>i().length),newOrders:(0,t.EWP)(()=>i().filter(n=>n.status===L.CREATED).length),inProcessOrders:(0,t.EWP)(()=>i().filter(n=>n.status===L.IN_PROCESS).length),completedOrders:(0,t.EWP)(()=>i().filter(n=>n.status===L.COMPLETED).length),canceledOrders:(0,t.EWP)(()=>i().filter(n=>n.status===L.CANCELLED).length)})));let $t=(()=>{class i{#t;#i=(0,t.WQX)(v.Ic);#e=(0,t.WQX)(Wt);#o=(0,t.WQX)(qe);constructor(){this.#t=this.#i.use(Ct.c.GRAPHQL_PROVIDER)}findAllProductionOrders(e=0,o=20,r="name",s="asc",a=""){return this.#t.query({query:Bo,errorPolicy:"all",variables:{page:e,size:o,sort:r,order:s,search:a}}).pipe((0,D.M)(({data:d})=>{this.#e.setProductionOrdersList(d.findAllProductionOrders.productionOrders,d.findAllProductionOrders.pagination)}))}findProductionOrdersForProductionLine(){return this.#t.query({query:Yo,errorPolicy:"all"}).pipe((0,D.M)(({data:e})=>{this.#o.setProductionOrders(e.findProductionOrdersForProductionLine.productionOrders)}))}findProductionOrderById(e){return this.#t.query({query:zo,variables:{productionOrderId:e},errorPolicy:"all"}).pipe((0,D.M)(({data:o})=>{this.#e.setProductionOrder(o.findProductionOrderById.productionOrder)}))}updateProductionOrder(e){return this.#t.mutate({mutation:Mo,variables:{updateProductionOrderInput:e},errorPolicy:"all"}).pipe((0,D.M)(({data:o})=>{const r=structuredClone(this.#e.productionOrders()),s=r.findIndex(a=>a.id===e.id);r[s]=o.updateProductionOrder.productionOrder,this.#e.setProductionOrders(r)}))}removeProductionOrder(e){return this.#t.mutate({mutation:Ao,variables:{productionOrderId:e},errorPolicy:"all"}).pipe((0,D.M)(()=>{const o=structuredClone(this.#e.productionOrders()),r=o.findIndex(s=>s.id===e);o.splice(r,1),this.#e.setProductionOrders(o)}))}changeProductionOrderStatus(e,o){return this.#t.mutate({mutation:Vo,variables:{productionOrderId:e,status:o},errorPolicy:"all"}).pipe((0,D.M)(({errors:s})=>{if(s)return;const a=structuredClone(this.#e.productionOrders());if(a.length){const d=a.findIndex(u=>u.id===e);a[d].status=o,this.#e.setProductionOrders(a)}}))}markProductionOrderAsCompleted(e){return this.#t.mutate({mutation:Xo,variables:{productionOrderId:e},errorPolicy:"all"}).pipe((0,D.M)(({errors:r})=>{r||this.#o.removeProductionOrderFromProductionLine(e)}))}static#n=this.\u0275fac=function(o){return new(o||i)};static#r=this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Qo=l(31849);const Uo=(i,n)=>n.productId;function Wo(i,n){if(1&i&&(t.j41(0,"div",4),t.nrm(1,"img",7),t.j41(2,"div",8)(3,"div",9),t.EFF(4),t.k0s(),t.j41(5,"div",10),t.EFF(6),t.k0s()()()),2&i){const e=n.$implicit;t.R7$(),t.Y8G("src",e.product.thumbnail,t.B4B),t.R7$(3),t.SpI(" ",e.product.name," "),t.R7$(2),t.SpI(" Cantidad: ",e.quantity," ")}}let Jo=(()=>{class i{constructor(e){this.data=e,this.productionOrder=e.productionOrder}static#t=this.\u0275fac=function(o){return new(o||i)(t.rXU(_.Vh))};static#i=this.\u0275cmp=t.VBU({type:i,selectors:[["production-line-order-products-dialog"]],standalone:!0,features:[t.aNF],decls:10,vars:2,consts:[[1,"flex","w-full","flex-col","px-8","pb-4","pt-6"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-semibold","leading-tight"],[1,"py-5","flex","flex-col"],[1,"flex","items-center"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black/10"],["mat-stroked-button","",3,"matDialogClose"],["alt","Product image",1,"mr-4","h-14","w-14","rounded","object-cover",3,"src"],[1,"flex","min-w-0","flex-col"],[1,"font-medium","leading-none","text-lg"],[1,"mt-1","truncate","text-lg","leading-none"]],template:function(o,r){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3),t.k0s()(),t.j41(4,"div",3),t.Z7z(5,Wo,7,3,"div",4,Uo),t.k0s(),t.j41(7,"div",5)(8,"button",6),t.EFF(9," Cerrar "),t.k0s()()()),2&o&&(t.R7$(3),t.SpI(" Productos de la orden: ",r.productionOrder.no," "),t.R7$(2),t.Dyx(r.productionOrder.request.products),t.R7$(3),t.Y8G("matDialogClose","cancelled"))},dependencies:[P.Hl,P.$z,_.tx,x.m_],encapsulation:2,changeDetection:0})}return i})();const Ne=(i,n)=>n.id,Ge=(i,n,e)=>({"bg-cyan-700 text-cyan-50":i,"bg-blue-700 text-blue-50":n,"bg-red-700 text-red-50":e}),Le=i=>({"text-red-600":i});function Ho(i,n){if(1&i&&(t.j41(0,"div",23),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.SpI(" ",e.request.comments," ")}}function Zo(i,n){if(1&i){const e=t.RV6();t.j41(0,"fuse-card",17)(1,"div",20)(2,"h2",21),t.EFF(3),t.k0s(),t.j41(4,"div")(5,"span",22),t.EFF(6),t.k0s()()(),t.DNE(7,Ho,2,1,"div",23),t.nrm(8,"hr",24),t.j41(9,"div",25)(10,"div",26),t.nrm(11,"mat-icon",27),t.j41(12,"span",28),t.EFF(13),t.k0s()(),t.j41(14,"div",29),t.nrm(15,"mat-icon",27),t.j41(16,"span",28),t.EFF(17),t.k0s()(),t.j41(18,"div",30),t.nrm(19,"mat-icon",27),t.j41(20,"span",28),t.EFF(21),t.nI1(22,"date"),t.k0s()(),t.j41(23,"div",31),t.nrm(24,"mat-icon",27),t.j41(25,"span",32),t.EFF(26),t.nI1(27,"date"),t.k0s()()(),t.j41(28,"div",33)(29,"button",34),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.openProductsDialog(r))}),t.EFF(30," Ver Productos "),t.k0s(),t.j41(31,"button",35),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.generateProductionOrderDocument(r))}),t.nrm(32,"mat-icon",14),t.j41(33,"span",36),t.EFF(34,"Ver Documento"),t.k0s()()()()}if(2&i){const e=n.$implicit,o=t.XpG();t.R7$(3),t.JRh(e.no),t.R7$(2),t.Y8G("ngClass",t.sMw(21,Ge,"LOW"===e.request.priority,"NORMAL"===e.request.priority,"HIGH"===e.request.priority)),t.R7$(),t.SpI(" ",e.request.priority," "),t.R7$(),t.vxM(e.request.comments?7:-1),t.R7$(4),t.Y8G("svgIcon","mat_solid:person"),t.R7$(2),t.JRh(e.request.requestedBy),t.R7$(2),t.Y8G("svgIcon","mat_solid:business_center"),t.R7$(2),t.JRh(e.request.customer.name),t.R7$(2),t.Y8G("svgIcon","mat_solid:event"),t.R7$(2),t.JRh(t.i5U(22,15,e.request.requestedDate,"dd/MM/yyyy")),t.R7$(3),t.Y8G("svgIcon","mat_solid:schedule"),t.R7$(),t.Y8G("ngClass",t.eq3(25,Le,o.isOverdue(e.request.dueDate))),t.R7$(),t.JRh(t.i5U(27,18,e.request.dueDate,"dd/MM/yyyy")),t.R7$(3),t.Y8G("color","primary"),t.R7$(3),t.Y8G("svgIcon","mat_solid:task")}}function Ko(i,n){if(1&i&&(t.j41(0,"div",23),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.SpI(" ",e.request.comments," ")}}function tn(i,n){if(1&i){const e=t.RV6();t.j41(0,"fuse-card",17)(1,"div",20)(2,"h2",21),t.EFF(3),t.k0s(),t.j41(4,"div")(5,"span",22),t.EFF(6),t.k0s()()(),t.DNE(7,Ko,2,1,"div",23),t.nrm(8,"hr",24),t.j41(9,"div",25)(10,"div",26),t.nrm(11,"mat-icon",27),t.j41(12,"span",28),t.EFF(13),t.k0s()(),t.j41(14,"div",29),t.nrm(15,"mat-icon",27),t.j41(16,"span",28),t.EFF(17),t.k0s()(),t.j41(18,"div",30),t.nrm(19,"mat-icon",27),t.j41(20,"span",28),t.EFF(21),t.nI1(22,"date"),t.k0s()(),t.j41(23,"div",31),t.nrm(24,"mat-icon",27),t.j41(25,"span",32),t.EFF(26),t.nI1(27,"date"),t.k0s()()(),t.j41(28,"div",37)(29,"button",38),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.openProductsDialog(r))}),t.EFF(30," Ver Productos "),t.k0s(),t.j41(31,"button",35),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.generateProductionOrderDocument(r))}),t.nrm(32,"mat-icon",14),t.j41(33,"span",36),t.EFF(34,"Ver Documento"),t.k0s()(),t.j41(35,"button",35),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.markProductionOrderAsCompleted(r))}),t.nrm(36,"mat-icon",14),t.j41(37,"span",36),t.EFF(38,"Completada"),t.k0s()()()()}if(2&i){const e=n.$implicit,o=t.XpG();t.R7$(3),t.JRh(e.no),t.R7$(2),t.Y8G("ngClass",t.sMw(22,Ge,"LOW"===e.request.priority,"NORMAL"===e.request.priority,"HIGH"===e.request.priority)),t.R7$(),t.SpI(" ",e.request.priority," "),t.R7$(),t.vxM(e.request.comments?7:-1),t.R7$(4),t.Y8G("svgIcon","mat_solid:person"),t.R7$(2),t.JRh(e.request.requestedBy),t.R7$(2),t.Y8G("svgIcon","mat_solid:business_center"),t.R7$(2),t.JRh(e.request.customer.name),t.R7$(2),t.Y8G("svgIcon","mat_solid:event"),t.R7$(2),t.JRh(t.i5U(22,16,e.request.requestedDate,"dd/MM/yyyy")),t.R7$(3),t.Y8G("svgIcon","mat_solid:schedule"),t.R7$(),t.Y8G("ngClass",t.eq3(26,Le,o.isOverdue(e.request.dueDate))),t.R7$(),t.JRh(t.i5U(27,19,e.request.dueDate,"dd/MM/yyyy")),t.R7$(3),t.Y8G("color","primary"),t.R7$(3),t.Y8G("svgIcon","mat_solid:task"),t.R7$(4),t.Y8G("svgIcon","mat_solid:check_circle")}}let en=(()=>{class i{constructor(){this.ProductionOrderStatusEnum=L,this.productionLineStore=(0,t.WQX)(qe),this.user=null,this.#t=65536,this.#i=500*this.#t,this.#e=(0,t.WQX)(t.gRc),this.#o=(0,t.WQX)(t.abz),this.#n=(0,t.WQX)(_.bZ),this.#r=(0,t.WQX)(St.Q),this.#s=(0,t.WQX)(c.ok),this.#a=(0,t.WQX)(ot.G),this.#c=(0,t.WQX)($t),this.#d=(0,t.WQX)(X.UG),this.#l=(0,t.WQX)(it.il),this.#u=new f.B}#t;#i;#e;#o;#n;#r;#s;#a;#c;#d;#l;#u;ngOnInit(){this.#l.select(Et.SW).pipe((0,C.pQ)(this.#o)).subscribe(e=>{this.user=e,this.#e.markForCheck()})}ngOnDestroy(){this.#u.next(null),this.#u.complete()}generateProductionOrderDocument(e){this.#r.generateProductionOrderDocument(e,this.user)}markProductionOrderAsCompleted(e){this.#a.open({title:"Cuidado",message:"\xbfEst\xe1 seguro que desea marcar la orden de producci\xf3n como completada?",icon:{show:!0,name:"mat_solid:question_mark",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,C.pQ)(this.#o)).subscribe(r=>{"confirmed"===r&&this.#c.markProductionOrderAsCompleted(e.id).pipe((0,C.pQ)(this.#o)).subscribe(({data:s})=>{s&&(this.#d.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.changeProductionOrderStatus.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#e.markForCheck())})})}cardDropped(e){e.previousContainer===e.container?Qt(e.container.data,e.previousIndex,e.currentIndex):(function Fo(i,n,e,o){const r=bt(e,i.length-1),s=bt(o,n.length);i.length&&n.splice(s,0,i.splice(r,1)[0])}(e.previousContainer.data,e.container.data,e.previousIndex,e.currentIndex),e.container.data[e.currentIndex].status=e.container.id,this.#c.changeProductionOrderStatus(e.container.data[e.currentIndex].id,e.container.id).pipe((0,C.pQ)(this.#o)).subscribe(({data:r})=>{r&&(this.#d.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:r.changeProductionOrderStatus.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#e.markForCheck())})),this.#m(e)}isOverdue(e){return Tt.c9.fromJSDate(e).startOf("day")<Tt.c9.now().startOf("day")}openProductsDialog(e){this.#n.open(Jo,{data:{productionOrder:e},panelClass:"ath-dialog-panel",disableClose:!0})}#m(e){let o=e.container.data;const r=o[e.currentIndex],s=o[e.currentIndex-1]||null,a=o[e.currentIndex+1]||null;return r.position=s?a?(s.position+a.position)/2:s.position+this.#t:a?a.position/2:this.#t,!Number.isInteger(r.position)||r.position>=this.#i?(o=o.map((d,u)=>(d.position=(u+1)*this.#t,d)),o):[r]}static#p=this.\u0275fac=function(o){return new(o||i)};static#h=this.\u0275cmp=t.VBU({type:i,selectors:[["production-line"]],standalone:!0,features:[t.aNF],decls:37,vars:11,consts:[[1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-hidden"],[1,"bg-card","flex","flex-0","flex-col","border-b","p-6","dark:bg-transparent","sm:flex-row","sm:items-center","sm:justify-between","sm:px-10","sm:py-8"],[1,"min-w-0","flex-1"],[1,"truncate","text-3xl","font-extrabold","leading-7","tracking-tight","sm:leading-10","md:text-4xl"],["cdkScrollable","",1,"flex-auto","overflow-y-auto","p-6","sm:p-8","sm:pt-4"],["cdkDropList","",1,"flex",3,"cdkDropListOrientation"],["cdkDropListGroup","",1,"flex","items-start","w-full"],["cdkDrag","",1,"bg-default","w-72","md:w-1/2","flex-0","rounded-2xl","p-2",3,"cdkDragLockAxis"],["cdkDragHandle","",1,"flex","items-center","justify-between"],[1,"flex","w-full","items-center","rounded-md","px-3"],[1,"text-lg","font-medium"],[1,"text-secondary","ml-4","flex","min-w-6","items-center","justify-center","rounded-full","bg-gray-300","text-sm","font-semibold","leading-6","dark:bg-gray-700"],[1,"ml-1"],["mat-icon-button","",1,"h-8","min-h-8","w-8"],[1,"icon-size-5",3,"svgIcon"],[1,"mt-2","rounded-xl","bg-gray-400","bg-opacity-12","dark:border","dark:bg-transparent"],["cdkDropList","",1,"p-3",3,"cdkDropListDropped","id","cdkDropListData"],["cdkDrag","",1,"filter-info","flex","w-full","cursor-pointer","flex-col","p-8"],["mat-icon-button","",1,"size-8","min-h-8"],[1,"pointer-events-none","invisible","absolute","h-0","w-0","opacity-0"],[1,"flex","flex-row","space-x-3"],["matTooltip","N\xfamero de Orden de producci\xf3n",1,"text-2xl","font-semibold","leading-tight"],[1,"mx-1","mb-2","rounded-full","px-3","py-0.5","text-sm","font-medium","w-auto",3,"ngClass"],[1,"mt-4"],[1,"my-6","w-full","border-t"],[1,"flex","flex-col","space-y-4"],["matTooltip","Solicitado por:",1,"flex","items-center"],[1,"mr-3","icon-size-5",3,"svgIcon"],[1,"leading-none"],["matTooltip","Cliente",1,"flex","items-center"],["matTooltip","Fecha de la Solicitud",1,"flex","items-center"],["matTooltip","Fecha de la Entrega",1,"flex","items-center"],[1,"leading-none",3,"ngClass"],[1,"mx-3","mt-8","flex","items-center","sm:mx-5","gap-2"],["mat-flat-button","",1,"px-6",3,"click","color"],["mat-button","",1,"mr-1","px-3",3,"click"],[1,"ml-2"],[1,"mt-8","flex","items-center","gap-3"],["mat-flat-button","",1,"px-3",3,"click","color"]],template:function(o,r){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),t.EFF(4," L\xednea de producci\xf3n "),t.k0s()()(),t.j41(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"h3",10),t.EFF(12,"\xd3rdenes Nuevas"),t.k0s()(),t.j41(13,"div",11),t.EFF(14),t.k0s(),t.j41(15,"div",12)(16,"button",13),t.nrm(17,"mat-icon",14),t.k0s()()(),t.j41(18,"div",15)(19,"div",16),t.bIt("cdkDropListDropped",function(a){return r.cardDropped(a)}),t.Z7z(20,Zo,35,27,"fuse-card",17,Ne),t.k0s()()(),t.j41(22,"div",7)(23,"div",8)(24,"div",9)(25,"h3",10),t.EFF(26,"\xd3rdenes en Proceso"),t.k0s()(),t.j41(27,"div",11),t.EFF(28),t.k0s(),t.j41(29,"button",18),t.nrm(30,"mat-icon",14),t.k0s()(),t.j41(31,"div",15)(32,"div",16),t.bIt("cdkDropListDropped",function(a){return r.cardDropped(a)}),t.Z7z(33,tn,39,28,"fuse-card",17,Ne),t.k0s()()()()()()(),t.j41(35,"div",19),t.nrm(36,"router-outlet"),t.k0s()),2&o&&(t.R7$(6),t.Y8G("cdkDropListOrientation","horizontal"),t.R7$(2),t.Y8G("cdkDragLockAxis","x"),t.R7$(6),t.SpI(" ",r.productionLineStore.newOrders().length," "),t.R7$(3),t.Y8G("svgIcon","mat_solid:more_vert"),t.R7$(2),t.Y8G("id",r.ProductionOrderStatusEnum.CREATED)("cdkDropListData",r.productionLineStore.newOrders()),t.R7$(),t.Dyx(r.productionLineStore.newOrders()),t.R7$(2),t.Y8G("cdkDragLockAxis","x"),t.R7$(6),t.SpI(" ",r.productionLineStore.inProcessOrders().length," "),t.R7$(2),t.Y8G("svgIcon","mat_solid:more_vert"),t.R7$(2),t.Y8G("id",r.ProductionOrderStatusEnum.IN_PROCESS)("cdkDropListData",r.productionLineStore.inProcessOrders()),t.R7$(),t.Dyx(r.productionLineStore.inProcessOrders()))},dependencies:[$e,ke,je,Oe,xt.uv,R.vh,Qo.$,P.Hl,P.$z,P.iY,x.m_,x.An,K.Cn,Z.uc,Z.oV,R.YU,E.n3],encapsulation:2,changeDetection:0})}return i})();const on=(i,n)=>n.id,nn=i=>({"pointer-events-none":i}),rn=()=>[5,10,25,100],sn=(i,n,e,o)=>({"bg-amber-700 text-amber-50":i,"bg-blue-700 text-blue-50":n,"bg-green-700 text-green-50":e,"bg-red-700 text-red-50":o});function an(i,n){1&i&&t.nrm(0,"mat-icon",39),2&i&&t.Y8G("svgIcon","mat_solid:done")}function cn(i,n){1&i&&t.nrm(0,"mat-icon",39),2&i&&t.Y8G("svgIcon","mat_solid:done")}function dn(i,n){1&i&&t.nrm(0,"mat-icon",39),2&i&&t.Y8G("svgIcon","mat_solid:done")}function ln(i,n){1&i&&t.nrm(0,"mat-icon",39),2&i&&t.Y8G("svgIcon","mat_solid:done")}function un(i,n){if(1&i){const e=t.RV6();t.j41(0,"div",28)(1,"div",30),t.nrm(2,"mat-icon",31),t.j41(3,"div",32),t.EFF(4),t.nI1(5,"date"),t.k0s()(),t.j41(6,"div",33),t.EFF(7),t.k0s(),t.j41(8,"div",34),t.nrm(9,"mat-icon",31),t.j41(10,"div",33),t.EFF(11),t.k0s()(),t.j41(12,"div",34),t.nrm(13,"mat-icon",31),t.j41(14,"div",33),t.EFF(15),t.nI1(16,"date"),t.k0s()(),t.j41(17,"div",34),t.nrm(18,"mat-icon",31),t.j41(19,"div",33),t.EFF(20),t.nI1(21,"date"),t.k0s()(),t.j41(22,"div",35)(23,"span",36),t.EFF(24),t.k0s()(),t.j41(25,"div",37)(26,"div")(27,"button",38),t.nrm(28,"mat-icon",39),t.k0s(),t.j41(29,"mat-menu",null,0)(31,"div",40),t.EFF(32," Actualizar Estado "),t.k0s(),t.j41(33,"button",41),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.changeProductionOrderStatus(r,s.ProductionOrderStatusEnum.CREATED))}),t.DNE(34,an,1,1,"mat-icon",39),t.j41(35,"span",42),t.EFF(36,"Creada"),t.k0s()(),t.j41(37,"button",41),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.changeProductionOrderStatus(r,s.ProductionOrderStatusEnum.IN_PROCESS))}),t.DNE(38,cn,1,1,"mat-icon",39),t.j41(39,"span",42),t.EFF(40,"En Producci\xf3n"),t.k0s()(),t.j41(41,"button",41),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.changeProductionOrderStatus(r,s.ProductionOrderStatusEnum.COMPLETED))}),t.DNE(42,dn,1,1,"mat-icon",39),t.j41(43,"span",42),t.EFF(44,"Completada"),t.k0s()(),t.j41(45,"button",41),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.changeProductionOrderStatus(r,s.ProductionOrderStatusEnum.CANCELLED))}),t.DNE(46,ln,1,1,"mat-icon",39),t.j41(47,"span",42),t.EFF(48,"Cancelada"),t.k0s()()()(),t.j41(49,"button",43),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.generateProductionOrderDocument(r))}),t.nrm(50,"mat-icon",39),t.k0s()()()}if(2&i){const e=n.$implicit,o=t.sdS(30),r=t.XpG(2);t.R7$(2),t.Y8G("svgIcon","mat_solid:date_range"),t.R7$(2),t.SpI(" ",t.i5U(5,22,e.createdAt,"dd/MM/yyyy")," "),t.R7$(3),t.SpI(" ",e.no," "),t.R7$(2),t.Y8G("svgIcon","mat_solid:person"),t.R7$(2),t.SpI(" ",e.request.requestedBy," "),t.R7$(2),t.Y8G("svgIcon","mat_solid:date_range"),t.R7$(2),t.SpI(" ",t.i5U(16,25,e.request.dueDate,"dd/MM/yyyy")," "),t.R7$(3),t.Y8G("svgIcon","mat_solid:date_range"),t.R7$(2),t.SpI(" ",t.i5U(21,28,e.completedDate,"dd/MM/yyyy")," "),t.R7$(3),t.Y8G("ngClass",t.ziG(31,sn,"CREATED"===e.status,"IN_PROCESS"===e.status,"COMPLETED"===e.status,"CANCELLED"===e.status)),t.R7$(),t.SpI(" ",r.translateStatus(e.status)," "),t.R7$(3),t.Y8G("matMenuTriggerFor",o),t.R7$(),t.Y8G("svgIcon","mat_solid:update"),t.R7$(5),t.Y8G("disabled",e.status.includes("CREATED")||e.status.includes("IN_PROCESS")||e.status.includes("COMPLETED")),t.R7$(),t.vxM(e.status.includes("PENDING")?34:-1),t.R7$(3),t.Y8G("disabled",e.status.includes("CANCELLED")||e.status.includes("COMPLETED")),t.R7$(),t.vxM(e.status.includes("IN_PROCESS")?38:-1),t.R7$(3),t.Y8G("disabled",e.status.includes("COMPLETED")||e.status.includes("CANCELLED")||e.status.includes("REJECTED")),t.R7$(),t.vxM(e.status.includes("COMPLETED")?42:-1),t.R7$(3),t.Y8G("disabled",e.status.includes("COMPLETED")||e.status.includes("CANCELLED")||e.status.includes("REJECTED")),t.R7$(),t.vxM(e.status.includes("CANCELLED")?46:-1),t.R7$(4),t.Y8G("svgIcon","mat_solid:description")}}function mn(i,n){if(1&i&&(t.j41(0,"div",22)(1,"div",23)(2,"div",24),t.EFF(3," Fecha de la Orden "),t.k0s(),t.j41(4,"div",25),t.EFF(5," N\xba "),t.k0s(),t.j41(6,"div",26),t.EFF(7," Solicitado por "),t.k0s(),t.j41(8,"div",24),t.EFF(9," Fecha de Entrega "),t.k0s(),t.j41(10,"div",24),t.EFF(11," Fecha de Completada "),t.k0s(),t.j41(12,"div",24),t.EFF(13," Estado "),t.k0s(),t.j41(14,"div",27),t.EFF(15,"Acciones"),t.k0s()(),t.Z7z(16,un,51,36,"div",28,on),t.k0s(),t.nrm(18,"mat-paginator",29)),2&i){const e=t.XpG();t.R7$(2),t.Y8G("mat-sort-header","OrderedDate"),t.R7$(2),t.Y8G("mat-sort-header","no"),t.R7$(4),t.Y8G("mat-sort-header","dueDate"),t.R7$(2),t.Y8G("mat-sort-header","priority"),t.R7$(2),t.Y8G("mat-sort-header","status"),t.R7$(4),t.Dyx(e.productionOrdersStore.productionOrders()),t.R7$(2),t.Y8G("ngClass",t.eq3(11,nn,e.isLoading))("length",e.productionOrdersStore.pagination().length)("pageIndex",e.productionOrdersStore.pagination().page)("pageSize",e.productionOrdersStore.pagination().size)("pageSizeOptions",t.lJ4(13,rn))("showFirstLastButtons",!0)}}function pn(i,n){1&i&&(t.j41(0,"div",21),t.EFF(1," \xa1No se ha registrado ninguna solicitud! "),t.k0s())}let hn=(()=>{class i{constructor(){this.isLoading=!1,this.paginator=(0,t.ebz)(q.iy),this.productionOrdersStore=(0,t.WQX)(Wt),this.ProductionOrderStatusEnum=L,this.searchInputControl=new c.MJ,this.selectedSlide=null,this.sort=(0,t.ebz)(S.B4),this.user=null,this.#t=(0,t.WQX)(t.gRc),this.#i=(0,t.WQX)(t.abz),this.#e=(0,t.WQX)(St.Q),this.#o=(0,t.WQX)(ot.G),this.#n=(0,t.WQX)($t),this.#r=(0,t.WQX)(X.UG),this.#s=(0,t.WQX)(it.il),this.#a=new f.B}#t;#i;#e;#o;#n;#r;#s;#a;ngOnInit(){this.searchInputControl.valueChanges.pipe((0,g.Q)(this.#a),(0,dt.B)(300),(0,st.n)(e=>(this.isLoading=!0,this.#n.findAllProductionOrders(this.productionOrdersStore.pagination().page,this.productionOrdersStore.pagination().size,this.sort().active,this.sort().direction,e))),(0,k.T)(()=>{this.isLoading=!1})).subscribe(),this.#s.select(Et.SW).pipe((0,C.pQ)(this.#i)).subscribe(e=>{this.user=e,this.#t.markForCheck()})}ngAfterViewInit(){this.sort()&&this.paginator()&&(this.sort().sort({id:"name",start:"asc",disableClear:!0}),this.#t.markForCheck(),this.sort().sortChange.pipe((0,C.pQ)(this.#i)).subscribe(()=>{this.paginator().pageIndex=0}),(0,ut.h)(this.sort().sortChange,this.paginator().page).pipe((0,st.n)(()=>(this.isLoading=!0,this.#n.findAllProductionOrders(this.paginator().pageIndex,this.paginator().pageSize,this.sort().active,this.sort().direction))),(0,k.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this.#a.next(null),this.#a.complete()}deleteProductionOrder(e){this.#o.open({title:"Cuidado",message:`\xbfEst\xe1 seguro que desea eliminar la orden de producci\xf3n: ${e.no}?`,icon:{show:!0,name:"mat_solid:question_mark",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,C.pQ)(this.#i)).subscribe(r=>{"confirmed"===r&&this.#n.removeProductionOrder(e.id).pipe((0,C.pQ)(this.#i)).subscribe(({data:s})=>{s&&(this.#r.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.removeProductionOrder.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#t.markForCheck())})})}translateStatus(e){switch(e){case L.CREATED:return"Creada";case L.IN_PROCESS:return"En proceso";case L.COMPLETED:return"Completada"}}generateProductionOrderDocument(e){this.#e.generateProductionOrderDocument(e,this.user)}changeProductionOrderStatus(e,o){this.#o.open({title:"Cuidado",message:`\xbfEst\xe1 seguro que desea actualizar el estado la orden de producci\xf3n: ${e.no}?`,icon:{show:!0,name:"mat_solid:question_mark",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,C.pQ)(this.#i)).subscribe(s=>{"confirmed"===s&&this.#n.changeProductionOrderStatus(e.id,o).pipe((0,C.pQ)(this.#i)).subscribe(({data:a})=>{a&&(this.#r.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.changeProductionOrderStatus.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#t.markForCheck())})})}static#c=this.\u0275fac=function(o){return new(o||i)};static#d=this.\u0275cmp=t.VBU({type:i,selectors:[["production-orders"]],viewQuery:function(o,r){1&o&&(t.wEZ(r.paginator,q.iy,5),t.wEZ(r.sort,S.B4,5)),2&o&&t.NyB(2)},standalone:!0,features:[t.aNF],decls:30,vars:9,consts:[["listStatusMenu","matMenu"],[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","md:flex-row","flex-0","md:items-center","md:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-3","text-secondary",3,"svgIcon"],["routerLink","/modules/production/dashboard",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","md:mt-0","md:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","","routerLink","new",1,"mt-4","text-white","sm:mt-0","bg-gradient-to-r","from-primary-500","to-primary-600","hover:to-primary-900","hover:shadow-lg"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","production-orders-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"flex","items-center","justify-center",3,"mat-sort-header"],[1,"flex","items-center","justify-start",3,"mat-sort-header"],[1,"flex","items-center","justify-center"],[1,"text-center"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","production-orders-grid","md:px-8"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"flex","items-center"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-2","truncate"],[1,"truncate"],[1,"flex","flex-row","justify-center","space-x-1"],[1,"flex","justify-center","mr-3","text-center"],[1,"px-2","py-1","text-xs","font-semibold","text-white","rounded-full","uppercase",3,"ngClass"],[1,"flex","flex-row","justify-center","gap-2"],["mat-stroked-button","","matTooltip","Actualizar Estado",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matMenuTriggerFor"],[1,"icon-size-5",3,"svgIcon"],[1,"w-full","p-2","text-lg","font-semibold","text-center","text-secondary"],["mat-menu-item","",1,"",3,"click","disabled"],[1,"ml-1","text-center"],["mat-stroked-button","","matTooltip","Ver Documento",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"]],template:function(o,r){1&o&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div")(5,"a",5),t.EFF(6,"Inicio"),t.k0s()(),t.j41(7,"div",6),t.nrm(8,"mat-icon",7),t.j41(9,"a",8),t.EFF(10,"Producci\xf3n"),t.k0s()(),t.j41(11,"div",6),t.nrm(12,"mat-icon",7),t.j41(13,"a",9),t.EFF(14,"\xd3rdenes de Producci\xf3n"),t.k0s()()(),t.j41(15,"div",10)(16,"h2",11),t.EFF(17," Registro \xd3rdenes de Producci\xf3n "),t.k0s()()(),t.j41(18,"div",12)(19,"mat-form-field",13),t.nrm(20,"mat-icon",14)(21,"input",15),t.k0s(),t.j41(22,"button",16),t.nrm(23,"mat-icon",17),t.j41(24,"span",18),t.EFF(25,"Agregar"),t.k0s()()()(),t.j41(26,"div",19)(27,"div",20),t.DNE(28,mn,19,14)(29,pn,2,0,"div",21),t.k0s()()()),2&o&&(t.R7$(8),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(7),t.Y8G("subscriptSizing","dynamic"),t.R7$(),t.Y8G("svgIcon","mat_solid:search"),t.R7$(),t.Y8G("formControl",r.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),t.R7$(2),t.Y8G("svgIcon","mat_solid:add"),t.R7$(5),t.vxM(r.productionOrdersStore.productionOrders().length>0?28:29))},dependencies:[R.vh,P.Hl,P.$z,h.RG,h.rl,h.JW,x.m_,x.An,T.fS,T.fg,q.Ou,q.iy,nt.D6,rt.mV,S.NQ,S.B4,S.aE,Z.uc,Z.oV,K.Cn,K.kk,K.fb,K.Cp,R.YU,c.X1,c.me,c.BC,c.l_,E.Wk],styles:[".production-orders-grid{grid-template-columns:150px 100px auto 150px 100px 100px 250px}\n"],encapsulation:2,changeDetection:0})}return i})();const Me=(i,n)=>(0,t.WQX)($t).findAllProductionOrders();var W=l(25084),O=l(9159),Ot=l(96850),j=function(i){return i.PENDING="PENDING",i.REJECTED="REJECTED",i.APPROVED="APPROVED",i.IN_PRODUCTION="IN_PRODUCTION",i.COMPLETED="COMPLETED",i.CANCELLED="CANCELLED",i}(j||{}),Dt=function(i){return i.LOW="LOW",i.NORMAL="NORMAL",i.HIGH="HIGH",i}(Dt||{});const jt=pt({providedIn:"root",protectedState:!1},gt({pagination:null,productionRequest:null,productionRequests:[]}),ht(i=>({setProductionRequestsList(n,e){G(i,{productionRequests:n,pagination:e})},setProductionRequests(n){G(i,{productionRequests:n})},setProductionRequest(n){G(i,{productionRequest:n})}})),Kt(({productionRequests:i})=>({count:(0,t.EWP)(()=>i().length),newRequests:(0,t.EWP)(()=>i().filter(n=>n.status===j.PENDING).length),approvedRequests:(0,t.EWP)(()=>i().filter(n=>n.status===j.APPROVED).length),inProcessRequests:(0,t.EWP)(()=>i().filter(n=>n.status===j.IN_PRODUCTION).length),completedRequests:(0,t.EWP)(()=>i().filter(n=>n.status===j.COMPLETED).length),canceledRequests:(0,t.EWP)(()=>i().filter(n=>n.status===j.CANCELLED).length),rejectedRequests:(0,t.EWP)(()=>i().filter(n=>n.status===j.REJECTED).length)})));var fn=l(53159);const Ae=pt({providedIn:"root",protectedState:!1},gt({productionPreferences:null}),ht(i=>({setProductionPreference(n){G(i,{productionPreferences:n})}}))),_n=v.J1`
    mutation CreateProductionPreferences($createProductionPreferencesInput: CreateProductionPreferencesInput!) {
        createProductionPreferences(createProductionPreferencesInput: $createProductionPreferencesInput) {

            ok
            message

            productionPreferences {
                id
                productionMaterialsDepotId
                productionMaterialsReservedDepotId
                productionFinishedDepotId
            }

        }
    }
`,vn=v.J1`
    mutation UpdateProductionPreferences($updateProductionPreferencesInput: UpdateProductionPreferencesInput!) {
        updateProductionPreferences(updateProductionPreferencesInput: $updateProductionPreferencesInput) {
            ok
            message

            productionPreferences {
                id
                productionMaterialsDepotId
                productionMaterialsReservedDepotId
                productionFinishedDepotId
            }
        }
    }
`,bn=v.J1`
    query FindProductionPreferencesByMerchant {
        findProductionPreferencesByMerchant {
            ok
            message

            productionPreferences {
                id
                productionMaterialsDepotId
                productionMaterialsReservedDepotId
                productionFinishedDepotId
            }
        }
    }
`;let Be=(()=>{class i{#t;#i=(0,t.WQX)(v.Ic);#e=(0,t.WQX)(Ae);constructor(){this.#t=this.#i.use(Ct.c.GRAPHQL_PROVIDER)}createProductionPreferences(e){return this.#t.mutate({mutation:_n,variables:{createProductionPreferencesInput:e},errorPolicy:"all"}).pipe((0,D.M)(({data:o})=>{this.#e.setProductionPreference(o.createProductionPreferences.productionPreferences)}))}findProductionPreferencesByMerchant(){return this.#t.query({query:bn,errorPolicy:"all"}).pipe((0,D.M)(({data:e})=>{this.#e.setProductionPreference(e.findProductionPreferencesByMerchant.productionPreferences)}))}updateProductionPreferences(e){return this.#t.mutate({mutation:vn,variables:{updateProductionPreferencesInput:e},errorPolicy:"all"}).pipe((0,D.M)(({data:o})=>{this.#e.setProductionPreference(o.updateProductionPreferences.productionPreferences)}))}static#o=this.\u0275fac=function(o){return new(o||i)};static#n=this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Pn=l(59649);let Dn=(()=>{class i{constructor(){this.depots=[],this.productionPreferencesStore=(0,t.WQX)(Ae),this.#t=(0,t.WQX)(t.gRc),this.#i=(0,t.WQX)(t.abz),this.#e=(0,t.WQX)(_.CP),this.#o=(0,t.WQX)(c.ok),this.#n=(0,t.WQX)(ot.G),this.#r=(0,t.WQX)(Be),this.#s=(0,t.WQX)(X.UG),this.#a=(0,t.WQX)(it.il)}#t;#i;#e;#o;#n;#r;#s;#a;ngOnInit(){this.productionPreferencesForm=this.#o.group({id:new c.MJ(null),productionMaterialsDepotId:new c.MJ(null,[c.k0.required,c.k0.pattern("^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$")]),productionMaterialsReservedDepotId:new c.MJ(null,[c.k0.required,c.k0.pattern("^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$")]),productionFinishedDepotId:new c.MJ(null,[c.k0.required,c.k0.pattern("^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$")])}),this.productionPreferencesForm.patchValue(this.productionPreferencesStore.productionPreferences()),this.#a.select(fn.c_).pipe((0,C.pQ)(this.#i)).subscribe(e=>{this.depots=e,this.#t.markForCheck()})}selectProductionMaterialsDepot(e){this.productionPreferencesForm.controls.productionMaterialsDepotId.setValue(e.id)}selectProductionMaterialsReservedDepot(e){this.productionPreferencesForm.controls.productionMaterialsReservedDepotId.setValue(e.id)}selectProductionFinishedDepot(e){this.productionPreferencesForm.controls.productionFinishedDepotId.setValue(e.id)}saveProductionPreferences(){let e=this.productionPreferencesForm.getRawValue();this.#n.open({title:"Guardar preferencias de producci\xf3n",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,C.pQ)(this.#i)).subscribe(r=>{"confirmed"===r&&(e.id?this.#r.updateProductionPreferences(e).subscribe(({data:s})=>{this.#s.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.updateProductionPreferences.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#e.close()}):(delete e.id,this.#r.createProductionPreferences(e).subscribe(({data:s})=>{this.#s.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.createProductionPreferences.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#e.close(!0)})))})}static#c=this.\u0275fac=function(o){return new(o||i)};static#d=this.\u0275cmp=t.VBU({type:i,selectors:[["production-panel-preferences-dialog"]],standalone:!0,features:[t.aNF],decls:16,vars:8,consts:[[1,"relative","flex","flex-col","w-full","max-h-screenl"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],[1,"text-2xl","text-gray-400"],[1,"flex","flex-col","items-center","flex-auto","mt-5","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],[1,"w-full","overflow-hidden"],[1,"flex","flex-col"],[1,"flex","flex-col","w-full","mt-1","space-y-5",3,"formGroup","autocomplete"],["labelName","Almac\xe9n de Materias Primas",3,"depotChange","rounded"],["labelName","Almac\xe9n de Materias Primas Reservadas",3,"depotChange","rounded"],["labelName","Almac\xe9n de Producci\xf3n Terminada",3,"depotChange","rounded"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-between","bg-gray-50","dark:bg-black/10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"click","color","disabled"]],template:function(o,r){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"h2",2),t.EFF(3," Guardar preferencias de producci\xf3n "),t.k0s()(),t.j41(4,"div",3)(5,"div",4)(6,"div",5)(7,"form",6)(8,"autocomplete-depots",7),t.bIt("depotChange",function(a){return r.selectProductionMaterialsDepot(a)}),t.k0s(),t.j41(9,"autocomplete-depots",8),t.bIt("depotChange",function(a){return r.selectProductionMaterialsReservedDepot(a)}),t.k0s(),t.j41(10,"autocomplete-depots",9),t.bIt("depotChange",function(a){return r.selectProductionFinishedDepot(a)}),t.k0s()()()()(),t.j41(11,"div",10)(12,"button",11),t.EFF(13," Cancelar "),t.k0s(),t.j41(14,"button",12),t.bIt("click",function(){return r.saveProductionPreferences()}),t.EFF(15," Guardar "),t.k0s()()()),2&o&&(t.R7$(7),t.Y8G("formGroup",r.productionPreferencesForm)("autocomplete","off"),t.R7$(),t.Y8G("rounded",!1),t.R7$(),t.Y8G("rounded",!1),t.R7$(),t.Y8G("rounded",!1),t.R7$(2),t.Y8G("matDialogClose","cancelled"),t.R7$(2),t.Y8G("color","primary")("disabled",r.productionPreferencesForm.invalid))},dependencies:[Pn.E,Q.jL,P.Hl,P.$z,_.tx,h.RG,x.m_,T.fS,c.X1,c.qT,c.cb,c.j4],encapsulation:2,changeDetection:0})}return i})();var Cn=l(25903),Ye=l(55364);const Rn=["recentRequestsTable"],xn=()=>["recentRequestsTableFooter"],Sn=(i,n,e)=>({"bg-cyan-200 text-cyan-800 dark:bg-cyan-600 dark:text-cyan-50":i,"bg-blue-200 text-blue-800 dark:bg-blue-600 dark:text-blue-50":n,"bg-red-200 text-red-800 dark:bg-red-600 dark:text-red-50":e}),En=(i,n,e,o,r,s)=>({"bg-red-200 text-red-800 dark:bg-red-600 dark:text-red-50":i,"bg-green-200 text-green-800 dark:bg-green-600 dark:text-green-50":n,"bg-blue-200 text-blue-800 dark:bg-blue-600 dark:text-blue-50":e,"bg-amber-200 text-amber-800 dark:bg-amber-600 dark:text-amber-50":o,"bg-red-200 text-red-800 dark:bg-red-600 dark:text-red-50":r,"bg-blue-200 text-blue-800 dark:bg-blue-600 dark:text-blue-50":s}),yn=()=>["recentOrdersTableFooter"],Fn=(i,n,e,o)=>({"bg-red-200 text-red-800 dark:bg-red-600 dark:text-red-50":i,"bg-green-200 text-green-800 dark:bg-green-600 dark:text-green-50":n,"bg-red-200 text-red-800 dark:bg-red-600 dark:text-red-50":e,"bg-blue-200 text-blue-800 dark:bg-blue-600 dark:text-blue-50":o});function In(i,n){if(1&i){const e=t.RV6();t.j41(0,"mat-icon",27),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.range.reset())}),t.k0s()}}function kn(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," Fecha de inicio no v\xe1lida "),t.k0s())}function wn(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," Fecha de final no v\xe1lida "),t.k0s())}function Tn(i,n){1&i&&(t.j41(0,"th",56),t.EFF(1," No "),t.k0s())}function $n(i,n){if(1&i&&(t.j41(0,"td",57)(1,"span",58),t.EFF(2),t.k0s()()),2&i){const e=n.$implicit;t.R7$(2),t.SpI(" ",e.no," ")}}function On(i,n){1&i&&(t.j41(0,"th",56),t.EFF(1," Fecha "),t.k0s())}function jn(i,n){if(1&i&&(t.j41(0,"td",57)(1,"span",59),t.EFF(2),t.nI1(3,"date"),t.k0s()()),2&i){const e=n.$implicit;t.R7$(2),t.SpI(" ",t.i5U(3,1,e.requestedDate,"dd/MM/yyyy")," ")}}function qn(i,n){1&i&&(t.j41(0,"th",56),t.EFF(1," Solicitado por "),t.k0s())}function Nn(i,n){if(1&i&&(t.j41(0,"td",57)(1,"span",59),t.EFF(2),t.k0s()()),2&i){const e=n.$implicit;t.R7$(2),t.SpI(" ",e.requestedBy," ")}}function Gn(i,n){1&i&&(t.j41(0,"th",56),t.EFF(1," Prioridad "),t.k0s())}function Ln(i,n){if(1&i&&(t.j41(0,"td",57)(1,"span",60)(2,"span",61),t.EFF(3),t.k0s()()()),2&i){const e=n.$implicit,o=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.sMw(2,Sn,e.priority===o.ProductionRequestPriorityEnum.LOW,e.priority===o.ProductionRequestPriorityEnum.NORMAL,e.priority===o.ProductionRequestPriorityEnum.HIGH)),t.R7$(2),t.SpI(" ",e.priority," ")}}function Mn(i,n){1&i&&(t.j41(0,"th",56),t.EFF(1," Estado "),t.k0s())}function An(i,n){if(1&i&&(t.j41(0,"td",57)(1,"span",60)(2,"span",61),t.EFF(3),t.k0s()()()),2&i){const e=n.$implicit,o=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.l4e(2,En,e.status===o.ProductionRequestStatusEnum.PENDING,e.status===o.ProductionRequestStatusEnum.COMPLETED,e.status===o.ProductionRequestStatusEnum.APPROVED,e.status===o.ProductionRequestStatusEnum.REJECTED,e.status===o.ProductionRequestStatusEnum.CANCELED,e.status===o.ProductionRequestStatusEnum.IN_PROCESS)),t.R7$(2),t.SpI(" ",e.status," ")}}function Bn(i,n){1&i&&(t.j41(0,"td",62)(1,"button",63),t.EFF(2," Ver todas las solicitudes "),t.k0s()())}function Yn(i,n){1&i&&t.nrm(0,"tr",64)}function zn(i,n){1&i&&t.nrm(0,"tr",65)}function Vn(i,n){1&i&&t.nrm(0,"tr",66)}function Xn(i,n){if(1&i&&(t.j41(0,"div",28)(1,"div",29)(2,"div",30)(3,"div",31)(4,"div",32),t.EFF(5," Nuevas "),t.k0s()(),t.j41(6,"div",33)(7,"div",34),t.EFF(8),t.k0s()()(),t.j41(9,"div",30)(10,"div",31)(11,"div",32),t.EFF(12," Rechazadas "),t.k0s()(),t.j41(13,"div",33)(14,"div",35),t.EFF(15),t.k0s()()(),t.j41(16,"div",30)(17,"div",31)(18,"div",32),t.EFF(19," Canceladas "),t.k0s()(),t.j41(20,"div",33)(21,"div",36),t.EFF(22),t.k0s()()(),t.j41(23,"div",30)(24,"div",31)(25,"div",32),t.EFF(26," Aprobadas "),t.k0s()(),t.j41(27,"div",33)(28,"div",37),t.EFF(29),t.k0s()()(),t.j41(30,"div",30)(31,"div",31)(32,"div",32),t.EFF(33," En Proceso "),t.k0s()(),t.j41(34,"div",33)(35,"div",37),t.EFF(36),t.k0s()()(),t.j41(37,"div",30)(38,"div",31)(39,"div",32),t.EFF(40," Completadas "),t.k0s()(),t.j41(41,"div",33)(42,"div",37),t.EFF(43),t.k0s()()()(),t.j41(44,"div",38)(45,"div",39)(46,"div",40),t.EFF(47," Solicitudes Recientes "),t.k0s(),t.j41(48,"div",41),t.EFF(49),t.k0s()(),t.j41(50,"div",42)(51,"table",43,1),t.qex(53,44),t.DNE(54,Tn,2,0,"th",45)(55,$n,3,1,"td",46),t.bVm(),t.qex(56,47),t.DNE(57,On,2,0,"th",45)(58,jn,4,4,"td",46),t.bVm(),t.qex(59,48),t.DNE(60,qn,2,0,"th",45)(61,Nn,3,1,"td",46),t.bVm(),t.qex(62,49),t.DNE(63,Gn,2,0,"th",45)(64,Ln,4,6,"td",46),t.bVm(),t.qex(65,50),t.DNE(66,Mn,2,0,"th",45)(67,An,4,9,"td",46),t.bVm(),t.qex(68,51),t.DNE(69,Bn,3,0,"td",52),t.bVm(),t.DNE(70,Yn,1,0,"tr",53)(71,zn,1,0,"tr",54)(72,Vn,1,0,"tr",55),t.k0s()()()()),2&i){const e=t.XpG();t.R7$(8),t.SpI(" ",e.largeNumber(e.productionRequestsStore.newRequests(),0)," "),t.R7$(7),t.SpI(" ",e.largeNumber(e.productionRequestsStore.rejectedRequests(),0)," "),t.R7$(7),t.SpI(" ",e.largeNumber(e.productionRequestsStore.canceledRequests(),0)," "),t.R7$(7),t.SpI(" ",e.largeNumber(e.productionRequestsStore.approvedRequests(),0)," "),t.R7$(7),t.SpI(" ",e.largeNumber(e.productionRequestsStore.inProcessRequests(),0)," "),t.R7$(7),t.SpI(" ",e.largeNumber(e.productionRequestsStore.completedRequests(),0)," "),t.R7$(6),t.Lme(" ",e.productionRequestsStore.newRequests()," pendientes, ",e.productionRequestsStore.approvedRequests()," aprobadas "),t.R7$(2),t.Y8G("dataSource",e.productionRequestsStore.productionRequests())("trackBy",e.trackByFn),t.R7$(19),t.Y8G("matHeaderRowDef",e.recentRequestsTableColumns),t.R7$(),t.Y8G("matRowDefColumns",e.recentRequestsTableColumns),t.R7$(),t.Y8G("matFooterRowDef",t.lJ4(13,xn))}}function Qn(i,n){1&i&&(t.j41(0,"th",56),t.EFF(1," No "),t.k0s())}function Un(i,n){if(1&i&&(t.j41(0,"td",57)(1,"span",58),t.EFF(2),t.k0s()()),2&i){const e=n.$implicit;t.R7$(2),t.SpI(" ",e.no," ")}}function Wn(i,n){1&i&&(t.j41(0,"th",56),t.EFF(1," Fecha "),t.k0s())}function Jn(i,n){if(1&i&&(t.j41(0,"td",57)(1,"span",59),t.EFF(2),t.nI1(3,"date"),t.k0s()()),2&i){const e=n.$implicit;t.R7$(2),t.SpI(" ",t.i5U(3,1,e.request.requestedDate,"dd/MM/yyyy")," ")}}function Hn(i,n){1&i&&(t.j41(0,"th",56),t.EFF(1," Solicitado por "),t.k0s())}function Zn(i,n){if(1&i&&(t.j41(0,"td",57)(1,"span",59),t.EFF(2),t.k0s()()),2&i){const e=n.$implicit;t.R7$(2),t.SpI(" ",e.request.requestedBy," ")}}function Kn(i,n){1&i&&(t.j41(0,"th",56),t.EFF(1," Estado "),t.k0s())}function tr(i,n){if(1&i&&(t.j41(0,"td",57)(1,"span",60)(2,"span",61),t.EFF(3),t.k0s()()()),2&i){const e=n.$implicit,o=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.ziG(2,Fn,e.status===o.ProductionOrderStatusEnum.CREATED,e.status===o.ProductionOrderStatusEnum.COMPLETED,e.status===o.ProductionOrderStatusEnum.CANCELED,e.status===o.ProductionOrderStatusEnum.IN_PROCESS)),t.R7$(2),t.SpI(" ",e.status," ")}}function er(i,n){1&i&&(t.j41(0,"td",70)(1,"button",71),t.EFF(2," Ver todas las \xf3rdenes "),t.k0s()())}function ir(i,n){1&i&&t.nrm(0,"tr",64)}function or(i,n){1&i&&t.nrm(0,"tr",65)}function nr(i,n){1&i&&t.nrm(0,"tr",66)}function rr(i,n){if(1&i&&(t.j41(0,"div",28)(1,"div",67)(2,"div",30)(3,"div",31)(4,"div",32),t.EFF(5," Nuevas "),t.k0s()(),t.j41(6,"div",33)(7,"div",34),t.EFF(8),t.k0s()()(),t.j41(9,"div",30)(10,"div",31)(11,"div",32),t.EFF(12," Canceladas "),t.k0s()(),t.j41(13,"div",33)(14,"div",36),t.EFF(15),t.k0s()()(),t.j41(16,"div",30)(17,"div",31)(18,"div",32),t.EFF(19," En Proceso "),t.k0s()(),t.j41(20,"div",33)(21,"div",37),t.EFF(22),t.k0s()()(),t.j41(23,"div",30)(24,"div",31)(25,"div",32),t.EFF(26," Completadas "),t.k0s()(),t.j41(27,"div",33)(28,"div",37),t.EFF(29),t.k0s()()()(),t.j41(30,"div",38)(31,"div",39)(32,"div",40),t.EFF(33," \xd3rdenes Recientes "),t.k0s(),t.j41(34,"div",41),t.EFF(35),t.k0s()(),t.j41(36,"div",42)(37,"table",43,2),t.qex(39,44),t.DNE(40,Qn,2,0,"th",45)(41,Un,3,1,"td",46),t.bVm(),t.qex(42,47),t.DNE(43,Wn,2,0,"th",45)(44,Jn,4,4,"td",46),t.bVm(),t.qex(45,48),t.DNE(46,Hn,2,0,"th",45)(47,Zn,3,1,"td",46),t.bVm(),t.qex(48,50),t.DNE(49,Kn,2,0,"th",45)(50,tr,4,7,"td",46),t.bVm(),t.qex(51,68),t.DNE(52,er,3,0,"td",69),t.bVm(),t.DNE(53,ir,1,0,"tr",53)(54,or,1,0,"tr",54)(55,nr,1,0,"tr",55),t.k0s()()()()),2&i){const e=t.XpG();t.R7$(8),t.SpI(" ",e.largeNumber(e.productionOrdersStore.newOrders(),0)," "),t.R7$(7),t.SpI(" ",e.largeNumber(e.productionOrdersStore.canceledOrders(),0)," "),t.R7$(7),t.SpI(" ",e.largeNumber(e.productionOrdersStore.inProcessOrders(),0)," "),t.R7$(7),t.SpI(" ",e.largeNumber(e.productionOrdersStore.completedOrders(),0)," "),t.R7$(6),t.Lme(" ",e.productionOrdersStore.newOrders()," pendientes, ",e.productionOrdersStore.completedOrders()," completadas "),t.R7$(2),t.Y8G("dataSource",e.productionOrdersStore.productionOrders())("trackBy",e.trackByFn),t.R7$(16),t.Y8G("matHeaderRowDef",e.recentOrdersTableColumns),t.R7$(),t.Y8G("matRowDefColumns",e.recentOrdersTableColumns),t.R7$(),t.Y8G("matFooterRowDef",t.lJ4(11,yn))}}let sr=(()=>{class i{constructor(){this.initDate=Tt.c9.now().minus({days:7}).set({hour:0,minute:0,second:0,millisecond:0}),this.endDate=Tt.c9.now(),this.maxDate=new Date,this.productionRequestsStore=(0,t.WQX)(jt),this.productionOrdersStore=(0,t.WQX)(Wt),this.ProductionRequestPriorityEnum=Dt,this.ProductionRequestStatusEnum=j,this.ProductionOrderStatusEnum=L,this.recentRequestsDataSource=new O.I6,this.recentRequestsTableColumns=["no","requestedDate","requestedBy","priority","status"],this.recentOrdersTableColumns=["no","requestedDate","requestedBy","status"],this.range=null,this.selectedTapIndex=0,this.#t=(0,t.WQX)(_.bZ)}#t;ngOnInit(){this.range=new c.gE({start:new c.MJ({disabled:!1,value:this.initDate},[Ye.t.futureDateValidator()]),end:new c.MJ({disabled:!1,value:this.endDate},[Ye.t.futureDateValidator()])})}ngAfterViewInit(){this.recentRequestsDataSource.sort=this.recentRequestsTableMatSort}onTabChanged(e){this.selectedTapIndex=e}largeNumber(e,o){return(0,Cn.s)(e,o)}openProductionPreferencesDialog(){this.#t.open(Dn,{panelClass:"ath-dialog-panel",disableClose:!0})}trackByFn(e,o){return o.id||e}static#i=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["production-panel"]],viewQuery:function(o,r){if(1&o&&t.GBs(Rn,5,S.B4),2&o){let s;t.mGM(s=t.lsd())&&(r.recentRequestsTableMatSort=s.first)}},standalone:!0,features:[t.aNF],decls:33,vars:13,consts:[["picker",""],["recentRequestsTable",""],["recentOrdersTable",""],[1,"flex","min-w-0","flex-auto","flex-col"],[1,"bg-card"],[1,"mx-auto","flex","w-full","max-w-screen-xl","flex-col","px-6","sm:px-8"],[1,"my-8","flex","min-w-0","flex-auto","flex-col","sm:my-12","sm:flex-row","sm:items-center"],[1,"min-w-0","flex-1"],[1,"truncate","text-3xl","font-extrabold","leading-7","tracking-tight","sm:leading-10","md:text-4xl"],[1,"mt-6","flex","items-center","space-x-3","sm:ml-2","sm:mt-0"],[1,"min-w-72","fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],[3,"formGroup","rangePicker","max"],["matStartDate","","formControlName","start","placeholder","Fecha de inicio"],["matEndDate","","formControlName","end","placeholder","Fecha final"],["matSuffix","",3,"for"],["disabled","false"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer"],["mat-flat-button","",1,"bg-accent",3,"color"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2"],["mat-flat-button","",3,"click","color"],[1,"-mt-px","flex-auto","border-t","pt-4","sm:pt-6"],[1,"mx-auto","w-full","max-w-screen-xl"],["mat-stretch-tabs","false",1,"w-full",3,"selectedIndexChange","animationDuration"],["label","Solicitudes de Producci\xf3n",1,"max-w-screen-xl","p-6","md:p-8"],["matTabContent",""],["label","\xd3rdenes de Producci\xf3n",1,"max-w-screen-xl","p-6","md:p-8"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer",3,"click"],[1,"flex","flex-col","items-center","justify-center","w-full"],[1,"grid","grid-cols-2","gap-6","mt-8","md:grid-cols-4","xl:grid-cols-6","w-full"],[1,"flex","flex-col","flex-auto","p-6","overflow-hidden","shadow","bg-card","rounded-2xl"],[1,"flex","items-start","justify-between"],[1,"text-lg","font-medium","leading-6","tracking-tight","truncate"],[1,"flex","flex-col","items-center","mt-2"],[1,"font-bold","leading-none","tracking-tight","text-green-500","text-7xl","sm:text-8xl"],[1,"font-bold","leading-none","tracking-tight","text-amber-500","text-7xl","sm:text-8xl"],[1,"font-bold","leading-none","tracking-tight","text-red-500","text-7xl","sm:text-8xl"],[1,"font-bold","leading-none","tracking-tight","text-blue-500","text-7xl","sm:text-8xl"],[1,"bg-card","flex","flex-auto","flex-col","w-full","mt-8","overflow-hidden","rounded-2xl","shadow","xl:col-span-2"],[1,"p-6"],[1,"mr-4","truncate","text-lg","font-medium","leading-6","tracking-tight"],[1,"text-secondary","font-medium"],[1,"mx-6","overflow-x-auto"],["mat-table","","matSort","",1,"w-full","bg-transparent",3,"dataSource","trackBy"],["matColumnDef","no"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","requestedDate"],["matColumnDef","requestedBy"],["matColumnDef","priority"],["matColumnDef","status"],["matColumnDef","recentRequestsTableFooter"],["class","border-0 px-0 py-6","mat-footer-cell","","colspan","5",4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","order-row h-16","mat-row","",4,"matRowDef","matRowDefColumns"],["class","h-16 border-0","mat-footer-row","",4,"matFooterRowDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"text-secondary","whitespace-nowrap","pr-6","text-sm","font-medium"],[1,"whitespace-nowrap","pr-6"],[1,"inline-flex","items-center","rounded-full","px-2.5","py-0.5","text-xs","font-bold","uppercase","tracking-wide",3,"ngClass"],[1,"whitespace-nowrap","leading-relaxed"],["mat-footer-cell","","colspan","5",1,"border-0","px-0","py-6"],["mat-stroked-button","","routerLink","/modules/production/requests"],["mat-header-row",""],["mat-row","",1,"order-row","h-16"],["mat-footer-row","",1,"h-16","border-0"],[1,"grid","grid-cols-2","gap-6","mt-8","md:grid-cols-4","w-full"],["matColumnDef","recentOrdersTableFooter"],["class","border-0 px-0 py-6","mat-footer-cell","","colspan","4",4,"matFooterCellDef"],["mat-footer-cell","","colspan","4",1,"border-0","px-0","py-6"],["mat-stroked-button","","routerLink","/modules/production/orders"]],template:function(o,r){if(1&o){const s=t.RV6();t.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"h2",8),t.EFF(6," Panel de Producci\xf3n "),t.k0s()(),t.j41(7,"div",9)(8,"mat-form-field",10)(9,"mat-date-range-input",11),t.nrm(10,"input",12)(11,"input",13),t.k0s(),t.nrm(12,"mat-datepicker-toggle",14)(13,"mat-date-range-picker",15,0),t.DNE(15,In,1,0,"mat-icon",16)(16,kn,2,0,"mat-error")(17,wn,2,0,"mat-error"),t.k0s(),t.j41(18,"button",17),t.nrm(19,"mat-icon",18),t.j41(20,"span",19),t.EFF(21,"Reportes"),t.k0s()(),t.j41(22,"button",20),t.bIt("click",function(){return t.eBV(s),t.Njj(r.openProductionPreferencesDialog())}),t.nrm(23,"mat-icon",18),t.j41(24,"span",19),t.EFF(25,"Ajustes"),t.k0s()()()()()(),t.j41(26,"div",21)(27,"div",22)(28,"mat-tab-group",23),t.bIt("selectedIndexChange",function(d){return t.eBV(s),t.Njj(r.onTabChanged(d))}),t.j41(29,"mat-tab",24),t.DNE(30,Xn,73,14,"ng-template",25),t.k0s(),t.j41(31,"mat-tab",26),t.DNE(32,rr,56,12,"ng-template",25),t.k0s()()()()()}if(2&o){const s=t.sdS(14);t.R7$(8),t.Y8G("subscriptSizing","dynamic"),t.R7$(),t.Y8G("formGroup",r.range)("rangePicker",s)("max",r.maxDate),t.R7$(3),t.Y8G("for",s),t.R7$(3),t.vxM(r.range.get("start").value||r.range.get("end").value?15:-1),t.R7$(),t.vxM(r.range.controls.start.hasError("matStartDateInvalid")?16:-1),t.R7$(),t.vxM(r.range.controls.end.hasError("matEndDateInvalid")?17:-1),t.R7$(),t.Y8G("color","accent"),t.R7$(),t.Y8G("svgIcon","mat_solid:find_in_page"),t.R7$(3),t.Y8G("color","primary"),t.R7$(),t.Y8G("svgIcon","mat_solid:settings"),t.R7$(5),t.Y8G("animationDuration",0)}},dependencies:[x.m_,x.An,P.Hl,P.$z,W.X6,W.bU,W.el,W.xR,W.IG,W.SG,h.RG,h.rl,h.TL,h.yw,T.fS,Ot.RI,Ot.$L,Ot.mq,Ot.T8,O.tP,O.Zl,O.tL,O.ji,O.cC,O.YV,O.iL,O.Zq,O.xW,O.KS,O.$R,O.Qo,O.YZ,O.NB,O.iF,S.NQ,S.B4,S.aE,c.X1,c.me,c.BC,c.cb,c.j4,c.JD,R.vh,R.YU,E.Wk],encapsulation:2,changeDetection:0})}return i})();const ar=v.J1`
    mutation CreateProductionRequest($createProductionRequestInput: CreateProductionRequestInput!) {
        createProductionRequest(createProductionRequestInput: $createProductionRequestInput) {

            ok
            message

            productionRequest {
                id
                no
                userId
                merchantId
                requestedBy
                requestedDate
                dueDate
                status
                priority
                customerId
                products {
                    productId
                    quantity
                    price
                    product {
                        name
                        price
                    }
                }
                completedDate
                comments
                merchant {
                    name
                }
                customer {
                    name
                    nit
                }
                user {
                    name
                    lastname1
                    lastname2
                    fullname
                }
            }

        }
    }
`,cr=v.J1`
    mutation UpdateProductionRequest($updateProductionRequestInput: UpdateProductionRequestInput!) {
        updateProductionRequest(updateProductionRequestInput: $updateProductionRequestInput) {
            ok
            message

            productionRequest {
                id
                no
                userId
                merchantId
                requestedBy
                requestedDate
                dueDate
                status
                priority
                customerId
                products {
                    productId
                    quantity
                    price
                    product {
                        name
                        price
                    }
                }
                completedDate
                comments
                merchant {
                    name
                }
                customer {
                    name
                    nit
                }
                user {
                    name
                    lastname1
                    lastname2
                    fullname
                }
            }
        }
    }
`,dr=v.J1`
    mutation RemoveProductionRequest($productionRequestId: String!) {
        removeProductionRequest(id: $productionRequestId) {
            ok
            message
        }
    }
`,lr=v.J1`
    query FindAllProductionRequests($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllProductionRequests(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            productionRequests {
                id
                no
                userId
                merchantId
                requestedBy
                requestedDate
                dueDate
                status
                priority
                customerId
                products {
                    productId
                    quantity
                    price
                    product {
                        name
                        price
                    }
                }
                completedDate
                comments
                merchant {
                    name
                }
                customer {
                    name
                    nit
                }
                user {
                    name
                    lastname1
                    lastname2
                    fullname
                }
            }
        }
    }
`,ur=(v.J1`
    query FindActiveProductionRequests($search: String!, $size: Int!) {
        findActiveProductionRequests(search: $search, size: $size) {
            ok
            message

            name {
                id
                name
            }
        }
    }
`,v.J1`
    query FindProductionRequestById($productionRequestId: String!) {
        findProductionRequestById(id: $productionRequestId) {
            ok
            message

            productionRequest {
                id
                no
                userId
                merchantId
                requestedBy
                requestedDate
                dueDate
                status
                priority
                customerId
                products {
                    productId
                    quantity
                    price
                    product {
                        name
                        price
                    }
                }
                completedDate
                comments
                merchant {
                    name
                }
                customer {
                    name
                    nit
                }
                user {
                    name
                    lastname1
                    lastname2
                    fullname
                }
            }
        }
    }
`),mr=v.J1`
    mutation ChangeProductionRequestStatus($productionRequestId: String!, $status: ProductionRequestStatusEnum!) {
        changeProductionRequestStatus(id: $productionRequestId, status: $status) {
            ok
            message
        }
    }
`,pr=v.J1`
    mutation ApproveProductionRequest($productionRequestId: String!) {
        approveProductionRequest(id: $productionRequestId) {
            ok
            message
        }
    }
`;let qt=(()=>{class i{#t;#i=(0,t.WQX)(v.Ic);#e=(0,t.WQX)(jt);constructor(){this.#t=this.#i.use(Ct.c.GRAPHQL_PROVIDER)}createProductionRequest(e){return this.#t.mutate({mutation:ar,variables:{createProductionRequestInput:e},errorPolicy:"all"}).pipe((0,D.M)(({data:o})=>{const r=structuredClone(this.#e.productionRequests());r.push(o.createProductionRequest.productionRequest),this.#e.setProductionRequests(r)}))}findAllProductionRequests(e=0,o=20,r="name",s="asc",a=""){return this.#t.query({query:lr,errorPolicy:"all",variables:{page:e,size:o,sort:r,order:s,search:a}}).pipe((0,D.M)(({data:d})=>{this.#e.setProductionRequestsList(d.findAllProductionRequests.productionRequests,d.findAllProductionRequests.pagination)}))}findProductionRequestById(e){return this.#t.query({query:ur,variables:{productionRequestId:e},errorPolicy:"all"}).pipe((0,D.M)(({data:o})=>{this.#e.setProductionRequest(o.findProductionRequestById.productionRequest)}))}updateProductionRequest(e){return this.#t.mutate({mutation:cr,variables:{updateProductionRequestInput:e},errorPolicy:"all"}).pipe((0,D.M)(({data:o})=>{const r=structuredClone(this.#e.productionRequests()),s=r.findIndex(a=>a.id===e.id);r[s]=o.updateProductionRequest.productionRequest,this.#e.setProductionRequests(r)}))}removeProductionRequest(e){return this.#t.mutate({mutation:dr,variables:{productionRequestId:e},errorPolicy:"all"}).pipe((0,D.M)(()=>{const o=structuredClone(this.#e.productionRequests()),r=o.findIndex(s=>s.id===e);o.splice(r,1),this.#e.setProductionRequests(o)}))}changeProductionRequestStatus(e,o){return this.#t.mutate({mutation:mr,variables:{productionRequestId:e,status:o},errorPolicy:"all"}).pipe((0,D.M)(({errors:s})=>{if(s)return;const a=structuredClone(this.#e.productionRequests()),d=a.findIndex(u=>u.id===e);a[d].status=o,this.#e.setProductionRequests(a)}))}approveProductionRequest(e){return this.#t.mutate({mutation:pr,variables:{productionRequestId:e},errorPolicy:"all"}).pipe((0,D.M)(({errors:r})=>{if(r)return;const s=structuredClone(this.#e.productionRequests()),a=s.findIndex(d=>d.id===e);s[a].status=j.APPROVED,this.#e.setProductionRequests(s)}))}static#o=this.\u0275fac=function(o){return new(o||i)};static#n=this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var hr=l(72797),gr=l(56808);const fr=()=>({suppressScrollX:!0}),_r=()=>({suppressScrollY:!0});function vr(i,n){if(1&i){const e=t.RV6();t.j41(0,"button",49),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.createProductionRequest())}),t.EFF(1," Registrar "),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("disabled",e.productionRequestForm.invalid||0===e.productionRequestForm.get("products").controls.length)}}function br(i,n){if(1&i){const e=t.RV6();t.j41(0,"button",49),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.updateProductionRequest())}),t.EFF(1," Actualizar "),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("disabled",e.productionRequestForm.invalid||0===e.productionRequestForm.get("products").controls.length)}}function Pr(i,n){if(1&i){const e=t.RV6();t.j41(0,"mat-option",50),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.selectCustomer(r))}),t.EFF(1),t.k0s()}if(2&i){const e=n.$implicit;t.Y8G("value",e),t.R7$(),t.SpI(" ",e.name," ")}}function Dr(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El nombre de la persona que realiza la solicitud es obligatorio "),t.k0s())}function Cr(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," La fecha de la solicitud es obligatoria "),t.k0s())}function Rr(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," La fecha de entrega es obligatoria "),t.k0s())}function xr(i,n){1&i&&(t.j41(0,"mat-error"),t.EFF(1," El tipo de comprobante es obligatorio "),t.k0s())}function Sr(i,n){if(1&i){const e=t.RV6();t.j41(0,"mat-option",51),t.bIt("click",function(r){const s=t.eBV(e).$implicit;return t.XpG().addOrRemoveProductionRequestProduct(s),t.Njj(r.stopPropagation())}),t.j41(1,"div",52),t.bIt("click",function(r){const s=t.eBV(e).$implicit;return t.XpG().addOrRemoveProductionRequestProduct(s),t.Njj(r.stopPropagation())}),t.j41(2,"span",53),t.nrm(3,"mat-checkbox",54),t.EFF(4),t.k0s()()()}if(2&i){const e=n.$implicit;t.Y8G("value",e),t.R7$(3),t.Y8G("checked",e.checked),t.R7$(),t.SpI(" ",e.name," ")}}function Er(i,n){if(1&i){const e=t.RV6();t.j41(0,"div")(1,"div",58)(2,"div"),t.EFF(3),t.k0s(),t.j41(4,"div",59),t.EFF(5),t.k0s(),t.j41(6,"mat-form-field",60),t.nrm(7,"input",61),t.k0s(),t.j41(8,"div",62),t.EFF(9),t.nI1(10,"number"),t.k0s(),t.j41(11,"div",62),t.EFF(12),t.nI1(13,"number"),t.k0s(),t.j41(14,"div",63)(15,"button",64),t.bIt("click",function(){const r=t.eBV(e).$index,s=t.XpG(2);return t.Njj(s.removeProduct(r))}),t.nrm(16,"mat-icon",65),t.k0s()()()()}if(2&i){const e=n.$implicit,o=n.$index;t.R7$(3),t.JRh(o+1),t.R7$(2),t.SpI(" ",e.get("product").value.name," "),t.R7$(),t.Y8G("subscriptSizing","dynamic"),t.R7$(),t.Y8G("min",1)("formControl",e.get("quantity")),t.R7$(2),t.SpI(" ",t.i5U(10,8,e.get("product").value.price,"1.2-2")," "),t.R7$(3),t.SpI(" ",t.i5U(13,11,e.get("product").value.price*e.get("quantity").value,"1.2-2")," "),t.R7$(4),t.Y8G("svgIcon","mat_solid:close")}}function yr(i,n){if(1&i&&(t.j41(0,"div",47)(1,"div",55),t.nrm(2,"div"),t.j41(3,"div",56),t.EFF(4," Producto "),t.k0s(),t.j41(5,"div",57),t.EFF(6," Cantidad "),t.k0s(),t.j41(7,"div",57),t.EFF(8," Precio "),t.k0s(),t.j41(9,"div",57),t.EFF(10," Total "),t.k0s(),t.j41(11,"div",57),t.EFF(12," Quitar "),t.k0s()(),t.Z7z(13,Er,17,14,"div",null,t.fX1),t.k0s()),2&i){const e=t.XpG();t.R7$(13),t.Dyx(e.productionRequestForm.get("products").controls)}}function Fr(i,n){1&i&&(t.j41(0,"div",48),t.EFF(1," \xa1No ha seleccionado ning\xfan producto a\xfan! "),t.k0s())}let Ir=(()=>{class i{constructor(){this.editMode=!1,this.maxDate=new Date,this.productionRequestId=t.hFB.required(),this.productionRequestsStore=(0,t.WQX)(jt),this.searchCustomerControl=new c.MJ(null),this.searchProductionRequestControl=new c.MJ(null),this.searchProductControl=new c.MJ(null),this.selectedCustomerName="",this.stayHere=!1,this.filteredProducts=[],this.productionDataSheetsStore=(0,t.WQX)(Rt),this.#t=(0,t.WQX)(t.gRc),this.#i=(0,t.WQX)(hr.h),this.#e=(0,t.WQX)(t.abz),this.#o=(0,t.WQX)(c.ok),this.#n=(0,t.WQX)(ot.G),this.#r=(0,t.WQX)(qt),this.#s=(0,t.WQX)(E.Ix),this.#a=(0,t.WQX)(X.UG),this.#c=(0,t.WQX)(it.il)}#t;#i;#e;#o;#n;#r;#s;#a;#c;ngOnInit(){if(this.productionRequestForm=this.#o.group({id:new c.MJ(null),requestedBy:new c.MJ(null,[c.k0.required,c.k0.maxLength(100)]),requestedDate:new c.MJ(null,[c.k0.required]),dueDate:new c.MJ(null,[c.k0.required]),priority:new c.MJ("NORMAL",[c.k0.required,c.k0.maxLength(10)]),customerId:new c.MJ(null,[c.k0.required]),products:new c.Yp([],[c.k0.required]),comments:new c.MJ(null,[c.k0.maxLength(500)])}),"new"!==this.productionRequestId()){this.editMode=!0;const e=this.productionRequestsStore.productionRequest();this.productionRequestForm.patchValue(e),this.searchCustomerControl.setValue(e.customer),this.productionRequestForm.setControl("products",this.#o.array(e.products.map(o=>this.#o.group(o))))}this.filteredProducts=this.productionDataSheetsStore.productionDataSheets(),this.customers$=this.#c.select(gr.wQ),this.customersFiltered=this.searchCustomerControl.valueChanges.pipe((0,dt.B)(200),(0,A.Z)(null),(0,oe.Z)(e=>null!==e&&"string"==typeof e&&e!==this.selectedCustomerName?this.#i.findActiveCustomers(e.trim()):this.customers$))}selectCustomer(e){this.productionRequestForm.get("customerId").setValue(e.id),this.selectedCustomerName=e.name}displayFn(e){return e&&e.product.name?e.product.name:""}displayFnCustomer(e){return e&&e.name?e.name:""}addOrRemoveProductionRequestProduct(e){const o=this.productionRequestForm.get("products"),r=o.controls.findIndex(s=>s.get("productId").value===e.id);-1===r?(o.push(this.#o.group({productId:new c.MJ(e.id,[c.k0.required]),quantity:new c.MJ(1,[c.k0.required,c.k0.min(1)]),price:new c.MJ(e.price,[c.k0.required,c.k0.min(.01)]),product:new c.MJ(e,[c.k0.required])})),this.filteredProducts=this.filteredProducts.map(s=>s.id===e.id?{...s,checked:!0}:s)):(o.removeAt(r),this.filteredProducts=this.filteredProducts.map(s=>s.id===e.id?{...s,checked:!1}:s)),this.#t.markForCheck()}removeProduct(e){this.productionRequestForm.get("products").removeAt(e)}createProductionRequest(){let e=this.productionRequestForm.getRawValue();delete e.id,e.products.forEach(r=>{delete r.product}),this.#n.open({title:"Crear solicitud de producci\xf3n ",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this.#r.createProductionRequest(e).pipe((0,C.pQ)(this.#e)).subscribe(({data:s})=>{this.#a.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:s.createProductionRequest.message,type:"success",svgIcon:"mat_solid:done"}}),this.#s.navigateByUrl("/modules/production/requests")}),this.#t.markForCheck()})}updateProductionRequest(){let e=this.productionRequestForm.getRawValue();e.products.forEach(r=>{delete r.product}),this.#n.open({title:"Actualizar solicitud de producci\xf3n ",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this.#r.updateProductionRequest(e).pipe((0,C.pQ)(this.#e)).subscribe(({data:s})=>{this.#a.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:s.updateProductionRequest.message,type:"success",svgIcon:"mat_solid:done"}}),this.#s.navigateByUrl("/modules/production/requests")}),this.#t.markForCheck()})}static#d=this.\u0275fac=function(o){return new(o||i)};static#l=this.\u0275cmp=t.VBU({type:i,selectors:[["production-request"]],inputs:{productionRequestId:[1,"productionRequestId"]},standalone:!0,features:[t.aNF],decls:94,vars:45,consts:[["productionRequestNgForm","ngForm"],["customerAutocomplete","matAutocomplete"],["requestedDate",""],["dueDate",""],["productsAutocomplete","matAutocomplete"],["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0",3,"fuseScrollbarOptions"],[1,"relative","flex","flex-col","px-6","py-8","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/production/dashboard",1,"ml-1","text-primary-500"],["routerLink","/modules/production/requests",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["color","primary",3,"ngModelChange","ngModel"],["mat-flat-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"disabled"],[1,"flex","flex-col","px-4","mt-4","mb-12","gap-y-8","sm:px-8"],[1,"col-span-2","shadow","rounded-2xl","bg-card"],[1,"grid","gap-4","p-10","sm:grid-cols-4","lg:grid-cols-5",3,"formGroup"],["appearance","fill",1,"w-full","fuse-mat-dense"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder","required"],[1,"ath-autocomplete",3,"displayWith"],[3,"value"],[1,"w-full","fuse-mat-dense"],["matInput","","maxlength","100",3,"type","formControlName"],["matInput","",3,"matDatepicker","formControlName","max","required"],["matIconSuffix","",3,"for"],["matInput","",3,"matDatepicker","formControlName","min","required"],[3,"formControlName"],["value","LOW"],["value","NORMAL"],["value","HIGH"],[1,"w-full","sm:col-span-4","lg:col-span-5","fuse-mat-textarea"],["matInput","",3,"formControlName","rows"],[1,"col-span-4","shadow","rounded-2xl","bg-card"],[1,"p-6","pb-0"],[1,"flex","flex-col-reverse","justify-between","sm:flex-row"],["appearance","fill",1,"w-full","fuse-mat-dense",3,"subscriptSizing"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete",3,"closed","displayWith"],[1,"w-full",3,"value"],["fuseScrollbar","",1,"flex","flex-col","flex-auto","pb-3","mt-2","min-h-72",3,"fuseScrollbarOptions"],[1,"grid"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-30"],["mat-flat-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"click","disabled"],[3,"click","value"],[1,"w-full",3,"click","value"],[1,"grid","w-full","grid-cols-6",3,"click"],[1,"flex","flex-row","items-center","col-span-5","truncate","md:col-span-3"],["color","primary",3,"checked"],[1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","products-request-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-primary","dark:bg-opacity-5"],[1,"text-left"],[1,"text-center"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","products-request-grid","md:px-8"],[1,"truncate"],[1,"fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],["matInput","","type","number",1,"font-mono","font-semibold","text-center",3,"min","formControl"],[1,"text-lg","text-center"],[1,"flex","justify-center"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"]],template:function(o,r){if(1&o){const s=t.RV6();t.j41(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"div")(5,"a",9),t.EFF(6,"Inicio"),t.k0s()(),t.j41(7,"div",10),t.nrm(8,"mat-icon",11),t.j41(9,"a",12),t.EFF(10,"Producci\xf3n"),t.k0s()(),t.j41(11,"div",10),t.nrm(12,"mat-icon",11),t.j41(13,"a",13),t.EFF(14,"Solicitudes"),t.k0s()(),t.j41(15,"div",10),t.nrm(16,"mat-icon",11),t.j41(17,"a",14),t.EFF(18),t.k0s()()(),t.j41(19,"div",15)(20,"h2",16),t.EFF(21," Registrar Solicitud de Producci\xf3n "),t.k0s()()(),t.j41(22,"div",17)(23,"mat-checkbox",18),t.mxI("ngModelChange",function(d){return t.eBV(s),t.DH7(r.stayHere,d)||(r.stayHere=d),t.Njj(d)}),t.EFF(24,"Permanecer aqu\xed"),t.k0s(),t.DNE(25,vr,2,1,"button",19)(26,br,2,1,"button",19),t.k0s()(),t.j41(27,"div",20)(28,"div",21)(29,"form",22,0)(31,"mat-form-field",23)(32,"mat-label"),t.EFF(33,"Cliente"),t.k0s(),t.nrm(34,"mat-icon",24)(35,"input",25),t.j41(36,"mat-autocomplete",26,1),t.Z7z(38,Pr,2,2,"mat-option",27,t.fX1),t.nI1(40,"async"),t.k0s()(),t.j41(41,"mat-form-field",28)(42,"mat-label"),t.EFF(43,"Solicitada por"),t.k0s(),t.nrm(44,"input",29),t.DNE(45,Dr,2,0,"mat-error"),t.k0s(),t.j41(46,"mat-form-field",28)(47,"mat-label"),t.EFF(48,"Fecha de la solicitud"),t.k0s(),t.nrm(49,"input",30),t.j41(50,"mat-hint"),t.EFF(51,"DD/MM/YYYY"),t.k0s(),t.nrm(52,"mat-datepicker-toggle",31)(53,"mat-datepicker",null,2),t.DNE(55,Cr,2,0,"mat-error"),t.k0s(),t.j41(56,"mat-form-field",28)(57,"mat-label"),t.EFF(58,"Fecha de entrega"),t.k0s(),t.nrm(59,"input",32),t.j41(60,"mat-hint"),t.EFF(61,"DD/MM/YYYY"),t.k0s(),t.nrm(62,"mat-datepicker-toggle",31)(63,"mat-datepicker",null,3),t.DNE(65,Rr,2,0,"mat-error"),t.k0s(),t.j41(66,"mat-form-field",28)(67,"mat-label"),t.EFF(68,"Prioridad"),t.k0s(),t.j41(69,"mat-select",33)(70,"mat-option",34),t.EFF(71,"Baja"),t.k0s(),t.j41(72,"mat-option",35),t.EFF(73,"Normal"),t.k0s(),t.j41(74,"mat-option",36),t.EFF(75,"Alta"),t.k0s()(),t.DNE(76,xr,2,0,"mat-error"),t.k0s(),t.j41(77,"mat-form-field",37)(78,"mat-label"),t.EFF(79,"Observaciones"),t.k0s(),t.nrm(80,"textarea",38),t.k0s()()(),t.j41(81,"div",39)(82,"div",40)(83,"div",41)(84,"mat-form-field",42),t.nrm(85,"mat-icon",24)(86,"input",43),t.j41(87,"mat-autocomplete",44,4),t.bIt("closed",function(){return t.eBV(s),t.Njj(r.searchProductControl.reset())}),t.Z7z(89,Sr,5,3,"mat-option",45,t.fX1),t.k0s()()(),t.j41(91,"div",46),t.DNE(92,yr,15,0,"div",47)(93,Fr,2,0,"div",48),t.k0s()()()()()}if(2&o){const s=t.sdS(37),a=t.sdS(54),d=t.sdS(64),u=t.sdS(88);t.Y8G("fuseScrollbarOptions",t.lJ4(43,fr)),t.R7$(8),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(2),t.SpI(" ","new"===r.productionRequestId()?"Crear":"Editar"," "),t.R7$(5),t.R50("ngModel",r.stayHere),t.R7$(2),t.vxM(r.editMode?26:25),t.R7$(4),t.Y8G("formGroup",r.productionRequestForm),t.R7$(5),t.Y8G("svgIcon","mat_solid:search"),t.R7$(),t.Y8G("formControl",r.searchCustomerControl)("matAutocomplete",s)("placeholder","Buscar cliente")("required",!0),t.R7$(),t.Y8G("displayWith",r.displayFnCustomer),t.R7$(2),t.Dyx(t.bMT(40,41,r.customersFiltered)),t.R7$(6),t.Y8G("type","text")("formControlName","requestedBy"),t.R7$(),t.vxM(r.productionRequestForm.get("requestedBy").hasError("required")?45:-1),t.R7$(4),t.Y8G("matDatepicker",a)("formControlName","requestedDate")("max",r.maxDate)("required",!0),t.R7$(3),t.Y8G("for",a),t.R7$(3),t.vxM(r.productionRequestForm.get("requestedDate").hasError("required")?55:-1),t.R7$(4),t.Y8G("matDatepicker",d)("formControlName","dueDate")("min",r.maxDate)("required",!0),t.R7$(3),t.Y8G("for",d),t.R7$(3),t.vxM(r.productionRequestForm.get("dueDate").hasError("required")?65:-1),t.R7$(4),t.Y8G("formControlName","priority"),t.R7$(7),t.vxM(r.productionRequestForm.get("priority").hasError("required")?76:-1),t.R7$(4),t.Y8G("formControlName","comments")("rows",2),t.R7$(4),t.Y8G("subscriptSizing","dynamic"),t.R7$(),t.Y8G("svgIcon","mat_solid:search"),t.R7$(),t.Y8G("formControl",r.searchProductControl)("matAutocomplete",u)("placeholder","Buscar productos"),t.R7$(),t.Y8G("displayWith",r.displayFn),t.R7$(2),t.Dyx(r.filteredProducts),t.R7$(2),t.Y8G("fuseScrollbarOptions",t.lJ4(44,_r)),t.R7$(),t.vxM(r.productionRequestForm.get("products").controls.length>0?92:93)}},dependencies:[R.Jj,R.QX,c.YN,c.qT,c.me,c.Q0,c.BC,c.cb,c.YS,c.tU,c.VZ,c.vS,ee.p,Q.jL,Q.$3,et.wT,Q.pN,P.Hl,P.$z,at.g7,at.So,W.X6,W.Vh,W.bZ,W.bU,h.RG,h.rl,h.nJ,h.MV,h.TL,h.JW,h.yw,x.m_,x.An,T.fS,T.fg,ct.Ve,ct.VO,Z.uc,c.X1,c.l_,c.j4,c.JD,E.Wk],styles:[".products-request-grid{grid-template-columns:10px auto 150px 150px 150px 50px}\n"],encapsulation:2,changeDetection:0})}return i})();const ze=(i,n)=>(0,t.WQX)(qt).findAllProductionRequests(),wr=(i,n)=>n.id,Tr=i=>({"pointer-events-none":i}),$r=()=>[5,10,25,100],Or=(i,n,e)=>({"bg-cyan-700 text-cyan-50":i,"bg-blue-700 text-blue-50":n,"bg-red-700 text-red-50":e}),jr=(i,n,e,o,r,s)=>({"bg-amber-700 text-amber-50":i,"bg-orange-700 text-orange-50":n,"bg-cyan-700 text-cyan-50":e,"bg-blue-700 text-blue-50":o,"bg-green-700 text-green-50":r,"bg-red-700 text-red-50":s}),qr=i=>["/modules/production/requests",i];function Nr(i,n){1&i&&t.nrm(0,"mat-icon",39),2&i&&t.Y8G("svgIcon","mat_solid:done")}function Gr(i,n){1&i&&t.nrm(0,"mat-icon",39),2&i&&t.Y8G("svgIcon","mat_solid:done")}function Lr(i,n){1&i&&t.nrm(0,"mat-icon",39),2&i&&t.Y8G("svgIcon","mat_solid:done")}function Mr(i,n){1&i&&t.nrm(0,"mat-icon",39),2&i&&t.Y8G("svgIcon","mat_solid:done")}function Ar(i,n){1&i&&t.nrm(0,"mat-icon",39),2&i&&t.Y8G("svgIcon","mat_solid:done")}function Br(i,n){if(1&i){const e=t.RV6();t.j41(0,"div",27)(1,"div",29),t.nrm(2,"mat-icon",30),t.j41(3,"div",31),t.EFF(4),t.nI1(5,"date"),t.k0s()(),t.j41(6,"div",32),t.EFF(7),t.k0s(),t.j41(8,"div",33),t.nrm(9,"mat-icon",30),t.j41(10,"div",32),t.EFF(11),t.k0s()(),t.j41(12,"div",33),t.nrm(13,"mat-icon",30),t.j41(14,"div",32),t.EFF(15),t.nI1(16,"date"),t.k0s()(),t.j41(17,"div",34)(18,"span",35),t.EFF(19),t.k0s()(),t.j41(20,"div",36)(21,"span",35),t.EFF(22),t.k0s()(),t.j41(23,"div",37)(24,"button",38),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.approveProductionRequest(r))}),t.nrm(25,"mat-icon",39),t.k0s(),t.j41(26,"div")(27,"button",40),t.nrm(28,"mat-icon",39),t.k0s(),t.j41(29,"mat-menu",null,0)(31,"div",41),t.EFF(32," Actualizar Estado "),t.k0s(),t.j41(33,"button",42),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.changeProductionRequestStatus(r,s.ProductionRequestStatusEnum.PENDING))}),t.DNE(34,Nr,1,1,"mat-icon",39),t.j41(35,"span",43),t.EFF(36,"Pendiente"),t.k0s()(),t.j41(37,"button",42),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.changeProductionRequestStatus(r,s.ProductionRequestStatusEnum.IN_PRODUCTION))}),t.DNE(38,Gr,1,1,"mat-icon",39),t.j41(39,"span",43),t.EFF(40,"En Producci\xf3n"),t.k0s()(),t.j41(41,"button",42),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.changeProductionRequestStatus(r,s.ProductionRequestStatusEnum.COMPLETED))}),t.DNE(42,Lr,1,1,"mat-icon",39),t.j41(43,"span",43),t.EFF(44,"Completada"),t.k0s()(),t.j41(45,"button",42),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.changeProductionRequestStatus(r,s.ProductionRequestStatusEnum.CANCELLED))}),t.DNE(46,Mr,1,1,"mat-icon",39),t.j41(47,"span",43),t.EFF(48,"Cancelada"),t.k0s()(),t.j41(49,"button",42),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.changeProductionRequestStatus(r,s.ProductionRequestStatusEnum.REJECTED))}),t.DNE(50,Ar,1,1,"mat-icon",39),t.j41(51,"span",43),t.EFF(52,"Rechazada"),t.k0s()()()(),t.j41(53,"button",44),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.generateProductionRequestDocument(r))}),t.nrm(54,"mat-icon",39),t.k0s(),t.j41(55,"button",45),t.nrm(56,"mat-icon",39),t.k0s(),t.j41(57,"button",46),t.bIt("click",function(){const r=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.deleteProductionRequest(r))}),t.nrm(58,"mat-icon",39),t.k0s()()()}if(2&i){const e=n.$implicit,o=t.sdS(30),r=t.XpG(2);t.R7$(2),t.Y8G("svgIcon","mat_solid:date_range"),t.R7$(2),t.SpI(" ",t.i5U(5,31,e.requestedDate,"dd/MM/yyyy")," "),t.R7$(3),t.SpI(" ",e.no," "),t.R7$(2),t.Y8G("svgIcon","mat_solid:person"),t.R7$(2),t.SpI(" ",e.requestedBy," "),t.R7$(2),t.Y8G("svgIcon","mat_solid:date_range"),t.R7$(2),t.SpI(" ",t.i5U(16,34,e.dueDate,"dd/MM/yyyy")," "),t.R7$(3),t.Y8G("ngClass",t.sMw(37,Or,"LOW"===e.priority,"NORMAL"===e.priority,"HIGH"===e.priority)),t.R7$(),t.SpI(" ",r.translatePriority(e.priority)," "),t.R7$(2),t.Y8G("ngClass",t.l4e(41,jr,"PENDING"===e.status,"REJECTED"===e.status,"APPROVED"===e.status,"IN_PRODUCTION"===e.status,"COMPLETED"===e.status,"CANCELLED"===e.status)),t.R7$(),t.SpI(" ",r.translateStatus(e.status)," "),t.R7$(2),t.Y8G("disabled","APPROVED"===e.status),t.R7$(),t.Y8G("svgIcon","mat_solid:task"),t.R7$(2),t.Y8G("matMenuTriggerFor",o),t.R7$(),t.Y8G("svgIcon","mat_solid:update"),t.R7$(5),t.Y8G("disabled",e.status.includes("APPROVED")||e.status.includes("IN_PRODUCTION")||e.status.includes("COMPLETED")),t.R7$(),t.vxM(e.status.includes("PENDING")?34:-1),t.R7$(3),t.Y8G("disabled",e.status.includes("CANCELLED")||e.status.includes("REJECTED")),t.R7$(),t.vxM(e.status.includes("IN_PRODUCTION")?38:-1),t.R7$(3),t.Y8G("disabled",e.status.includes("COMPLETED")||e.status.includes("CANCELLED")||e.status.includes("REJECTED")),t.R7$(),t.vxM(e.status.includes("COMPLETED")?42:-1),t.R7$(3),t.Y8G("disabled",e.status.includes("COMPLETED")||e.status.includes("CANCELLED")||e.status.includes("REJECTED")),t.R7$(),t.vxM(e.status.includes("CANCELLED")?46:-1),t.R7$(3),t.Y8G("disabled",e.status.includes("COMPLETED")||e.status.includes("CANCELLED")||e.status.includes("REJECTED")),t.R7$(),t.vxM(e.status.includes("REJECTED")?50:-1),t.R7$(4),t.Y8G("svgIcon","mat_solid:description"),t.R7$(),t.Y8G("routerLink",t.eq3(48,qr,e.id))("disabled","PENDING"!==e.status),t.R7$(),t.Y8G("svgIcon","mat_solid:edit"),t.R7$(),t.Y8G("disabled","PENDING"!==e.status),t.R7$(),t.Y8G("svgIcon","mat_solid:delete")}}function Yr(i,n){if(1&i&&(t.j41(0,"div",22)(1,"div",23)(2,"div",24),t.EFF(3," Fecha de Solicitud "),t.k0s(),t.j41(4,"div",25),t.EFF(5," N\xba "),t.k0s(),t.j41(6,"div",24),t.EFF(7," Solicitado por "),t.k0s(),t.j41(8,"div",24),t.EFF(9," Fecha de Entrega "),t.k0s(),t.j41(10,"div",24),t.EFF(11," Prioridad "),t.k0s(),t.j41(12,"div",24),t.EFF(13," Estado "),t.k0s(),t.j41(14,"div",26),t.EFF(15,"Acciones"),t.k0s()(),t.Z7z(16,Br,59,50,"div",27,wr),t.k0s(),t.nrm(18,"mat-paginator",28)),2&i){const e=t.XpG();t.R7$(2),t.Y8G("mat-sort-header","requestedDate"),t.R7$(2),t.Y8G("mat-sort-header","no"),t.R7$(2),t.Y8G("mat-sort-header","requestedBy"),t.R7$(2),t.Y8G("mat-sort-header","dueDate"),t.R7$(2),t.Y8G("mat-sort-header","priority"),t.R7$(2),t.Y8G("mat-sort-header","status"),t.R7$(4),t.Dyx(e.productionRequestsStore.productionRequests()),t.R7$(2),t.Y8G("ngClass",t.eq3(12,Tr,e.isLoading))("length",e.productionRequestsStore.pagination().length)("pageIndex",e.productionRequestsStore.pagination().page)("pageSize",e.productionRequestsStore.pagination().size)("pageSizeOptions",t.lJ4(14,$r))("showFirstLastButtons",!0)}}function zr(i,n){1&i&&(t.j41(0,"div",21),t.EFF(1," \xa1No se ha registrado ninguna solicitud! "),t.k0s())}let Vr=(()=>{class i{constructor(){this.isLoading=!1,this.paginator=(0,t.ebz)(q.iy),this.productionRequestsStore=(0,t.WQX)(jt),this.searchInputControl=new c.MJ,this.selectedSlide=null,this.sort=(0,t.ebz)(S.B4),this.user=null,this.ProductionRequestStatusEnum=j,this.#t=(0,t.WQX)(t.gRc),this.#i=(0,t.WQX)(t.abz),this.#e=(0,t.WQX)(St.Q),this.#o=(0,t.WQX)(ot.G),this.#n=(0,t.WQX)(qt),this.#r=(0,t.WQX)(X.UG),this.#s=new f.B,this.#a=(0,t.WQX)(it.il)}#t;#i;#e;#o;#n;#r;#s;#a;ngOnInit(){this.searchInputControl.valueChanges.pipe((0,g.Q)(this.#s),(0,dt.B)(300),(0,st.n)(e=>(this.isLoading=!0,this.#n.findAllProductionRequests(this.productionRequestsStore.pagination().page,this.productionRequestsStore.pagination().size,this.sort().active,this.sort().direction,e))),(0,k.T)(()=>{this.isLoading=!1})).subscribe(),this.#a.select(Et.SW).pipe((0,C.pQ)(this.#i)).subscribe(e=>{this.user=e,this.#t.markForCheck()})}ngAfterViewInit(){this.sort()&&this.paginator()&&(this.sort().sort({id:"name",start:"asc",disableClear:!0}),this.#t.markForCheck(),this.sort().sortChange.pipe((0,C.pQ)(this.#i)).subscribe(()=>{this.paginator().pageIndex=0}),(0,ut.h)(this.sort().sortChange,this.paginator().page).pipe((0,st.n)(()=>(this.isLoading=!0,this.#n.findAllProductionRequests(this.paginator().pageIndex,this.paginator().pageSize,this.sort().active,this.sort().direction))),(0,k.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this.#s.next(null),this.#s.complete()}deleteProductionRequest(e){this.#o.open({title:"Cuidado",message:`\xbfEst\xe1 seguro que desea eliminar la solicitud de producci\xf3n: ${e.no}?`,icon:{show:!0,name:"mat_solid:question_mark",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,C.pQ)(this.#i)).subscribe(r=>{"confirmed"===r&&this.#n.removeProductionRequest(e.id).pipe((0,C.pQ)(this.#i)).subscribe(({data:s})=>{s&&(this.#r.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.removeProductionRequest.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#t.markForCheck())})})}translateStatus(e){switch(e){case j.PENDING:return"Pendiente";case j.REJECTED:return"Rechazada";case j.APPROVED:return"Aprobada";case j.IN_PRODUCTION:return"En producci\xf3n";case j.COMPLETED:return"Completada";case j.CANCELLED:return"Cancelada"}}translatePriority(e){switch(e){case Dt.LOW:return"Baja";case Dt.NORMAL:return"Normal";case Dt.HIGH:return"Alta"}}generateProductionRequestDocument(e){this.#e.generateProductionRequestDocument(e,this.user)}changeProductionRequestStatus(e,o){this.#o.open({title:"Cuidado",message:`\xbfEst\xe1 seguro que desea actualizar el estado de la solicitud de producci\xf3n: ${e.no}?`,icon:{show:!0,name:"mat_solid:question_mark",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,C.pQ)(this.#i)).subscribe(s=>{"confirmed"===s&&this.#n.changeProductionRequestStatus(e.id,o).pipe((0,C.pQ)(this.#i)).subscribe(({data:a})=>{a&&(this.#r.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.changeProductionRequestStatus.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#t.markForCheck())})})}approveProductionRequest(e){this.#o.open({title:"Cuidado",message:`\xbfEst\xe1 seguro que desea aprobar la solicitud de producci\xf3n: ${e.no}?`,icon:{show:!0,name:"mat_solid:question_mark",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,C.pQ)(this.#i)).subscribe(r=>{"confirmed"===r&&this.#n.approveProductionRequest(e.id).pipe((0,C.pQ)(this.#i)).subscribe(({data:s})=>{s&&(this.#r.openFromComponent(I.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.approveProductionRequest.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.#t.markForCheck())})})}static#c=this.\u0275fac=function(o){return new(o||i)};static#d=this.\u0275cmp=t.VBU({type:i,selectors:[["production-requests"]],viewQuery:function(o,r){1&o&&(t.wEZ(r.paginator,q.iy,5),t.wEZ(r.sort,S.B4,5)),2&o&&t.NyB(2)},standalone:!0,features:[t.aNF],decls:30,vars:9,consts:[["listStatusMenu","matMenu"],[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","md:flex-row","flex-0","md:items-center","md:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-3","text-secondary",3,"svgIcon"],["routerLink","/modules/production/dashboard",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","md:mt-0","md:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","","routerLink","new",1,"mt-4","text-white","sm:mt-0","bg-gradient-to-r","from-primary-500","to-primary-600","hover:to-primary-900","hover:shadow-lg"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","production-requests-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"flex","items-center","justify-center",3,"mat-sort-header"],[1,"flex","items-center","justify-start",3,"mat-sort-header"],[1,"text-center"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","production-requests-grid","md:px-8"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"flex","items-center"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-2","truncate"],[1,"truncate"],[1,"flex","flex-row","justify-center","space-x-1"],[1,"block","text-center"],[1,"px-2","py-1","text-xs","font-semibold","text-white","rounded-full","uppercase",3,"ngClass"],[1,"flex","justify-center","mr-3","text-center"],[1,"flex","flex-row","justify-center","gap-2"],["mat-stroked-button","","matTooltip","Aprobar Solicitud",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click","disabled"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","","matTooltip","Actualizar Estado",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matMenuTriggerFor"],[1,"w-full","p-2","text-lg","font-semibold","text-center","text-secondary"],["mat-menu-item","",1,"",3,"click","disabled"],[1,"ml-1","text-center"],["mat-stroked-button","","matTooltip","Ver Documento",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],["mat-stroked-button","","matTooltip","Editar",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink","disabled"],["mat-stroked-button","","matTooltip","Eliminar",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click","disabled"]],template:function(o,r){1&o&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div")(5,"a",5),t.EFF(6,"Inicio"),t.k0s()(),t.j41(7,"div",6),t.nrm(8,"mat-icon",7),t.j41(9,"a",8),t.EFF(10,"Producci\xf3n"),t.k0s()(),t.j41(11,"div",6),t.nrm(12,"mat-icon",7),t.j41(13,"a",9),t.EFF(14,"Solicitudes de Producci\xf3n"),t.k0s()()(),t.j41(15,"div",10)(16,"h2",11),t.EFF(17," Registro Solicitudes de Producci\xf3n "),t.k0s()()(),t.j41(18,"div",12)(19,"mat-form-field",13),t.nrm(20,"mat-icon",14)(21,"input",15),t.k0s(),t.j41(22,"button",16),t.nrm(23,"mat-icon",17),t.j41(24,"span",18),t.EFF(25,"Agregar"),t.k0s()()()(),t.j41(26,"div",19)(27,"div",20),t.DNE(28,Yr,19,15)(29,zr,2,0,"div",21),t.k0s()()()),2&o&&(t.R7$(8),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(4),t.Y8G("svgIcon","mat_solid:chevron_right"),t.R7$(7),t.Y8G("subscriptSizing","dynamic"),t.R7$(),t.Y8G("svgIcon","mat_solid:search"),t.R7$(),t.Y8G("formControl",r.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),t.R7$(2),t.Y8G("svgIcon","mat_solid:add"),t.R7$(5),t.vxM(r.productionRequestsStore.productionRequests().length>0?28:29))},dependencies:[R.vh,P.Hl,P.$z,h.RG,h.rl,h.JW,x.m_,x.An,T.fS,T.fg,q.Ou,q.iy,nt.D6,rt.mV,S.NQ,S.B4,S.aE,Z.uc,Z.oV,K.Cn,K.kk,K.fb,K.Cp,R.YU,c.X1,c.me,c.BC,c.l_,E.Wk],styles:[".production-requests-grid{grid-template-columns:150px 100px auto 150px 100px 100px 250px}\n"],encapsulation:2,changeDetection:0})}return i})();var Xr=l(23301),Qr=l(36646),Hr=l(79451),Ve=l(43801);const ts=[{path:"",component:H,children:[{path:"",pathMatch:"full",redirectTo:"dashboard"},{path:"dashboard",component:sr,resolve:{depots:l(16551).MQ,productionRequests:ze,productionOrders:Me,productionPreferences:(i,n)=>(0,t.WQX)(Be).findProductionPreferencesByMerchant()}},{path:"data-sheets",component:go,resolve:{dataSheets:(i,n)=>(0,t.WQX)(lt).findAllProductionDataSheets(),products:Ve.bN}},{path:"data-sheets/:productionDataSheetId",component:Ki,resolve:{categories:Hr.V7,currencies:Xr.I,products:Ve.Tn,productionDataSheet:(i,n)=>{const e=i.params.productionDataSheetId;return e&&"new"!==e?(0,t.WQX)(lt).findProductionDataSheetById(e):{}}}},{path:"requests",component:Vr,resolve:{productionRequests:ze}},{path:"requests/:productionRequestId",component:Ir,resolve:{customers:Qr.iL,dataSheets:(i,n)=>(0,t.WQX)(lt).findActiveProductionDataSheets(),productionRequest:(i,n)=>{const e=i.params.productionRequestId;return e&&"new"!==e?(0,t.WQX)(qt).findProductionRequestById(e):{}}}},{path:"orders",component:hn,resolve:{productionOrders:Me}},{path:"line",component:en,resolve:{productionOrders:(i,n)=>(0,t.WQX)($t).findProductionOrdersForProductionLine()}},{path:"**",redirectTo:"dashboard"}]}]}}]);