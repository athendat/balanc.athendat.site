"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[9844],{49098:(Ge,ce,d)=>{d.d(ce,{O:()=>j});var g=d(88141),e=d(96354),W=d(24984),p=d(98216),a=d(53473);const v=a.J1`
    mutation CreateLocation($createLocationInput: CreateLocationInput!) {
        createLocation(createLocationInput: $createLocationInput) {

            ok
            message

            location {
                id
                active
                managerId
                # manager {
                #     name
                # }
                name
                slug
                phone
                address
                country
                state
                city
                zip
            }

        }
    }
`,m=a.J1`
    mutation UpdateLocation($updateLocationInput: UpdateLocationInput!) {
        updateLocation(updateLocationInput: $updateLocationInput) {
            ok
            message

            location {
                id
                active
                managerId
                # manager {
                #     name
                # }
                name
                slug
                phone
                address
                country
                state
                city
                zip
            }
        }
    }
`,C=a.J1`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateLocationStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }

    }
`,k=a.J1`
    mutation RemoveLocation($removeLocationId: String!) {
        removeLocation(id: $removeLocationId) {
            ok
            message
        }
    }
`,I=a.J1`
    query FindAllLocations($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllLocations(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length,
                size,
                page,
                lastPage,
                startIndex,
                endIndex
            },

            locations {
                id
                active
                managerId
                manager {
                    id
                    name
                    lastname1
                    lastname2
                    fullname
                }
                name
                slug
                phone
                address
                country
                state
                city
                zip
            }
        }
    }
`,Q=a.J1`
    query findActiveLocations($search: String!, $size: Int!) {
        findActiveLocations(search: $search, size: $size) {
            id
            active
            managerId
            name
            slug
            phone
            address
            country
            state
            city
            zip
        }
    }
`,de=a.J1`
    query FindLocationById($findLocationByIdId: String!) {
        findLocationById(id: $findLocationByIdId) {
            ok
            message

            location {
                id
                active
                managerId
                # manager {
                #     name
                # }
                name
                slug
                phone
                address
                country
                state
                city
                zip
            }
        }
    }
`;var F=d(54438),E=d(59640);let j=(()=>{class V{constructor(f,x){this.apolloProvider=f,this.store=x,this._apollo=this.apolloProvider.use("BALANC")}createLocation(f){return this._apollo.mutate({mutation:v,variables:{createLocationInput:f},errorPolicy:"all"}).pipe((0,g.M)(({data:x})=>{x&&(this.store.dispatch((0,W.yJ)({location:x.createLocation.location})),this.store.dispatch((0,W.Og)({location:x.createLocation.location})))}))}getLocations(f=0,x=25,_="name",b="asc",G=""){return this._apollo.query({query:I,errorPolicy:"all",variables:{page:f,size:x,sort:_,order:b,search:G}}).pipe((0,g.M)(({data:A})=>{A&&(this.store.dispatch((0,p.Bp)({pagination:A.findAllLocations.pagination})),this.store.dispatch((0,W.xu)({locations:A.findAllLocations.locations})))}))}findActiveLocations(f="",x=25){return this._apollo.query({query:Q,variables:{search:f,size:x},errorPolicy:"all"}).pipe((0,e.T)(({data:_})=>_?_.findActiveLocations:[]),(0,g.M)(_=>{_&&this.store.dispatch((0,W.xu)({locations:_}))}))}getLocationById(f){return this._apollo.query({query:de,variables:{findLocationByIdId:f},errorPolicy:"all"}).pipe((0,g.M)(({data:x})=>{x&&this.store.dispatch((0,W.Og)({location:x.findLocationById.location}))}))}updateLocation(f){return this._apollo.mutate({mutation:m,variables:{updateLocationInput:f},errorPolicy:"all"}).pipe((0,g.M)(({data:x})=>{x&&(this.store.dispatch((0,W.Nt)({location:x.updateLocation.location})),this.store.dispatch((0,W.Og)({location:x.updateLocation.location})))}))}updateLocationStatus(f){return this._apollo.mutate({mutation:C,variables:{updateEntityStatusInput:f},errorPolicy:"all"}).pipe((0,g.M)(({data:x})=>{x&&this.store.dispatch((0,W.jr)({id:f.id,active:f.active}))}))}removeLocation(f){return this._apollo.mutate({mutation:k,variables:{removeLocationId:f},errorPolicy:"all"}).pipe((0,g.M)(({data:x})=>{x&&this.store.dispatch((0,W.q$)({id:f}))}))}static#e=this.\u0275fac=function(x){return new(x||V)(F.KVO(a.Ic),F.KVO(E.il))};static#t=this.\u0275prov=F.jDH({token:V,factory:V.\u0275fac,providedIn:"root"})}return V})()},47399:(Ge,ce,d)=>{d.d(ce,{T:()=>p,l:()=>W});var g=d(54438),e=d(36596);const W=(a,v)=>(0,g.WQX)(e.m).getBrands(),p=(a,v)=>(0,g.WQX)(e.m).findActiveBrands()},67943:(Ge,ce,d)=>{d.d(ce,{DC:()=>p});var g=d(59640);const e=a=>a.brands,p=((0,g.Mz)(e,a=>a.brand),(0,g.Mz)(e,a=>a.brands))},36596:(Ge,ce,d)=>{d.d(ce,{m:()=>u});var g=d(54438),e=d(53473),W=d(96697),p=d(25558),a=d(88141),v=d(59640),m=d(17022),C=d(98216),k=d(67943);const I=e.J1`
    mutation CreateBrand($createBrandInput: CreateBrandInput!) {
        createBrand(createBrandInput: $createBrandInput) {

            ok
            message

            brand {
                id
                active
                name
                description
                logo
            }

        }
    }
`,Q=e.J1`
    mutation UpdateBrand($updateBrandInput: UpdateBrandInput!) {
        updateBrand(updateBrandInput: $updateBrandInput) {
            ok
            message

            brand {
                id
                active
                name
                description
                logo
            }
        }
    }
`,de=e.J1`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateBrandStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }

    }
`,F=e.J1`
    mutation RemoveBrand($removeBrandId: String!) {
        removeBrand(id: $removeBrandId) {
            ok
            message
        }
    }
`,E=e.J1`
    query FindAllBrands($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllBrands(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            brands {
                id
                active
                name
                description
                slug
            }
        }
    }
`,j=e.J1`
    query FindActiveBrands($search: String!, $size: Int!) {
        findActiveBrands(search: $search, size: $size) {
            ok
            message

            brands {
                id
                name
                slug
            }
        }
    }
`,V=e.J1`
    query FindBrandById($findBrandByIdId: String!) {
        findBrandById(id: $findBrandByIdId) {
            ok
            message

            brand {
                id
                active
                name
                description
                slug
                logo
            }
        }
    }
`;let u=(()=>{class f{constructor(){this.apolloProvider=(0,g.WQX)(e.Ic),this.store=(0,g.WQX)(v.il),this._apollo=this.apolloProvider.use("BALANC")}createBrand(_){return this.store.select(k.DC).pipe((0,W.s)(1),(0,p.n)(b=>this._apollo.mutate({mutation:I,variables:{createBrandInput:_},errorPolicy:"all"}).pipe((0,a.M)(({data:G})=>{const A=structuredClone(b);A.push(G.createBrand.brand),this.store.dispatch((0,m.VO)({brands:A}))}))))}getBrands(_=0,b=20,G="code",A="asc",B=""){return this._apollo.query({query:E,errorPolicy:"all",variables:{page:_,size:b,sort:G,order:A,search:B}}).pipe((0,a.M)(({data:q})=>{this.store.dispatch((0,C.Bp)({pagination:q.findAllBrands.pagination})),this.store.dispatch((0,m.VO)({brands:q.findAllBrands.brands}))}))}findActiveBrands(_="",b=50){return this._apollo.query({query:j,errorPolicy:"all",variables:{search:_,size:b}}).pipe((0,a.M)(({data:G})=>{this.store.dispatch((0,m.VO)({brands:G.findActiveBrands.brands}))}))}getBrandById(_){return this._apollo.query({query:V,variables:{findBrandByIdId:_},errorPolicy:"all"}).pipe((0,a.M)(({data:b})=>{this.store.dispatch((0,m.aA)({brand:b.findBrandById.brand}))}))}updateBrand(_){return this.store.select(k.DC).pipe((0,W.s)(1),(0,p.n)(b=>this._apollo.mutate({mutation:Q,variables:{updateBrandInput:_},errorPolicy:"all"}).pipe((0,a.M)(({data:G})=>{const A=structuredClone(b);A[b.findIndex(q=>q.id===_.id)]=G.updateBrand.brand,this.store.dispatch((0,m.VO)({brands:A}))}))))}updateBrandStatus(_){return this.store.select(k.DC).pipe((0,W.s)(1),(0,p.n)(b=>this._apollo.mutate({mutation:de,variables:{updateEntityStatusInput:_},errorPolicy:"all"}).pipe((0,a.M)(()=>{const G=structuredClone(b);G[b.findIndex(B=>B.id===_.id)].active=_.active,this.store.dispatch((0,m.VO)({brands:G}))}))))}removeBrand(_){return this.store.select(k.DC).pipe((0,W.s)(1),(0,p.n)(b=>this._apollo.mutate({mutation:F,variables:{removeBrandId:_},errorPolicy:"all"}).pipe((0,a.M)(({})=>{const A=structuredClone(b),B=b.findIndex(q=>q.id===_);A.splice(B,1),this.store.dispatch((0,m.VO)({brands:A}))}))))}static#e=this.\u0275fac=function(b){return new(b||f)};static#t=this.\u0275prov=g.jDH({token:f,factory:f.\u0275fac,providedIn:"root"})}return f})()},49844:(Ge,ce,d)=>{d.r(ce),d.d(ce,{default:()=>Uu});var g=d(51188),e=d(54438);let W=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["app-warehouse"]],standalone:!0,features:[e.aNF],decls:1,vars:0,template:function(i,n){1&i&&e.nrm(0,"router-outlet")},dependencies:[g.n3],encapsulation:2})}return o})();var p=d(60177),a=d(89417),v=d(88834),m=d(32102),C=d(99213),k=d(59042),I=d(96695),Q=d(9183),de=d(30450),F=d(2042),E=d(7673),j=d(21413),V=d(57786),u=d(56977),f=d(70152),x=d(99172),_=d(25558),b=d(96354),G=d(97586),A=d(77235),B=d(82643),q=d(53159),se=d(47413),re=d(63729),T=d(94794),X=d(75351),O=d(95416),S=d(59640),Ct=d(29217),ae=d(46601),ue=d(69599),Z=d(82798),D=d(60850),U=d(70980),L=d(31397),mo=d(62590),oe=d(86600);const po=o=>({"fuse-mat-rounded":o});function ho(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-option",7),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.addEmployee(n))}),e.EFF(1),e.k0s()}if(2&o){const t=s.$implicit;e.Y8G("value",t.name),e.R7$(),e.SpI(" ",t.fullname," ")}}function fo(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-icon",8),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.resetEmployee())}),e.k0s()}}let go=(()=>{class o{constructor(){this.rounded=!0,this.labelName="Empleado",this.selectedEmployee=null,this.searchEmployeesControl=new a.MJ(null),this.isLoading=!1,this.employeeChange=new e.bkB,this._changeDetectorRef=(0,e.WQX)(e.gRc),this._employeesService=(0,e.WQX)(mo.r),this._unsubscribeAll=new j.B,this.store=(0,e.WQX)(S.il)}ngOnInit(){this.employees$=this.store.select(Ct.OB),this.employeesFiltered=this.searchEmployeesControl.valueChanges.pipe((0,f.B)(200),(0,x.Z)(null),(0,U.j)(()=>{this.isLoading=!1}),(0,L.Z)(t=>null!==t&&"string"==typeof t&&(this.selectedEmployee&&t!==this.selectedEmployee.name||!this.selectedEmployee)?(this.isLoading=!0,this._employeesService.findActiveEmployees(t.trim())):this.employees$))}ngAfterViewInit(){this.selectedEmployee&&this.searchEmployeesControl.setValue(this.selectedEmployee.name,{emitEvent:!1})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}addEmployee(t){this.selectedEmployee=t,this.employeeChange.next(t),this._changeDetectorRef.markForCheck()}resetEmployee(){this.selectedEmployee=null,this.searchEmployeesControl.setValue(""),this.employeeChange.next(null),this._changeDetectorRef.markForCheck()}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["autocomplete-employees"]],inputs:{rounded:"rounded",labelName:"labelName",selectedEmployee:"selectedEmployee"},outputs:{employeeChange:"employeeChange"},standalone:!0,features:[e.aNF],decls:11,vars:12,consts:[["employeesEmployeesAutocomplete","matAutocomplete"],["appearance","fill",1,"w-full","fuse-mat-dense","fuse-mat-no-subscript",3,"ngClass","subscriptSizing"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete"],[3,"value"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer"],[3,"click","value"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer",3,"click"]],template:function(i,n){if(1&i&&(e.j41(0,"mat-form-field",1),e.nrm(1,"mat-icon",2),e.j41(2,"mat-label"),e.EFF(3),e.k0s(),e.nrm(4,"input",3),e.j41(5,"mat-autocomplete",4,0),e.Z7z(7,ho,2,2,"mat-option",5,e.fX1),e.nI1(9,"async"),e.k0s(),e.DNE(10,fo,1,0,"mat-icon",6),e.k0s()),2&i){const r=e.sdS(6);e.Y8G("ngClass",e.eq3(10,po,n.rounded))("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(2),e.JRh(n.labelName),e.R7$(),e.Y8G("formControl",n.searchEmployeesControl)("matAutocomplete",r)("placeholder","Filtre por Empleado"),e.R7$(3),e.Dyx(e.bMT(9,8,n.employeesFiltered)),e.R7$(3),e.vxM(10,n.selectedEmployee?10:-1)}},dependencies:[D.jL,D.$3,oe.wT,D.pN,C.m_,C.An,a.X1,a.me,a.BC,a.l_,m.RG,m.rl,m.nJ,m.JW,m.yw,p.YU,p.Jj,k.fS,k.fg],encapsulation:2,changeDetection:0})}return o})();function _o(o,s){1&o&&(e.j41(0,"h2",2),e.EFF(1," Agregar Almac\xe9n "),e.k0s())}function vo(o,s){1&o&&(e.j41(0,"h2",2),e.EFF(1," Editar Almac\xe9n "),e.k0s())}function bo(o,s){if(1&o&&(e.j41(0,"div",4)(1,"div",7)(2,"div",8)(3,"div",9)(4,"div",10)(5,"h6",11),e.EFF(6,"Nombre"),e.k0s(),e.j41(7,"span",12),e.EFF(8),e.k0s()()()()()()),2&o){const t=e.XpG();e.R7$(8),e.JRh(t.data.depot.name||"Sin nombre")}}function Co(o,s){1&o&&(e.j41(0,"mat-hint"),e.EFF(1,"Restringir apertura de per\xedodos de inventario. Este caso no restringe."),e.k0s())}function Fo(o,s){if(1&o&&(e.j41(0,"mat-hint"),e.EFF(1),e.k0s()),2&o){const t=e.XpG(2);e.R7$(),e.SpI("Restringir apertura de per\xedodos de inventario. Ejem: Se limita a abrir solo un inventario de este almac\xe9n al ","day"===t.depotForm.get("periodRestriction").value?"D\xeda.":"year"===t.depotForm.get("periodRestriction").value?"A\xf1o.":"","")}}function ko(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",5)(1,"div",13)(2,"form",14)(3,"mat-form-field",15)(4,"mat-label"),e.EFF(5,"Nombre"),e.k0s(),e.nrm(6,"input",16),e.k0s(),e.j41(7,"mat-form-field",15)(8,"mat-label"),e.EFF(9,"C\xf3digo en Versat"),e.k0s(),e.nrm(10,"input",17),e.j41(11,"mat-hint"),e.EFF(12,"C\xf3digo del almac\xe9n en Sistema Contable Versat"),e.k0s()(),e.j41(13,"autocomplete-employees",18),e.bIt("employeeChange",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.selectEmployee(n))}),e.k0s(),e.j41(14,"div",19)(15,"mat-form-field",20)(16,"mat-label"),e.EFF(17,"Restricci\xf3n en per\xedodos"),e.k0s(),e.j41(18,"mat-select",21)(19,"mat-option",22),e.EFF(20,"D\xeda"),e.k0s(),e.j41(21,"mat-option",22),e.EFF(22,"A\xf1o"),e.k0s(),e.j41(23,"mat-option",22),e.EFF(24,"Ninguno"),e.k0s()(),e.DNE(25,Co,2,0,"mat-hint")(26,Fo,2,1),e.k0s()()()()()}if(2&o){const t=e.XpG();e.R7$(2),e.Y8G("formGroup",t.depotForm)("autocomplete","off"),e.R7$(4),e.Y8G("formControlName","name")("placeholder","Nombre del Almac\xe9n"),e.R7$(4),e.Y8G("formControlName","codev")("placeholder","Ejemplo: 0001"),e.R7$(3),e.Y8G("selectedEmployee",t.data.depot.manager)("rounded",!1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","periodRestriction"),e.R7$(),e.Y8G("value","day"),e.R7$(2),e.Y8G("value","year"),e.R7$(2),e.Y8G("value","none"),e.R7$(2),e.vxM(25,"none"===t.depotForm.get("periodRestriction").value?25:26)}}function xo(o,s){if(1&o){const t=e.RV6();e.j41(0,"button",25),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.updateDepot())}),e.EFF(1," Actualizar "),e.k0s()}if(2&o){const t=e.XpG(2);e.Y8G("color","primary")("disabled",t.depotForm.invalid)}}function yo(o,s){if(1&o){const t=e.RV6();e.j41(0,"button",25),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.createDepot())}),e.EFF(1," Agregar "),e.k0s()}if(2&o){const t=e.XpG(2);e.Y8G("color","primary")("disabled",t.depotForm.invalid)}}function So(o,s){if(1&o&&(e.j41(0,"div",6)(1,"button",23),e.EFF(2," Cancelar "),e.k0s(),e.DNE(3,xo,2,2,"button",24)(4,yo,2,2,"button",24),e.k0s()),2&o){const t=e.XpG();e.R7$(),e.Y8G("matDialogClose","cancelled"),e.R7$(2),e.vxM(3,"edit"===t.data.dialogMode?3:-1),e.R7$(),e.vxM(4,"add"===t.data.dialogMode?4:-1)}}let Io=(()=>{class o{#e;constructor(t){this.data=t,this.employees=[],this.dialogMode="view",this.imageChangedEvent="",this.croppedImage="",this._unsubscribeAll=new j.B,this._depotsService=(0,e.WQX)(ue.t),this._changeDetectorRef=(0,e.WQX)(e.gRc),this._formBuilder=(0,e.WQX)(a.ok),this._fuseConfirmationService=(0,e.WQX)(ae.G),this._dialogRef=(0,e.WQX)(X.CP),this._snackBar=(0,e.WQX)(O.UG),this.#e=(0,e.WQX)(S.il),this.dialogMode=t.dialogMode,this.depot=t.depot}ngOnInit(){this.depotForm=this._formBuilder.group({id:[null],name:[null,[a.k0.required,a.k0.minLength(3),a.k0.maxLength(255)]],codev:[null],managerId:[null],periodRestriction:[null]}),"edit"===this.dialogMode&&this.depotForm.patchValue(this.depot),this.#e.select(Ct.OB).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.employees=t,this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}selectEmployee(t){this.depotForm.get("managerId").setValue(t?t.id:null)}closeDialog(){this._dialogRef.close()}createDepot(){const t=this.depotForm.getRawValue();delete t.id,this._fuseConfirmationService.open({title:"Crear almac\xe9n",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{"confirmed"===n&&this._depotsService.createDepot(t).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(({data:r})=>{r&&(this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:r.createDepot.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._dialogRef.close())})})}updateDepot(){const t=this.depotForm.getRawValue();this._fuseConfirmationService.open({title:"Actualizar almac\xe9n",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._depotsService.updateDepot(t).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(({data:r})=>{r&&(this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:r.updateDepot.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._dialogRef.close())})})}static#t=this.\u0275fac=function(i){return new(i||o)(e.rXU(X.Vh))};static#o=this.\u0275cmp=e.VBU({type:o,selectors:[["warehouse-depot-dialog"]],standalone:!0,features:[e.aNF],decls:8,vars:5,consts:[[1,"relative","flex","flex-col","w-full","max-h-screenl"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],[1,"text-2xl","text-gray-400"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","py-6","sm:flex-row","sm:items-start","sm:pb-8"],[1,"flex-auto"],[1,"w-full","overflow-hidden"],[1,"flex","items-center","justify-between","px-6","py-4","space-x-3","sm:justify-betweenbg-gray-50","dark:bg-black/10"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"flex","flex-col"],[1,"grid","grid-cols-2","w-full","my-1","gap-5",3,"formGroup","autocomplete"],[1,"w-full","fuse-mat-dense"],["matInput","","type","text","required","","maxlength","250",3,"formControlName","placeholder"],["matInput","","type","text","maxlength","250",3,"formControlName","placeholder"],["labelName","Responsable",3,"employeeChange","selectedEmployee","rounded"],[1,"w-full"],[1,"w-full","fuse-mat-dense",3,"subscriptSizing"],[3,"formControlName"],[3,"value"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","disabled"],["mat-flat-button","",3,"click","color","disabled"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"div",1),e.DNE(2,_o,2,0,"h2",2)(3,vo,2,0,"h2",2),e.k0s(),e.j41(4,"div",3),e.DNE(5,bo,9,1,"div",4)(6,ko,27,14,"div",5),e.k0s(),e.DNE(7,So,5,3,"div",6),e.k0s()),2&i&&(e.R7$(2),e.vxM(2,"add"===n.data.dialogMode?2:-1),e.R7$(),e.vxM(3,"edit"===n.data.dialogMode?3:-1),e.R7$(2),e.vxM(5,"view"===n.data.dialogMode?5:-1),e.R7$(),e.vxM(6,6),e.R7$(),e.vxM(7,"view"!==n.data.dialogMode?7:-1))},dependencies:[v.Hl,v.$z,X.hM,X.tx,m.RG,m.rl,m.nJ,m.MV,C.m_,k.fS,k.fg,Z.Ve,Z.VO,oe.wT,a.X1,a.qT,a.me,a.BC,a.cb,a.YS,a.tU,a.j4,a.JD,go],encapsulation:2,changeDetection:0})}return o})();class Ro{}var fe=d(70819),H=d(64193);const Eo=(o,s)=>s.id,$o=()=>({wheelPropagation:!1}),jo=(o,s)=>({"pointer-events-none":o,hidden:s}),Do=()=>[10,25,50,100];function wo(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-slide-toggle",33),e.bIt("change",function(n){e.eBV(t);const r=e.XpG(),l=r.$implicit,c=r.$index,h=e.XpG(3);return e.Njj(h.updateDepotStatus(n,l,c))}),e.k0s()}if(2&o){const t=e.XpG().$implicit;e.Y8G("checked",t.active)("color","primary")}}function Mo(o,s){1&o&&e.nrm(0,"mat-spinner",28),2&o&&e.Y8G("diameter",20)("color","primary")}function Go(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",23)(1,"div",25),e.EFF(2),e.k0s(),e.j41(3,"div",25),e.EFF(4),e.k0s(),e.j41(5,"div",26),e.EFF(6),e.k0s(),e.j41(7,"div",25),e.DNE(8,wo,1,2,"mat-slide-toggle",27)(9,Mo,1,2,"mat-spinner",28),e.k0s(),e.j41(10,"div",29)(11,"button",30),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(3);return e.Njj(r.updateDepot(n))}),e.nrm(12,"mat-icon",31),e.k0s(),e.j41(13,"button",32),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(3);return e.Njj(r.deleteDepot(n.id))}),e.nrm(14,"mat-icon",31),e.k0s()()()}if(2&o){const t=s.$implicit,i=s.$index,n=e.XpG(3);e.R7$(2),e.SpI(" ",t.code," "),e.R7$(2),e.SpI(" ",t.codev," "),e.R7$(2),e.SpI(" ",t.name," "),e.R7$(2),e.vxM(8,n.isSlideLoading&&n.selectedSlide===i?-1:8),e.R7$(),e.vxM(9,n.isSlideLoading&&n.selectedSlide===i?9:-1),e.R7$(3),e.Y8G("svgIcon","mat_solid:edit"),e.R7$(),e.Y8G("disabled",t.static),e.R7$(),e.Y8G("svgIcon","mat_solid:delete")}}function To(o,s){if(1&o&&(e.j41(0,"div",19)(1,"div",20)(2,"div",21),e.EFF(3,"C\xf3digo"),e.k0s(),e.j41(4,"div",21),e.EFF(5,"C\xf3digo en Versat"),e.k0s(),e.j41(6,"div",21),e.EFF(7,"Nombre"),e.k0s(),e.j41(8,"div"),e.EFF(9,"Activo"),e.k0s(),e.j41(10,"div",22),e.EFF(11,"Acciones"),e.k0s()(),e.Z7z(12,Go,15,8,"div",23,Eo),e.nrm(14,"mat-paginator",24),e.k0s()),2&o){const t=e.XpG(),i=e.XpG();e.R7$(2),e.Y8G("mat-sort-header","code"),e.R7$(2),e.Y8G("mat-sort-header","codev"),e.R7$(2),e.Y8G("mat-sort-header","name"),e.R7$(6),e.Dyx(t),e.R7$(2),e.Y8G("ngClass",e.l_i(9,jo,i.isLoading,i.pagination.length<10&&i.pagination.page<1))("length",i.pagination.length)("pageIndex",i.pagination.page)("pageSize",i.pagination.size)("pageSizeOptions",e.lJ4(12,Do))("showFirstLastButtons",!0)}}function Po(o,s){1&o&&(e.j41(0,"div",34),e.EFF(1," \xa1No se ha creado ninguna almac\xe9n! "),e.k0s())}function Ao(o,s){1&o&&e.DNE(0,To,15,13,"div",19)(1,Po,2,0),2&o&&e.vxM(0,s.length>0?0:1)}B.vfs=A.b.vfs;let Bo=(()=>{class o{constructor(t,i,n,r,l,c){this._depotsService=t,this._changeDetectorRef=i,this._fuseConfirmationService=n,this._dialog=r,this._snackBar=l,this.store=c,this.depots=[],this.depots$=(0,E.of)([]),this.isLoading=!1,this.isSlideLoading=!1,this.merchant=null,this.merchantInputControl=new a.MJ,this.searchInputControl=new a.MJ(null),this.selectedSlide=null,this.user=null,this._unsubscribeAll=new j.B}ngOnInit(){this.store.select(re.SW).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(fe.Xb).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.depots$=this.store.select(q.c_),this.depots$.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.depots=t,this._changeDetectorRef.markForCheck()}),this.store.select(se.Dz).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,u.Q)(this._unsubscribeAll),(0,f.B)(300),(0,x.Z)(null),(0,_.n)(t=>null!==t?(this.isLoading=!0,this._depotsService.getDepots(this.pagination.page,this.pagination.size,"code","asc",t)):(0,E.of)()),(0,b.T)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"code",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,V.h)(this._sort.sortChange,this._paginator.page).pipe((0,_.n)(()=>(this.isLoading=!0,this._depotsService.getDepots(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,b.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createDepot(){this._openDialog(new Ro,"add")}updateDepot(t){this._openDialog(t,"edit")}trackByFn(t,i){return t||i.id}updateDepotStatus(t,i,n){this.isSlideLoading=!0,this.selectedSlide=n,this._depotsService.updateDepotStatus({id:i.id,active:t.checked}).subscribe(({data:r})=>{this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:r.updateDepotStatus.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.isSlideLoading=!1,this.selectedSlide=null,this._changeDetectorRef.markForCheck()})}deleteDepot(t){this._fuseConfirmationService.open({title:"Eliminar almac\xe9n",message:"\xbfEsta seguro que desea eliminar el almac\xe9n?.",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._depotsService.removeDepot(t).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(({data:r})=>{r&&(this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:r.removeDepot.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck())}),this._changeDetectorRef.markForCheck()})}generatePDF(t="open"){const i={header:{text:"LISTADO DE MARCAS",style:"header",marginTop:5},content:[{lineHeight:1.3,table:{headerRows:1,widths:[30,"*",80],body:[[{text:"N\xba",style:"table_header"},{text:"Nombre de Marca",style:"table_header",alignment:"left"},{text:"Estado",style:"table_header"}],...this.depots.map(n=>[{text:this.depots.indexOf(n)+1,alignment:"center",style:"table_body"},{text:n.name,style:"table_body"},{text:!0===n.active?"ACTIVA":"INACTIVA",alignment:"center",style:"table_body"}])]},layout:"lightHorizontalLines",margin:[0,30,0,20]}],footer:(n,r)=>({table:{widths:["*","*"],body:[[{text:`Reporte generador por: ${this.user.fullname} | Esta informaci\xf3n es exclusiva de ${this.merchant.name}`,bold:!0,fontSize:8},{text:`P\xe1gina ${n.toString()}/${r} - Fecha de impresi\xf3n ${G().format("DD/MM/yyyy HH:mm:ss")}`,bold:!0,fontSize:8,alignment:"right"}]]},margin:[30,0,30,0],layout:"noBorders",italics:!0}),defaultStyle:{fontSize:12},styles:{header:{fontSize:18,bold:!0,marginBottom:5,alignment:"center",fontFeatures:["c2sc","smcp"]},table_header:{fontSize:11,bold:!0,alignment:"center",fontFeatures:["c2sc","smcp"]},table_body:{fontSize:10}},pageOrientation:"portrait",pageSize:"LETTER",watermark:{text:this.merchant.name,color:"#fff",opacity:.07,angle:-35,bold:!0,italics:!1},info:{title:"Listado de marcas",author:`${this.user.fullname}`,creationDate:G().toDate(),modDate:G().toDate(),producer:this.merchant.name}};switch(t){case t="download":B.createPdf(i).download();break;case t="open":B.createPdf(i).open();break;case t="print":B.createPdf(i).print()}}_openDialog(t,i){this._dialog.open(Io,{data:{depot:t,dialogMode:i},panelClass:"ath-dialog-panel",disableClose:!0})}static#e=this.\u0275fac=function(i){return new(i||o)(e.rXU(ue.t),e.rXU(e.gRc),e.rXU(ae.G),e.rXU(X.bZ),e.rXU(O.UG),e.rXU(S.il))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["warehouse-depots"]],viewQuery:function(i,n){if(1&i&&(e.GBs(I.iy,5),e.GBs(F.B4,5)),2&i){let r;e.mGM(r=e.lsd())&&(n._paginator=r.first),e.mGM(r=e.lsd())&&(n._sort=r.first)}},standalone:!0,features:[e.aNF],decls:30,vars:13,consts:[["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent",3,"fuseScrollbarOptions"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","flex-wrap","items-center","gap-2","mt-6","md:fixed","right-8","shrink-0","lg:mt-0","lg:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","depots-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[3,"mat-sort-header"],[1,"pr-4","text-right"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","depots-grid","md:px-8"],[1,"border-b","first-letter:z-10","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","text-swamp-200","bg-gray-50","dark:bg-slate-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,""],[1,"truncate"],[3,"checked","color"],[3,"diameter","color"],[1,"flex","flex-row","justify-end","gap-2"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click","disabled"],[3,"change","checked","color"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(i,n){if(1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",5),e.nrm(8,"mat-icon",6),e.j41(9,"a",7),e.EFF(10,"Almac\xe9n"),e.k0s()(),e.j41(11,"div",5),e.nrm(12,"mat-icon",6),e.j41(13,"a",7),e.EFF(14,"Almacenes"),e.k0s()()(),e.j41(15,"div",8)(16,"h2",9),e.EFF(17," Listado de Almacenes "),e.k0s()()(),e.j41(18,"div",10)(19,"mat-form-field",11),e.nrm(20,"mat-icon",12)(21,"input",13),e.k0s(),e.j41(22,"button",14),e.bIt("click",function(){return n.createDepot()}),e.nrm(23,"mat-icon",15),e.j41(24,"span",16),e.EFF(25,"Agregar"),e.k0s()()()(),e.j41(26,"div",17)(27,"div",18),e.DNE(28,Ao,2,1),e.nI1(29,"async"),e.k0s()()()),2&i){let r;e.Y8G("fuseScrollbarOptions",e.lJ4(12,$o)),e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),e.R7$(2),e.Y8G("svgIcon","mat_solid:add"),e.R7$(5),e.vxM(28,(r=e.bMT(29,10,n.depots$))?28:-1,r)}},dependencies:[p.Jj,a.YN,a.me,a.BC,v.Hl,v.$z,m.RG,m.rl,m.JW,C.m_,C.An,k.fS,k.fg,I.Ou,I.iy,Q.D6,Q.LG,de.mV,de.sG,F.NQ,F.B4,F.aE,p.YU,a.X1,a.l_,g.Wk,H.p],encapsulation:2,changeDetection:0})}return o})();var J=d(76233),be=d(96697),P=d(88141),Te=d(98216);const Ft=o=>o.dispatches,Wo=(0,S.Mz)(Ft,o=>o.dispatch),Pe=(0,S.Mz)(Ft,o=>o.dispatches);var Ie=d(87124),w=d(53473);const No=w.J1`
    mutation CreateDispatch($createDispatchInput: CreateDispatchInput!) {
        createDispatch(createDispatchInput: $createDispatchInput) {
            ok
            message

            dispatch {
                id
                no
                userId
                merchantId
                createdAt
                haveSpare
                obsSpare
                haveMissing
                obsMissing
                haveDamaged
                obsDamaged
                depotInitId
                depotEndId
                depotInit {
                    id
                    name
                }
                depotEnd {
                    id
                    name
                }
                products {
                    productId
                    quantity
                    name
                    uom
                    spare
                    missing
                    damaged
                }
                needConfirmation
                confirmed
                confirmedAt
                confirmedBy
                user {
                    name
                    lastname1
                    lastname2
                    fullname
                }
            }
        }
    }
`,Vo=w.J1`
    mutation ConfirmDispatch($confirmDispatchInput: ConfirmDispatchInput!) {
        confirmDispatch(confirmDispatchInput: $confirmDispatchInput) {
            ok
            message

            dispatch {
                id
                no
                userId
                merchantId
                createdAt
                haveSpare
                obsSpare
                haveMissing
                obsMissing
                haveDamaged
                obsDamaged
                depotInitId
                depotEndId
                depotInit {
                    id
                    name
                }
                depotEnd {
                    id
                    name
                }
                products {
                    productId
                    quantity
                    name
                    uom
                    spare
                    missing
                    damaged
                }
                needConfirmation
                confirmed
                confirmedAt
                confirmedBy
                user {
                    name
                    lastname1
                    lastname2
                    fullname
                }
            }
        }
    }
`,Yo=(w.J1`
    mutation UpdateDispatch($updateDispatchInput: UpdateDispatchInput!) {
        updateDispatch(updateDispatchInput: $updateDispatchInput) {
            ok
            message

            dispatch {
                id
                no
                userId
                merchantId
                createdAt
                haveSpare
                obsSpare
                haveMissing
                obsMissing
                haveDamaged
                obsDamaged
                depotInitId
                depotEndId
                depotInit {
                    id
                    name
                }
                depotEnd {
                    id
                    name
                }
                products {
                    productId
                    quantity
                    name
                    uom
                    spare
                    missing
                    damaged
                }
                needConfirmation
                confirmed
                confirmedAt
                confirmedBy
                user {
                    name
                    lastname1
                    lastname2
                    fullname
                }
            }
        }
    }
`,w.J1`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateDispatchStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }
    }
`,w.J1`
    mutation RemoveDispatch($removeDispatchId: String!) {
        removeDispatch(id: $removeDispatchId) {
            ok
            message
        }
    }
`),zo=w.J1`
    query FindAllDispatches($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllDispatches(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length,
                size,
                page,
                lastPage,
                startIndex,
                endIndex
            },

            dispatches {
                id
                no
                userId
                merchantId
                createdAt
                haveSpare
                obsSpare
                haveMissing
                obsMissing
                haveDamaged
                obsDamaged
                depotInitId
                depotEndId
                depotInit {
                    id
                    name
                }
                depotEnd {
                    id
                    name
                }
                products {
                    productId
                    quantity
                    name
                    uom
                    spare
                    missing
                    damaged
                }
                needConfirmation
                confirmed
                confirmedAt
                confirmedBy
                user {
                    name
                    lastname1
                    lastname2
                    fullname
                }
            }
        }
    }
`,Lo=w.J1`
    query FindDispatchById($dispatchId: String!) {
        findDispatchById(dispatchId: $dispatchId) {
            ok
            message

            dispatch {
                id
                no
                userId
                merchantId
                createdAt
                haveSpare
                obsSpare
                haveMissing
                obsMissing
                haveDamaged
                obsDamaged
                depotInitId
                depotEndId
                depotInit {
                    id
                    name
                }
                depotEnd {
                    id
                    name
                }
                products {
                    productId
                    quantity
                    name
                    uom
                    spare
                    missing
                    damaged
                }
                needConfirmation
                confirmed
                confirmedAt
                confirmedBy
                user {
                    name
                    lastname1
                    lastname2
                    fullname
                }
            }
        }
    }
`;w.J1`
    query findDispatchByLocationAndEmployee {
        findDispatchByLocationAndEmployee {
            ok
            message

            dispatch {
                id
                no
                userId
                merchantId
                createdAt
                haveSpare
                obsSpare
                haveMissing
                obsMissing
                haveDamaged
                obsDamaged
                depotInitId
                depotEndId
                depotInit {
                    id
                    name
                }
                depotEnd {
                    id
                    name
                }
                products {
                    productId
                    quantity
                    name
                    uom
                    spare
                    missing
                    damaged
                }
                needConfirmation
                confirmed
                confirmedAt
                confirmedBy
                user {
                    name
                    lastname1
                    lastname2
                    fullname
                }
            }
        }
    }
`;let Re=(()=>{class o{constructor(t,i){this.apolloProvider=t,this.store=i,this._apollo=this.apolloProvider.use("BALANC")}createDispatch(t){return this.store.select(Pe).pipe((0,be.s)(1),(0,_.n)(i=>this._apollo.mutate({mutation:No,variables:{createDispatchInput:t},errorPolicy:"all"}).pipe((0,P.M)(({data:n})=>{const r=structuredClone(i);r.push(n.createDispatch.dispatch),this.store.dispatch((0,Ie.BE)({dispatches:r}))}))))}confirmDispatch(t){return this.store.select(Pe).pipe((0,be.s)(1),(0,_.n)(i=>this._apollo.mutate({mutation:Vo,variables:{confirmDispatchInput:t},errorPolicy:"all"}).pipe((0,P.M)(({data:n})=>{const r=structuredClone(i);r.push(n.confirmDispatch.dispatch),this.store.dispatch((0,Ie.BE)({dispatches:r}))}))))}getDispatches(t=0,i=50,n="no",r="desc",l="",c=null,h=null){return this._apollo.query({query:zo,errorPolicy:"all",variables:{page:t,size:i,sort:n,order:r,search:l,depotId:c,productId:h}}).pipe((0,P.M)(({data:y})=>{this.store.dispatch((0,Ie.BE)({dispatches:y.findAllDispatches.dispatches})),this.store.dispatch((0,Te.Bp)({pagination:y.findAllDispatches.pagination}))}))}findDispatchById(t){return this._apollo.query({query:Lo,variables:{dispatchId:t},errorPolicy:"all"}).pipe((0,P.M)(({data:i})=>{this.store.dispatch((0,Ie.ZK)({dispatch:i.findDispatchById.dispatch}))}))}removeDispatch(t){return this.store.select(Pe).pipe((0,be.s)(1),(0,_.n)(i=>this._apollo.mutate({mutation:Yo,variables:{removeDispatchId:t},errorPolicy:"all"}).pipe((0,P.M)(()=>{const n=structuredClone(i),r=i.findIndex(l=>l.id===t);n.splice(r,1),this.store.dispatch((0,Ie.BE)({dispatches:n}))}))))}static#e=this.\u0275fac=function(i){return new(i||o)(e.KVO(w.Ic),e.KVO(S.il))};static#t=this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var kt=d(99327),K=d(55364),M=d(14823);const xt=(o,s)=>s.id,Le=o=>({"stepper-reception-form-grid":o});function Qo(o,s){1&o&&(e.j41(0,"mat-error",46),e.EFF(1," Valor m\xednimo 0 "),e.k0s())}function qo(o,s){1&o&&(e.j41(0,"mat-error",46),e.EFF(1," Valor requerido "),e.k0s())}function Xo(o,s){1&o&&(e.j41(0,"mat-error",46),e.EFF(1," Valor m\xednimo 0 "),e.k0s())}function Oo(o,s){1&o&&(e.j41(0,"mat-error",46),e.EFF(1," Valor requerido "),e.k0s())}function Uo(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Cantidad excedida "),e.k0s())}function Ho(o,s){1&o&&(e.j41(0,"mat-error",46),e.EFF(1," Valor m\xednimo 0 "),e.k0s())}function Jo(o,s){1&o&&(e.j41(0,"mat-error",46),e.EFF(1," Valor requerido "),e.k0s())}function Zo(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Cantidad excedida "),e.k0s())}function Ko(o,s){if(1&o&&(e.j41(0,"div",40)(1,"div"),e.EFF(2),e.k0s(),e.j41(3,"div",41),e.EFF(4),e.k0s(),e.j41(5,"div",42),e.EFF(6),e.k0s(),e.j41(7,"div",39),e.EFF(8),e.nI1(9,"number"),e.k0s(),e.j41(10,"div",43)(11,"mat-form-field",44),e.nrm(12,"input",45),e.k0s(),e.DNE(13,Qo,2,0,"mat-error",46)(14,qo,2,0,"mat-error",46),e.k0s(),e.j41(15,"div",43)(16,"mat-form-field",44),e.nrm(17,"input",45),e.k0s(),e.DNE(18,Xo,2,0,"mat-error",46)(19,Oo,2,0,"mat-error",46)(20,Uo,2,0,"mat-error"),e.k0s(),e.j41(21,"div",43)(22,"mat-form-field",44),e.nrm(23,"input",45),e.k0s(),e.DNE(24,Ho,2,0,"mat-error",46)(25,Jo,2,0,"mat-error",46)(26,Zo,2,0,"mat-error"),e.k0s()()),2&o){const t=s.$implicit,i=s.$index;e.R7$(2),e.SpI(" ",i+1," "),e.R7$(),e.Y8G("matTooltip",t.get("name").value),e.R7$(),e.SpI(" ",t.get("name").value," "),e.R7$(2),e.SpI(" ",t.get("uom").value," "),e.R7$(2),e.SpI(" ",e.i5U(9,25,t.get("quantity").value,"1.0-4")," "),e.R7$(3),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("min",0)("max",9999999)("formControl",t.get("spare")),e.R7$(),e.vxM(13,t.get("spare").hasError("min")?13:-1),e.R7$(),e.vxM(14,t.get("spare").hasError("required")?14:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("min",0)("max",t.get("quantity").value)("formControl",t.get("missing")),e.R7$(),e.vxM(18,t.get("missing").hasError("min")?18:-1),e.R7$(),e.vxM(19,t.get("missing").hasError("required")?19:-1),e.R7$(),e.vxM(20,t.hasError("totalQuantityExceeded")||t.get("missing").hasError("max")?20:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("min",0)("max",t.get("quantity").value)("formControl",t.get("damaged")),e.R7$(),e.vxM(24,t.get("damaged").hasError("min")?24:-1),e.R7$(),e.vxM(25,t.get("damaged").hasError("required")?25:-1),e.R7$(),e.vxM(26,t.hasError("totalQuantityExceeded")||t.get("damaged").hasError("max")?26:-1)}}function ei(o,s){if(1&o&&(e.j41(0,"div",18)(1,"div",37),e.nrm(2,"div"),e.j41(3,"div",38),e.EFF(4," Producto "),e.k0s(),e.j41(5,"div",38),e.EFF(6," UM "),e.k0s(),e.j41(7,"div",39),e.EFF(8," Cantidad "),e.k0s(),e.j41(9,"div",39),e.EFF(10," Sobrante "),e.k0s(),e.j41(11,"div",39),e.EFF(12," Faltante "),e.k0s(),e.j41(13,"div",39),e.EFF(14," Averiada "),e.k0s()(),e.Z7z(15,Ko,27,28,"div",40,xt),e.k0s()),2&o){const t=e.XpG();e.R7$(15),e.Dyx(t.dispatchConfirmationFormGroup.get("products").controls)}}function ti(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Las observaciones sobre sobrante son obligatorias si tienes repuestos. "),e.k0s())}function oi(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Las observaciones sobre sobrante no deben pasar los 5000 caracteres "),e.k0s())}function ii(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Las observaciones sobre faltantes son obligatorias si tienes faltantes. "),e.k0s())}function ni(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Las observaciones sobre faltantes no deben pasar los 5000 caracteres "),e.k0s())}function si(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Las observaciones sobre aver\xedas son obligatorias si tienes da\xf1os. "),e.k0s())}function ri(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Las observaciones sobre aver\xedas no deben pasar los 5000 caracteres "),e.k0s())}function ai(o,s){if(1&o&&(e.j41(0,"mat-step",22)(1,"div",16),e.nI1(2,"async"),e.j41(3,"form",47)(4,"div",48)(5,"mat-form-field",49)(6,"mat-label"),e.EFF(7,"Observaciones sobre Sobrantes"),e.k0s(),e.nrm(8,"textarea",50,1),e.DNE(10,ti,2,0,"mat-error")(11,oi,2,0,"mat-error"),e.j41(12,"mat-hint",51),e.EFF(13),e.k0s()()(),e.j41(14,"div",48)(15,"mat-form-field",49)(16,"mat-label"),e.EFF(17,"Observaciones sobre Faltantes"),e.k0s(),e.nrm(18,"textarea",50,2),e.DNE(20,ii,2,0,"mat-error")(21,ni,2,0,"mat-error"),e.j41(22,"mat-hint",51),e.EFF(23),e.k0s()()(),e.j41(24,"div",48)(25,"mat-form-field",49)(26,"mat-label"),e.EFF(27,"Observaciones de Aver\xedas"),e.k0s(),e.nrm(28,"textarea",50,3),e.DNE(30,si,2,0,"mat-error")(31,ri,2,0,"mat-error"),e.j41(32,"mat-hint",51),e.EFF(33),e.k0s()()()(),e.j41(34,"div",19)(35,"button",20),e.EFF(36,"Atr\xe1s"),e.k0s(),e.j41(37,"button",21),e.EFF(38,"Siguiente"),e.k0s()()()()),2&o){const t=e.sdS(9),i=e.sdS(19),n=e.sdS(29),r=e.XpG();e.Y8G("stepControl",r.dispatchConfirmationFormGroup),e.R7$(),e.Y8G("ngClass",e.eq3(32,Le,"horizontal"===e.bMT(2,30,r.stepperOrientation))),e.R7$(2),e.Y8G("formGroup",r.dispatchConfirmationFormGroup),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","obsSpare")("rows",2)("spellcheck",!1)("maxlength",5e3)("required",r.dispatchConfirmationFormGroup.get("haveSpare").value),e.R7$(2),e.vxM(10,r.dispatchConfirmationFormGroup.get("obsSpare").hasError("required")?10:-1),e.R7$(),e.vxM(11,r.dispatchConfirmationFormGroup.get("obsSpare").hasError("maxlength")?11:-1),e.R7$(2),e.SpI("",t.value.length||0,"/5000"),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","obsMissing")("rows",2)("spellcheck",!1)("maxlength",5e3)("required",r.dispatchConfirmationFormGroup.get("haveMissing").value),e.R7$(2),e.vxM(20,r.dispatchConfirmationFormGroup.get("obsMissing").hasError("required")?20:-1),e.R7$(),e.vxM(21,r.dispatchConfirmationFormGroup.get("obsMissing").hasError("maxlength")?21:-1),e.R7$(2),e.SpI("",i.value.length||0,"/5000"),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","obsDamaged")("rows",2)("spellcheck",!1)("maxlength",5e3)("required",r.dispatchConfirmationFormGroup.get("haveDamaged").value),e.R7$(2),e.vxM(30,r.dispatchConfirmationFormGroup.get("obsDamaged").hasError("required")?30:-1),e.R7$(),e.vxM(31,r.dispatchConfirmationFormGroup.get("obsDamaged").hasError("maxlength")?31:-1),e.R7$(2),e.SpI("",n.value.length||0,"/5000")}}function li(o,s){if(1&o&&(e.j41(0,"div",40)(1,"div"),e.EFF(2),e.k0s(),e.j41(3,"div",42),e.EFF(4),e.k0s(),e.j41(5,"div",42),e.EFF(6),e.k0s(),e.j41(7,"div",39),e.EFF(8),e.nI1(9,"number"),e.k0s(),e.j41(10,"div",39),e.EFF(11),e.nI1(12,"number"),e.k0s(),e.j41(13,"div",39),e.EFF(14),e.nI1(15,"number"),e.k0s(),e.j41(16,"div",39),e.EFF(17),e.nI1(18,"number"),e.k0s()()),2&o){const t=s.$implicit,i=s.$index;e.R7$(2),e.SpI(" ",i+1," "),e.R7$(2),e.SpI(" ",t.get("name").value," "),e.R7$(2),e.SpI(" ",t.get("uom").value," "),e.R7$(2),e.SpI(" ",e.i5U(9,7,t.get("quantity").value,"1.0-4")," "),e.R7$(3),e.SpI(" ",e.i5U(12,10,t.get("spare").value,"1.0-4")," "),e.R7$(3),e.SpI(" ",e.i5U(15,13,t.get("missing").value,"1.0-4")," "),e.R7$(3),e.SpI(" ",e.i5U(18,16,t.get("damaged").value,"1.0-4")," ")}}function ci(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",27)(1,"span",28),e.EFF(2,"Cantidades"),e.k0s(),e.j41(3,"button",29),e.bIt("click",function(){e.eBV(t),e.XpG();const n=e.sdS(22);return e.Njj(n.selectedIndex=1)}),e.nrm(4,"mat-icon",30),e.k0s()(),e.j41(5,"div",52)(6,"div",53),e.nrm(7,"div"),e.j41(8,"div",38),e.EFF(9," Producto "),e.k0s(),e.j41(10,"div",38),e.EFF(11," UM "),e.k0s(),e.j41(12,"div",39),e.EFF(13," Cantidad "),e.k0s(),e.j41(14,"div",39),e.EFF(15," Sobrante "),e.k0s(),e.j41(16,"div",39),e.EFF(17," Faltante "),e.k0s(),e.j41(18,"div",39),e.EFF(19," Averiada "),e.k0s()(),e.Z7z(20,li,19,19,"div",40,xt),e.k0s()}if(2&o){const t=e.XpG();e.R7$(4),e.Y8G("svgIcon","mat_solid:edit"),e.R7$(16),e.Dyx(t.dispatchConfirmationFormGroup.get("products").controls)}}function di(o,s){1&o&&(e.j41(0,"span",31),e.EFF(1," Sin observaciones "),e.k0s())}function ui(o,s){if(1&o&&(e.j41(0,"div",33)(1,"span",54),e.EFF(2,"Observaciones sobre sobrantes"),e.k0s(),e.j41(3,"div",31),e.EFF(4),e.k0s()()),2&o){const t=e.XpG();e.R7$(4),e.SpI(" ",t.dispatchConfirmationFormGroup.get("obsSpare").value," ")}}function mi(o,s){if(1&o&&(e.j41(0,"div",33)(1,"span",54),e.EFF(2,"Observaciones sobre faltantes"),e.k0s(),e.j41(3,"div",31),e.EFF(4),e.k0s()()),2&o){const t=e.XpG();e.R7$(4),e.SpI(" ",t.dispatchConfirmationFormGroup.get("obsMissing").value," ")}}function pi(o,s){if(1&o&&(e.j41(0,"div",33)(1,"span",54),e.EFF(2,"Observaciones sobre aver\xedas"),e.k0s(),e.j41(3,"div",31),e.EFF(4),e.k0s()()),2&o){const t=e.XpG();e.R7$(4),e.SpI(" ",t.dispatchConfirmationFormGroup.get("obsDamaged").value," ")}}let hi=(()=>{class o{constructor(){this.dispatch=null,this.user=null,this._changeDetectorRef=(0,e.WQX)(e.gRc),this._dispatchesService=(0,e.WQX)(Re),this._formBuilder=(0,e.WQX)(a.ok),this._fuseConfirmationService=(0,e.WQX)(ae.G),this._router=(0,e.WQX)(g.Ix),this._snackBar=(0,e.WQX)(O.UG),this._stepperIntl=(0,e.WQX)(J.hc).optionalLabel="Opcional",this._unsubscribeAll=new j.B,this.store=(0,e.WQX)(S.il),this.stepperOrientation=(0,e.WQX)(kt.QP).observe("(min-width: 800px)").pipe((0,b.T)(({matches:t})=>t?"horizontal":"vertical"))}ngOnInit(){this.dispatchConfirmationFormGroup=this._formBuilder.group({haveDamaged:new a.MJ(!1),haveMissing:new a.MJ(!1),haveSpare:new a.MJ(!1),obsDamaged:new a.MJ("",[a.k0.maxLength(5e3)]),obsMissing:new a.MJ("",[a.k0.maxLength(5e3)]),obsSpare:new a.MJ("",[a.k0.maxLength(5e3)]),products:new a.Yp([])}),this.store.select(re.SW).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(Wo).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.dispatch=t;for(const i of t.products){const n=this._formBuilder.group({productId:new a.MJ(i.productId,[a.k0.required]),name:new a.MJ(i.name,[a.k0.required]),uom:new a.MJ(i.uom,[a.k0.required]),quantity:new a.MJ(i.quantity,[K.t.onlyNumbersPattern(),a.k0.required,a.k0.min(.1),a.k0.max(i.quantity)]),spare:new a.MJ(i.spare,[K.t.onlyNumbersPattern(),a.k0.required,a.k0.min(0),a.k0.max(i.quantity)]),missing:new a.MJ(i.missing,[K.t.onlyNumbersPattern(),a.k0.required,a.k0.min(0),a.k0.max(i.quantity)]),damaged:new a.MJ(i.damaged,[K.t.onlyNumbersPattern(),a.k0.required,a.k0.min(0),a.k0.max(i.quantity)])});this.dispatchConfirmationFormGroup.get("products").push(n)}this._changeDetectorRef.markForCheck()}),this.dispatchConfirmationFormGroup.get("products").valueChanges.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{const i=t.reduce((l,c)=>l+c.spare,0),n=t.reduce((l,c)=>l+c.missing,0),r=t.reduce((l,c)=>l+c.damaged,0);i>0?this.dispatchConfirmationFormGroup.get("haveSpare").setValue(!0):this.dispatchConfirmationFormGroup.get("haveSpare").setValue(!1),n>0?this.dispatchConfirmationFormGroup.get("haveMissing").setValue(!0):this.dispatchConfirmationFormGroup.get("haveMissing").setValue(!1),r>0?this.dispatchConfirmationFormGroup.get("haveDamaged").setValue(!0):this.dispatchConfirmationFormGroup.get("haveDamaged").setValue(!1),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}confirmDispatch(){let t=this.dispatchConfirmationFormGroup.getRawValue();t.id=this.dispatch.id,this._fuseConfirmationService.open({title:"Confirmar Despacho",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{"confirmed"===n&&this._dispatchesService.confirmDispatch(t).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(({data:r})=>{this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:r.confirmDispatch.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/modules/warehouse/dispatches")})})}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["dispatch-confirmation"]],standalone:!0,features:[e.aNF],decls:59,vars:28,consts:[["stepper",""],["obsSpare",""],["obsMissing",""],["obsDamaged",""],[1,"flex","flex-col","flex-auto","min-w-0","overflow-auto","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","pb-3","print:hidden","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-7"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],["routerLink","/modules/warehouse/dispatches'",1,"ml-1","text-primary-500"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],[1,"h-full","sm:overflow-auto",3,"orientation"],["label","Cantidades Recibidas",3,"stepControl"],[1,"grid","h-full","grid-cols-1","pt-4","sm:px-4",3,"ngClass"],["fuseScrollbar","",1,"h-full","pb-6"],["fuseScrollbar","",1,"grid"],[1,"flex","items-center","justify-end","gap-x-4"],["mat-button","","matStepperPrevious",""],["color","primary","mat-flat-button","","matStepperNext",""],["label","Observaciones",3,"stepControl"],["label","Resumen",3,"stepControl"],["fuseScrollbar","",1,"flex","flex-col","justify-between","p-10","pt-8","overscroll-y-contain","print:row-span-2","bg-gray-50","dark:bg-primary","dark:bg-opacity-5"],[1,"flex","flex-col","w-full","gap-2"],[1,""],[1,"flex","flex-row","items-center","gap-1"],[1,"font-bold"],["mat-icon-button","",1,"print:hidden",3,"click"],[1,"icon-size-4",3,"svgIcon"],[1,"text-secondary"],[1,"flex","flex-col","gap-2"],[1,"flex","flex-col","text-md"],[1,"mt-10"],[1,"flex","items-center","justify-end","print:hidden","gap-x-4"],["color","primary","mat-flat-button","",3,"click","disabled"],[1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","reception-form-products-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-primary","dark:bg-opacity-5"],[1,"text-left"],[1,"text-center"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","reception-form-products-grid","md:px-8"],[1,"truncate",3,"matTooltip"],[1,"truncate"],[1,"flex","flex-col","items-center","justify-center"],[1,"fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],["matInput","","type","number",1,"font-mono","font-semibold","text-center",3,"min","max","formControl"],[1,"w-full","text-sm","text-center"],["fuseScrollbar","",1,"grid","w-full","gap-4","px-4","pb-6","lg:grid-cols-4","sm:gap-6",3,"formGroup"],[1,"lg:col-span-2"],[1,"w-full","fuse-mat-textarea",3,"subscriptSizing"],["matInput","","matTextareaAutosize","",3,"formControlName","rows","spellcheck","maxlength","required"],[1,"w-full","text-right"],[1,"grid","overscroll-y-auto"],[1,"grid","gap-4","px-6","py-4","font-semibold","bg-gray-100","reception-form-products-grid","md:px-8","text-md","text-secondary","dark:bg-primary","dark:bg-opacity-5"],[1,"font-semibold"]],template:function(i,n){if(1&i){const r=e.RV6();e.j41(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7)(4,"div",7)(5,"div")(6,"a",8),e.EFF(7,"Inicio"),e.k0s()(),e.j41(8,"div",9),e.nrm(9,"mat-icon",10),e.j41(10,"a",11),e.EFF(11,"Almac\xe9n"),e.k0s()(),e.j41(12,"div",9),e.nrm(13,"mat-icon",10),e.j41(14,"a",12),e.EFF(15,"Recepciones"),e.k0s()(),e.j41(16,"div",9),e.nrm(17,"mat-icon",10),e.j41(18,"a",11),e.EFF(19,"Confirmar Recepci\xf3n"),e.k0s()()()()(),e.nrm(20,"div",13),e.k0s(),e.j41(21,"mat-stepper",14,0),e.nI1(23,"async"),e.j41(24,"mat-step",15)(25,"div",16),e.nI1(26,"async"),e.j41(27,"div",17),e.DNE(28,ei,17,0,"div",18),e.k0s(),e.j41(29,"div",19)(30,"button",20),e.EFF(31,"Atr\xe1s"),e.k0s(),e.j41(32,"button",21),e.EFF(33,"Siguiente"),e.k0s()()()(),e.DNE(34,ai,39,34,"mat-step",22),e.j41(35,"mat-step",23)(36,"div",16),e.nI1(37,"async"),e.j41(38,"div",24)(39,"div",25),e.DNE(40,ci,22,1),e.j41(41,"div",26)(42,"div",27)(43,"span",28),e.EFF(44,"Observaciones"),e.k0s(),e.j41(45,"button",29),e.bIt("click",function(){e.eBV(r);const c=e.sdS(22);return e.Njj(c.selectedIndex=2)}),e.nrm(46,"mat-icon",30),e.k0s()(),e.DNE(47,di,2,0,"span",31),e.j41(48,"div",32),e.DNE(49,ui,5,1,"div",33)(50,mi,5,1,"div",33)(51,pi,5,1,"div",33),e.k0s()()(),e.j41(52,"span",34),e.EFF(53),e.k0s()(),e.j41(54,"div",35)(55,"button",20),e.EFF(56,"Atr\xe1s"),e.k0s(),e.j41(57,"button",36),e.bIt("click",function(){return e.eBV(r),e.Njj(n.confirmDispatch())}),e.EFF(58,"Confirmar Despacho"),e.k0s()()()()()()}2&i&&(e.R7$(9),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("orientation",e.bMT(23,18,n.stepperOrientation)),e.R7$(3),e.Y8G("stepControl",n.dispatchConfirmationFormGroup),e.R7$(),e.Y8G("ngClass",e.eq3(24,Le,"horizontal"===e.bMT(26,20,n.stepperOrientation))),e.R7$(3),e.vxM(28,n.dispatchConfirmationFormGroup.get("products").controls.length>0?28:-1),e.R7$(6),e.vxM(34,n.dispatchConfirmationFormGroup.get("haveSpare").value||n.dispatchConfirmationFormGroup.get("haveMissing").value||n.dispatchConfirmationFormGroup.get("haveDamaged").value?34:-1),e.R7$(),e.Y8G("stepControl",n.dispatchConfirmationFormGroup),e.R7$(),e.Y8G("ngClass",e.eq3(26,Le,"horizontal"===e.bMT(37,22,n.stepperOrientation))),e.R7$(4),e.vxM(40,n.dispatchConfirmationFormGroup.get("products").controls.length>0?40:-1),e.R7$(6),e.Y8G("svgIcon","mat_solid:edit"),e.R7$(),e.vxM(47,n.dispatchConfirmationFormGroup.get("obsSpare").value||n.dispatchConfirmationFormGroup.get("obsMissing").value||n.dispatchConfirmationFormGroup.get("obsDamaged").value?-1:47),e.R7$(2),e.vxM(49,n.dispatchConfirmationFormGroup.get("obsSpare").value?49:-1),e.R7$(),e.vxM(50,n.dispatchConfirmationFormGroup.get("obsMissing").value?50:-1),e.R7$(),e.vxM(51,n.dispatchConfirmationFormGroup.get("obsDamaged").value?51:-1),e.R7$(2),e.SpI("Recibido por: ",n.user.employee.fullname," "),e.R7$(4),e.Y8G("disabled",n.dispatchConfirmationFormGroup.invalid))},dependencies:[p.Jj,p.QX,a.YN,a.qT,a.me,a.Q0,a.BC,a.cb,a.YS,a.tU,a.VZ,a.zX,v.Hl,v.$z,v.iY,C.m_,C.An,m.RG,m.rl,m.nJ,m.MV,m.TL,k.fS,k.fg,J.aP,J.V5,J.M6,J.F7,J.FR,M.uc,M.oV,p.YU,a.X1,a.l_,a.j4,a.JD,g.Wk,H.p],encapsulation:2,changeDetection:0})}return o})();var me=d(82765),Ce=d(13189),pe=d(4840);const yt=(o,s)=>s.id,fi=()=>({suppressScrollX:!0}),gi=()=>({suppressScrollY:!0});function _i(o,s){if(1&o&&(e.j41(0,"mat-option",21),e.EFF(1),e.k0s()),2&o){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function vi(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," El almac\xe9n de salida obligatorio "),e.k0s())}function bi(o,s){if(1&o&&(e.j41(0,"mat-option",21),e.EFF(1),e.k0s()),2&o){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function Ci(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," El almac\xe9n de entrada obligatorio "),e.k0s())}function Fi(o,s){1&o&&(e.j41(0,"div",24),e.EFF(1," \xa1Seleccione el almac\xe9n de salida! "),e.k0s())}function ki(o,s){1&o&&(e.j41(0,"div",25),e.nrm(1,"mat-spinner"),e.k0s())}function xi(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-option",34),e.bIt("click",function(n){const r=e.eBV(t).$implicit;return e.XpG(2).addProductToDispatch(r),e.Njj(n.stopPropagation())}),e.j41(1,"div",35),e.bIt("click",function(n){const r=e.eBV(t).$implicit;return e.XpG(2).addProductToDispatch(r),e.Njj(n.stopPropagation())}),e.j41(2,"span",36),e.nrm(3,"mat-checkbox",37),e.EFF(4),e.k0s(),e.j41(5,"span",38),e.EFF(6),e.k0s(),e.j41(7,"span",39),e.EFF(8),e.nI1(9,"number"),e.k0s()()()}if(2&o){const t=s.$implicit;e.Y8G("value",t),e.R7$(3),e.Y8G("checked",t.checked),e.R7$(),e.SpI(" ",t.name," "),e.R7$(2),e.SpI(" ",t.depot," "),e.R7$(2),e.Lme("",e.i5U(9,6,t.quantity,"1.2-2")," ",t.uom," ")}}function yi(o,s){1&o&&(e.j41(0,"mat-error",52),e.EFF(1," Valor m\xednimo 0.1 "),e.k0s())}function Si(o,s){if(1&o&&(e.j41(0,"mat-error",52),e.EFF(1),e.k0s()),2&o){const t=e.XpG().$implicit;e.R7$(),e.SpI(" Valor m\xe1ximo ",t.quantity," ")}}function Ii(o,s){1&o&&(e.j41(0,"mat-error",52),e.EFF(1," Patr\xf3n no v\xe1lido "),e.k0s())}function Ri(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",43)(1,"div"),e.EFF(2),e.k0s(),e.j41(3,"div",44),e.EFF(4),e.k0s(),e.j41(5,"div",45),e.EFF(6),e.k0s(),e.j41(7,"div",46)(8,"div",47)(9,"button",48),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(3);return e.Njj(r.decrementProductQty(n))}),e.nrm(10,"mat-icon",49),e.k0s(),e.j41(11,"mat-form-field",50),e.nrm(12,"input",51),e.k0s(),e.j41(13,"button",48),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(3);return e.Njj(r.incrementProductQty(n))}),e.nrm(14,"mat-icon",49),e.k0s()(),e.DNE(15,yi,2,0,"mat-error",52)(16,Si,2,1,"mat-error",52)(17,Ii,2,0,"mat-error",52),e.k0s(),e.j41(18,"div",53)(19,"button",54),e.bIt("click",function(){const n=e.eBV(t).$index,r=e.XpG(3);return e.Njj(r.removeProductToDispatch(n))}),e.nrm(20,"mat-icon",49),e.k0s()()()}if(2&o){const t=s.$implicit,i=s.$index;e.R7$(2),e.SpI(" ",i+1," "),e.R7$(),e.Y8G("matTooltip",t.get("name").value),e.R7$(),e.SpI(" ",t.get("name").value," "),e.R7$(2),e.SpI(" ",t.get("stock").value-t.get("quantity").value," "),e.R7$(3),e.Y8G("disabled",t.get("quantity").value<=.1||t.get("quantity").hasError("pattern")),e.R7$(),e.Y8G("svgIcon","mat_solid:remove"),e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("min",.1)("formControl",t.get("quantity")),e.R7$(),e.Y8G("disabled",t.get("quantity").hasError("pattern")),e.R7$(),e.Y8G("svgIcon","mat_solid:add"),e.R7$(),e.vxM(15,t.get("quantity").hasError("min")?15:-1),e.R7$(),e.vxM(16,t.get("quantity").hasError("max")?16:-1),e.R7$(),e.vxM(17,t.get("quantity").hasError("pattern")&&!t.get("quantity").hasError("min")?17:-1),e.R7$(3),e.Y8G("svgIcon","mat_solid:close")}}function Ei(o,s){if(1&o&&(e.j41(0,"div",33)(1,"div",40),e.nrm(2,"div"),e.j41(3,"div",41),e.EFF(4," Producto "),e.k0s(),e.j41(5,"div",42),e.EFF(6," Disponible "),e.k0s(),e.j41(7,"div",42),e.EFF(8," Cantidad "),e.k0s(),e.j41(9,"div",42),e.EFF(10," Quitar "),e.k0s()(),e.Z7z(11,Ri,21,15,"div",43,yt),e.k0s()),2&o){const t=e.XpG(2);e.R7$(11),e.Dyx(t.dispatchingForm.get("products").controls)}}function $i(o,s){1&o&&(e.j41(0,"div",24),e.EFF(1," \xa1No ha seleccionado ning\xfan producto a\xfan! "),e.k0s())}function ji(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",26)(1,"mat-form-field",27),e.nrm(2,"mat-icon",28)(3,"input",29),e.j41(4,"mat-autocomplete",30,1),e.bIt("closed",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.searchProductControl.reset())}),e.Z7z(6,xi,10,9,"mat-option",31,e.fX1),e.nI1(8,"async"),e.k0s()(),e.j41(9,"div",32),e.DNE(10,Ei,13,0,"div",33)(11,$i,2,0),e.k0s()()}if(2&o){const t=e.sdS(5),i=e.XpG();e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",i.searchProductControl)("matAutocomplete",t)("placeholder","Buscar existencia de productos en inventario"),e.R7$(),e.Y8G("displayWith",i.displayFn),e.R7$(2),e.Dyx(e.bMT(8,8,i.productsFiltered)),e.R7$(3),e.Y8G("fuseScrollbarOptions",e.lJ4(10,gi)),e.R7$(),e.vxM(10,i.dispatchingForm.get("products").controls.length>0?10:11)}}let Di=(()=>{class o{constructor(){this.productsInStock$=(0,E.of)([]),this.products=[],this.filteredDepots=[],this.depots=[],this.ownDepots=[],this.searchProductControl=new a.MJ(null),this.stayHere=!1,this.loadingProducts=!1,this.user=null,this._changeDetectorRef=(0,e.WQX)(e.gRc),this._dispatchesService=(0,e.WQX)(Re),this._formBuilder=(0,e.WQX)(a.ok),this._fuseConfirmationService=(0,e.WQX)(ae.G),this._router=(0,e.WQX)(g.Ix),this._snackBar=(0,e.WQX)(O.UG),this._stocksService=(0,e.WQX)(pe.t),this._unsubscribeAll=new j.B,this.store=(0,e.WQX)(S.il)}ngOnInit(){this.dispatchingForm=this._formBuilder.group({id:new a.MJ,depotInitId:new a.MJ(null,[a.k0.required]),depotEndId:new a.MJ({disabled:!0,value:null},[a.k0.required]),needConfirmation:new a.MJ(!0),products:new a.Yp([])}),this.store.select(re.SW).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(q.c_).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.depots=t,this.filteredDepots=t,this.ownDepots=t.filter(i=>i.managerId===this.user.employeeId),this._changeDetectorRef.markForCheck()}),this.productsInStock$=this.store.select(Ce.IP),this.dispatchingForm.get("depotInitId").valueChanges.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.filteredDepots=this.depots.filter(i=>i.id!==t),this.searchProductControl.setValue(""),this.dispatchingForm.get("depotEndId").setValue(null),this.dispatchingForm.get("depotEndId").enable(),this._changeDetectorRef.markForCheck()}),this.productsFiltered=this.searchProductControl.valueChanges.pipe((0,f.B)(200),(0,x.Z)(""),(0,L.Z)(t=>{const i=this.dispatchingForm.get("depotInitId").value;return this._mapChecked(null!==t&&"string"==typeof t&&i?this._stocksService.getProductsInStockAvailable(t,100,i):this.productsInStock$)}))}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}addStockProduct(t){const i=this._formBuilder.group({productId:new a.MJ(t.productId,[a.k0.required]),name:new a.MJ(t.name,[a.k0.required]),uom:new a.MJ(t.uom,[a.k0.required]),depotId:new a.MJ(t.depotId,[a.k0.required]),stock:new a.MJ(t.quantity,[a.k0.required]),quantity:new a.MJ(1,[K.t.onlyNumbersPattern(),a.k0.required,a.k0.min(.1),a.k0.max(t.quantity)])});this.dispatchingForm.get("products").push(i),this._changeDetectorRef.markForCheck()}removeStockProduct(t){this.dispatchingForm.get("products").removeAt(t),this._changeDetectorRef.markForCheck()}addProductToDispatch(t){const i=this.dispatchingForm.get("products").getRawValue().findIndex(n=>n.productId===t.productId&&n.depotId===t.depotId);t.checked?(this.removeStockProduct(i),t.checked=!1):t.checked=!0,!(i>-1)&&this.addStockProduct(t)}incrementProductQty(t){let i=t.get("quantity").value;t.get("quantity").setValue(+i+1)}decrementProductQty(t){let i=t.get("quantity").value;t.get("quantity").setValue(+i-1)}removeProductToDispatch(t){this.removeStockProduct(t),this.searchProductControl.reset()}createDispatch(){if(this.dispatchingForm.invalid)return;if(0===this.dispatchingForm.get("products").controls.length)return void this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Alerta",message:"Debe agrear al menos un producto al despacho",type:"warning",svgIcon:"mat_solid:warning"}});const t=this.dispatchingForm.getRawValue();delete t.id,t.products.forEach(n=>{delete n.depotId,delete n.stock,n.quantity=Number(n.quantity)}),this._fuseConfirmationService.open({title:"Generar Despacho",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{"confirmed"===n&&this._dispatchesService.createDispatch(t).pipe((0,u.Q)(this._unsubscribeAll),(0,U.j)(()=>{this._changeDetectorRef.markForCheck()})).subscribe(({data:r})=>{r&&(this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:r.createDispatch.message,type:"success",svgIcon:"mat_solid:done"}}),this.stayHere?this.restoreForm():this._router.navigateByUrl("/modules/warehouse/dispatches"))})})}displayFn(t){return t&&t.name?t.name:""}restoreForm(){this.dispatchingForm.get("products").clear(),this.searchProductControl.reset(),this.dispatchingForm.reset(),this.searchProductControl.setValue("")}_mapChecked(t){return t.pipe((0,b.T)(i=>i.map(n=>this.dispatchingForm.get("products").getRawValue().some(l=>l.productId===n.productId&&l.depotId===n.depotId)?{...structuredClone(n),checked:!0}:{...structuredClone(n),checked:!1})))}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["app-dispatches-form"]],standalone:!0,features:[e.aNF],decls:52,vars:18,consts:[["dispatchingNgForm","ngForm"],["productsAutocomplete","matAutocomplete"],["fuseScrollbar","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-auto","bg-card","dark:bg-transparent",3,"fuseScrollbarOptions"],[1,"relative","flex","flex-col","px-6","py-8","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],["routerLink","/modules/warehouse/dispatches",1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["color","primary",3,"ngModelChange","ngModel"],["mat-flat-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"click","disabled"],[1,"flex","flex-col","px-4","mt-4","mb-12","gap-y-8","sm:px-8"],[1,"shadow","rounded-2xl","bg-card"],[1,"grid","p-10","gap-x-4","sm:grid-cols-2",3,"formGroup"],[1,"w-full","fuse-mat-dense"],[3,"formControlName","required"],[3,"value"],[1,"sm:col-span-2"],["color","primary",3,"formControlName"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-30"],[1,"flex","items-center","justify-center","w-full","h-200"],[1,"p-6","pb-0"],["appearance","fill",1,"w-full","fuse-mat-dense",3,"subscriptSizing"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete",3,"closed","displayWith"],[1,"w-full",3,"value"],["fuseScrollbar","",1,"flex","flex-col","flex-auto","pb-2","mt-2","min-h-72",3,"fuseScrollbarOptions"],[1,"grid"],[1,"w-full",3,"click","value"],[1,"grid","w-full","grid-cols-6",3,"click"],[1,"flex","flex-row","items-center","col-span-5","truncate","md:col-span-3"],["color","primary",3,"checked"],[1,"items-center","hidden","col-span-2","md:flex"],[1,"flex","items-center","text-center"],[1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","dispatching-products-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"text-left"],[1,"text-center"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","dispatching-products-grid","md:px-8"],[1,"truncate",3,"matTooltip"],[1,"truncate","text-center"],[1,"flex","flex-col","justify-center"],[1,"flex","flex-row","items-center","justify-center","gap-2"],["mat-stroked-button","",1,"p-2","leading-6","min-w-7","min-h-7","h-7",3,"click","disabled"],[1,"icon-size-5",3,"svgIcon"],[1,"fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],["matInput","","type","number","name","quantity",1,"font-mono","font-semibold","text-center",3,"min","formControl"],[1,"w-full","text-sm","text-center"],[1,"flex","justify-center"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"]],template:function(i,n){if(1&i){const r=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div")(5,"a",6),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",7),e.nrm(8,"mat-icon",8),e.j41(9,"a",9),e.EFF(10,"Almac\xe9n"),e.k0s()(),e.j41(11,"div",7),e.nrm(12,"mat-icon",8),e.j41(13,"a",10),e.EFF(14,"Despachos"),e.k0s()(),e.j41(15,"div",7),e.nrm(16,"mat-icon",8),e.j41(17,"a",9),e.EFF(18,"Despachar Mercanc\xedas"),e.k0s()()(),e.j41(19,"div",11)(20,"h2",12),e.EFF(21," Despachar Mercanc\xedas "),e.k0s()()(),e.j41(22,"div",13)(23,"mat-checkbox",14),e.mxI("ngModelChange",function(c){return e.eBV(r),e.DH7(n.stayHere,c)||(n.stayHere=c),e.Njj(c)}),e.EFF(24,"Permanecer aqu\xed"),e.k0s(),e.j41(25,"button",15),e.bIt("click",function(){return e.eBV(r),e.Njj(n.createDispatch())}),e.EFF(26," Generar Despacho "),e.k0s()()(),e.j41(27,"div",16)(28,"div",17)(29,"form",18,0)(31,"mat-form-field",19)(32,"mat-label"),e.EFF(33,"Almac\xe9n de Salida"),e.k0s(),e.j41(34,"mat-select",20),e.Z7z(35,_i,2,2,"mat-option",21,e.fX1),e.k0s(),e.DNE(37,vi,2,0,"mat-error"),e.k0s(),e.j41(38,"mat-form-field",19)(39,"mat-label"),e.EFF(40,"Almac\xe9n de Entrada"),e.k0s(),e.j41(41,"mat-select",20),e.Z7z(42,bi,2,2,"mat-option",21,yt),e.k0s(),e.DNE(44,Ci,2,0,"mat-error"),e.k0s(),e.j41(45,"div",22)(46,"mat-checkbox",23),e.EFF(47,"\xbfNecesita Confirmaci\xf3n?"),e.k0s()()()(),e.j41(48,"div",17),e.DNE(49,Fi,2,0,"div",24)(50,ki,2,0,"div",25)(51,ji,12,11,"div",26),e.k0s()()()}2&i&&(e.Y8G("fuseScrollbarOptions",e.lJ4(17,fi)),e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.R50("ngModel",n.stayHere),e.R7$(2),e.Y8G("disabled",n.dispatchingForm.invalid),e.R7$(4),e.Y8G("formGroup",n.dispatchingForm),e.R7$(5),e.Y8G("formControlName","depotInitId")("required",!0),e.R7$(),e.Dyx(n.ownDepots),e.R7$(2),e.vxM(37,n.dispatchingForm.get("depotInitId").hasError("required")?37:-1),e.R7$(4),e.Y8G("formControlName","depotEndId")("required",!0),e.R7$(),e.Dyx(n.filteredDepots),e.R7$(2),e.vxM(44,n.dispatchingForm.get("depotEndId").hasError("required")?44:-1),e.R7$(2),e.Y8G("formControlName","needConfirmation"),e.R7$(3),e.vxM(49,null===n.dispatchingForm.get("depotInitId").value?49:-1),e.R7$(),e.vxM(50,n.loadingProducts?50:-1),e.R7$(),e.vxM(51,n.loadingProducts||null===n.dispatchingForm.get("depotInitId").value?-1:51))},dependencies:[p.Jj,p.QX,a.YN,a.qT,a.me,a.Q0,a.BC,a.cb,a.YS,a.VZ,a.vS,H.p,D.jL,D.$3,oe.wT,D.pN,v.Hl,v.$z,me.g7,me.So,m.RG,m.rl,m.nJ,m.TL,m.JW,C.m_,C.An,k.fS,k.fg,Q.D6,Q.LG,Z.Ve,Z.VO,M.uc,M.oV,a.X1,a.l_,a.j4,a.JD,g.Wk],encapsulation:2,changeDetection:0})}return o})();var Ee=d(10467),xe=d(56730),Qe=d(82341);const wi=(o,s)=>s.id,Mi=()=>({wheelPropagation:!1}),Gi=()=>["Cajero"],Ti=()=>["/modules/warehouse/dispatches/form"],Pi=(o,s)=>({"pointer-events-none":o,hidden:s}),Ai=()=>[10,25,50,100],Bi=(o,s)=>({"text-red-500":o,"text-green-500":s}),Wi=o=>["/modules/warehouse/dispatches/confirm",o];function Ni(o,s){1&o&&(e.j41(0,"button",17),e.nrm(1,"mat-icon",18),e.j41(2,"span",19),e.EFF(3,"Agregar"),e.k0s()()),2&o&&(e.Y8G("routerLink",e.lJ4(2,Ti)),e.R7$(),e.Y8G("svgIcon","mat_solid:add"))}function Vi(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",25)(1,"div",27),e.EFF(2),e.k0s(),e.j41(3,"div",28),e.EFF(4),e.nI1(5,"date"),e.k0s(),e.j41(6,"div",27),e.EFF(7),e.k0s(),e.j41(8,"div",27),e.EFF(9),e.k0s(),e.j41(10,"div",23),e.EFF(11),e.k0s(),e.j41(12,"div",29),e.nrm(13,"mat-icon",30),e.k0s(),e.j41(14,"div",31)(15,"button",32),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.viewDispatchReport(n))}),e.nrm(16,"mat-icon",33),e.k0s(),e.j41(17,"button",34),e.nrm(18,"mat-icon",33),e.k0s()()()}if(2&o){const t=s.$implicit;e.R7$(2),e.SpI(" ",t.no," "),e.R7$(2),e.SpI(" ",e.i5U(5,12,t.createdAt,"dd/MM/yyyy hh:mm a")," "),e.R7$(3),e.SpI(" ",t.depotInit.name," "),e.R7$(2),e.SpI(" ",t.depotEnd.name," "),e.R7$(2),e.SpI(" ",t.user.fullname," "),e.R7$(2),e.Y8G("ngClass",e.l_i(15,Bi,!t.confirmed,t.confirmed))("svgIcon",t.confirmed?"mat_solid:done":"mat_solid:close")("matTooltip",t.confirmed?"Confirmado":"Sin Confirmaci\xf3n"),e.R7$(3),e.Y8G("svgIcon","mat_solid:description"),e.R7$(),e.Y8G("routerLink",e.eq3(18,Wi,t.id))("disabled",t.confirmed),e.R7$(),e.Y8G("svgIcon","mat_solid:find_in_page")}}function Yi(o,s){if(1&o&&(e.j41(0,"div",20)(1,"div",21)(2,"div",22),e.EFF(3,"No."),e.k0s(),e.j41(4,"div",23),e.EFF(5," Fecha "),e.k0s(),e.j41(6,"div",23),e.EFF(7," Origen "),e.k0s(),e.j41(8,"div",23),e.EFF(9," Destino "),e.k0s(),e.j41(10,"div",23),e.EFF(11," Empleado "),e.k0s(),e.j41(12,"div",24),e.EFF(13," Confirmaci\xf3n "),e.k0s(),e.j41(14,"div",24),e.EFF(15," Detalles "),e.k0s()(),e.Z7z(16,Vi,19,20,"div",25,wi),e.k0s(),e.nrm(18,"mat-paginator",26)),2&o){const t=e.XpG();e.R7$(2),e.Y8G("mat-sort-header","no"),e.R7$(14),e.Dyx(t.dispatches),e.R7$(2),e.Y8G("ngClass",e.l_i(7,Pi,t.isLoading,t.pagination.length<10&&t.pagination.page<1))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.lJ4(10,Ai))("showFirstLastButtons",!0)}}function zi(o,s){1&o&&(e.j41(0,"div",35),e.EFF(1,"\xa1No se ha creado ning\xfan despacho!"),e.k0s())}let Li=(()=>{class o{constructor(){this.isLoading=!1,this.dispatches=[],this.searchInputControl=new a.MJ(""),this.merchant=null,this.user=null,this._changeDetectorRef=(0,e.WQX)(e.gRc),this._dispatchesService=(0,e.WQX)(Re),this._documentsService=(0,e.WQX)(xe.Q),this._unsubscribeAll=new j.B,this._permissionsService=(0,e.WQX)(Qe.$R),this.store=(0,e.WQX)(S.il)}ngOnInit(){this.store.select(re.SW).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(fe.Xb).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(se.Dz).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.store.select(Pe).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.dispatches=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,u.Q)(this._unsubscribeAll),(0,f.B)(300),(0,_.n)(t=>null!==t?(this.isLoading=!0,this._dispatchesService.getDispatches(0,25,"no","desc",t)):(0,E.of)()),(0,b.T)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this.waitForPaginatorLoad().then(()=>{this._sort&&this._paginator&&(this._sort.sort({id:"no",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,V.h)(this._sort.sortChange,this._paginator.page).pipe((0,_.n)(()=>this._dispatchesService.getDispatches(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value)),(0,b.T)(()=>{this.isLoading=!1})).subscribe())})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}viewDispatchReport(t){this._documentsService.generateDispatchDocument(t,this.merchant,this.user)}waitForPaginatorLoad(){var t=this;return(0,Ee.A)(function*(){for(;!t._paginator||void 0===t._paginator;)yield new Promise(i=>{setTimeout(i,200)});return t._paginator})()}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["dispatches-list"]],viewQuery:function(i,n){if(1&i&&(e.GBs(I.iy,5),e.GBs(F.B4,5)),2&i){let r;e.mGM(r=e.lsd())&&(n._paginator=r.first),e.mGM(r=e.lsd())&&(n._sort=r.first)}},standalone:!0,features:[e.aNF],decls:27,vars:12,consts:[["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent",3,"fuseScrollbarOptions"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","","class","text-white bg-gradient-to-r from-primary-500 to-primary-700",3,"routerLink",4,"ngxPermissionsExcept"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto","sm:mb-18"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"routerLink"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","dispatches-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[3,"mat-sort-header"],[1,""],[1,"text-center"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","dispatches-grid","md:px-8"],[1,"border-b","first-letter:z-10","-mb-1","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","text-swamp-200","bg-gray-50","dark:bg-slate-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"truncate"],[1,"flex","flex-wrap","gap-1","font-mono"],[1,"flex","items-center","justify-center"],[1,"icon-size-7",3,"ngClass","svgIcon","matTooltip"],[1,"flex","flex-row","items-center","justify-center","gap-1"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink","disabled"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",5),e.nrm(8,"mat-icon",6),e.j41(9,"a",7),e.EFF(10,"Almac\xe9n"),e.k0s()(),e.j41(11,"div",5),e.nrm(12,"mat-icon",6),e.j41(13,"a",7),e.EFF(14,"Registro de Despachos"),e.k0s()()(),e.j41(15,"div",8)(16,"h2",9),e.EFF(17," Registro de Despachos "),e.k0s()()(),e.j41(18,"div",10)(19,"mat-form-field",11),e.nrm(20,"mat-icon",12)(21,"input",13),e.k0s(),e.DNE(22,Ni,4,3,"button",14),e.k0s()(),e.j41(23,"div",15)(24,"div",16),e.DNE(25,Yi,19,11)(26,zi,2,0),e.k0s()()()),2&i&&(e.Y8G("fuseScrollbarOptions",e.lJ4(10,Mi)),e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),e.R7$(),e.Y8G("ngxPermissionsExcept",e.lJ4(11,Gi)),e.R7$(3),e.vxM(25,n.dispatches.length>0?25:26))},dependencies:[p.vh,p.YU,m.RG,m.rl,m.JW,F.NQ,F.B4,F.aE,I.Ou,I.iy,v.Hl,v.$z,C.m_,C.An,k.fS,k.fg,M.uc,M.oV,a.X1,a.me,a.BC,a.l_,g.Wk,Qe.Ov,Qe.f6,H.p],encapsulation:2,changeDetection:0})}return o})();const St=o=>o.incomes,qe=((0,S.Mz)(St,o=>o.income),(0,S.Mz)(St,o=>o.incomes));var $e=d(25786);const Qi=w.J1`
   query FindAllIncomes($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllIncomes(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length,
                size,
                page,
                lastPage,
                startIndex,
                endIndex
            }

            incomes {
                id
                no
                userId
                depotId
                createdAt

                products {
                    productId
                    quantity
                    product {
                        name
                        price
                        uom {
                            abbr
                        }
                    }
                }

                depot {
                    name
                }

                user {
                    fullname
                }
            }
        }
    }
`,qi=w.J1`
    query FindIncomeById($findIncomeById: String!) {
        findIncomeById(id: $findIncomeById) {
            ok
            message

            income {
                id
                no
                userId
                depotId
                createdAt

                products {
                    productId
                    quantity
                    product {
                        name
                        price
                    }
                }

                user {
                    fullname
                }
            }
        }
    }
`,Xi=w.J1`
    mutation CreateIncome($createIncomeInput: CreateIncomeInput!) {
        createIncome(createIncomeInput: $createIncomeInput) {
            ok
            message

            income {
                id
                no
                userId
                depotId
                createdAt

                products {
                    productId
                    quantity
                    product {
                        name
                        price
                    }
                }


                user {
                    fullname
                }
            }
        }
    }
`,Oi=w.J1`
    mutation UpdateIncome($updateIncomeInput: UpdateIncomeInput!) {
        updatedIncome(updateIncomeInput: $updateIncomeInput) {
            ok
            message

            income {
                id
                no
                userId
                depotId
                createdAt

                products {
                    productId
                    quantity
                    product {
                        name
                        price
                    }
                }
            }
        }
    }
`,Ui=w.J1`
    mutation RemoveIncome($removeIncomeId: String!) {
        removeIncome(id: $removeIncomeId) {
            ok
            message
        }
    }
`;let Xe=(()=>{class o{constructor(t,i,n){this.apolloProvider=t,this._snackBar=i,this.store=n,this._apollo=this.apolloProvider.use("BALANC")}createIncome(t){return this._apollo.mutate({mutation:Xi,variables:{createIncomeInput:t},errorPolicy:"all"}).pipe((0,P.M)(({data:i})=>{this.store.dispatch((0,$e.e_)({income:i.createIncome.income}))}))}getIncomes(t=0,i=50,n="no",r="desc",l=""){return this._apollo.query({query:Qi,errorPolicy:"all",variables:{page:t,size:i,sort:n,order:r,search:l}}).pipe((0,P.M)(({data:c})=>{this.store.dispatch((0,$e.FE)({incomes:c.findAllIncomes.incomes})),this.store.dispatch((0,Te.Bp)({pagination:c.findAllIncomes.pagination}))}))}getIncomeById(t){return this._apollo.query({query:qi,variables:{findIncomeByIdId:t},errorPolicy:"all"}).pipe((0,P.M)(({data:i})=>{this.store.dispatch((0,$e.e_)({income:i.findIncomeById.income}))}))}updateIncome(t){return this.store.select(qe).pipe((0,be.s)(1),(0,_.n)(i=>this._apollo.mutate({mutation:Oi,variables:{updateIncomeInput:t},errorPolicy:"all"}).pipe((0,P.M)(({data:n})=>{const r=structuredClone(i);r[i.findIndex(c=>c.id===t.id)]=n.updateIncome.income,this.store.dispatch((0,$e.FE)({incomes:r}))}))))}removeIncome(t){return this.store.select(qe).pipe((0,be.s)(1),(0,_.n)(i=>this._apollo.mutate({mutation:Ui,variables:{removeIncomeId:t},errorPolicy:"all"}).pipe((0,P.M)(()=>{const n=structuredClone(i),r=i.findIndex(l=>l.id===t);n.splice(r,1),this.store.dispatch((0,$e.FE)({incomes:n}))}))))}static#e=this.\u0275fac=function(i){return new(i||o)(e.KVO(w.Ic),e.KVO(O.UG),e.KVO(S.il))};static#t=this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var Ae=d(36296);const Hi=(o,s)=>s.id,Ji=()=>({suppressScrollX:!0}),Zi=()=>({suppressScrollY:!0});function Ki(o,s){if(1&o&&(e.j41(0,"mat-option",19),e.EFF(1),e.k0s()),2&o){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function en(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," El almac\xe9n es obligatorio "),e.k0s())}function tn(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-option",29),e.bIt("click",function(n){const r=e.eBV(t).$implicit;return e.XpG().addProductToIncome(r),e.Njj(n.stopPropagation())}),e.j41(1,"div",30),e.bIt("click",function(n){const r=e.eBV(t).$implicit;return e.XpG().addProductToIncome(r),e.Njj(n.stopPropagation())}),e.j41(2,"span",31),e.nrm(3,"mat-checkbox",32),e.EFF(4),e.k0s(),e.j41(5,"span",33),e.EFF(6),e.nI1(7,"number"),e.k0s()()()}if(2&o){const t=s.$implicit;e.Y8G("value",t),e.R7$(3),e.Y8G("checked",t.checked),e.R7$(),e.SpI(" ",t.name," "),e.R7$(2),e.Lme("",e.i5U(7,5,t.quantity,"1.2-2")," ",t.uom.abbr,"")}}function on(o,s){1&o&&(e.j41(0,"mat-error",45),e.EFF(1," Valor m\xednimo 0.1 "),e.k0s())}function nn(o,s){if(1&o&&(e.j41(0,"mat-error",45),e.EFF(1),e.k0s()),2&o){const t=e.XpG().$implicit;e.R7$(),e.SpI(" Valor m\xe1ximo ",t.quantity," ")}}function sn(o,s){1&o&&(e.j41(0,"mat-error",45),e.EFF(1," Patr\xf3n no v\xe1lido "),e.k0s())}function rn(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",37)(1,"div"),e.EFF(2),e.k0s(),e.j41(3,"div",38),e.EFF(4),e.k0s(),e.j41(5,"div",39)(6,"div",40)(7,"button",41),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.decrementProductQty(n))}),e.nrm(8,"mat-icon",42),e.k0s(),e.j41(9,"mat-form-field",43),e.nrm(10,"input",44),e.k0s(),e.j41(11,"button",41),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.incrementProductQty(n))}),e.nrm(12,"mat-icon",42),e.k0s()(),e.DNE(13,on,2,0,"mat-error",45)(14,nn,2,1,"mat-error",45)(15,sn,2,0,"mat-error",45),e.k0s(),e.j41(16,"div",46)(17,"button",47),e.bIt("click",function(){const n=e.eBV(t).$index,r=e.XpG(2);return e.Njj(r.removeProductFromIncome(n))}),e.nrm(18,"mat-icon",42),e.k0s()()()}if(2&o){const t=s.$implicit,i=s.$index;e.R7$(2),e.SpI(" ",i+1," "),e.R7$(),e.Y8G("matTooltip",t.get("name").value),e.R7$(),e.SpI(" ",t.get("name").value," "),e.R7$(3),e.Y8G("disabled",t.get("quantity").value<=.1||t.get("quantity").hasError("pattern")),e.R7$(),e.Y8G("svgIcon","mat_solid:remove"),e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("min",.1)("formControl",t.get("quantity")),e.R7$(),e.Y8G("disabled",t.get("quantity").hasError("pattern")),e.R7$(),e.Y8G("svgIcon","mat_solid:add"),e.R7$(),e.vxM(13,t.get("quantity").hasError("min")?13:-1),e.R7$(),e.vxM(14,t.get("quantity").hasError("max")?14:-1),e.R7$(),e.vxM(15,t.get("quantity").hasError("pattern")&&!t.get("quantity").hasError("min")?15:-1),e.R7$(3),e.Y8G("svgIcon","mat_solid:close")}}function an(o,s){if(1&o&&(e.j41(0,"div",28)(1,"div",34),e.nrm(2,"div"),e.j41(3,"div",35),e.EFF(4," Producto "),e.k0s(),e.j41(5,"div",36),e.EFF(6," Cantidad "),e.k0s(),e.j41(7,"div",36),e.EFF(8," Quitar "),e.k0s()(),e.Z7z(9,rn,19,14,"div",37,Hi),e.k0s()),2&o){const t=e.XpG();e.R7$(9),e.Dyx(t.incomeForm.get("products").controls)}}function ln(o,s){1&o&&(e.j41(0,"div",48),e.EFF(1," \xa1No ha seleccionado ning\xfan producto a\xfan! "),e.k0s())}let cn=(()=>{class o{constructor(){this.incomeProducts=!1,this.previewsProductsFormData=[],this.depots=[],this.searchProductControl=new a.MJ(null),this._changeDetectorRef=(0,e.WQX)(e.gRc),this._formBuilder=(0,e.WQX)(a.ok),this._unsubscribeAll=new j.B,this._fuseConfirmationService=(0,e.WQX)(ae.G),this._incomesService=(0,e.WQX)(Xe),this._router=(0,e.WQX)(g.Ix),this._snackBar=(0,e.WQX)(O.UG),this._productsService=(0,e.WQX)(Ae.g),this.store=(0,e.WQX)(S.il)}ngOnInit(){this.incomeForm=this._formBuilder.group({products:new a.Yp([]),depotId:new a.MJ(null,[a.k0.required])}),this.store.select(q.c_).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.depots=t,this._changeDetectorRef.markForCheck()}),this.products$=this.store.select(Ce.VW),this.productsFiltered=this.searchProductControl.valueChanges.pipe((0,f.B)(600),(0,x.Z)(null),(0,L.Z)(t=>this._mapChecked("string"==typeof t?this._productsService.findActiveProducts(t.trim(),10):this.products$)))}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}displayFn(t){return t&&t.name?t.name:""}addProductToIncome(t){const i=this.incomeForm.get("products").getRawValue().findIndex(r=>r.productId===t.id);if(t.checked?(this.removeProductFromIncome(i),t.checked=!1):t.checked=!0,i>-1)return;const n=this._formBuilder.group({productId:new a.MJ(t.id,[a.k0.required]),name:new a.MJ(t.name,[a.k0.required]),uom:new a.MJ(t.uom,[a.k0.required]),quantity:new a.MJ(1,[K.t.onlyNumbersPattern(),a.k0.required,a.k0.min(.1)])});this.incomeForm.get("products").push(n),this._changeDetectorRef.markForCheck()}removeProductFromIncome(t){this.incomeForm.get("products").removeAt(t),this.searchProductControl.reset(),this._changeDetectorRef.markForCheck()}incrementProductQty(t){const i=t.get("quantity").value;t.get("quantity").setValue(+i+1)}decrementProductQty(t){const i=t.get("quantity").value;t.get("quantity").setValue(+i-1)}createIncome(){if(this.incomeForm.invalid)return;if(0===this.incomeForm.get("products").controls.length)return void this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Alerta",message:"Debe agrear al menos un producto a la entrada",type:"warning",svgIcon:"mat_solid:warning"}});const{products:t,depotId:i}=this.incomeForm.getRawValue(),n={depotId:i,products:t.map(l=>({productId:l.productId,quantity:Number(l.quantity)}))};this._fuseConfirmationService.open({title:"Generar entrada",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,u.Q)(this._unsubscribeAll)).subscribe(l=>{"confirmed"===l&&this._incomesService.createIncome(n).subscribe(({})=>{this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:"Entrada registrada correctamente",type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/modules/warehouse/incomes")})})}_mapChecked(t){return t.pipe((0,b.T)(i=>i.map(n=>this.incomeForm.get("products").getRawValue().some(l=>l.productId===n.id)?{...structuredClone(n),checked:!0}:{...structuredClone(n),checked:!1})))}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["warehouse-income-form"]],standalone:!0,features:[e.aNF],decls:49,vars:21,consts:[["dispatchingNgForm","ngForm"],["productsAutocomplete","matAutocomplete"],["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0",3,"fuseScrollbarOptions"],[1,"relative","flex","flex-col","px-6","py-8","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["mat-flat-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"click","disabled"],[1,"flex","flex-col","px-4","mt-4","mb-12","gap-y-8","sm:px-8"],[1,"p-8","shadow","rounded-2xl","bg-card"],[1,"w-full",3,"formGroup"],[1,"w-full","fuse-mat-dense"],[3,"formControlName","required"],[3,"value"],[1,"col-span-4","shadow","rounded-2xl","bg-card"],[1,"p-6","pb-0"],["appearance","fill",1,"w-full","fuse-mat-dense",3,"subscriptSizing"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete",3,"displayWith"],[1,"w-full",3,"value"],["fuseScrollbar","",1,"flex","flex-col","flex-auto","pb-2","mt-2","min-h-72",3,"fuseScrollbarOptions"],[1,"grid"],[1,"w-full",3,"click","value"],[1,"grid","w-full","grid-cols-6",3,"click"],[1,"flex","flex-row","items-center","col-span-5","truncate","md:col-span-3"],["color","primary",3,"checked"],[1,"flex","items-center","text-center"],[1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","income-products-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-primary","dark:bg-opacity-5"],[1,"text-left"],[1,"text-center"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","income-products-grid","md:px-8"],[1,"truncate",3,"matTooltip"],[1,"flex","flex-col","justify-center"],[1,"flex","flex-row","items-center","justify-center","gap-2"],["mat-stroked-button","",1,"p-2","leading-6","min-w-7","min-h-7","h-7",3,"click","disabled"],[1,"icon-size-5",3,"svgIcon"],[1,"fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],["matInput","","type","text","name","quantity",1,"font-mono","font-semibold","text-center",3,"min","formControl"],[1,"w-full","text-sm","text-center"],[1,"flex","justify-center"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-30"]],template:function(i,n){if(1&i){const r=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div")(5,"a",6),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",7),e.nrm(8,"mat-icon",8),e.j41(9,"a",9),e.EFF(10,"Almac\xe9n"),e.k0s()(),e.j41(11,"div",7),e.nrm(12,"mat-icon",8),e.j41(13,"a",9),e.EFF(14,"Entradas"),e.k0s()(),e.j41(15,"div",7),e.nrm(16,"mat-icon",8),e.j41(17,"a",9),e.EFF(18,"Recibir"),e.k0s()()(),e.j41(19,"div",10)(20,"h2",11),e.EFF(21," Recibir mercanc\xedas "),e.k0s()()(),e.j41(22,"div",12)(23,"button",13),e.bIt("click",function(){return e.eBV(r),e.Njj(n.createIncome())}),e.EFF(24," Registrar Entrada "),e.k0s()()(),e.j41(25,"div",14)(26,"div",15)(27,"form",16,0)(29,"mat-form-field",17)(30,"mat-label"),e.EFF(31,"Almac\xe9n de Entrada"),e.k0s(),e.j41(32,"mat-select",18),e.Z7z(33,Ki,2,2,"mat-option",19,e.fX1),e.k0s(),e.DNE(35,en,2,0,"mat-error"),e.k0s()()(),e.j41(36,"div",20)(37,"div",21)(38,"mat-form-field",22),e.nrm(39,"mat-icon",23)(40,"input",24),e.j41(41,"mat-autocomplete",25,1),e.Z7z(43,tn,8,8,"mat-option",26,e.fX1),e.nI1(45,"async"),e.k0s()(),e.j41(46,"div",27),e.DNE(47,an,11,0,"div",28)(48,ln,2,0),e.k0s()()()()()}if(2&i){const r=e.sdS(42);e.Y8G("fuseScrollbarOptions",e.lJ4(19,Ji)),e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.Y8G("disabled",n.incomeForm.invalid),e.R7$(4),e.Y8G("formGroup",n.incomeForm),e.R7$(5),e.Y8G("formControlName","depotId")("required",!0),e.R7$(),e.Dyx(n.depots),e.R7$(2),e.vxM(35,n.incomeForm.get("depotId").hasError("required")?35:-1),e.R7$(3),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.searchProductControl)("matAutocomplete",r)("placeholder","Buscar existencia de productos en inventario"),e.R7$(),e.Y8G("displayWith",n.displayFn),e.R7$(2),e.Dyx(e.bMT(45,17,n.productsFiltered)),e.R7$(3),e.Y8G("fuseScrollbarOptions",e.lJ4(20,Zi)),e.R7$(),e.vxM(47,n.incomeForm.get("products").controls.length>0?47:48)}},dependencies:[p.QX,H.p,D.jL,D.$3,oe.wT,D.pN,v.Hl,v.$z,me.g7,me.So,m.RG,m.rl,m.nJ,m.TL,m.JW,C.m_,C.An,k.fS,k.fg,F.NQ,M.uc,M.oV,a.X1,a.qT,a.me,a.BC,a.cb,a.YS,a.l_,a.j4,a.JD,a.YN,g.Wk,p.Jj,Z.Ve,Z.VO],encapsulation:2})}return o})(),dn=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["warehouse-incomes"]],standalone:!0,features:[e.aNF],decls:1,vars:0,template:function(i,n){1&i&&e.nrm(0,"router-outlet")},dependencies:[g.n3],encapsulation:2})}return o})();var N=d(5864),It=d(39928),Rt=d(17085),un=d(99184);const mn=["stockTemplateFile"],pn=(o,s)=>s.id,hn=()=>({wheelPropagation:!1}),fn=o=>({"cursor-not-allowed":o});function gn(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Campo requerido "),e.k0s())}function _n(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Campo requerido "),e.k0s())}function vn(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Valor entre 3 y 255 caracteres. "),e.k0s())}function bn(o,s){if(1&o&&(e.j41(0,"mat-option",35),e.EFF(1),e.k0s()),2&o){const t=s.$implicit;e.Y8G("value",t.abbr),e.R7$(),e.SpI(" ",t.abbr," ")}}function Cn(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Campo requerido "),e.k0s())}function Fn(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Valor m\xednimo de 0.1 "),e.k0s())}function kn(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Campo requerido "),e.k0s())}function xn(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Campo requerido "),e.k0s())}function yn(o,s){if(1&o){const t=e.RV6();e.j41(0,"form",23)(1,"div"),e.EFF(2),e.k0s(),e.qex(3),e.j41(4,"mat-form-field",28),e.nrm(5,"input",29),e.DNE(6,gn,2,0,"mat-error"),e.k0s(),e.bVm(),e.qex(7),e.j41(8,"mat-form-field",30),e.nrm(9,"input",31),e.k0s(),e.bVm(),e.qex(10),e.j41(11,"mat-form-field",30),e.nrm(12,"input",31),e.k0s(),e.bVm(),e.j41(13,"mat-form-field",30),e.nrm(14,"input",29),e.DNE(15,_n,2,0,"mat-error")(16,vn,2,0,"mat-error"),e.k0s(),e.j41(17,"mat-form-field",30),e.nrm(18,"input",32,0),e.j41(20,"span",33),e.EFF(21),e.k0s()(),e.qex(22),e.j41(23,"mat-form-field",30)(24,"mat-select",34),e.Z7z(25,bn,2,2,"mat-option",35,e.fX1),e.nI1(27,"async"),e.k0s()(),e.bVm(),e.j41(28,"mat-form-field",30),e.nrm(29,"input",36),e.DNE(30,Cn,2,0,"mat-error")(31,Fn,2,0,"mat-error"),e.k0s(),e.j41(32,"mat-form-field",37),e.nrm(33,"mat-icon",38)(34,"input",39),e.DNE(35,kn,2,0,"mat-error"),e.k0s(),e.j41(36,"mat-form-field",37),e.nrm(37,"mat-icon",38)(38,"input",39),e.DNE(39,xn,2,0,"mat-error"),e.k0s(),e.qex(40),e.j41(41,"mat-form-field",30),e.nrm(42,"input",40),e.k0s(),e.bVm(),e.j41(43,"div",41)(44,"button",42),e.bIt("click",function(){const n=e.eBV(t).$index,r=e.XpG(3);return e.Njj(r.removeProduct(n))}),e.nrm(45,"mat-icon",26),e.k0s()()()}if(2&o){const t=s.$implicit,i=s.$index,n=e.sdS(19),r=e.XpG(3);e.Y8G("formGroup",t),e.R7$(2),e.JRh(i+1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("formControlName","upc"),e.R7$(),e.vxM(6,t.get("upc").hasError("required")?6:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("formControlName","sku"),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("formControlName","bCode"),e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("formControlName","name"),e.R7$(),e.vxM(15,t.get("name").hasError("required")?15:-1),e.R7$(),e.vxM(16,t.get("name").hasError("minlength")||t.get("name").hasError("maxlength")?16:-1),e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("formControlName","description"),e.R7$(3),e.SpI("",n.value.length," / 10000"),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("formControlName","uom"),e.R7$(),e.Dyx(e.bMT(27,31,r.uoms$)),e.R7$(3),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("formControlName","quantity"),e.R7$(),e.vxM(30,t.get("quantity").hasError("required")?30:-1),e.R7$(),e.vxM(31,t.get("quantity").hasError("min")?31:-1),e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(2),e.Y8G("formControlName","cost"),e.R7$(),e.vxM(35,t.get("cost").hasError("required")?35:-1),e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(2),e.Y8G("formControlName","price"),e.R7$(),e.vxM(39,t.get("price").hasError("required")?39:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("formControlName","brand"),e.R7$(3),e.Y8G("svgIcon","mat_solid:close")}}function Sn(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",19)(1,"div",20)(2,"div"),e.EFF(3,"#"),e.k0s(),e.j41(4,"div",21),e.EFF(5,"UPC *"),e.k0s(),e.j41(6,"div",21),e.EFF(7,"SKU"),e.k0s(),e.j41(8,"div",21),e.EFF(9,"C\xf3digo"),e.k0s(),e.j41(10,"div",21),e.EFF(11,"Nombre *"),e.k0s(),e.j41(12,"div",21),e.EFF(13,"Descripci\xf3n"),e.k0s(),e.j41(14,"div",21),e.EFF(15,"U.Medida"),e.k0s(),e.j41(16,"div",21),e.EFF(17,"Cantidad *"),e.k0s(),e.j41(18,"div",21),e.EFF(19,"Costo *"),e.k0s(),e.j41(20,"div",21),e.EFF(21,"Precio *"),e.k0s(),e.j41(22,"div",21),e.EFF(23,"Marca"),e.k0s(),e.j41(24,"div",22),e.EFF(25,"Quitar"),e.k0s()(),e.Z7z(26,yn,46,33,"form",23,pn),e.j41(28,"div",24)(29,"div",25),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.addNewProduct())}),e.nrm(30,"mat-icon",26),e.j41(31,"span",27),e.EFF(32," Agregar Producto "),e.k0s()(),e.j41(33,"div",25),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.addNewProduct())}),e.nrm(34,"mat-icon",26),e.j41(35,"span",27),e.EFF(36," Agregar Producto "),e.k0s()()()()}if(2&o){const t=e.XpG();e.R7$(26),e.Dyx(t),e.R7$(4),e.Y8G("svgIcon","mat_solid:add_circle"),e.R7$(4),e.Y8G("svgIcon","mat_solid:add_circle")}}function In(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",43)(1,"div",44)(2,"label",45),e.nrm(3,"mat-icon",46),e.EFF(4," Importar Plantilla "),e.k0s(),e.j41(5,"input",47,1),e.bIt("change",function(n){e.eBV(t);const r=e.XpG(2);return e.Njj(r.importStockFormTemplateFile(n))}),e.k0s()(),e.j41(7,"div",48),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.addNewProduct())}),e.j41(8,"label",49),e.nrm(9,"mat-icon",46),e.EFF(10," Agregar Producto "),e.k0s()()()}2&o&&(e.R7$(3),e.Y8G("svgIcon","mat_solid:upload"),e.R7$(6),e.Y8G("svgIcon","mat_solid:add"))}function Rn(o,s){1&o&&e.DNE(0,Sn,37,2,"div",19)(1,In,11,2),2&o&&e.vxM(0,s.length>0?0:1)}let En=(()=>{class o{constructor(){this.uoms$=(0,E.of)([]),this._changeDetectorRef=(0,e.WQX)(e.gRc),this._dialog=(0,e.WQX)(X.bZ),this._formBuilder=(0,e.WQX)(a.ok),this._productsService=(0,e.WQX)(Ae.g),this._router=(0,e.WQX)(g.Ix),this._snackBar=(0,e.WQX)(O.UG),this._unsubscribeAll=new j.B,this.store=(0,e.WQX)(S.il)}ngOnInit(){this.uoms$=this.store.select(Rt.Ns),this.productsForm=this._formBuilder.group({products:this._formBuilder.array([])}),this.store.select(Ce.MW).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{if(t&&t.length>0){const i=t.map(n=>this.createProductFormGroup(n));this.productsForm.setControl("products",this._formBuilder.array(i)),this._changeDetectorRef.markForCheck()}})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}addNewProduct(){this.productsForm.get("products").push(this.createEmptyProductFormGroup())}removeProduct(t){this.productsForm.get("products").removeAt(t)}importStockFormTemplateFile(t){const i=t.target;this.isExcelFile=!!i.files[0].name.match(/(.xls|.xlsx)/),i.files.length>1&&(this.stockTemplateFile.nativeElement.value=""),this.isExcelFile?this._productsService.importStockFormTemplateFile(t):this.stockTemplateFile.nativeElement.value=""}selectDepot(){const t=this.productsForm.get("products").getRawValue();this.openDialog().afterClosed().pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{n&&!N.H.IsNullOrEmpty(n.depot)&&this.importProducts(t,n.depot.id)})}createProductFormGroup(t){return this._formBuilder.group({upc:[t.upc,[a.k0.required]],sku:[t.sku],bCode:[t.bCode],name:[t.name,[a.k0.required]],description:[t.description,[a.k0.maxLength(1e4)]],uom:[t.uom],quantity:[t.quantity,[a.k0.min(.1)]],cost:[Number(t.cost.toFixed(2)),[a.k0.required,a.k0.min(0)]],price:[Number(t.price.toFixed(2)),[a.k0.required,a.k0.min(0)]],brand:[t.brand]})}createEmptyProductFormGroup(){return this._formBuilder.group({upc:[null,[a.k0.required]],sku:[null],bCode:[null],name:[null,[a.k0.required]],description:[null,[a.k0.maxLength(1e4)]],uom:[""],quantity:[1,[a.k0.min(.1)]],cost:[0,[a.k0.required,a.k0.min(0)]],price:[0,[a.k0.required,a.k0.min(0)]],brand:[""]})}openDialog(){return this._dialog.open(un._,{data:{},panelClass:"ath-dialog-panel",disableClose:!0})}importProducts(t,i){this._productsService.importProductsFromTemplateFile(t,i).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(({data:n})=>{n&&(this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:n.importProductsFromTemplateFile.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.store.dispatch((0,It.R4)()),this._router.navigateByUrl("/modules/warehouse/products")),this._changeDetectorRef.markForCheck()})}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["load-products"]],viewQuery:function(i,n){if(1&i&&e.GBs(mn,5),2&i){let r;e.mGM(r=e.lsd())&&(n.stockTemplateFile=r.first)}},standalone:!0,features:[e.aNF],decls:27,vars:10,consts:[["descriptionLength",""],["stockTemplateFile",""],["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent",3,"fuseScrollbarOptions"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/warehouse/products",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["mat-raised-button","",1,"ml-8","text-white","md:ml-0","md:fixed","right-8","bg-gradient-to-r","from-primary-500","to-primary-600",3,"click","disabled","ngClass"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto","h-full"],[1,"grid"],[1,"sticky","top-0","z-10","grid","gap-0.5","px-6","py-4","font-semibold","shadow","products-template-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-gray-900"],[1,"text-center"],[1,"text-end"],[1,"z-0","grid","items-center","gap-0.5","px-6","bg-white","border-b","dark:bg-default","products-template-grid","md:px-8",3,"formGroup"],[1,"flex","justify-between","px-8","py-8"],[1,"inline-flex","items-center","rounded","cursor-pointer",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2","font-medium","text-secondary","group-hover:underline"],["matTooltip","C\xf3digo de barras",1,"w-full","fuse-mat-dense",3,"subscriptSizing"],["matInput","","type","text","minlength","3","maxlength","255","required","",3,"formControlName"],[1,"w-full","fuse-mat-dense",3,"subscriptSizing"],["matInput","","type","text","minlength","3","maxlength","255",3,"formControlName"],["matInput","","type","text","matInput","","matTextareaAutoSize","","maxlength","10000","rows","1",3,"formControlName"],["matSuffix","",1,"ml-2"],[3,"formControlName"],[3,"value"],["matInput","","type","number","min","0.1","max","999999999","required","",3,"formControlName"],[1,"w-full","sm:","fuse-mat-dense",3,"subscriptSizing"],["matPrefix","","svgIcon","mat_solid:attach_money"],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName"],["matInput","","type","text","minlength","1","maxlength","255",3,"formControlName"],[1,"flex","justify-end"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"flex","flex-row","items-center","justify-center","w-full","min-h-full","space-x-4"],[1,"flex","flex-col","items-center","justify-center","p-5","rounded-md","cursor-pointer","hover:bg-hover","hover:shadow-md"],["for","stock-template-file-input",1,"flex","flex-col","items-center","justify-center","text-xl","font-bold","cursor-pointer"],[1,"icon-size-20",3,"svgIcon"],["id","stock-template-file-input","type","file","accept",".xls, .xlsx",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"change"],[1,"flex","flex-col","items-center","justify-center","p-5","rounded-md","cursor-pointer","hover:bg-hover","hover:shadow-md",3,"click"],[1,"flex","flex-col","items-center","justify-center","text-xl","font-bold","cursor-pointer"]],template:function(i,n){if(1&i&&(e.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"div")(4,"div",5)(5,"div")(6,"a",6),e.EFF(7,"Inicio"),e.k0s()(),e.j41(8,"div",7),e.nrm(9,"mat-icon",8),e.j41(10,"a",9),e.EFF(11,"Productos"),e.k0s()(),e.j41(12,"div",7),e.nrm(13,"mat-icon",8),e.j41(14,"a",10),e.EFF(15,"Crear Productos"),e.k0s()()()(),e.j41(16,"div",11)(17,"h2",12),e.EFF(18," Plantilla de Existencia "),e.k0s()()(),e.j41(19,"div",13)(20,"button",14),e.bIt("click",function(){return n.selectDepot()}),e.nrm(21,"mat-icon",15),e.j41(22,"span",16),e.EFF(23,"Seleccionar Almac\xe9n y Guardar"),e.k0s()()()(),e.j41(24,"div",17)(25,"div",18),e.DNE(26,Rn,2,1),e.k0s()()()),2&i){let r;e.Y8G("fuseScrollbarOptions",e.lJ4(7,hn)),e.R7$(9),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.Y8G("disabled",n.productsForm.invalid||0===n.productsForm.get("products").getRawValue().length)("ngClass",e.eq3(8,fn,n.productsForm.invalid||0===n.productsForm.get("products").getRawValue().length)),e.R7$(),e.Y8G("svgIcon","mat_solid:save"),e.R7$(5),e.vxM(26,(r=n.productsForm.get("products").controls)?26:-1,r)}},dependencies:[p.Jj,v.Hl,v.$z,m.RG,m.rl,m.TL,m.JW,m.yw,C.m_,C.An,k.fS,k.fg,Z.Ve,Z.VO,oe.wT,p.YU,a.X1,a.qT,a.me,a.Q0,a.BC,a.cb,a.YS,a.xh,a.tU,a.VZ,a.zX,a.j4,a.JD,H.p],styles:[".products-template-grid{grid-template-columns:25px 150px 150px 150px 300px 300px 100px 100px 140px 140px 140px 55px}\n"],encapsulation:2,changeDetection:0})}return o})();var Y=d(59115),ie=d(25084);const Et=o=>o.movements,$n=((0,S.Mz)(Et,o=>o.movement),(0,S.Mz)(Et,o=>o.movements));var Oe=d(40826),ge=d(49074);const jn=w.J1`
    mutation CreatedMovement($createMovementInput: CreateMovementInput!) {
        createdMovement(createMovementInput: $createMovementInput) {
            id
            productId
            product {
                name
                brandId
                brand {
                    name
                }

                uom {
                    abbr
                }
            }

            createdAt

            depotInitId
            depotEndId

            depotInit {
                id
                name
                code
            }

            depotEnd {
                id
                name
                code
            }

            reason
            initQuantity
            quantity
            endQuantity
            type
        }
    }

`,Dn=w.J1`
    query FindAllMovements($page: Int, $size: Int, $sort: String, $order: Order, $search: String, $depotId: String, $productId: String,) {
        findAllMovements(page: $page, size: $size, sort: $sort, order: $order, search: $search, depotId: $depotId, productId: $productId) {
            ok
            message

            pagination {
                length,
                size,
                page,
                lastPage,
                startIndex,
                endIndex
            }

            movements {
                id
                productId
                product {
                    name
                    brandId
                    brand {
                        name
                    }

                    uom {
                        abbr
                    }
                }

                depotInitId
                depotEndId

                depotInit {
                    id
                    name
                    code
                }

                depotEnd {
                    id
                    name
                    code
                }

                observation


                reason
                initQuantity
                quantity
                endQuantity
                type
                createdAt
            }
        }
    }
`,wn=w.J1`
    query FindMovementById($findMovementById: String!) {
        movement(id: $findMovementById) {
            id
            productId
            product {
                name
                brandId
                brand {
                    name
                }
            }

            depotInitId
            depotEndId

            depotInit {
                id
                name
                code
            }

            depotEnd {
                id
                name
                code
            }

            reason
            initQuantity
            quantity
            endQuantity
            type
            createdAt
        }
    }
`,Mn=w.J1`
    query FindMovementsByDateRange($startDate: DateTime!, $endDate: DateTime!, $depotId: String, $productId: String) {
        findMovementsByDateRange(startDate: $startDate, endDate: $endDate, depotId: $depotId, productId: $productId) {
            ok
            message

            movements {
                id
                productId
                product {
                    id
                    name
                }

                stockId

                stock {
                    id
                    purchase {
                       id
                       voucherNo
                    }
                }

                depotInitId
                depotEndId

                depotInit {
                    id
                    name
                }

                depotEnd {
                    id
                    name
                }

                observation

                reason
                initQuantity
                quantity
                endQuantity
                type
                createdAt
            }
        }
    }
`;let Ue=(()=>{class o{constructor(t,i){this.apolloProvider=t,this.store=i,this._apollo=this.apolloProvider.use("BALANC")}createMovement(t){return this._apollo.mutate({mutation:jn,variables:{createMovementInput:t},errorPolicy:"all"}).pipe((0,P.M)(({data:i})=>{i&&(this.store.dispatch((0,Oe.B4)({movements:i.createdMovement})),this.store.dispatch((0,ge.kp)({movements:i.createdMovement})))}))}getMovements(t=0,i=50,n="createdAt",r="desc",l="",c=null,h=null){return this._apollo.query({query:Dn,errorPolicy:"all",variables:{page:t,size:i,sort:n,order:r,search:l,depotId:c,productId:h}}).pipe((0,P.M)(({data:y})=>{this.store.dispatch((0,Oe.t1)({movements:y.findAllMovements.movements})),this.store.dispatch((0,Te.Bp)({pagination:y.findAllMovements.pagination}))}))}getMovementsByDateRange(t,i,n=null,r=null){return this._apollo.query({query:Mn,errorPolicy:"all",variables:{startDate:t,endDate:i,depotId:n,productId:r}})}getMovementById(t){return this._apollo.query({query:wn,variables:{findMovementByIdId:t},errorPolicy:"all"}).pipe((0,P.M)(({data:i})=>{this.store.dispatch((0,Oe.Ik)({movement:i.movement}))}))}static#e=this.\u0275fac=function(i){return new(i||o)(e.KVO(w.Ic),e.KVO(S.il))};static#t=this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var $=d(33984);let Gn=(()=>{class o{transform(t){if(t)switch(t){case $.aY.inicial:return"Inventario inicial";case $.aY.ajuste:return"Por ajuste de inventario";case $.aY.averia:return"Por aver\xeda del producto";case $.aY.promocion:return"Por promoci\xf3n del proveedor";case $.aY.compra:return"Por compra de mercanc\xedas";case $.aY.venta:return"Por venta de mercanc\xedas";case $.aY.between:return"Movimiento entre almacenes";case $.aY.reembolso:return"Por reembolso";case $.aY.cancelacion:return"Por cancelaci\xf3n";case $.aY.perdida:return"Por p\xe9rdida";case $.aY.gasto:return"Por gasto";case $.aY.activo:return"Por activo fijo tangible"}return""}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275pipe=e.EJ8({name:"movementReason",type:o,pure:!0,standalone:!0})}return o})();const Tn=()=>({wheelPropagation:!1}),Pn=(o,s)=>({"pointer-events-none":o,hidden:s}),An=()=>[25,50,100];function Bn(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-option",36),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.addDepot(n))}),e.EFF(1),e.k0s()}if(2&o){const t=s.$implicit;e.Y8G("value",t.name),e.R7$(),e.SpI(" ",t.name," ")}}function Wn(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-icon",37),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.resetDepot())}),e.k0s()}}function Nn(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-option",36),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.addProduct(n))}),e.EFF(1),e.k0s()}if(2&o){const t=s.$implicit;e.Y8G("value",t.name),e.R7$(),e.SpI(" ",t.name," ")}}function Vn(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-icon",37),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.resetProduct())}),e.k0s()}}function Yn(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-icon",37),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.range.reset())}),e.k0s()}}function zn(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1,"Fecha de inicio no v\xe1lida "),e.k0s())}function Ln(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1,"Fecha de final no v\xe1lida "),e.k0s())}function Qn(o,s){if(1&o&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&o){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.depotInit.name)}}function qn(o,s){1&o&&e.nrm(0,"span")}function Xn(o,s){if(1&o&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&o){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.depotEnd.name)}}function On(o,s){1&o&&e.nrm(0,"span")}function Un(o,s){if(1&o&&(e.j41(0,"div",45)(1,"div",40),e.EFF(2),e.k0s(),e.j41(3,"div",28),e.EFF(4),e.nI1(5,"movementReason"),e.k0s(),e.j41(6,"div",46),e.EFF(7),e.k0s(),e.j41(8,"div",47),e.EFF(9),e.nI1(10,"uppercase"),e.k0s(),e.j41(11,"div",43),e.DNE(12,Qn,2,1,"span")(13,qn,1,0,"span"),e.k0s(),e.j41(14,"div",43),e.DNE(15,Xn,2,1,"span")(16,On,1,0,"span"),e.k0s(),e.j41(17,"div",43),e.EFF(18),e.k0s(),e.j41(19,"div",43),e.EFF(20),e.nI1(21,"number"),e.k0s(),e.j41(22,"div",43),e.EFF(23),e.nI1(24,"number"),e.k0s(),e.j41(25,"div",48),e.EFF(26),e.nI1(27,"number"),e.k0s(),e.j41(28,"div",43),e.EFF(29),e.nI1(30,"date"),e.k0s()()),2&o){const t=s.$implicit;e.R7$(2),e.SpI(" ",t.product.name," "),e.R7$(2),e.SpI(" ",e.bMT(5,14,t.reason)," "),e.R7$(2),e.Y8G("matTooltip",t.observation),e.R7$(),e.SpI(" ",t.observation," "),e.R7$(2),e.SpI(" ",e.bMT(10,16,t.type)," "),e.R7$(3),e.vxM(12,t.depotInit?12:-1),e.R7$(),e.vxM(13,t.depotInit?-1:13),e.R7$(2),e.vxM(15,t.depotEnd?15:-1),e.R7$(),e.vxM(16,t.depotEnd?-1:16),e.R7$(2),e.SpI(" ",t.product.uom.abbr," "),e.R7$(2),e.SpI(" ",e.i5U(21,18,t.initQuantity,"1.2-2")," "),e.R7$(3),e.SpI(" ",e.i5U(24,21,t.quantity,"1.2-2")," "),e.R7$(3),e.SpI(" ",e.i5U(27,24,t.endQuantity,"1.2-2")," "),e.R7$(3),e.SpI(" ",e.i5U(30,27,t.createdAt,"dd/MM/yyyy HH:mm:ss")," ")}}function Hn(o,s){1&o&&e.Z7z(0,Un,31,30,"div",45,e.BUC().trackByFn,!0),2&o&&e.Dyx(s)}function Jn(o,s){if(1&o&&(e.j41(0,"div",38)(1,"div",39)(2,"div",40),e.EFF(3," Producto "),e.k0s(),e.j41(4,"div",41),e.EFF(5," Motivo "),e.k0s(),e.j41(6,"div",42),e.EFF(7," Observaciones "),e.k0s(),e.j41(8,"div",41),e.EFF(9," Tipo "),e.k0s(),e.j41(10,"div",43),e.EFF(11," Almac\xe9n Origen "),e.k0s(),e.j41(12,"div",43),e.EFF(13," Almac\xe9n Destino "),e.k0s(),e.j41(14,"div",43),e.EFF(15," U.Medida "),e.k0s(),e.j41(16,"div",41),e.EFF(17," Cantidad Inicial "),e.k0s(),e.j41(18,"div",41),e.EFF(19," Cantidad "),e.k0s(),e.j41(20,"div",41),e.EFF(21," Cantidad Final "),e.k0s(),e.j41(22,"div",41),e.EFF(23," Fecha "),e.k0s()(),e.DNE(24,Hn,2,0),e.nI1(25,"async"),e.nrm(26,"mat-paginator",44),e.k0s()),2&o){let t;const i=e.XpG(2);e.R7$(4),e.Y8G("mat-sort-header","reason"),e.R7$(4),e.Y8G("mat-sort-header","type"),e.R7$(8),e.Y8G("mat-sort-header","initQuantity"),e.R7$(2),e.Y8G("mat-sort-header","quantity"),e.R7$(2),e.Y8G("mat-sort-header","endQuantity"),e.R7$(2),e.Y8G("mat-sort-header","createdAt"),e.R7$(2),e.vxM(24,(t=e.bMT(25,13,i.movements$))?24:-1,t),e.R7$(2),e.Y8G("ngClass",e.l_i(15,Pn,i.isLoading,i.pagination.length<10&&i.pagination.page<1))("length",i.pagination.length)("pageIndex",i.pagination.page)("pageSize",i.pagination.size)("pageSizeOptions",e.lJ4(18,An))("showFirstLastButtons",!0)}}function Zn(o,s){1&o&&(e.j41(0,"div",49),e.EFF(1," \xa1No se ha registrado ning\xfan movimiento! "),e.k0s())}function Kn(o,s){1&o&&e.DNE(0,Jn,27,19,"div",38)(1,Zn,2,0),2&o&&e.vxM(0,s.length>0?0:1)}let es=(()=>{class o{constructor(){this.isLoading=!1,this.movement=new $.yG,this.movements$=(0,E.of)([]),this.searchInputControl=new a.MJ(null),this.merchant=null,this.user=null,this.searchDepotsControl=new a.MJ(null),this.searchProductsControl=new a.MJ(null),this.selectedDepot=null,this.selectedProduct=null,this.availability=null,this.range=new a.gE({start:new a.MJ({disabled:!1,value:null},[K.t.futureDateValidator()]),end:new a.MJ({disabled:!1,value:null},[K.t.futureDateValidator()])}),this.maxDate=new Date,this._changeDetectorRef=(0,e.WQX)(e.gRc),this._depotsService=(0,e.WQX)(ue.t),this._dialog=(0,e.WQX)(X.bZ),this._movementsService=(0,e.WQX)(Ue),this._stocksService=(0,e.WQX)(pe.t),this._unsubscribeAll=new j.B,this._documentsService=(0,e.WQX)(xe.Q),this.store=(0,e.WQX)(S.il)}ngOnInit(){this.store.select(se.Dz).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.store.select(re.SW).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(fe.Xb).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.movements$=this.store.select($n),this.searchInputControl.valueChanges.pipe((0,u.Q)(this._unsubscribeAll),(0,f.B)(300),(0,_.n)(t=>null!==t?(this.isLoading=!0,this._movementsService.getMovements(0,25,"createdAt","desc",t,this.selectedDepot?this.selectedDepot.id:null,this.selectedProduct?this.selectedProduct.id:null)):(0,E.of)()),(0,b.T)(()=>{this.isLoading=!1})).subscribe(),this.depotsFiltered=this.searchDepotsControl.valueChanges.pipe((0,f.B)(200),(0,x.Z)(null),(0,U.j)(()=>{this.isLoading=!1}),(0,L.Z)(t=>null!==t&&"string"==typeof t&&(this.selectedDepot&&t!==this.selectedDepot.name||!this.selectedDepot)?(this.isLoading=!0,this._depotsService.findActiveDepots(t.trim())):(0,E.of)())),this.productsFiltered=this.searchProductsControl.valueChanges.pipe((0,f.B)(200),(0,x.Z)(null),(0,U.j)(()=>{this.isLoading=!1}),(0,L.Z)(t=>{if(null!==t&&"string"==typeof t&&(this.selectedProduct&&t!==this.selectedProduct.name||!this.selectedProduct)){this.isLoading=!0;const i=this.selectedDepot?this.selectedDepot.id:null;return this._stocksService.findStockProducts(t.trim(),10,i,this.availability)}return(0,E.of)()}))}ngAfterViewInit(){this.waitForPaginatorLoad().then(()=>{this._sort&&this._paginator&&(this._sort.sort({id:"createdAt",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,V.h)(this._sort.sortChange,this._paginator.page).pipe((0,_.n)(()=>(this.isLoading=!0,this._movementsService.getMovements(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.selectedDepot?this.selectedDepot.id:null,this.selectedProduct?this.selectedProduct.id:null))),(0,b.T)(()=>{this.isLoading=!1})).subscribe())})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}addDepot(t){this.selectedDepot=t,this.selectedProduct=null,this.searchProductsControl.setValue(""),this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}resetDepot(){this.selectedDepot=null,this.searchDepotsControl.setValue(""),this.selectedProduct=null,this.searchProductsControl.setValue("",{emitEvent:!1}),this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addProduct(t){this.selectedProduct=t,this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}resetProduct(){this.selectedProduct=null,this.searchProductsControl.setValue(""),this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}generateMovementsReport(){this._movementsService.getMovementsByDateRange(this.range.value.start,this.range.value.end,this.selectedDepot?.id,this.selectedProduct?.id).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this._documentsService.generateMovementsDocument({start:this.range.value.start,end:this.range.value.end},t.data.findMovementsByDateRange.movements,this.merchant,this.user)},t=>{console.error(t)})}trackByFn(t,i){return i.id||t}waitForPaginatorLoad(){var t=this;return(0,Ee.A)(function*(){for(;!t._paginator||void 0===t._paginator;)yield new Promise(i=>{setTimeout(i,200)});return t._paginator})()}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["movements"]],viewQuery:function(i,n){if(1&i&&(e.GBs(I.iy,5),e.GBs(F.B4,5)),2&i){let r;e.mGM(r=e.lsd())&&(n._paginator=r.first),e.mGM(r=e.lsd())&&(n._sort=r.first)}},standalone:!0,features:[e.aNF],decls:60,vars:34,consts:[["depotsDepotsAutocomplete","matAutocomplete"],["depotsProductsAutocomplete","matAutocomplete"],["picker",""],["reportsMenu","matMenu"],["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent",3,"fuseScrollbarOptions"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","flex-wrap","items-center","gap-2","mt-6","md:fixed","md:max-w-1/2","md:justify-end","right-8","shrink-0","lg:mt-0","lg:ml-4"],["appearance","fill",1,"w-full","mt-4","sm:w-auto","sm:mr-4","sm:mt-0","fuse-mat-dense","fuse-mat-no-subscript","mat-fuse-de","fuse-mat-rounded","sm:min-w-72",3,"subscriptSizing"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete"],[3,"value"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer"],["appearance","fill",1,"w-full","mt-4","sm:w-auto","sm:mr-4","sm:mt-0","fuse-mat-dense","fuse-mat-no-subscript","mat-fuse-de","fuse-mat-rounded","sm:min-w-60",3,"subscriptSizing"],[1,"sm:mx-4","min-w-64","fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],[3,"formGroup","rangePicker","max"],["matStartDate","","formControlName","start","placeholder","Fecha de inicio"],["matEndDate","","formControlName","end","placeholder","Fecha final"],["matPrefix","",3,"for"],["disabled","false"],[1,""],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-yellow-500","to-yellow-600",3,"disabled","matMenuTriggerFor"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],["xPosition","before"],["mat-menu-item","",3,"click"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-col","justify-between","flex-auto"],[3,"click","value"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer",3,"click"],[1,"relative","grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","md:px-8","text-md","text-primary-200","bg-gray-50","dark:bg-slate-900","movement-grid"],[1,"truncate"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"flex","justify-center"],[1,"text-center"],[1,"border-b","first-letter:z-10","-mb-1","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","text-swamp-200","bg-gray-50","dark:bg-slate-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","md:px-8","movement-grid"],[1,"truncate",3,"matTooltip"],[1,"text-center","truncate"],[1,"text-center","uppercase"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(i,n){if(1&i){const r=e.RV6();e.j41(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7)(4,"div")(5,"a",8),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",9),e.nrm(8,"mat-icon",10),e.j41(9,"a",11),e.EFF(10,"Almac\xe9n"),e.k0s()(),e.j41(11,"div",9),e.nrm(12,"mat-icon",10),e.j41(13,"a",11),e.EFF(14,"Movimientos de inventario"),e.k0s()()(),e.j41(15,"div",12)(16,"h2",13),e.EFF(17," Movimientos de inventario "),e.k0s()()(),e.j41(18,"div",14)(19,"mat-form-field",15),e.nrm(20,"mat-icon",16)(21,"input",17),e.j41(22,"mat-autocomplete",18,0),e.Z7z(24,Bn,2,2,"mat-option",19,e.fX1),e.nI1(26,"async"),e.k0s(),e.DNE(27,Wn,1,0,"mat-icon",20),e.k0s(),e.j41(28,"mat-form-field",21),e.nrm(29,"mat-icon",16)(30,"input",17),e.j41(31,"mat-autocomplete",18,1),e.Z7z(33,Nn,2,2,"mat-option",19,e.fX1),e.nI1(35,"async"),e.k0s(),e.DNE(36,Vn,1,0,"mat-icon",20),e.k0s(),e.j41(37,"mat-form-field",22)(38,"mat-date-range-input",23),e.nrm(39,"input",24)(40,"input",25),e.k0s(),e.nrm(41,"mat-datepicker-toggle",26)(42,"mat-date-range-picker",27,2),e.DNE(44,Yn,1,0,"mat-icon",20)(45,zn,2,0,"mat-error")(46,Ln,2,0,"mat-error"),e.k0s(),e.j41(47,"div",28)(48,"button",29),e.nrm(49,"mat-icon",30),e.j41(50,"span",31),e.EFF(51,"Reportes"),e.k0s()(),e.j41(52,"mat-menu",32,3)(54,"button",33),e.bIt("click",function(){return e.eBV(r),e.Njj(n.generateMovementsReport())}),e.EFF(55,"Generar"),e.k0s()()()()(),e.j41(56,"div",34)(57,"div",35),e.DNE(58,Kn,2,1),e.nI1(59,"async"),e.k0s()()()}if(2&i){let r;const l=e.sdS(23),c=e.sdS(32),h=e.sdS(43),y=e.sdS(53);e.Y8G("fuseScrollbarOptions",e.lJ4(33,Tn)),e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.searchDepotsControl)("matAutocomplete",l)("placeholder","Filtre por Almac\xe9n"),e.R7$(3),e.Dyx(e.bMT(26,27,n.depotsFiltered)),e.R7$(3),e.vxM(27,n.selectedDepot?27:-1),e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.searchProductsControl)("matAutocomplete",c)("placeholder","Filtre por Productos"),e.R7$(3),e.Dyx(e.bMT(35,29,n.productsFiltered)),e.R7$(3),e.vxM(36,n.selectedProduct?36:-1),e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("formGroup",n.range)("rangePicker",h)("max",n.maxDate),e.R7$(3),e.Y8G("for",h),e.R7$(3),e.vxM(44,n.range.get("start").value||n.range.get("end").value?44:-1),e.R7$(),e.vxM(45,n.range.controls.start.hasError("matStartDateInvalid")?45:-1),e.R7$(),e.vxM(46,n.range.controls.end.hasError("matEndDateInvalid")?46:-1),e.R7$(2),e.Y8G("disabled",!n.range.get("start").value||!n.range.get("end").value||n.range.invalid)("matMenuTriggerFor",y),e.R7$(),e.Y8G("svgIcon","mat_solid:plagiarism"),e.R7$(9),e.vxM(58,(r=e.bMT(59,31,n.movements$))?58:-1,r)}},dependencies:[p.Jj,p.QX,p.vh,D.jL,D.$3,oe.wT,D.pN,v.Hl,v.$z,m.RG,m.rl,m.TL,m.JW,m.yw,C.m_,C.An,k.fS,k.fg,Y.Cn,Y.kk,Y.fb,Y.Cp,I.Ou,I.iy,F.NQ,F.B4,F.aE,M.uc,M.oV,Gn,p.YU,a.X1,a.me,a.BC,a.cb,a.l_,a.j4,a.JD,g.Wk,p.Pc,H.p,ie.X6,ie.bU,ie.el,ie.xR,ie.IG,ie.SG],encapsulation:2,changeDetection:0})}return o})();var He=d(92790),ts=d(31849),je=d(62884),Be=function(o){return o.open="open",o.close="close",o}(Be||{});const ns=(o,s)=>s.id,ss=o=>({"ring ring-inset ring-primary":o});function rs(o,s){if(1&o&&(e.j41(0,"div",19)(1,"div",20),e.EFF(2),e.k0s(),e.j41(3,"div",18),e.EFF(4),e.k0s(),e.j41(5,"div",18),e.EFF(6),e.k0s(),e.j41(7,"div",18),e.EFF(8),e.k0s(),e.j41(9,"div",18),e.EFF(10),e.k0s(),e.j41(11,"div",18),e.EFF(12),e.k0s(),e.j41(13,"div",18),e.EFF(14),e.k0s(),e.j41(15,"div",18),e.EFF(16),e.k0s(),e.j41(17,"div",18),e.EFF(18),e.k0s(),e.j41(19,"div",18),e.EFF(20),e.nI1(21,"number"),e.k0s()()),2&o){const t=s.$implicit;e.R7$(2),e.SpI(" ",t.productName," "),e.R7$(2),e.SpI(" ",t.uomAbbr," "),e.R7$(2),e.SpI(" ",t.initialInventory," "),e.R7$(2),e.SpI(" ",t.entries," "),e.R7$(2),e.SpI(" ",t.shrinkages," "),e.R7$(2),e.SpI(" ",t.losses," "),e.R7$(2),e.SpI(" ",t.sold," "),e.R7$(2),e.SpI(" ",t.returned," "),e.R7$(2),e.SpI(" ",t.finalInventory," "),e.R7$(2),e.SpI(" ",e.i5U(21,10,t.totalSales,"1.2-2")," ")}}function as(o,s){if(1&o&&(e.j41(0,"div",16)(1,"div",17)(2,"div"),e.EFF(3,"Producto"),e.k0s(),e.j41(4,"div",18),e.EFF(5," U.M "),e.k0s(),e.j41(6,"div",18),e.EFF(7," Inicial "),e.k0s(),e.j41(8,"div",18),e.EFF(9," Entrada "),e.k0s(),e.j41(10,"div",18),e.EFF(11," Merma "),e.k0s(),e.j41(12,"div",18),e.EFF(13," Perdido "),e.k0s(),e.j41(14,"div",18),e.EFF(15," Vendido "),e.k0s(),e.j41(16,"div",18),e.EFF(17," Devuelto "),e.k0s(),e.j41(18,"div",18),e.EFF(19," Final "),e.k0s(),e.j41(20,"div",18),e.EFF(21," Importe de Venta "),e.k0s()(),e.Z7z(22,rs,22,13,"div",19,e.Vm6),e.k0s()),2&o){const t=e.XpG(2);e.R7$(22),e.Dyx(t.ipv.ipvProductsData)}}function ls(o,s){if(1&o&&(e.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"a",4),e.EFF(5,"Inicio"),e.k0s()(),e.j41(6,"div",5),e.nrm(7,"mat-icon",6),e.j41(8,"a",7),e.EFF(9,"Almac\xe9n"),e.k0s()(),e.j41(10,"div",5),e.nrm(11,"mat-icon",6),e.j41(12,"a",8),e.EFF(13,"Cierres de Inventario"),e.k0s()()(),e.j41(14,"div",9)(15,"h2",10),e.EFF(16),e.k0s()()(),e.j41(17,"div",11)(18,"button",12)(19,"span",13),e.EFF(20,"Cerrar Inventario"),e.k0s()()()(),e.j41(21,"div",14)(22,"div",15),e.DNE(23,as,24,0,"div",16),e.k0s()()),2&o){const t=e.XpG();e.R7$(7),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(5),e.SpI(" Cerrar inventario de ",(null==t.depot?null:t.depot.name)||""," "),e.R7$(7),e.vxM(23,t.ipv&&t.ipv.ipvProductsData.length>0?23:-1)}}function cs(o,s){if(1&o){const t=e.RV6();e.j41(0,"fuse-card",28),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(3);return e.Njj(r.selectDepot(n))}),e.nrm(1,"mat-icon",29),e.j41(2,"div",30)(3,"div",31),e.EFF(4),e.k0s()()()}if(2&o){const t=s.$implicit,i=e.XpG(3);e.Y8G("ngClass",e.eq3(3,ss,t===i.selectedDepot)),e.R7$(),e.Y8G("svgIcon","mat_solid:warehouse"),e.R7$(3),e.JRh(t.name)}}function ds(o,s){if(1&o){const t=e.RV6();e.j41(0,"button",32),e.bIt("click",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.openPeriod())}),e.nrm(1,"mat-icon",33),e.j41(2,"span",13),e.EFF(3,"Abrir Inventario"),e.k0s()()}if(2&o){const t=e.XpG(3);e.Y8G("disabled",t.isLoading),e.R7$(),e.Y8G("svgIcon","mat_solid:key")}}function us(o,s){if(1&o&&(e.j41(0,"div",21)(1,"div",22),e.nrm(2,"mat-icon",23),e.j41(3,"h1",24),e.EFF(4," Selecciona un almac\xe9n para abrir un nuevo per\xedodo inventario "),e.k0s()(),e.j41(5,"div",25),e.Z7z(6,cs,5,5,"fuse-card",26,ns),e.k0s(),e.DNE(8,ds,4,2,"button",27),e.k0s()),2&o){const t=e.XpG(2);e.R7$(2),e.Y8G("svgIcon","mat_solid:date_range"),e.R7$(4),e.Dyx(t.depots),e.R7$(2),e.vxM(8,t.selectedDepot?8:-1)}}function ms(o,s){1&o&&(e.j41(0,"div",34)(1,"h1",35),e.EFF(2,"Cargando Datos"),e.k0s(),e.nrm(3,"mat-spinner",36),e.k0s()),2&o&&(e.R7$(3),e.Y8G("diameter",50)("color","primary"))}function ps(o,s){if(1&o&&e.DNE(0,us,9,2,"div",21)(1,ms,4,2),2&o){const t=e.XpG();e.vxM(0,t.isLoading?1:0)}}let hs=(()=>{class o{constructor(){this.depots=[],this.depot=null,this.selectedDepot=null,this.isLoading=!1,this.period=null,this.ipv=null,this._changeDetectorRef=(0,e.WQX)(e.gRc),this._fuseConfirmationService=(0,e.WQX)(ae.G),this._periodsService=(0,e.WQX)(je.w),this._router=(0,e.WQX)(g.Ix),this._snackBar=(0,e.WQX)(O.UG),this._unsubscribeAll=new j.B,this.store=(0,e.WQX)(S.il)}ngOnInit(){this.store.select(q.c_).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.depots=t,this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this.store.dispatch((0,He.$E)())}selectDepot(t){this.isLoading=!0,this.selectedDepot=t,this._changeDetectorRef.markForCheck(),this._periodsService.findCurrentPeriodByDepotId(t.id).pipe((0,u.Q)(this._unsubscribeAll),(0,U.j)(()=>{this.isLoading=!1})).subscribe(({data:i})=>{this.period=i.findCurrentPeriodByDepotId.period,this._changeDetectorRef.markForCheck(),this.period&&this.period.state===Be.open&&this._router.navigateByUrl("/modules/warehouse/inventory-periods/ipv/"+this.period.id)})}openPeriod(){this._fuseConfirmationService.open({title:"Abrir inventario.",message:"\xbfEst\xe1 seguro que desea abrir en inventario?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._periodsService.openPeriodByDepotId(this.selectedDepot.id).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(({data:n})=>{this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:n.openPeriodByDepotId.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/modules/warehouse/inventory-periods/ipv/"+n.openPeriodByDepotId.period.id),this._changeDetectorRef.markForCheck()})})}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["warehouse-period-admin"]],standalone:!0,features:[e.aNF],decls:3,vars:1,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-64"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],["routerLink","/modules/warehouse/inventory-periods ",1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-col","items-center","flex-auto","p-6","sm:p-10"],[1,"w-full"],[1,"relative","grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","period-stocks-grid","md:px-8","text-md","text-primary-200","bg-gray-50","dark:bg-slate-900"],[1,"text-center"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","period-stocks-grid","md:px-8"],[1,"truncate"],[1,"flex","flex-col","items-center","justify-center","w-full","h-full","px-3","space-y-5"],[1,"flex","flex-col","items-center","justify-center","w-full","space-y-5"],[1,"text-current","icon-size-12",3,"svgIcon"],[1,"text-2xl","font-bold","text-center"],[1,"flex","flex-row","flex-wrap","items-center","justify-center","w-full","gap-5"],[1,"flex","items-center","w-full","p-6","transition-all","duration-300","ease-in-out","cursor-pointer","max-w-80","filter-info","hover:ring","hover:ring-primary-200","hover:ring-inset",3,"ngClass"],["mat-raised-button","",1,"ml-4","text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"disabled"],[1,"flex","items-center","w-full","p-6","transition-all","duration-300","ease-in-out","cursor-pointer","max-w-80","filter-info","hover:ring","hover:ring-primary-200","hover:ring-inset",3,"click","ngClass"],[1,"mr-6","icon-size-12",3,"svgIcon"],[1,"flex","flex-col"],[1,"text-xl","font-semibold","leading-tight"],["mat-raised-button","",1,"ml-4","text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"click","disabled"],[1,"icon-size-5",3,"svgIcon"],[1,"flex","items-center","justify-center","w-full","h-full","space-y-5"],[1,"text-4xl","font-bold"],[3,"diameter","color"]],template:function(i,n){1&i&&(e.j41(0,"div",0),e.DNE(1,ls,24,4)(2,ps,2,1),e.k0s()),2&i&&(e.R7$(),e.vxM(1,null!==n.period&&"open"===n.period.state?1:2))},dependencies:[p.QX,ts.$,v.Hl,v.$z,C.m_,C.An,Q.D6,Q.LG,p.YU,g.Wk],encapsulation:2})}return o})();const Je=o=>o.periods,fs=((0,S.Mz)(Je,o=>o.period),(0,S.Mz)(Je,o=>o.periods)),gs=(0,S.Mz)(Je,o=>o.ipv);function _s(o,s){if(1&o&&(e.j41(0,"div",19)(1,"div",20),e.EFF(2),e.k0s(),e.j41(3,"div",18),e.EFF(4),e.k0s(),e.j41(5,"div",18),e.EFF(6),e.k0s(),e.j41(7,"div",18),e.EFF(8),e.k0s(),e.j41(9,"div",18),e.EFF(10),e.k0s(),e.j41(11,"div",18),e.EFF(12),e.k0s(),e.j41(13,"div",18),e.EFF(14),e.k0s(),e.j41(15,"div",18),e.EFF(16),e.k0s(),e.j41(17,"div",18),e.EFF(18),e.k0s(),e.j41(19,"div",18),e.EFF(20),e.nI1(21,"number"),e.k0s()()),2&o){const t=s.$implicit;e.R7$(2),e.SpI(" ",t.productName," "),e.R7$(2),e.SpI(" ",t.uomAbbr," "),e.R7$(2),e.SpI(" ",t.initialInventory," "),e.R7$(2),e.SpI(" ",t.entries," "),e.R7$(2),e.SpI(" ",t.shrinkages," "),e.R7$(2),e.SpI(" ",t.losses," "),e.R7$(2),e.SpI(" ",t.sold," "),e.R7$(2),e.SpI(" ",t.returned," "),e.R7$(2),e.SpI(" ",t.finalInventory," "),e.R7$(2),e.SpI(" ",e.i5U(21,10,t.totalSales,"1.2-2")," ")}}function vs(o,s){if(1&o&&(e.j41(0,"div",16)(1,"div",17)(2,"div"),e.EFF(3,"Producto"),e.k0s(),e.j41(4,"div",18),e.EFF(5," U.M "),e.k0s(),e.j41(6,"div",18),e.EFF(7," Inicial "),e.k0s(),e.j41(8,"div",18),e.EFF(9," Entrada "),e.k0s(),e.j41(10,"div",18),e.EFF(11," Merma "),e.k0s(),e.j41(12,"div",18),e.EFF(13," Perdido "),e.k0s(),e.j41(14,"div",18),e.EFF(15," Vendido "),e.k0s(),e.j41(16,"div",18),e.EFF(17," Devuelto "),e.k0s(),e.j41(18,"div",18),e.EFF(19," Final "),e.k0s(),e.j41(20,"div",18),e.EFF(21," Importe de Venta "),e.k0s()(),e.Z7z(22,_s,22,13,"div",19,e.fX1),e.k0s()),2&o){const t=e.XpG(2);e.R7$(22),e.Dyx(t.ipv.ipvProductsData)}}function bs(o,s){if(1&o&&(e.j41(0,"div",21),e.EFF(1),e.k0s()),2&o){const t=e.XpG(2);e.R7$(),e.SpI(" \xa1No se han encontrado productos en el almac\xe9n ",t.depot.name,"! ")}}function Cs(o,s){if(1&o&&(e.j41(0,"div",15),e.DNE(1,vs,24,0,"div",16)(2,bs,2,1),e.k0s()),2&o){const t=e.XpG();e.R7$(),e.vxM(1,t.ipv&&t.ipv.ipvProductsData.length>0?1:2)}}let Fs=(()=>{class o{constructor(){this.depot=null,this.ipv=null,this.periodId=null,this._changeDetectorRef=(0,e.WQX)(e.gRc),this._fuseConfirmationService=(0,e.WQX)(ae.G),this._periodsService=(0,e.WQX)(je.w),this._route=(0,e.WQX)(g.nX),this._router=(0,e.WQX)(g.Ix),this._snackBar=(0,e.WQX)(O.UG),this._unsubscribeAll=new j.B,this.store=(0,e.WQX)(S.il)}ngOnInit(){this._route.params.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.periodId=t.periodId,this._changeDetectorRef.markForCheck()}),this.store.select(q.dY).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.depot=t,this._changeDetectorRef.markForCheck()}),this.store.select(gs).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.ipv=t,this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this.store.dispatch((0,He.$E)())}closePeriod(){const t={periodId:this.periodId};this._fuseConfirmationService.open({title:"Cerrar inventario.",message:"\xbfEst\xe1 seguro que desea cerrar en inventario?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._periodsService.closePeriodByDepotId(t).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(({data:r})=>{r&&(this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:r.closePeriodByDepotId.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/modules/warehouse/inventory-periods"),this._changeDetectorRef.markForCheck())})})}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["warehouse-period-ipv"]],standalone:!0,features:[e.aNF],decls:28,vars:5,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-64"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],["routerLink","/modules/warehouse/inventory-periods",1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"click"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-col","items-center","flex-auto","p-6","sm:p-10"],[1,"w-full"],[1,"relative","grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","period-stocks-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"text-center"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","period-stocks-grid","md:px-8"],[1,"truncate"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",5),e.nrm(8,"mat-icon",6),e.j41(9,"a",7),e.EFF(10,"Almac\xe9n"),e.k0s()(),e.j41(11,"div",5),e.nrm(12,"mat-icon",6),e.j41(13,"a",8),e.EFF(14,"Cierres de Inventario"),e.k0s()(),e.j41(15,"div",5),e.nrm(16,"mat-icon",6),e.j41(17,"a",7),e.EFF(18,"IPV"),e.k0s()()(),e.j41(19,"div",9)(20,"h2",10),e.EFF(21),e.k0s()()(),e.j41(22,"div",11)(23,"button",12),e.bIt("click",function(){return n.closePeriod()}),e.j41(24,"span",13),e.EFF(25,"Cerrar Inventario"),e.k0s()()()(),e.j41(26,"div",14),e.DNE(27,Cs,3,1,"div",15),e.k0s()()),2&i&&(e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(5),e.SpI(" Cerrar per\xedodo en ",n.depot.name," "),e.R7$(6),e.vxM(27,n.ipv?27:-1))},dependencies:[p.QX,v.Hl,v.$z,C.m_,C.An,F.NQ,F.B4,g.Wk],encapsulation:2})}return o})();var $t=d(67336),De=d(36471),We=d(5951),Ze=d(67376);const Ke={toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"],["table"]]},et=new e.nKC("config",{providedIn:"root",factory:()=>({modules:Ke})});var ks=d(345),xs=d(89079),ys=d(71985),Ss=d(59030),Is=d(74402),Rs=d(54843),tt=d(18359),ot=d(33726),Es=d(44668);const $s=[[["","above-quill-editor-toolbar",""]],[["","quill-editor-toolbar",""]],[["","below-quill-editor-toolbar",""]]],js=["[above-quill-editor-toolbar]","[quill-editor-toolbar]","[below-quill-editor-toolbar]"];function Ds(o,s){1&o&&e.nrm(0,"div",0)}function ws(o,s){1&o&&e.nrm(0,"div",0)}const Ne=(o,s)=>o||s||"html";let Gs=(()=>{class o{constructor(t,i){var n=this;this.config=i,this.quill$=(0,Ss.v)((0,Ee.A)(function*(){if(!n.Quill){const r=n.document.addEventListener;n.document.addEventListener=n.document.__zone_symbol__addEventListener||n.document.addEventListener;const l=yield d.e(4720).then(d.bind(d,94720));n.document.addEventListener=r,n.Quill=l.default?.default??l.default??l}return n.config.customOptions?.forEach(r=>{const l=n.Quill.import(r.import);l.whitelist=r.whitelist,n.Quill.register(l,!0,n.config.suppressGlobalRegisterWarning)}),yield n.registerCustomModules(n.Quill,n.config.customModules,n.config.suppressGlobalRegisterWarning)})).pipe((0,Es.t)({bufferSize:1,refCount:!0})),this.document=t.get(p.qQ),this.config||(this.config={modules:Ke})}getQuill(){return this.quill$}registerCustomModules(t,i,n){return(0,Ee.A)(function*(){if(Array.isArray(i))for(let{implementation:r,path:l}of i)(0,Is.A)(r)&&(r=yield(0,Rs._)(r)),t.register(l,r,n);return t})()}static#e=this.\u0275fac=function(i){return new(i||o)(e.KVO(e.zZn),e.KVO(et,8))};static#t=this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),Ts=(()=>{class o{constructor(){this.format=(0,e.hFB)(void 0),this.theme=(0,e.hFB)(void 0),this.modules=(0,e.hFB)(void 0),this.debug=(0,e.hFB)(!1),this.readOnly=(0,e.hFB)(!1),this.placeholder=(0,e.hFB)(void 0),this.maxLength=(0,e.hFB)(void 0),this.minLength=(0,e.hFB)(void 0),this.required=(0,e.hFB)(!1),this.formats=(0,e.hFB)(void 0),this.customToolbarPosition=(0,e.hFB)("top"),this.sanitize=(0,e.hFB)(!1),this.beforeRender=(0,e.hFB)(void 0),this.styles=(0,e.hFB)(null),this.registry=(0,e.hFB)(void 0),this.bounds=(0,e.hFB)(void 0),this.customOptions=(0,e.hFB)([]),this.customModules=(0,e.hFB)([]),this.trackChanges=(0,e.hFB)(void 0),this.classes=(0,e.hFB)(void 0),this.trimOnValidation=(0,e.hFB)(!1),this.linkPlaceholder=(0,e.hFB)(void 0),this.compareValues=(0,e.hFB)(!1),this.filterNull=(0,e.hFB)(!1),this.debounceTime=(0,e.hFB)(void 0),this.defaultEmptyValue=(0,e.hFB)(null),this.onEditorCreated=new e.bkB,this.onEditorChanged=new e.bkB,this.onContentChanged=new e.bkB,this.onSelectionChanged=new e.bkB,this.onFocus=new e.bkB,this.onBlur=new e.bkB,this.onNativeFocus=new e.bkB,this.onNativeBlur=new e.bkB,this.disabled=!1,this.toolbarPosition=(0,e.vPA)("top"),this.subscription=null,this.quillSubscription=null,this.elementRef=(0,e.WQX)(e.aKT),this.document=(0,e.WQX)(p.qQ),this.cd=(0,e.WQX)(e.gRc),this.domSanitizer=(0,e.WQX)(ks.up),this.platformId=(0,e.WQX)(e.Agw),this.renderer=(0,e.WQX)(e.sFG),this.zone=(0,e.WQX)(e.SKi),this.service=(0,e.WQX)(Gs),this.destroyRef=(0,e.WQX)(e.abz),this.valueGetter=(0,e.hFB)(t=>{let i=t.getSemanticHTML();this.isEmptyValue(i)&&(i=this.defaultEmptyValue());let n=i;const r=Ne(this.format(),this.service.config.format);if("text"===r)n=t.getText();else if("object"===r)n=t.getContents();else if("json"===r)try{n=JSON.stringify(t.getContents())}catch{n=t.getText()}return n}),this.valueSetter=(0,e.hFB)((t,i)=>{const n=Ne(this.format(),this.service.config.format);if("html"===n)return([!0,!1].includes(this.sanitize())?this.sanitize():this.service.config.sanitize||!1)&&(i=this.domSanitizer.sanitize(e.WPN.HTML,i)),t.clipboard.convert({html:i});if("json"===n)try{return JSON.parse(i)}catch{return[{insert:i}]}return i}),this.selectionChangeHandler=(t,i,n)=>{const r=this.trackChanges()||this.service.config.trackChanges,l=!t&&!!this.onModelTouched&&("user"===n||r&&"all"===r);!this.onBlur.observed&&!this.onFocus.observed&&!this.onSelectionChanged.observed&&!l||this.zone.run(()=>{null===t?this.onBlur.emit({editor:this.quillEditor,source:n}):null===i&&this.onFocus.emit({editor:this.quillEditor,source:n}),this.onSelectionChanged.emit({editor:this.quillEditor,oldRange:i,range:t,source:n}),l&&this.onModelTouched(),this.cd.markForCheck()})},this.textChangeHandler=(t,i,n)=>{const r=this.quillEditor.getText(),l=this.quillEditor.getContents();let c=this.quillEditor.getSemanticHTML();this.isEmptyValue(c)&&(c=this.defaultEmptyValue());const h=this.trackChanges()||this.service.config.trackChanges,y=("user"===n||h&&"all"===h)&&!!this.onModelChange;!this.onContentChanged.observed&&!y||this.zone.run(()=>{if(y){const R=this.valueGetter();this.onModelChange(R(this.quillEditor))}this.onContentChanged.emit({content:l,delta:t,editor:this.quillEditor,html:c,oldDelta:i,source:n,text:r}),this.cd.markForCheck()})},this.editorChangeHandler=(t,i,n,r)=>{if(this.onEditorChanged.observed)if("text-change"===t){const l=this.quillEditor.getText(),c=this.quillEditor.getContents();let h=this.quillEditor.getSemanticHTML();this.isEmptyValue(h)&&(h=this.defaultEmptyValue()),this.zone.run(()=>{this.onEditorChanged.emit({content:c,delta:i,editor:this.quillEditor,event:t,html:h,oldDelta:n,source:r,text:l}),this.cd.markForCheck()})}else this.zone.run(()=>{this.onEditorChanged.emit({editor:this.quillEditor,event:t,oldRange:n,range:i,source:r}),this.cd.markForCheck()})}}static normalizeClassNames(t){return t.trim().split(" ").reduce((n,r)=>{const l=r.trim();return l&&n.push(l),n},[])}ngOnInit(){this.toolbarPosition.set(this.customToolbarPosition())}ngAfterViewInit(){(0,p.Vy)(this.platformId)||(this.quillSubscription=this.service.getQuill().pipe((0,L.Z)(t=>{const i=[this.service.registerCustomModules(t,this.customModules())],n=this.beforeRender()??this.service.config.beforeRender;return n&&i.push(n()),Promise.all(i).then(()=>t)})).subscribe(t=>{this.editorElem=this.elementRef.nativeElement.querySelector("[quill-editor-element]");const i=this.elementRef.nativeElement.querySelector("[quill-editor-toolbar]"),n=Object.assign({},this.modules()||this.service.config.modules);i?n.toolbar=i:void 0===n.toolbar&&(n.toolbar=Ke.toolbar);let r=void 0!==this.placeholder()?this.placeholder():this.service.config.placeholder;void 0===r&&(r="Insert text here ...");const l=this.styles();l&&Object.keys(l).forEach(te=>{this.renderer.setStyle(this.editorElem,te,l[te])}),this.classes()&&this.addClasses(this.classes()),this.customOptions().forEach(te=>{const ne=t.import(te.import);ne.whitelist=te.whitelist,t.register(ne,!0)});let c=this.bounds()&&"self"===this.bounds()?this.editorElem:this.bounds();c||(c=this.service.config.bounds?this.service.config.bounds:this.document.body);let h=this.debug();!h&&!1!==h&&this.service.config.debug&&(h=this.service.config.debug);let y=this.readOnly();!y&&!1!==this.readOnly()&&(y=void 0!==this.service.config.readOnly&&this.service.config.readOnly);let R=this.formats();if(!R&&void 0===R&&(R=this.service.config.formats?[...this.service.config.formats]:null===this.service.config.formats?null:void 0),this.zone.runOutsideAngular(()=>{if(this.quillEditor=new t(this.editorElem,{bounds:c,debug:h,formats:R,modules:n,placeholder:r,readOnly:y,registry:this.registry(),theme:this.theme()||(this.service.config.theme?this.service.config.theme:"snow")}),this.onNativeBlur.observed&&(this.quillEditor.scroll.domNode.addEventListener("blur",()=>this.onNativeBlur.next({editor:this.quillEditor,source:"dom"})),this.quillEditor.getModule("toolbar").container?.addEventListener("mousedown",ne=>ne.preventDefault())),this.onNativeFocus.observed&&this.quillEditor.scroll.domNode.addEventListener("focus",()=>this.onNativeFocus.next({editor:this.quillEditor,source:"dom"})),this.linkPlaceholder()){const ne=this.quillEditor?.theme?.tooltip?.root?.querySelector("input[data-link]");ne?.dataset&&(ne.dataset.link=this.linkPlaceholder())}}),this.content){if("text"===Ne(this.format(),this.service.config.format))this.quillEditor.setText(this.content,"silent");else{const Hu=this.valueSetter()(this.quillEditor,this.content);this.quillEditor.setContents(Hu,"silent")}this.quillEditor.getModule("history").clear()}this.setDisabledState(),this.addQuillEventListeners(),(this.onEditorCreated.observed||this.onValidatorChanged)&&new ys.c(o=>{const s=requestAnimationFrame(()=>{o.next(),o.complete()});return()=>cancelAnimationFrame(s)}).pipe((0,xs.pQ)(this.destroyRef)).subscribe(()=>{this.onValidatorChanged&&this.onValidatorChanged(),this.onEditorCreated.emit(this.quillEditor)})}))}ngOnDestroy(){this.dispose(),this.quillSubscription?.unsubscribe(),this.quillSubscription=null}ngOnChanges(t){if(this.quillEditor){if(t.readOnly&&this.quillEditor.enable(!t.readOnly.currentValue),t.placeholder&&(this.quillEditor.root.dataset.placeholder=t.placeholder.currentValue),t.styles){const i=t.styles.currentValue,n=t.styles.previousValue;n&&Object.keys(n).forEach(r=>{this.renderer.removeStyle(this.editorElem,r)}),i&&Object.keys(i).forEach(r=>{this.renderer.setStyle(this.editorElem,r,this.styles()[r])})}if(t.classes){const i=t.classes.currentValue,n=t.classes.previousValue;n&&this.removeClasses(n),i&&this.addClasses(i)}t.debounceTime&&this.addQuillEventListeners()}}addClasses(t){o.normalizeClassNames(t).forEach(i=>{this.renderer.addClass(this.editorElem,i)})}removeClasses(t){o.normalizeClassNames(t).forEach(i=>{this.renderer.removeClass(this.editorElem,i)})}writeValue(t){if(this.filterNull()&&null===t||(this.content=t,!this.quillEditor))return;const i=Ne(this.format(),this.service.config.format),r=this.valueSetter()(this.quillEditor,t);if(this.compareValues()){const l=this.quillEditor.getContents();if(JSON.stringify(l)===JSON.stringify(r))return}t?"text"===i?this.quillEditor.setText(t):this.quillEditor.setContents(r):this.quillEditor.setText("")}setDisabledState(t=this.disabled){this.disabled=t,this.quillEditor&&(t?(this.quillEditor.disable(),this.renderer.setAttribute(this.elementRef.nativeElement,"disabled","disabled")):(this.readOnly()||this.quillEditor.enable(),this.renderer.removeAttribute(this.elementRef.nativeElement,"disabled")))}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}registerOnValidatorChange(t){this.onValidatorChanged=t}validate(){if(!this.quillEditor)return null;const t={};let i=!0;const n=this.quillEditor.getText(),r=this.trimOnValidation()?n.trim().length:1===n.length&&0===n.trim().length?0:n.length-1,l=this.quillEditor.getContents().ops,c=!!l&&1===l.length&&["\n",""].includes(l[0].insert?.toString());return this.minLength()&&r&&r<this.minLength()&&(t.minLengthError={given:r,minLength:this.minLength()},i=!1),this.maxLength()&&r>this.maxLength()&&(t.maxLengthError={given:r,maxLength:this.maxLength()},i=!1),this.required()&&!r&&c&&(t.requiredError={empty:!0},i=!1),i?null:t}addQuillEventListeners(){this.dispose(),this.zone.runOutsideAngular(()=>{this.subscription=new tt.yU,this.subscription.add((0,ot.R)(this.quillEditor,"selection-change").subscribe(([n,r,l])=>{this.selectionChangeHandler(n,r,l)}));let t=(0,ot.R)(this.quillEditor,"text-change"),i=(0,ot.R)(this.quillEditor,"editor-change");"number"==typeof this.debounceTime()&&(t=t.pipe((0,f.B)(this.debounceTime())),i=i.pipe((0,f.B)(this.debounceTime()))),this.subscription.add(t.subscribe(([n,r,l])=>{this.textChangeHandler(n,r,l)})),this.subscription.add(i.subscribe(([n,r,l,c])=>{this.editorChangeHandler(n,r,l,c)}))})}dispose(){null!==this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)}isEmptyValue(t){return"<p></p>"===t||"<div></div>"===t||"<p><br></p>"===t||"<div><br></div>"===t}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275dir=e.FsC({type:o,inputs:{format:[e.Mj6.SignalBased,"format"],theme:[e.Mj6.SignalBased,"theme"],modules:[e.Mj6.SignalBased,"modules"],debug:[e.Mj6.SignalBased,"debug"],readOnly:[e.Mj6.SignalBased,"readOnly"],placeholder:[e.Mj6.SignalBased,"placeholder"],maxLength:[e.Mj6.SignalBased,"maxLength"],minLength:[e.Mj6.SignalBased,"minLength"],required:[e.Mj6.SignalBased,"required"],formats:[e.Mj6.SignalBased,"formats"],customToolbarPosition:[e.Mj6.SignalBased,"customToolbarPosition"],sanitize:[e.Mj6.SignalBased,"sanitize"],beforeRender:[e.Mj6.SignalBased,"beforeRender"],styles:[e.Mj6.SignalBased,"styles"],registry:[e.Mj6.SignalBased,"registry"],bounds:[e.Mj6.SignalBased,"bounds"],customOptions:[e.Mj6.SignalBased,"customOptions"],customModules:[e.Mj6.SignalBased,"customModules"],trackChanges:[e.Mj6.SignalBased,"trackChanges"],classes:[e.Mj6.SignalBased,"classes"],trimOnValidation:[e.Mj6.SignalBased,"trimOnValidation"],linkPlaceholder:[e.Mj6.SignalBased,"linkPlaceholder"],compareValues:[e.Mj6.SignalBased,"compareValues"],filterNull:[e.Mj6.SignalBased,"filterNull"],debounceTime:[e.Mj6.SignalBased,"debounceTime"],defaultEmptyValue:[e.Mj6.SignalBased,"defaultEmptyValue"],valueGetter:[e.Mj6.SignalBased,"valueGetter"],valueSetter:[e.Mj6.SignalBased,"valueSetter"]},outputs:{onEditorCreated:"onEditorCreated",onEditorChanged:"onEditorChanged",onContentChanged:"onContentChanged",onSelectionChanged:"onSelectionChanged",onFocus:"onFocus",onBlur:"onBlur",onNativeFocus:"onNativeFocus",onNativeBlur:"onNativeBlur"},features:[e.OA$]})}return o})(),Ps=(()=>{class o extends Ts{static#e=this.\u0275fac=(()=>{let t;return function(n){return(t||(t=e.xGo(o)))(n||o)}})();static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["quill-editor"]],standalone:!0,features:[e.Jv_([{multi:!0,provide:a.kq,useExisting:(0,e.Rfq)(()=>o)},{multi:!0,provide:a.cz,useExisting:(0,e.Rfq)(()=>o)}]),e.Vt3,e.aNF],ngContentSelectors:js,decls:5,vars:2,consts:[["quill-editor-element",""]],template:function(i,n){1&i&&(e.NAR($s),e.DNE(0,Ds,1,0,"div",0),e.SdG(1),e.SdG(2,1),e.SdG(3,2),e.DNE(4,ws,1,0,"div",0)),2&i&&(e.vxM(0,"top"!==n.toolbarPosition()?0:-1),e.R7$(4),e.vxM(4,"top"===n.toolbarPosition()?4:-1))},styles:["[_nghost-%COMP%]{display:inline-block}"]})}return o})(),As=(()=>{class o{static forRoot(t){return{ngModule:o,providers:[{provide:et,useValue:t}]}}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275mod=e.$C({type:o});static#o=this.\u0275inj=e.G2t({})}return o})();function z(o,s){(function Bs(o){return"string"==typeof o&&-1!==o.indexOf(".")&&1===parseFloat(o)})(o)&&(o="100%");var t=function Ws(o){return"string"==typeof o&&-1!==o.indexOf("%")}(o);return o=360===s?o:Math.min(s,Math.max(0,parseFloat(o))),t&&(o=parseInt(String(o*s),10)/100),Math.abs(o-s)<1e-6?1:o=360===s?(o<0?o%s+s:o%s)/parseFloat(String(s)):o%s/parseFloat(String(s))}function Ve(o){return Math.min(1,Math.max(0,o))}function jt(o){return o=parseFloat(o),(isNaN(o)||o<0||o>1)&&(o=1),o}function Ye(o){return o<=1?"".concat(100*Number(o),"%"):o}function Fe(o){return 1===o.length?"0"+o:String(o)}function Dt(o,s,t){o=z(o,255),s=z(s,255),t=z(t,255);var i=Math.max(o,s,t),n=Math.min(o,s,t),r=0,l=0,c=(i+n)/2;if(i===n)l=0,r=0;else{var h=i-n;switch(l=c>.5?h/(2-i-n):h/(i+n),i){case o:r=(s-t)/h+(s<t?6:0);break;case s:r=(t-o)/h+2;break;case t:r=(o-s)/h+4}r/=6}return{h:r,s:l,l:c}}function it(o,s,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?o+6*t*(s-o):t<.5?s:t<2/3?o+(s-o)*(2/3-t)*6:o}function wt(o,s,t){o=z(o,255),s=z(s,255),t=z(t,255);var i=Math.max(o,s,t),n=Math.min(o,s,t),r=0,l=i,c=i-n,h=0===i?0:c/i;if(i===n)r=0;else{switch(i){case o:r=(s-t)/c+(s<t?6:0);break;case s:r=(t-o)/c+2;break;case t:r=(o-s)/c+4}r/=6}return{h:r,s:h,v:l}}function Mt(o,s,t,i){var n=[Fe(Math.round(o).toString(16)),Fe(Math.round(s).toString(16)),Fe(Math.round(t).toString(16))];return i&&n[0].startsWith(n[0].charAt(1))&&n[1].startsWith(n[1].charAt(1))&&n[2].startsWith(n[2].charAt(1))?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0):n.join("")}function Gt(o){return Math.round(255*parseFloat(o)).toString(16)}function Tt(o){return ee(o)/255}function ee(o){return parseInt(o,16)}var nt={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};var _e="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),st="[\\s|\\(]+(".concat(_e,")[,|\\s]+(").concat(_e,")[,|\\s]+(").concat(_e,")\\s*\\)?"),rt="[\\s|\\(]+(".concat(_e,")[,|\\s]+(").concat(_e,")[,|\\s]+(").concat(_e,")[,|\\s]+(").concat(_e,")\\s*\\)?"),le={CSS_UNIT:new RegExp(_e),rgb:new RegExp("rgb"+st),rgba:new RegExp("rgba"+rt),hsl:new RegExp("hsl"+st),hsla:new RegExp("hsla"+rt),hsv:new RegExp("hsv"+st),hsva:new RegExp("hsva"+rt),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function he(o){return!!le.CSS_UNIT.exec(String(o))}var we=function(){function o(s,t){var i;if(void 0===s&&(s=""),void 0===t&&(t={}),s instanceof o)return s;"number"==typeof s&&(s=function Ls(o){return{r:o>>16,g:(65280&o)>>8,b:255&o}}(s)),this.originalInput=s;var n=function Qs(o){var s={r:0,g:0,b:0},t=1,i=null,n=null,r=null,l=!1,c=!1;return"string"==typeof o&&(o=function Os(o){if(0===(o=o.trim().toLowerCase()).length)return!1;var s=!1;if(nt[o])o=nt[o],s=!0;else if("transparent"===o)return{r:0,g:0,b:0,a:0,format:"name"};var t=le.rgb.exec(o);return t?{r:t[1],g:t[2],b:t[3]}:(t=le.rgba.exec(o))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=le.hsl.exec(o))?{h:t[1],s:t[2],l:t[3]}:(t=le.hsla.exec(o))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=le.hsv.exec(o))?{h:t[1],s:t[2],v:t[3]}:(t=le.hsva.exec(o))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=le.hex8.exec(o))?{r:ee(t[1]),g:ee(t[2]),b:ee(t[3]),a:Tt(t[4]),format:s?"name":"hex8"}:(t=le.hex6.exec(o))?{r:ee(t[1]),g:ee(t[2]),b:ee(t[3]),format:s?"name":"hex"}:(t=le.hex4.exec(o))?{r:ee(t[1]+t[1]),g:ee(t[2]+t[2]),b:ee(t[3]+t[3]),a:Tt(t[4]+t[4]),format:s?"name":"hex8"}:!!(t=le.hex3.exec(o))&&{r:ee(t[1]+t[1]),g:ee(t[2]+t[2]),b:ee(t[3]+t[3]),format:s?"name":"hex"}}(o)),"object"==typeof o&&(he(o.r)&&he(o.g)&&he(o.b)?(s=function Ns(o,s,t){return{r:255*z(o,255),g:255*z(s,255),b:255*z(t,255)}}(o.r,o.g,o.b),l=!0,c="%"===String(o.r).substr(-1)?"prgb":"rgb"):he(o.h)&&he(o.s)&&he(o.v)?(i=Ye(o.s),n=Ye(o.v),s=function Ys(o,s,t){o=6*z(o,360),s=z(s,100),t=z(t,100);var i=Math.floor(o),n=o-i,r=t*(1-s),l=t*(1-n*s),c=t*(1-(1-n)*s),h=i%6;return{r:255*[t,l,r,r,c,t][h],g:255*[c,t,t,l,r,r][h],b:255*[r,r,c,t,t,l][h]}}(o.h,i,n),l=!0,c="hsv"):he(o.h)&&he(o.s)&&he(o.l)&&(i=Ye(o.s),r=Ye(o.l),s=function Vs(o,s,t){var i,n,r;if(o=z(o,360),s=z(s,100),t=z(t,100),0===s)n=t,r=t,i=t;else{var l=t<.5?t*(1+s):t+s-t*s,c=2*t-l;i=it(c,l,o+1/3),n=it(c,l,o),r=it(c,l,o-1/3)}return{r:255*i,g:255*n,b:255*r}}(o.h,i,r),l=!0,c="hsl"),Object.prototype.hasOwnProperty.call(o,"a")&&(t=o.a)),t=jt(t),{ok:l,format:o.format||c,r:Math.min(255,Math.max(s.r,0)),g:Math.min(255,Math.max(s.g,0)),b:Math.min(255,Math.max(s.b,0)),a:t}}(s);this.originalInput=s,this.r=n.r,this.g=n.g,this.b=n.b,this.a=n.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(i=t.format)&&void 0!==i?i:n.format,this.gradientType=t.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=n.ok}return o.prototype.isDark=function(){return this.getBrightness()<128},o.prototype.isLight=function(){return!this.isDark()},o.prototype.getBrightness=function(){var s=this.toRgb();return(299*s.r+587*s.g+114*s.b)/1e3},o.prototype.getLuminance=function(){var s=this.toRgb(),r=s.r/255,l=s.g/255,c=s.b/255;return.2126*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.7152*(l<=.03928?l/12.92:Math.pow((l+.055)/1.055,2.4))+.0722*(c<=.03928?c/12.92:Math.pow((c+.055)/1.055,2.4))},o.prototype.getAlpha=function(){return this.a},o.prototype.setAlpha=function(s){return this.a=jt(s),this.roundA=Math.round(100*this.a)/100,this},o.prototype.isMonochrome=function(){return 0===this.toHsl().s},o.prototype.toHsv=function(){var s=wt(this.r,this.g,this.b);return{h:360*s.h,s:s.s,v:s.v,a:this.a}},o.prototype.toHsvString=function(){var s=wt(this.r,this.g,this.b),t=Math.round(360*s.h),i=Math.round(100*s.s),n=Math.round(100*s.v);return 1===this.a?"hsv(".concat(t,", ").concat(i,"%, ").concat(n,"%)"):"hsva(".concat(t,", ").concat(i,"%, ").concat(n,"%, ").concat(this.roundA,")")},o.prototype.toHsl=function(){var s=Dt(this.r,this.g,this.b);return{h:360*s.h,s:s.s,l:s.l,a:this.a}},o.prototype.toHslString=function(){var s=Dt(this.r,this.g,this.b),t=Math.round(360*s.h),i=Math.round(100*s.s),n=Math.round(100*s.l);return 1===this.a?"hsl(".concat(t,", ").concat(i,"%, ").concat(n,"%)"):"hsla(".concat(t,", ").concat(i,"%, ").concat(n,"%, ").concat(this.roundA,")")},o.prototype.toHex=function(s){return void 0===s&&(s=!1),Mt(this.r,this.g,this.b,s)},o.prototype.toHexString=function(s){return void 0===s&&(s=!1),"#"+this.toHex(s)},o.prototype.toHex8=function(s){return void 0===s&&(s=!1),function zs(o,s,t,i,n){var r=[Fe(Math.round(o).toString(16)),Fe(Math.round(s).toString(16)),Fe(Math.round(t).toString(16)),Fe(Gt(i))];return n&&r[0].startsWith(r[0].charAt(1))&&r[1].startsWith(r[1].charAt(1))&&r[2].startsWith(r[2].charAt(1))&&r[3].startsWith(r[3].charAt(1))?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0)+r[3].charAt(0):r.join("")}(this.r,this.g,this.b,this.a,s)},o.prototype.toHex8String=function(s){return void 0===s&&(s=!1),"#"+this.toHex8(s)},o.prototype.toHexShortString=function(s){return void 0===s&&(s=!1),1===this.a?this.toHexString(s):this.toHex8String(s)},o.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},o.prototype.toRgbString=function(){var s=Math.round(this.r),t=Math.round(this.g),i=Math.round(this.b);return 1===this.a?"rgb(".concat(s,", ").concat(t,", ").concat(i,")"):"rgba(".concat(s,", ").concat(t,", ").concat(i,", ").concat(this.roundA,")")},o.prototype.toPercentageRgb=function(){var s=function(t){return"".concat(Math.round(100*z(t,255)),"%")};return{r:s(this.r),g:s(this.g),b:s(this.b),a:this.a}},o.prototype.toPercentageRgbString=function(){var s=function(t){return Math.round(100*z(t,255))};return 1===this.a?"rgb(".concat(s(this.r),"%, ").concat(s(this.g),"%, ").concat(s(this.b),"%)"):"rgba(".concat(s(this.r),"%, ").concat(s(this.g),"%, ").concat(s(this.b),"%, ").concat(this.roundA,")")},o.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var s="#"+Mt(this.r,this.g,this.b,!1),t=0,i=Object.entries(nt);t<i.length;t++){var n=i[t];if(s===n[1])return n[0]}return!1},o.prototype.toString=function(s){var t=!!s;s=s??this.format;var i=!1;return!t&&this.a<1&&this.a>=0&&(s.startsWith("hex")||"name"===s)?"name"===s&&0===this.a?this.toName():this.toRgbString():("rgb"===s&&(i=this.toRgbString()),"prgb"===s&&(i=this.toPercentageRgbString()),("hex"===s||"hex6"===s)&&(i=this.toHexString()),"hex3"===s&&(i=this.toHexString(!0)),"hex4"===s&&(i=this.toHex8String(!0)),"hex8"===s&&(i=this.toHex8String()),"name"===s&&(i=this.toName()),"hsl"===s&&(i=this.toHslString()),"hsv"===s&&(i=this.toHsvString()),i||this.toHexString())},o.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},o.prototype.clone=function(){return new o(this.toString())},o.prototype.lighten=function(s){void 0===s&&(s=10);var t=this.toHsl();return t.l+=s/100,t.l=Ve(t.l),new o(t)},o.prototype.brighten=function(s){void 0===s&&(s=10);var t=this.toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(-s/100*255))),t.g=Math.max(0,Math.min(255,t.g-Math.round(-s/100*255))),t.b=Math.max(0,Math.min(255,t.b-Math.round(-s/100*255))),new o(t)},o.prototype.darken=function(s){void 0===s&&(s=10);var t=this.toHsl();return t.l-=s/100,t.l=Ve(t.l),new o(t)},o.prototype.tint=function(s){return void 0===s&&(s=10),this.mix("white",s)},o.prototype.shade=function(s){return void 0===s&&(s=10),this.mix("black",s)},o.prototype.desaturate=function(s){void 0===s&&(s=10);var t=this.toHsl();return t.s-=s/100,t.s=Ve(t.s),new o(t)},o.prototype.saturate=function(s){void 0===s&&(s=10);var t=this.toHsl();return t.s+=s/100,t.s=Ve(t.s),new o(t)},o.prototype.greyscale=function(){return this.desaturate(100)},o.prototype.spin=function(s){var t=this.toHsl(),i=(t.h+s)%360;return t.h=i<0?360+i:i,new o(t)},o.prototype.mix=function(s,t){void 0===t&&(t=50);var i=this.toRgb(),n=new o(s).toRgb(),r=t/100;return new o({r:(n.r-i.r)*r+i.r,g:(n.g-i.g)*r+i.g,b:(n.b-i.b)*r+i.b,a:(n.a-i.a)*r+i.a})},o.prototype.analogous=function(s,t){void 0===s&&(s=6),void 0===t&&(t=30);var i=this.toHsl(),n=360/t,r=[this];for(i.h=(i.h-(n*s>>1)+720)%360;--s;)i.h=(i.h+n)%360,r.push(new o(i));return r},o.prototype.complement=function(){var s=this.toHsl();return s.h=(s.h+180)%360,new o(s)},o.prototype.monochromatic=function(s){void 0===s&&(s=6);for(var t=this.toHsv(),i=t.h,n=t.s,r=t.v,l=[],c=1/s;s--;)l.push(new o({h:i,s:n,v:r})),r=(r+c)%1;return l},o.prototype.splitcomplement=function(){var s=this.toHsl(),t=s.h;return[this,new o({h:(t+72)%360,s:s.s,l:s.l}),new o({h:(t+216)%360,s:s.s,l:s.l})]},o.prototype.onBackground=function(s){var t=this.toRgb(),i=new o(s).toRgb(),n=t.a+i.a*(1-t.a);return new o({r:(t.r*t.a+i.r*i.a*(1-t.a))/n,g:(t.g*t.a+i.g*i.a*(1-t.a))/n,b:(t.b*t.a+i.b*i.a*(1-t.a))/n,a:n})},o.prototype.triad=function(){return this.polyad(3)},o.prototype.tetrad=function(){return this.polyad(4)},o.prototype.polyad=function(s){for(var t=this.toHsl(),i=t.h,n=[this],r=360/s,l=1;l<s;l++)n.push(new o({h:(i+l*r)%360,s:t.s,l:t.l}));return n},o.prototype.equals=function(s){return this.toRgbString()===new o(s).toRgbString()},o}();const Us=["*"];function Hs(o,s){1&o&&e.nrm(0,"color-checkboard",2)}const at={};let Ks=(()=>{class o{white="transparent";size=8;grey="rgba(0,0,0,.08)";boxShadow;borderRadius;gridStyles;ngOnInit(){const t=function Zs(o,s,t){const i=`${o}-${s}-${t}`;if(at[i])return at[i];const n=function Js(o,s,t){if(typeof document>"u")return null;const i=document.createElement("canvas");i.width=2*t,i.height=2*t;const n=i.getContext("2d");return n?(n.fillStyle=o,n.fillRect(0,0,i.width,i.height),n.fillStyle=s,n.fillRect(0,0,t,t),n.translate(t,t),n.fillRect(0,0,t,t),i.toDataURL()):null}(o,s,t);return n?(at[i]=n,n):null}(this.white,this.grey,this.size);this.gridStyles={borderRadius:this.borderRadius,boxShadow:this.boxShadow,background:`url(${t}) center left`}}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=e.VBU({type:o,selectors:[["color-checkboard"]],inputs:{white:"white",size:"size",grey:"grey",boxShadow:"boxShadow",borderRadius:"borderRadius"},decls:1,vars:1,consts:[[1,"grid",3,"ngStyle"]],template:function(i,n){1&i&&e.nrm(0,"div",0),2&i&&e.Y8G("ngStyle",n.gridStyles)},dependencies:[p.B3],styles:[".grid[_ngcontent-%COMP%]{inset:0;position:absolute}"],changeDetection:0})}return o})(),er=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=e.$C({type:o});static \u0275inj=e.G2t({imports:[p.MD]})}return o})();function Pt(o){let t=0,i=0;return["r","g","b","a","h","s","l","v"].forEach(n=>{o[n]&&(t+=1,isNaN(o[n])||(i+=1),("s"===n||"l"===n)&&/^\d+%$/.test(o[n])&&(i+=1))}),t===i&&o}function Me(o,s,t){const i=new we(o.hex?o.hex:o);t&&i.setAlpha(1);const n=i.toHsl(),r=i.toHsv(),l=i.toRgb(),c=i.toHex();return 0===n.s&&(n.h=s||0,r.h=s||0),{hsl:n,hex:"000000"===c&&0===l.a?"transparent":i.toHexString(),rgb:l,hsv:r,oldHue:o.h||s||n.h,source:o.source}}var ye=function(o){return o.HEX="hex",o.HSL="hsl",o.HSV="hsv",o.RGB="rgb",o}(ye||{});let At=(()=>{class o{className;mode=ye.HEX;color={h:250,s:.5,l:.2,a:1};colorChange=new e.bkB;onChange=new e.bkB;onChangeComplete=new e.bkB;onSwatchHover=new e.bkB;oldHue;hsl;hsv;rgb;hex;source;currentColor;changes;disableAlpha;_onChangeCompleteSubscription=new tt.yU;_onSwatchHoverSubscription=new tt.yU;ngOnInit(){this.changes=this.onChange.pipe((0,f.B)(100),(0,P.M)(t=>{switch(this.onChangeComplete.emit(t),this.mode){case ye.HEX:this.colorChange.emit(t.color.hex);break;case ye.HSL:this.colorChange.emit(t.color.hsl);break;case ye.HSV:this.colorChange.emit(t.color.hsv);break;case ye.RGB:this.colorChange.emit(t.color.rgb);break;default:const i=`The mode '${this.mode}' is not supported`;if((0,e.naY)())throw new Error(i);console.warn(i)}})).subscribe(),this.setState(Me(this.color,0)),this.currentColor=this.hex}ngOnChanges(){this.setState(Me(this.color,this.oldHue))}ngOnDestroy(){this.changes?.unsubscribe(),this._onChangeCompleteSubscription?.unsubscribe(),this._onSwatchHoverSubscription?.unsubscribe()}setState(t){this.oldHue=t.oldHue,this.hsl=t.hsl,this.hsv=t.hsv,this.rgb=t.rgb,this.hex=t.hex,this.source=t.source,this.afterValidChange()}handleChange(t,i){if(Pt(t)){const r=Me(t,t.h||this.oldHue,this.disableAlpha);this.setState(r),this.onChange.emit({color:r,$event:i}),this.afterValidChange()}}afterValidChange(){}handleSwatchHover(t,i){if(Pt(t)){const r=Me(t,t.h||this.oldHue);this.setState(r),this.onSwatchHover.emit({color:r,$event:i})}}registerOnChange(t){this._onChangeCompleteSubscription.add(this.onChangeComplete.pipe((0,P.M)(i=>t(i.color.hex))).subscribe())}registerOnTouched(t){this._onSwatchHoverSubscription.add(this.onSwatchHover.pipe((0,P.M)(()=>t())).subscribe())}setDisabledState(t){}writeValue(t){this.color=t}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=e.VBU({type:o,selectors:[["color-wrap"]],inputs:{className:"className",mode:"mode",color:"color"},outputs:{colorChange:"colorChange",onChange:"onChange",onChangeComplete:"onChangeComplete",onSwatchHover:"onSwatchHover"},features:[e.Jv_([{provide:a.kq,useExisting:(0,e.Rfq)(()=>o),multi:!0}]),e.OA$],decls:0,vars:0,template:function(i,n){},encapsulation:2})}return o})(),or=(()=>{class o{color;style={};focusStyle={};focus;onClick=new e.bkB;onHover=new e.bkB;divStyles={};focusStyles={};inFocus=!1;ngOnInit(){this.divStyles={background:this.color,...this.style}}currentStyles(){return this.focusStyles={...this.divStyles,...this.focusStyle},this.focus||this.inFocus?this.focusStyles:this.divStyles}handleFocusOut(){this.inFocus=!1}handleFocus(){this.inFocus=!0}handleHover(t,i){this.onHover.emit({hex:t,$event:i})}handleClick(t,i){this.onClick.emit({hex:t,$event:i})}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=e.VBU({type:o,selectors:[["color-swatch"]],inputs:{color:"color",style:"style",focusStyle:"focusStyle",focus:"focus"},outputs:{onClick:"onClick",onHover:"onHover"},ngContentSelectors:Us,decls:3,vars:3,consts:[["tabindex","0",1,"swatch",3,"click","keydown.enter","focus","blur","mouseover","ngStyle"],["boxShadow","inset 0 0 0 1px rgba(0,0,0,0.1)",4,"ngIf"],["boxShadow","inset 0 0 0 1px rgba(0,0,0,0.1)"]],template:function(i,n){1&i&&(e.NAR(),e.j41(0,"div",0),e.bIt("click",function(l){return n.handleClick(n.color,l)})("keydown.enter",function(l){return n.handleClick(n.color,l)})("focus",function(){return n.handleFocus()})("blur",function(){return n.handleFocusOut()})("mouseover",function(l){return n.handleHover(n.color,l)}),e.SdG(1),e.DNE(2,Hs,1,0,"color-checkboard",1),e.k0s()),2&i&&(e.Y8G("ngStyle",n.currentStyles()),e.BMQ("title",n.color),e.R7$(2),e.Y8G("ngIf","transparent"===n.color))},dependencies:[p.bT,p.B3,Ks],styles:[".swatch[_ngcontent-%COMP%]{outline:none;height:100%;width:100%;cursor:pointer;position:relative}"],changeDetection:0})}return o})(),ir=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=e.$C({type:o});static \u0275inj=e.G2t({imports:[p.MD,er]})}return o})();var Bt_500="#f44336",Wt_500="#e91e63",Nt_500="#9c27b0",Vt_500="#673ab7",Yt_500="#3f51b5",zt_500="#2196f3",Lt_500="#03a9f4",Qt_500="#00bcd4",qt_500="#009688",Xt_500="#4caf50",Ot_500="#8bc34a",Ut_500="#cddc39",Ht_500="#ffeb3b",Jt_500="#ffc107",Zt_500="#ff9800",Kt_500="#ff5722",eo_500="#795548",to_500="#607d8b";function ur(o,s){if(1&o){const t=e.RV6();e.j41(0,"color-circle-swatch",1),e.bIt("onClick",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.handleBlockChange(n))})("onSwatchHover",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.onSwatchHover.emit(n))}),e.k0s()}if(2&o){const t=s.$implicit,i=e.XpG();e.Y8G("circleSize",i.circleSize)("circleSpacing",i.circleSpacing)("color",t)("focus",i.isActive(t))}}let mr=(()=>{class o{color;circleSize=28;circleSpacing=14;focus=!1;onClick=new e.bkB;onSwatchHover=new e.bkB;focusStyle={};swatchStyle={borderRadius:"50%",background:"transparent",transition:"100ms box-shadow ease 0s"};ngOnChanges(){this.swatchStyle.boxShadow=`inset 0 0 0 ${this.circleSize/2}px ${this.color}`,this.focusStyle.boxShadow=`inset 0 0 0 ${this.circleSize/2}px ${this.color}, 0 0 5px ${this.color}`,this.focus&&(this.focusStyle.boxShadow=`inset 0 0 0 3px ${this.color}, 0 0 5px ${this.color}`)}handleClick({hex:t,$event:i}){this.onClick.emit({hex:t,$event:i})}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=e.VBU({type:o,selectors:[["color-circle-swatch"]],inputs:{color:"color",circleSize:"circleSize",circleSpacing:"circleSpacing",focus:"focus"},outputs:{onClick:"onClick",onSwatchHover:"onSwatchHover"},features:[e.OA$],decls:3,vars:13,consts:[[1,"circle-swatch"],[3,"onClick","onHover","color","focus","focusStyle"],[1,"clear"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"color-swatch",1),e.bIt("onClick",function(l){return n.handleClick(l)})("onHover",function(l){return n.onSwatchHover.emit(l)}),e.k0s(),e.nrm(2,"div",2),e.k0s()),2&i&&(e.xc7("width",n.circleSize,"px")("height",n.circleSize,"px")("margin-right",n.circleSpacing,"px")("margin-bottom",n.circleSpacing,"px"),e.R7$(),e.Aen(n.swatchStyle),e.Y8G("color",n.color)("focus",n.focus)("focusStyle",n.focusStyle))},dependencies:[or],styles:[".circle-swatch[_ngcontent-%COMP%]{transform:scale(1);transition:transform .1s ease}.circle-swatch[_ngcontent-%COMP%]:hover{transform:scale(1.2)}"],changeDetection:0})}return o})(),pr=(()=>{class o extends At{width=252;colors=[Bt_500,Wt_500,Nt_500,Vt_500,Yt_500,zt_500,Lt_500,Qt_500,qt_500,Xt_500,Ot_500,Ut_500,Ht_500,Jt_500,Zt_500,Kt_500,eo_500,to_500];circleSize=28;circleSpacing=14;constructor(){super()}isActive(t){return new we(this.hex).equals(t)}handleBlockChange({hex:t,$event:i}){(function tr(o){return new we(o).isValid})(t)&&this.handleChange({hex:t,source:"hex"},i)}handleValueChange({data:t,$event:i}){this.handleChange(t,i)}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=e.VBU({type:o,selectors:[["color-circle"]],inputs:{width:"width",colors:"colors",circleSize:"circleSize",circleSpacing:"circleSpacing"},features:[e.Jv_([{provide:a.kq,useExisting:(0,e.Rfq)(()=>o),multi:!0},{provide:At,useExisting:(0,e.Rfq)(()=>o)}]),e.Vt3],decls:2,vars:10,consts:[[3,"circleSize","circleSpacing","color","focus","onClick","onSwatchHover",4,"ngFor","ngForOf"],[3,"onClick","onSwatchHover","circleSize","circleSpacing","color","focus"]],template:function(i,n){1&i&&(e.j41(0,"div"),e.DNE(1,ur,1,4,"color-circle-swatch",0),e.k0s()),2&i&&(e.ZvI("circle-picker ",n.className,""),e.xc7("width",n.width,"px")("margin-right",-n.circleSpacing,"px")("margin-bottom",-n.circleSpacing,"px"),e.R7$(),e.Y8G("ngForOf",n.colors))},dependencies:()=>[p.Sq,mr],styles:[".circle-picker[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}"],changeDetection:0})}return o})(),hr=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=e.$C({type:o});static \u0275inj=e.G2t({imports:[p.MD,ir]})}return o})();var fr=d(91401),lt=d(73779),gr=d(67943),oo=d(98049),_r=d(52002),vr=d(65478);const ve=o=>({hidden:o}),ct=o=>({"cursor-not-allowed":o}),br=(o,s,t)=>({"ring ring-inset ring-primary":o,"cursor-not-allowed bg-slate-300 bg-opacity-50":s,"cursor-pointer":t}),Cr=()=>({height:"270px"});function Fr(o,s){if(1&o){const t=e.RV6();e.j41(0,"button",51),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.createProduct())}),e.nrm(1,"mat-icon",52),e.j41(2,"span",53),e.EFF(3,"Guardar"),e.k0s()()}if(2&o){const t=e.XpG();e.Y8G("disabled",t.productForm.invalid||"standard"!==t.productForm.get("type").value&&0===t.variants.length)("ngClass",e.eq3(3,ct,t.productForm.invalid||"standard"!==t.productForm.get("type").value&&0===t.variants.length)),e.R7$(),e.Y8G("svgIcon","mat_solid:save")}}function kr(o,s){if(1&o){const t=e.RV6();e.j41(0,"button",51),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.updateProduct())}),e.nrm(1,"mat-icon",52),e.j41(2,"span",53),e.EFF(3,"Actualizar"),e.k0s()()}if(2&o){const t=e.XpG();e.Y8G("disabled",t.productForm.invalid)("ngClass",e.eq3(3,ct,t.productForm.invalid)),e.R7$(),e.Y8G("svgIcon","mat_solid:refresh")}}function xr(o,s){1&o&&e.nrm(0,"mat-icon",55),2&o&&e.Y8G("svgIcon","mat_solid:check_circle")}function yr(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",54),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.selectType(n))}),e.DNE(1,xr,1,1,"mat-icon",55),e.j41(2,"div",56),e.EFF(3),e.k0s(),e.j41(4,"div",57),e.EFF(5),e.k0s(),e.nrm(6,"div",58),e.k0s()}if(2&o){const t=s.$implicit,i=e.XpG();e.Y8G("ngClass",e.sMw(5,br,i.productForm.get("type").value===t.value,!t.active,t.active))("matTooltip",t.tooltip),e.R7$(),e.vxM(1,i.productForm.get("type").value===t.value?1:-1),e.R7$(2),e.JRh(t.label),e.R7$(2),e.JRh(t.details)}}function Sr(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," El nombre del producto es obligatorio. "),e.k0s())}function Ir(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," El nombre del producto debe contener entre 3 y 255 caracteres. "),e.k0s())}function Rr(o,s){if(1&o&&(e.j41(0,"mat-option",35),e.EFF(1),e.k0s()),2&o){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function Er(o,s){if(1&o&&(e.j41(0,"mat-optgroup",59),e.Z7z(1,Rr,2,2,"mat-option",35,e.fX1),e.k0s()),2&o){const t=e.XpG().$implicit;e.Y8G("label",t.name)("disabled",!t.active),e.R7$(),e.Dyx(t.children)}}function $r(o,s){if(1&o&&(e.j41(0,"mat-option",35),e.EFF(1),e.k0s()),2&o){const t=e.XpG().$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function jr(o,s){if(1&o&&e.DNE(0,Er,3,2,"mat-optgroup",59)(1,$r,2,2,"mat-option",35),2&o){const t=s.$implicit;e.vxM(0,t.children.length>0?0:-1),e.R7$(),e.vxM(1,0===t.children.length?1:-1)}}function Dr(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-icon",60),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.resetCategoryField())}),e.k0s()}}function wr(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Debe seleccionar una categor\xeda. "),e.k0s())}function Mr(o,s){if(1&o&&(e.j41(0,"mat-form-field",31)(1,"mat-label"),e.EFF(2,"SKU"),e.k0s(),e.nrm(3,"input",61),e.k0s()),2&o){const t=e.XpG();e.Y8G("ngClass",e.eq3(2,ve,!t.showAllFieldsCtrl.value&&!t.isFieldRequired("sku")&&!t.productForm.get("sku").value)),e.R7$(3),e.Y8G("formControlName","sku")}}function Gr(o,s){1&o&&(e.j41(0,"mat-form-field",32)(1,"mat-label"),e.EFF(2,"C\xf3digo de barras"),e.k0s(),e.nrm(3,"input",26),e.k0s()),2&o&&(e.R7$(3),e.Y8G("formControlName","upc"))}function Tr(o,s){if(1&o&&(e.j41(0,"mat-form-field",33)(1,"mat-label"),e.EFF(2,"C\xf3digo"),e.k0s(),e.nrm(3,"input",61),e.k0s()),2&o){const t=e.XpG();e.Y8G("ngClass",e.eq3(2,ve,!t.showAllFieldsCtrl.value&&!t.isFieldRequired("bCode")&&!t.productForm.get("bCode").value)),e.R7$(3),e.Y8G("formControlName","bCode")}}function Pr(o,s){if(1&o&&(e.j41(0,"mat-option",35),e.EFF(1),e.k0s()),2&o){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function Ar(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Debe seleccionar la marca. "),e.k0s())}function Br(o,s){if(1&o&&(e.j41(0,"mat-option",35),e.EFF(1),e.k0s()),2&o){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.iso," ")}}function Wr(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Debe seleccionar una Moneda. "),e.k0s())}function Nr(o,s){if(1&o&&(e.j41(0,"mat-option",35),e.EFF(1),e.k0s()),2&o){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function Vr(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," El la unidad de medida es obligatoria. "),e.k0s())}function Yr(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Este campo es obligatorio "),e.k0s())}function zr(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Este campo es obligatorio "),e.k0s())}function Lr(o,s){if(1&o&&(e.j41(0,"mat-form-field",32)(1,"mat-label"),e.EFF(2,"Cantidad M\xedn"),e.k0s(),e.nrm(3,"input",62),e.DNE(4,zr,2,0,"mat-error"),e.k0s()),2&o){const t=e.XpG(2);e.R7$(3),e.Y8G("formControlName","stockMin"),e.R7$(),e.vxM(4,t.productForm.get("stock").hasError("required")?4:-1)}}function Qr(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," El precio del producto es obligatorio "),e.k0s())}function qr(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-option",70),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(3);return e.Njj(r.addDepotIdToMovement(n))}),e.EFF(1),e.k0s()}if(2&o){const t=s.$implicit;e.Y8G("value",t.name),e.R7$(),e.SpI(" ",t.name," ")}}function Xr(o,s){1&o&&(e.j41(0,"mat-error",69),e.EFF(1," El almac\xe9n es obligatorio "),e.k0s())}function Or(o,s){if(1&o&&(e.j41(0,"mat-form-field",66)(1,"mat-label"),e.EFF(2,"Almac\xe9n"),e.k0s(),e.nrm(3,"mat-icon",67)(4,"input",68),e.j41(5,"mat-autocomplete",null,3),e.Z7z(7,qr,2,2,"mat-option",35,e.fX1),e.nI1(9,"async"),e.k0s(),e.DNE(10,Xr,2,0,"mat-error",69),e.k0s()),2&o){const t=e.sdS(6);e.XpG();const i=e.sdS(4),n=e.XpG();e.Y8G("ngClass",e.eq3(9,ve,!n.showAllFieldsCtrl.value&&!n.isFieldRequired("depotId"))),e.R7$(3),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.searchDepotsControl)("required",i.value>0)("matAutocomplete",t)("placeholder","Buscar almacenes"),e.R7$(3),e.Dyx(e.bMT(9,7,n.depotsFiltered)),e.R7$(3),e.vxM(10,n.productForm.get("depotId").hasError("required")?10:-1)}}function Ur(o,s){if(1&o&&(e.j41(0,"mat-form-field",32)(1,"mat-label"),e.EFF(2,"Cantidad"),e.k0s(),e.nrm(3,"input",62,2),e.DNE(5,Yr,2,0,"mat-error"),e.k0s(),e.DNE(6,Lr,5,2,"mat-form-field",32),e.j41(7,"mat-form-field",32)(8,"mat-label"),e.EFF(9,"Costo"),e.k0s(),e.nrm(10,"mat-icon",63)(11,"input",64),e.k0s(),e.j41(12,"mat-form-field",32)(13,"mat-label"),e.EFF(14,"Precio"),e.k0s(),e.nrm(15,"mat-icon",63)(16,"input",65),e.DNE(17,Qr,2,0,"mat-error"),e.k0s(),e.DNE(18,Or,11,11,"mat-form-field",66)),2&o){const t=e.XpG();e.R7$(3),e.Y8G("formControlName","stock"),e.R7$(2),e.vxM(5,t.productForm.get("stock").hasError("required")?5:-1),e.R7$(),e.vxM(6,t.productForm.get("isDigital").value?-1:6),e.R7$(5),e.Y8G("formControlName","cost"),e.R7$(5),e.Y8G("formControlName","price"),e.R7$(),e.vxM(17,t.productForm.get("price").hasError("required")?17:-1),e.R7$(),e.vxM(18,t.editMode||t.productForm.get("isDigital").value?-1:18)}}function Hr(o,s){if(1&o&&(e.j41(0,"mat-form-field",31)(1,"mat-label"),e.EFF(2,"Largo"),e.k0s(),e.nrm(3,"mat-icon",71)(4,"mat-icon",63)(5,"input",64),e.k0s(),e.j41(6,"mat-form-field",31)(7,"mat-label"),e.EFF(8,"Ancho"),e.k0s(),e.nrm(9,"mat-icon",71)(10,"input",64),e.k0s(),e.j41(11,"mat-form-field",31)(12,"mat-label"),e.EFF(13,"Altura"),e.k0s(),e.nrm(14,"mat-icon",71)(15,"input",64),e.k0s(),e.j41(16,"mat-form-field",31)(17,"mat-label"),e.EFF(18,"Peso"),e.k0s(),e.nrm(19,"mat-icon",72)(20,"input",64),e.k0s()),2&o){const t=e.XpG();e.Y8G("ngClass",e.eq3(8,ve,!t.showAllFieldsCtrl.value&&!t.isFieldRequired("length")&&0===t.productForm.get("length").value)),e.R7$(5),e.Y8G("formControlName","length"),e.R7$(),e.Y8G("ngClass",e.eq3(10,ve,!t.showAllFieldsCtrl.value&&!t.isFieldRequired("width")&&0===t.productForm.get("width").value)),e.R7$(4),e.Y8G("formControlName","width"),e.R7$(),e.Y8G("ngClass",e.eq3(12,ve,!t.showAllFieldsCtrl.value&&!t.isFieldRequired("height")&&0===t.productForm.get("height").value)),e.R7$(4),e.Y8G("formControlName","height"),e.R7$(),e.Y8G("ngClass",e.eq3(14,ve,!t.showAllFieldsCtrl.value&&!t.isFieldRequired("weight")&&0===t.productForm.get("weight").value)),e.R7$(4),e.Y8G("formControlName","weight")}}function Jr(o,s){if(1&o&&(e.j41(0,"div",40)(1,"mat-label"),e.EFF(2,"Especificaciones"),e.k0s(),e.nrm(3,"quill-editor",73),e.k0s()),2&o){const t=e.XpG();e.R7$(3),e.Y8G("formControlName","specifications")("styles",e.lJ4(3,Cr))("modules",t.quillModules)}}function Zr(o,s){if(1&o&&(e.j41(0,"mat-option",35),e.EFF(1),e.k0s()),2&o){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function Kr(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad es obligatoria "),e.k0s())}function ea(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad es obligatoria "),e.k0s())}function ta(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," La cantidad debe ser mayor o igual a 1 "),e.k0s())}function oa(o,s){if(1&o&&(e.j41(0,"form",41)(1,"mat-form-field",32)(2,"mat-label"),e.EFF(3,"Subunidad de Medida"),e.k0s(),e.j41(4,"mat-select",74),e.Z7z(5,Zr,2,2,"mat-option",35,e.fX1),e.k0s(),e.DNE(7,Kr,2,0,"mat-error"),e.k0s(),e.j41(8,"mat-form-field",32)(9,"mat-label"),e.EFF(10,"Cantidad"),e.k0s(),e.nrm(11,"input",75),e.DNE(12,ea,2,0,"mat-error")(13,ta,2,0,"mat-error"),e.k0s()()),2&o){const t=e.XpG();e.Y8G("formGroup",t.productForm.get("subunit")),e.R7$(4),e.Y8G("formControlName","uomId")("required",t.haveSubunitsCtrl.value),e.R7$(),e.Dyx(t.uoms),e.R7$(2),e.vxM(7,t.productForm.get("subunit.uomId").hasError("required")?7:-1),e.R7$(4),e.Y8G("formControlName","quantity")("required",t.haveSubunitsCtrl.value)("min",1),e.R7$(),e.vxM(12,t.productForm.get("subunit.quantity").hasError("required")?12:-1),e.R7$(),e.vxM(13,t.productForm.get("subunit.quantity").hasError("min")?13:-1)}}function ia(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Los d\xedas de garant\xeda deben ser mayores igual que 1 o menor igual que 365. "),e.k0s())}function na(o,s){if(1&o&&(e.j41(0,"mat-form-field",76)(1,"mat-label"),e.EFF(2,"Garant\xeda"),e.k0s(),e.j41(3,"span",77),e.EFF(4,"D\xedas"),e.k0s(),e.nrm(5,"mat-icon",78)(6,"input",79),e.DNE(7,ia,2,0,"mat-error"),e.k0s(),e.j41(8,"div",40)(9,"mat-form-field")(10,"mat-label"),e.EFF(11,"Descripci\xf3n de la garant\xeda"),e.k0s(),e.nrm(12,"mat-icon",78)(13,"textarea",80),e.j41(14,"mat-hint",39),e.EFF(15),e.k0s()()()),2&o){const t=e.XpG(),i=e.sdS(77);e.R7$(5),e.Y8G("svgIcon","mat_solid:schedule"),e.R7$(),e.Y8G("formControlName","guaranty")("min",t.haveGuarantyCtrl.value?1:0)("max",365),e.R7$(),e.vxM(7,t.productForm.get("guaranty").hasError("min")||t.productForm.get("guaranty").hasError("max")?7:-1),e.R7$(5),e.Y8G("svgIcon","mat_solid:subject"),e.R7$(),e.Y8G("rows",5)("formControlName","guarantyDescription")("rows",1),e.R7$(2),e.SpI("Total de caracteres ",i.value.length," / 10000 ")}}function sa(o,s){if(1&o){const t=e.RV6();e.j41(0,"div")(1,"input",81,4),e.bIt("change",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.selectFiles(n,"thumbnail"))}),e.k0s(),e.j41(3,"label",82),e.nrm(4,"mat-icon",83),e.k0s()()}2&o&&(e.R7$(),e.Y8G("multiple",!1)("accept","image/png, image/webp, image/jpeg, image/png"),e.R7$(3),e.Y8G("svgIcon","mat_solid:photo_camera"))}function ra(o,s){if(1&o){const t=e.RV6();e.j41(0,"div")(1,"button",84),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.removeImage("thumbnail"))}),e.nrm(2,"mat-icon",83),e.k0s()()}2&o&&(e.R7$(2),e.Y8G("svgIcon","mat_solid:delete"))}function aa(o,s){if(1&o&&e.nrm(0,"img",47),2&o){const t=e.XpG();e.Y8G("ngSrc",t.productForm.get("thumbnail").value)}}function la(o,s){1&o&&(e.j41(0,"mat-slide-toggle",49),e.EFF(1,"\xbfEs digital? "),e.k0s()),2&o&&e.Y8G("color","primary")("formControlName","isDigital")}function ca(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-chip",94),e.bIt("removed",function(){const n=e.eBV(t).$implicit,r=e.XpG(3);return e.Njj(r.removeSize(n))}),e.EFF(1),e.j41(2,"button",95),e.nrm(3,"mat-icon",96),e.k0s()()}if(2&o){const t=s.$implicit;e.R7$(),e.SpI(" ",t," "),e.R7$(),e.BMQ("aria-label","Eliminar "+t),e.R7$(),e.Y8G("svgIcon","mat_solid:cancel")}}function da(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",88)(1,"mat-form-field",91)(2,"mat-label"),e.EFF(3,"Variantes de tallas"),e.k0s(),e.j41(4,"input",92),e.bIt("matChipInputTokenEnd",function(n){e.eBV(t);const r=e.XpG(2);return e.Njj(r.addSize(n))}),e.k0s(),e.j41(5,"mat-chip-list",93,5),e.Z7z(7,ca,4,3,"mat-chip",null,e.fX1),e.k0s()()()}if(2&o){const t=e.sdS(6),i=e.XpG(2);e.R7$(4),e.Y8G("matChipInputFor",t)("matChipInputSeparatorKeyCodes",i.separatorKeysCodes)("matChipInputAddOnBlur",i.addOnBlur),e.R7$(),e.Y8G("formControl",i.sizesCtrl),e.R7$(2),e.Dyx(i.sizes)}}function ua(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-chip",94),e.bIt("removed",function(){const n=e.eBV(t).$implicit,r=e.XpG(3);return e.Njj(r.removeColor(n))}),e.nrm(1,"div",100),e.j41(2,"button",95),e.nrm(3,"mat-icon",96),e.k0s()()}if(2&o){const t=s.$implicit;e.R7$(),e.xc7("background",t),e.R7$(),e.BMQ("aria-label","Eliminar "+t),e.R7$(),e.Y8G("svgIcon","mat_solid:cancel")}}function ma(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",89)(1,"span"),e.EFF(2,"Variantes de colores"),e.k0s(),e.j41(3,"div",97)(4,"color-circle",98),e.bIt("onChange",function(n){e.eBV(t);const r=e.XpG(2);return e.Njj(r.addColor(n))}),e.k0s(),e.j41(5,"mat-chip-grid",99),e.Z7z(6,ua,4,4,"mat-chip",null,e.fX1),e.k0s()()()}if(2&o){const t=e.XpG(2);e.R7$(4),e.Y8G("colors",t.defaultColors),e.R7$(2),e.Dyx(t.colors)}}function pa(o,s){if(1&o&&(e.j41(0,"mat-option",35),e.EFF(1),e.k0s()),2&o){const t=s.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}function ha(o,s){if(1&o&&(e.j41(0,"mat-form-field",32)(1,"mat-label",102),e.EFF(2,"Talla"),e.k0s(),e.j41(3,"mat-select",74)(4,"mat-option",107),e.EFF(5,"Seleccione una talla"),e.k0s(),e.Z7z(6,pa,2,2,"mat-option",35,e.fX1),e.k0s()()),2&o){const t=e.XpG(3);e.R7$(3),e.Y8G("formControlName","size")("required",t.showSize),e.R7$(3),e.Dyx(t.sizes)}}function fa(o,s){if(1&o&&(e.j41(0,"mat-option",35)(1,"div",108),e.nrm(2,"div",109),e.EFF(3),e.k0s()()),2&o){const t=s.$implicit;e.Y8G("value",t),e.R7$(2),e.xc7("background",t),e.R7$(),e.SpI(" ",t," ")}}function ga(o,s){if(1&o&&(e.j41(0,"mat-form-field",32)(1,"mat-label",102),e.EFF(2,"Color"),e.k0s(),e.j41(3,"mat-select",74)(4,"mat-option",107),e.EFF(5,"Seleccione un color"),e.k0s(),e.Z7z(6,fa,4,4,"mat-option",35,e.fX1),e.k0s()()),2&o){const t=e.XpG(3);e.R7$(3),e.Y8G("formControlName","color")("required",t.showColor),e.R7$(3),e.Dyx(t.colors)}}function _a(o,s){if(1&o&&(e.j41(0,"div",112),e.EFF(1),e.k0s()),2&o){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.size," ")}}function va(o,s){if(1&o&&(e.j41(0,"div",113),e.nrm(1,"div",109),e.k0s()),2&o){const t=e.XpG().$implicit;e.R7$(),e.xc7("background",t.color)}}function ba(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",110)(1,"div",111),e.EFF(2),e.k0s(),e.j41(3,"div",112),e.EFF(4),e.k0s(),e.DNE(5,_a,2,1,"div",112)(6,va,2,2,"div",113),e.j41(7,"div",112),e.EFF(8),e.nI1(9,"currency"),e.k0s(),e.j41(10,"div",112),e.EFF(11),e.k0s(),e.j41(12,"button",114),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(4);return e.Njj(r.removeVariant(n))}),e.nrm(13,"mat-icon",52),e.k0s()()}if(2&o){const t=s.$implicit,i=e.XpG(4);e.R7$(2),e.SpI(" ",i.productForm.get("name").value," "),e.R7$(2),e.SpI(" ",t.sku," "),e.R7$(),e.vxM(5,i.showSize?5:-1),e.R7$(),e.vxM(6,i.showColor?6:-1),e.R7$(2),e.SpI(" ",e.i5U(9,7,t.price,"$ ")," "),e.R7$(3),e.SpI(" ",t.stock," "),e.R7$(2),e.Y8G("svgIcon","mat_solid:remove")}}function Ca(o,s){if(1&o&&e.Z7z(0,ba,14,10,"div",110,e.fX1),2&o){const t=e.XpG(3);e.Dyx(t.variants)}}function Fa(o,s){1&o&&(e.j41(0,"div",115),e.EFF(1," \xa1No se ha creado ninguna variante! "),e.k0s())}function ka(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",90)(1,"span",21),e.EFF(2,"Listado de variantes del producto"),e.k0s(),e.j41(3,"form",101)(4,"div"),e.EFF(5),e.k0s(),e.j41(6,"mat-form-field",32)(7,"mat-label",102),e.EFF(8,"SKU"),e.k0s(),e.nrm(9,"input",103),e.k0s(),e.DNE(10,ha,8,2,"mat-form-field",32)(11,ga,8,2,"mat-form-field",32),e.j41(12,"mat-form-field",32)(13,"mat-label",104),e.EFF(14,"Precio"),e.k0s(),e.nrm(15,"input",105),e.k0s(),e.j41(16,"mat-form-field",32)(17,"mat-label",104),e.EFF(18,"Cantidad"),e.k0s(),e.nrm(19,"input",105),e.k0s(),e.j41(20,"button",106),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.addVariant())}),e.nrm(21,"mat-icon",52),e.k0s()(),e.DNE(22,Ca,2,0)(23,Fa,2,0),e.k0s()}if(2&o){const t=e.XpG(2);e.R7$(3),e.Y8G("formGroup",t.variantForm),e.R7$(2),e.SpI(" ",t.productForm.get("name").value," "),e.R7$(4),e.Y8G("formControlName","sku"),e.R7$(),e.vxM(10,t.sizes.length>0?10:-1),e.R7$(),e.vxM(11,t.colors.length>0?11:-1),e.R7$(4),e.Y8G("formControlName","price"),e.R7$(4),e.Y8G("formControlName","stock"),e.R7$(),e.Y8G("disabled",t.variantForm.invalid)("ngClass",e.eq3(11,ct,t.variantForm.invalid)),e.R7$(),e.Y8G("svgIcon","mat_solid:add"),e.R7$(),e.vxM(22,t.variants.length>0?22:23)}}function xa(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",50)(1,"div",85)(2,"span",21),e.EFF(3,"Tipo de Variante"),e.k0s(),e.j41(4,"span"),e.EFF(5,"Selecciona el tipo de variante"),e.k0s(),e.j41(6,"div",86)(7,"mat-checkbox",87),e.bIt("change",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.selectShowSize(n))}),e.EFF(8," Talla "),e.k0s(),e.j41(9,"mat-checkbox",87),e.bIt("change",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.selectShowColor(n))}),e.EFF(10," Color "),e.k0s()(),e.DNE(11,da,9,4,"div",88)(12,ma,8,1,"div",89)(13,ka,24,13,"div",90),e.k0s()()}if(2&o){const t=e.XpG();e.R7$(7),e.Y8G("formControl",t.haveSizeCtrl),e.R7$(2),e.Y8G("formControl",t.haveColorCtrl),e.R7$(2),e.vxM(11,t.showSize?11:-1),e.R7$(),e.vxM(12,t.showColor?12:-1),e.R7$(),e.vxM(13,(t.colors.length>0||t.sizes.length>0)&&(t.showSize||t.showColor)?13:-1)}}let ya=(()=>{class o{constructor(){this.addOnBlur=!0,this.categories=[],this.categoriesFiltered$=(0,E.of)([]),this.colors=[],this.currencies=[],this.editMode=!1,this.flashMessage=null,this.haveColorCtrl=new a.MJ(!1),this.haveGuarantyCtrl=new a.MJ(!1),this.haveSubunitsCtrl=new a.MJ(!1),this.haveSizeCtrl=new a.MJ(!1),this.haveSpecificationsCtrl=new a.MJ(!1),this.images=[],this.isLoading=!1,this.productId=null,this.products$=(0,E.of)([]),this.searchDepotsControl=new a.MJ({value:null,disabled:!0}),this.searchInputControl=new a.MJ,this.selectedDepotName="",this.selectedProduct=new _r.Yt,this.separatorKeysCodes=[$t.Fm,$t.KE],this.showAllFieldsCtrl=new a.MJ(!1),this.showColor=!1,this.showSize=!1,this.sizes=["S","M","L","XL"],this.sizesCtrl=new a.MJ(["M"]),this.tagsEditMode=!1,this.thumbnail="",this.uoms=[],this.uoms$=(0,E.of)(null),this.quillModules={toolbar:[[{font:[]}],[{color:[]}],[{align:[]}],["bold","italic","underline"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{size:["small",!1,"large","huge"]}]]},this.defaultColors=["#e9182d","#f78da7","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#607d8b"],this.variants=[],this.types=[{value:"standard",label:"Est\xe1ndar",details:"Producto que no tiene variantes.",active:!0,tooltip:"Seleccionar"},{value:"generic",label:"Gen\xe9rico",details:"Producto que re\xfane variantes.",active:!1,tooltip:"Pr\xf3ximamente"},{value:"group",label:"Combo",details:"Agrupaci\xf3n de productos.",active:!1,tooltip:"Pr\xf3ximamente"}],this._activatedRoute=(0,e.WQX)(g.nX),this._changeDetectorRef=(0,e.WQX)(e.gRc),this._depotsService=(0,e.WQX)(ue.t),this._formBuilder=(0,e.WQX)(a.ok),this._fuseConfirmationService=(0,e.WQX)(ae.G),this._imagesService=(0,e.WQX)(oo.M),this._productsService=(0,e.WQX)(Ae.g),this._router=(0,e.WQX)(g.Ix),this._snackBar=(0,e.WQX)(O.UG),this._unsubscribeAll=new j.B,this.store=(0,e.WQX)(S.il),this._filter=(t,i)=>{const n=i.toLowerCase();return t?t.filter(r=>r.name.toLowerCase().trim().includes(n)):[]}}ngOnInit(){this.categoriesFiltered$=this.store.select(lt.J),this.store.select(lt.J).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.categories=t,this._changeDetectorRef.markForCheck()}),this.productForm=this._formBuilder.group({id:[""],type:["standard",[a.k0.required]],categoryId:["",[a.k0.required]],name:["",[a.k0.required,a.k0.minLength(3),a.k0.maxLength(255)]],description:["",[a.k0.maxLength(1e4)]],brandId:["",[a.k0.required]],currencyId:["",[a.k0.required]],uomId:["",[a.k0.required]],thumbnail:[""],sku:[null],upc:["",[a.k0.required]],bCode:[null],tags:[[]],cost:[0,[a.k0.min(0),a.k0.max(999999999),a.k0.maxLength(9)]],discount:[0,[a.k0.min(0),a.k0.max(999999999),a.k0.maxLength(9)]],tax:[0,[a.k0.min(0),a.k0.max(999999999),a.k0.maxLength(9)]],price:[0,[a.k0.required,a.k0.min(0),a.k0.max(999999999),a.k0.maxLength(9)]],depotId:[null],stock:[0,[a.k0.required,a.k0.min(0),a.k0.max(999999999),a.k0.maxLength(9)]],stockMin:[0,[a.k0.required,a.k0.min(0),a.k0.max(999999999),a.k0.maxLength(9)]],length:[0,[a.k0.min(0),a.k0.max(999999999),a.k0.maxLength(9)]],width:[0,[a.k0.min(0),a.k0.max(999999999),a.k0.maxLength(9)]],height:[0,[a.k0.min(0),a.k0.max(999999999),a.k0.maxLength(9)]],weight:[0,[a.k0.min(0),a.k0.max(999999999),a.k0.maxLength(9)]],specifications:[""],guaranty:[0,[a.k0.max(365)]],guarantyDescription:["",[a.k0.maxLength(1e4)]],subunit:this._formBuilder.group({uomId:[""],quantity:[0]}),active:[!0],isPerishable:[!1],isService:[!1],isDigital:[!1],isIngredient:[!1]}),this.variantForm=this._formBuilder.group({sku:new a.MJ(""),size:new a.MJ,color:new a.MJ,price:new a.MJ,stock:new a.MJ}),this._activatedRoute.params.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(({productId:t})=>{this.productId=t,"new"!==this.productId&&(this.editMode=!0,this.store.select(Ce.C4).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(i=>{this.productForm.patchValue(i),this.selectedProduct=i,this.variants=i.variants,i.variants&&i.variants.length>0&&(null!==i.variants[0].color&&(this.showColor=!0,this.haveColorCtrl.setValue(!0)),null!==i.variants[0].size&&(this.showSize=!0,this.haveSizeCtrl.setValue(!0))),N.H.IsNullOrEmpty(i.specifications)||this.haveSpecificationsCtrl.setValue(!0),N.H.IsNullOrEmpty(i.subunit)||this.haveSubunitsCtrl.setValue(!0),!N.H.IsNullOrEmpty(i.guaranty)&&i.guaranty>0&&this.haveGuarantyCtrl.setValue(!0),this.productForm.patchValue(i),i.variants&&(this.variants=i.variants.map(n=>{const r={...n};return delete r.__typename,r})),(N.H.IsNullOrEmpty(i.isDigital)||i.stock>0)&&this.productForm.get("stock").disable(),this.images=this.selectedProduct.images,this.productForm.get("type").setValue("standard")})),this._changeDetectorRef.markForCheck()}),this.store.select(fr.y$).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.currencies=t,this._changeDetectorRef.markForCheck()}),this.uoms$=this.store.select(Rt.Ns),this.uoms$.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.uoms=t,this._changeDetectorRef.markForCheck()}),this.store.select(gr.DC).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.brands=t,this._changeDetectorRef.markForCheck()}),this.store.select(Ce.O).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.tags=(0,Ze.cloneDeep)(t),this.filteredTags=(0,Ze.cloneDeep)(t),this._changeDetectorRef.markForCheck()}),this.depots$=this.store.select(q.c_),this.productForm.get("isDigital").valueChanges.pipe((0,u.Q)(this._unsubscribeAll),(0,b.T)(t=>{t?(this.productForm.get("stockMin").setValidators([a.k0.required,a.k0.min(0),a.k0.max(999999999),a.k0.maxLength(9)]),this.productForm.patchValue({sku:null,bCode:null,depotId:null,stock:0,stockMin:0,length:0,width:0,height:0,weight:0,isPerishable:!1},{emitEvent:!1}),this.searchDepotsControl.reset()):this.productForm.get("stockMin").clearValidators(),this.productForm.get("stockMin").updateValueAndValidity()})).subscribe(),this.productForm.get("stock").valueChanges.pipe((0,u.Q)(this._unsubscribeAll),(0,b.T)(t=>{t&&t>0&&!this.productForm.get("isDigital").value?(this.productForm.get("depotId").setValidators([a.k0.required]),this.searchDepotsControl.enable(),this.productForm.get("depotId").reset()):(this.productForm.get("depotId").clearValidators(),this.searchDepotsControl.disable(),this.searchDepotsControl.setValue(null),this.productForm.get("depotId").reset())})).subscribe(),this.depotsFiltered=this.searchDepotsControl.valueChanges.pipe((0,f.B)(100),(0,x.Z)(null),(0,L.Z)(t=>null!==t&&"string"==typeof t&&t!==this.selectedDepotName?this._depotsService.findActiveDepots(t.trim()):this.depots$)),this.categoriesFiltered$=this.productForm.get("categoryId").valueChanges.pipe((0,x.Z)(""),(0,b.T)(t=>this._filterCategories(t||""))),this.haveGuarantyCtrl.valueChanges.pipe((0,u.Q)(this._unsubscribeAll),(0,b.T)(t=>{t?this.productForm.get("guaranty").setValidators([a.k0.required,a.k0.min(1)]):(this.productForm.get("guaranty").setValue(0),this.productForm.get("guarantyDescription").setValue(""),this.productForm.get("guaranty").setValidators([a.k0.min(0)])),this.productForm.get("guaranty").updateValueAndValidity()})).subscribe(),this.haveSubunitsCtrl.valueChanges.pipe((0,u.Q)(this._unsubscribeAll),(0,b.T)(t=>{t?(this.productForm.get("subunit").get("uomId").addValidators([a.k0.required]),this.productForm.get("subunit").get("quantity").addValidators([a.k0.required,a.k0.min(1)])):(this.productForm.get("subunit").get("uomId").clearValidators(),this.productForm.get("subunit").get("quantity").clearValidators(),this.productForm.get("subunit").reset())})).subscribe()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}isFieldRequired(t){const i=this.productForm.get(t);return!!(i.validator&&i.validator({})&&i.validator({}).required)}addDepotIdToMovement(t){this.selectedDepotName=t.name,this.productForm.get("depotId").setValue(t.id)}selectType(t){t.active&&this.productForm.get("type").setValue(t.value)}resetCategoryField(){this.productForm.get("categoryId").reset(),this.categoriesFiltered$=this.store.select(lt.J)}selectShowSize(t){this.showSize=t.checked,this._changeDetectorRef.markForCheck()}addSize(t){const i=(t.value||"").trim();this.sizes.indexOf(i.toUpperCase())>=0?t.chipInput.clear():(i&&this.sizes.push(i),t.chipInput.clear(),this._changeDetectorRef.markForCheck())}removeSize(t){const i=this.sizes.indexOf(t);i>=0&&this.sizes.splice(i,1)}selectShowColor(t){this.showColor=t.checked,this._changeDetectorRef.markForCheck()}addColor({color:t}){this.colors.indexOf(t.hex)>=0||(t.hex&&this.colors.push(t.hex),this._changeDetectorRef.markForCheck())}removeColor(t){const i=this.colors.indexOf(t);i>=0&&this.colors.splice(i,1)}addVariant(){const t=this.variantForm.getRawValue();this.variants.indexOf(t)>=0||(t&&this.variants.push(t),this.variantForm.reset(),this._changeDetectorRef.markForCheck())}removeVariant(t){const i=this.variants.indexOf(t);i>=0&&this.variants.splice(i,1),this._changeDetectorRef.markForCheck()}toggleTagsEditMode(){this.tagsEditMode=!this.tagsEditMode}filterTags(t){const i=t.target.value.toLowerCase();this.filteredTags=this.tags.filter(n=>n.name.toLowerCase().includes(i))}filterTagsInputKeyDown(t){if("Enter"!==t.key)return;if(0===this.filteredTags.length)return this.createTag(t.target.value),void(t.target.value="");const i=this.filteredTags[0];this.selectedProduct.tags.find(r=>r===i.id)?this.removeTagFromProduct(i):this.addTagToProduct(i)}createTag(t){this._productsService.createTag({active:!0,name:t}).subscribe(({data:n})=>{this.addTagToProduct(n.createTag.tag),this._changeDetectorRef.markForCheck()})}updateTagName(t,i){t.name=i.target.value,delete t.__typename,setTimeout(()=>{this._productsService.updateTag(t).pipe((0,f.B)(300)).subscribe(()=>{this._changeDetectorRef.markForCheck()})},1e3)}deleteTag(t){this._productsService.deleteTag(t.id).subscribe(),this._changeDetectorRef.markForCheck()}addTagToProduct(t){const i=(0,Ze.cloneDeep)(this.selectedProduct);i.tags.unshift(t.id),this.productForm.get("tags").patchValue(i.tags),this._changeDetectorRef.markForCheck()}removeTagFromProduct(t){const i=this.productForm.getRawValue();i.tags.splice(i.tags.findIndex(n=>n===t.id),1),this.productForm.get("tags").patchValue(i.tags),this._changeDetectorRef.markForCheck()}toggleProductTag(t,i){i.checked?this.addTagToProduct(t):this.removeTagFromProduct(t)}shouldShowCreateTagButton(t){return!(""===t||this.tags.findIndex(i=>i.name.toLowerCase()===t.toLowerCase())>-1)}createProduct(){const t=this.productForm.getRawValue();delete t.id,delete t.guaranty,"generic"===t.type&&(delete t.stock,delete t.price),t.haveColor=this.showColor,t.haveSize=this.showSize,t.variants=this.variants,this._fuseConfirmationService.open({title:"Crear familia de productos",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._productsService.createProduct(t).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(({data:r})=>{this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:r.createProduct.message,type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/modules/warehouse/products")}),this._changeDetectorRef.markForCheck()})}updateProduct(){const t=this.productForm.getRawValue();t.variants=this.variants,"generic"===t.type&&(delete t.stock,delete t.price),this._fuseConfirmationService.open({title:"Actualizar Producto",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._productsService.updateProduct(t).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(({data:r})=>{this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:r.updateProduct.message,type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/modules/warehouse/products")}),this._changeDetectorRef.markForCheck()})}showFlashMessage(t){this.flashMessage=t,this._changeDetectorRef.markForCheck(),setTimeout(()=>{this.flashMessage=null,this._changeDetectorRef.markForCheck()},3e3)}trackByFn(t,i){return i.id||t}displayFnCategory(t){if(""===t)return;let i="";const n=this.categories.find(r=>r.id===t&&0===r.children.length);if(n)return n.name;for(const r of this.categories){const l=r.children.find(c=>c.id===t);if(l){i=l.name;break}}return i}selectFiles(t,i){if(0===t.target.files.length)return;const n=t.target.files[0];this._imagesService.validMaxMBSize(n,2)&&this._imagesService.validImageType(n)&&this._uploadFile(t,i)}removeImage(t){this._fuseConfirmationService.open({title:"Cuidado",message:"\xbfEst\xe1 seguro que desea eliminar esta imagen?",icon:{show:!0,name:"mat_solid:question_mark",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{if("confirmed"===n){const r=this.productForm.get(t).value;this._imagesService.removeImage(r).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(l=>{switch(t){case"images":this.productForm.get(t).setValue([]);break;case"thumbnail":this.productForm.get(t).setValue(null)}const c=this.productForm.getRawValue();this.editMode&&this._productsService.updateProductImages(c.id,c.thumbnail,c.images).subscribe(h=>{this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:h.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}})},h=>{this.productForm.get(t).setValue(r)}),this._changeDetectorRef.markForCheck()})}})}_checkOnSaleQty(t,i){return n=>{const r=n.get(t),l=n.get(i);if(!r||!l||(l.hasError("invalid")&&(delete l.errors.invalid,l.updateValueAndValidity()),r.value>=l.value))return null;const c={invalid:"La cantidad en venta no debe ser mayor a la disponible"};return l.setErrors(c),c}}_filterCategories(t){return t?this.categories.map(i=>({id:i.id,active:i.active,name:i.name,children:this._filter(i.children,t)})).filter(i=>i.children.length>0||i.name.toLowerCase().trim().includes(t.toLocaleLowerCase())):this.categories}_uploadFile(t,i){this._imagesService.openCropperDialog(t,!1).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{n&&this._imagesService.uploadImage("products",n).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(r=>{this.productForm.get(i).setValue(r.public_id);const l=this.productForm.getRawValue();this.editMode&&this._productsService.updateProductImages(l.id,l.thumbnail,l.images).subscribe(c=>{this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()},c=>{this.productForm.get(i).setValue(null)}),this._changeDetectorRef.markForCheck()})})}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["stock-product-detail"]],standalone:!0,features:[e.aNF],decls:112,vars:58,consts:[["categoriesGroup","matAutocomplete"],["descriptionLength",""],["stock",""],["depotsAutocomplete","matAutocomplete"],["thumbnailFileInput",""],["sizesChipGrid",""],["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","gap-5","p-3","overflow-y-auto","bg-cover","sm:absolute","sm:inset-0","dark:bg-transparent"],[1,"z-20","flex","flex-col","bg-transparent","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:px-5"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/warehouse/products",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","items-center","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-600",3,"disabled","ngClass"],[1,"flex","flex-auto"],[1,"w-full",3,"formGroup","autocomplete"],[1,"grid","grid-cols-1","gap-3","sm:grid-cols-4"],[1,"flex","flex-col","gap-3","p-3","rounded-md","shadow-md","sm:col-span-3","bg-card"],[1,"text-xl","font-semibold"],[1,"grid","w-full","gap-6","sm:grid-cols-3"],[1,"relative","flex","flex-col","items-start","justify-start","p-3","border","rounded-md",3,"ngClass","matTooltip"],[1,"grid","grid-cols-1","gap-3","mt-5","sm:grid-cols-2","lg:grid-cols-4"],[1,"w-full","col-span-2","fuse-mat-dense"],["matInput","","type","text","minlength","3","maxlength","255","required","",3,"formControlName"],["svgIcon","mat_solid:search","matPrefix",""],["type","text","matInput","","required","",3,"formControlName","matAutocomplete"],[3,"displayWith"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer"],[1,"w-full","fuse-mat-dense",3,"ngClass"],[1,"w-full","fuse-mat-dense"],["matTooltip","C\xf3digo",1,"w-full","fuse-mat-dense",3,"ngClass"],[3,"formControlName"],[3,"value"],[3,"formControlName","required","placeholder"],[1,"w-full","col-span-2","sm:col-span-4",3,"ngClass"],["matInput","","matTextareaAutoSize","","maxlength","10000",3,"formControlName","rows"],[1,"text-right"],[1,"flex","flex-col","w-full","gap-5","sm:col-span-4"],["autocomplete","off",1,"flex","flex-col","gap-3","md:flex-row","md:col-span-2",3,"formGroup"],[1,"flex","flex-col","gap-3","p-3","rounded-md","shadow-md","bg-card"],[1,"flex","items-center","justify-center","flex-auto","max-h-40"],[1,"relative","flex","items-center","justify-center","w-32","h-32","overflow-hidden","rounded-md","ring-4","ring-bg-card"],[1,"absolute","inset-0","z-10","bg-opacity-50","bg-slate-300"],[1,"absolute","inset-0","z-20","flex","items-center","justify-center"],["height","800","width","800",1,"object-cover","w-full","h-full",3,"ngSrc"],[3,"color","formControl"],[3,"color","formControlName"],[1,"flex","flex-col","w-full","gap-3","p-3","rounded-md","shadow-md","sm:col-span-4","bg-card"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-600",3,"click","disabled","ngClass"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"relative","flex","flex-col","items-start","justify-start","p-3","border","rounded-md",3,"click","ngClass","matTooltip"],[1,"absolute","top-0","right-0","mt-3","mr-3","icon-size-7","text-primary",3,"svgIcon"],[1,"font-semibold"],[1,"mt-1","whitespace-normal","text-secondary"],[1,"flex-auto"],[3,"label","disabled"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer",3,"click"],["matInput","","type","text","minlength","3","maxlength","255",3,"formControlName"],["matInput","","type","number","min","0","max","999999999","maxlength","50","required","",3,"formControlName"],["matPrefix","","svgIcon","mat_solid:attach_money"],["matInput","","type","number","min","0","max","999999999","maxlength","9",3,"formControlName"],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName"],[1,"w-full","sm:col-span-2","fuse-mat-dense",3,"ngClass"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","required","matAutocomplete","placeholder"],[1,"pb-5"],[3,"click","value"],["matPrefix","","svgIcon","mat_solid:square_foot"],["matPrefix","","svgIcon","mat_solid:scale"],[1,"h-full",3,"formControlName","styles","modules"],[3,"formControlName","required"],["type","number","matInput","",3,"formControlName","required","min"],[1,"w-full"],["matSuffix","",1,"ml-1"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["type","number","matInput","",3,"formControlName","min","max"],["matInput","","matTextareaAutoSize","","maxlength","10000",1,"min-h-28",3,"rows","formControlName"],["id","thumbnail-file-input","type","file",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"change","multiple","accept"],["for","thumbnail-file-input","matRipple","",1,"flex","items-center","justify-center","w-10","h-10","rounded-full","cursor-pointer","hover:bg-hover"],[1,"text-white",3,"svgIcon"],["mat-icon-button","",3,"click"],[1,"flex","flex-col"],[1,"flex","flex-row","flex-wrap","gap-2","mt-2"],[3,"change","formControl"],[1,"flex","flex-row","mt-5"],[1,"flex","flex-col","gap-5","mt-5"],[1,"flex","flex-col","pt-5","mt-5","border-t"],["appearance","fill",1,"flex","flex-col","w-full"],["placeholder","Agregar talla...",1,"w-full",3,"matChipInputTokenEnd","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur"],["aria-label","Agregar talla",3,"formControl"],[3,"removed"],["matChipRemove","",1,"w-5","h-5"],[1,"icon-size-5",3,"svgIcon"],[1,"flex","flex-row","gap-5"],[3,"onChange","colors"],["aria-label","Colores"],[1,"w-5","h-5","rounded-full"],["autocomplete","off",1,"grid","items-center","gap-4","px-6","py-3","border-b","variant-form-grid","md:px-8",3,"formGroup"],[1,"w-full","text-center"],["matInput","","type","text","maxlength","255",3,"formControlName"],[1,"w-full","text-right"],["matInput","","type","number","min","0","max","999999999","required","",3,"formControlName"],["mat-icon-button","","color","primary","matTooltip","Agregar Variante",3,"click","disabled","ngClass"],["value",""],[1,"inline-flex","items-center","gap-5"],[1,"rounded-full","h-7","w-7"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","variants-grid","md:px-8"],[1,"truncate"],[1,"text-center","truncate"],[1,"flex","justify-center","w-full"],["mat-icon-button","","color","warn","matTooltip","Quitar Variante",3,"click"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(i,n){if(1&i&&(e.j41(0,"div",6)(1,"div",7)(2,"div",8)(3,"div")(4,"div",9)(5,"div")(6,"a",10),e.EFF(7,"Inicio"),e.k0s()(),e.j41(8,"div",11),e.nrm(9,"mat-icon",12),e.j41(10,"a",13),e.EFF(11,"Productos"),e.k0s()(),e.j41(12,"div",11),e.nrm(13,"mat-icon",12),e.j41(14,"a",14),e.EFF(15),e.k0s()()()()(),e.j41(16,"div",15),e.DNE(17,Fr,4,5,"button",16)(18,kr,4,5,"button",16),e.k0s()(),e.j41(19,"div",17)(20,"form",18)(21,"div",19)(22,"div",20)(23,"div",21),e.EFF(24," Informaci\xf3n General "),e.k0s(),e.j41(25,"div",22),e.Z7z(26,yr,7,9,"div",23,n.trackByFn,!0),e.k0s(),e.j41(28,"div",24)(29,"mat-form-field",25)(30,"mat-label"),e.EFF(31,"Nombre"),e.k0s(),e.nrm(32,"input",26),e.DNE(33,Sr,2,0,"mat-error")(34,Ir,2,0,"mat-error"),e.k0s(),e.j41(35,"mat-form-field",25)(36,"mat-label"),e.EFF(37,"Categor\xeda"),e.k0s(),e.nrm(38,"mat-icon",27)(39,"input",28),e.j41(40,"mat-autocomplete",29,0),e.Z7z(42,jr,2,2,null,null,e.fX1),e.nI1(44,"async"),e.k0s(),e.DNE(45,Dr,1,0,"mat-icon",30)(46,wr,2,0,"mat-error"),e.k0s(),e.DNE(47,Mr,4,4,"mat-form-field",31)(48,Gr,4,1,"mat-form-field",32)(49,Tr,4,4,"mat-form-field",33),e.j41(50,"mat-form-field",32)(51,"mat-label"),e.EFF(52,"Marca"),e.k0s(),e.j41(53,"mat-select",34),e.Z7z(54,Pr,2,2,"mat-option",35,e.fX1),e.k0s(),e.DNE(56,Ar,2,0,"mat-error"),e.k0s(),e.j41(57,"mat-form-field",32)(58,"mat-label"),e.EFF(59,"Moneda"),e.k0s(),e.j41(60,"mat-select",36),e.Z7z(61,Br,2,2,"mat-option",35,e.fX1),e.k0s(),e.DNE(63,Wr,2,0,"mat-error"),e.k0s(),e.j41(64,"mat-form-field",32)(65,"mat-label"),e.EFF(66,"Unidad de Medida"),e.k0s(),e.j41(67,"mat-select",34),e.Z7z(68,Nr,2,2,"mat-option",35,e.fX1),e.k0s(),e.DNE(70,Vr,2,0,"mat-error"),e.k0s(),e.DNE(71,Ur,19,7)(72,Hr,21,16),e.j41(73,"mat-form-field",37)(74,"mat-label"),e.EFF(75,"Descripci\xf3n"),e.k0s(),e.nrm(76,"textarea",38,1),e.j41(78,"mat-hint",39),e.EFF(79),e.k0s()(),e.DNE(80,Jr,4,4,"div",40)(81,oa,14,9,"form",41)(82,na,16,10),e.k0s()(),e.j41(83,"div",42),e.qex(84),e.j41(85,"div",21),e.EFF(86," Imagen "),e.k0s(),e.j41(87,"div",43)(88,"div",44),e.nrm(89,"div",45),e.j41(90,"div",46),e.DNE(91,sa,5,3,"div")(92,ra,3,1,"div"),e.k0s(),e.DNE(93,aa,1,1,"img",47),e.k0s()(),e.bVm(),e.j41(94,"div",21),e.EFF(95," Opciones "),e.k0s(),e.j41(96,"mat-slide-toggle",48),e.EFF(97,"\xbfMostrar todos los campos? "),e.k0s(),e.j41(98,"mat-slide-toggle",49),e.EFF(99,"\xbfEst\xe1 activo?"),e.k0s(),e.j41(100,"mat-slide-toggle",48),e.EFF(101,"\xbfTiene subunidades? "),e.k0s(),e.j41(102,"mat-slide-toggle",49),e.EFF(103,"\xbfEs un ingrediente?"),e.k0s(),e.j41(104,"mat-slide-toggle",49),e.EFF(105,"\xbfEs perecedero? "),e.k0s(),e.DNE(106,la,2,2,"mat-slide-toggle",49),e.j41(107,"mat-slide-toggle",48),e.EFF(108,"\xbfTiene garant\xeda? "),e.k0s(),e.j41(109,"mat-slide-toggle",48),e.EFF(110,"\xbfTiene especificaciones? "),e.k0s()(),e.DNE(111,xa,14,5,"div",50),e.k0s()()()()),2&i){const r=e.sdS(41),l=e.sdS(77);e.R7$(9),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(2),e.JRh("new"===n.productId?"Crear Producto":n.selectedProduct.name),e.R7$(2),e.vxM(17,n.editMode?-1:17),e.R7$(),e.vxM(18,n.editMode?18:-1),e.R7$(2),e.Y8G("formGroup",n.productForm)("autocomplete","off"),e.R7$(6),e.Dyx(n.types),e.R7$(6),e.Y8G("formControlName","name"),e.R7$(),e.vxM(33,n.productForm.get("name").hasError("required")?33:-1),e.R7$(),e.vxM(34,n.productForm.get("name").hasError("minlength")||n.productForm.get("name").hasError("maxlength")?34:-1),e.R7$(5),e.Y8G("formControlName","categoryId")("matAutocomplete",r),e.R7$(),e.Y8G("displayWith",n.displayFnCategory.bind(n)),e.R7$(2),e.Dyx(e.bMT(44,54,n.categoriesFiltered$)),e.R7$(3),e.vxM(45,n.productForm.get("categoryId").value?45:-1),e.R7$(),e.vxM(46,n.productForm.get("categoryId").hasError("required")?46:-1),e.R7$(),e.vxM(47,"standard"!==n.productForm.get("type").value||n.productForm.get("isDigital").value?-1:47),e.R7$(),e.vxM(48,"standard"===n.productForm.get("type").value?48:-1),e.R7$(),e.vxM(49,n.productForm.get("isDigital").value?-1:49),e.R7$(4),e.Y8G("formControlName","brandId"),e.R7$(),e.Dyx(n.brands),e.R7$(2),e.vxM(56,n.productForm.get("brandId").hasError("required")?56:-1),e.R7$(4),e.Y8G("formControlName","currencyId")("required",!0)("placeholder","Moneda"),e.R7$(),e.Dyx(n.currencies),e.R7$(2),e.vxM(63,n.productForm.get("currencyId").hasError("required")?63:-1),e.R7$(4),e.Y8G("formControlName","uomId"),e.R7$(),e.Dyx(n.uoms),e.R7$(2),e.vxM(70,n.productForm.get("uomId").hasError("required")?70:-1),e.R7$(),e.vxM(71,"generic"!==n.productForm.get("type").value?71:-1),e.R7$(),e.vxM(72,"generic"===n.productForm.get("type").value||n.productForm.get("isDigital").value?-1:72),e.R7$(),e.Y8G("ngClass",e.eq3(56,ve,!n.showAllFieldsCtrl.value&&!n.isFieldRequired("description")&&!n.productForm.get("description").value)),e.R7$(3),e.Y8G("formControlName","description")("rows",1),e.R7$(3),e.SpI("Total de caracteres ",l.value.length," / 10000 "),e.R7$(),e.vxM(80,n.haveSpecificationsCtrl.value?80:-1),e.R7$(),e.vxM(81,n.haveSubunitsCtrl.value?81:-1),e.R7$(),e.vxM(82,n.haveGuarantyCtrl.value?82:-1),e.R7$(9),e.vxM(91,n.productForm.get("thumbnail").value?-1:91),e.R7$(),e.vxM(92,n.productForm.get("thumbnail").value?92:-1),e.R7$(),e.vxM(93,n.productForm.get("thumbnail").value?93:-1),e.R7$(3),e.Y8G("color","primary")("formControl",n.showAllFieldsCtrl),e.R7$(2),e.Y8G("color","primary")("formControlName","active"),e.R7$(2),e.Y8G("color","primary")("formControl",n.haveSubunitsCtrl),e.R7$(2),e.Y8G("color","primary")("formControlName","isIngredient"),e.R7$(2),e.Y8G("color","primary")("formControlName","isPerishable"),e.R7$(2),e.vxM(106,n.editMode?-1:106),e.R7$(),e.Y8G("color","primary")("formControl",n.haveGuarantyCtrl),e.R7$(2),e.Y8G("color","primary")("formControl",n.haveSpecificationsCtrl),e.R7$(2),e.vxM(111,"generic"===n.productForm.get("type").value?111:-1)}},dependencies:[p.Jj,hr,pr,p.oe,D.jL,vr.uv,D.$3,oe.wT,oe.D7,D.pN,v.Hl,v.$z,v.iY,me.g7,me.So,De.YN,De.Jl,De.HW,De.D7,De.Zv,m.RG,m.rl,m.nJ,m.MV,m.TL,m.JW,m.yw,C.m_,C.An,k.fS,k.fg,I.Ou,We.Wk,Z.Ve,Z.VO,de.mV,de.sG,F.NQ,J.aP,M.uc,M.oV,p.YU,p.kt,As,Ps,a.X1,a.qT,a.me,a.Q0,a.BC,a.cb,a.YS,a.xh,a.tU,a.VZ,a.zX,a.l_,a.j4,a.JD,g.Wk],encapsulation:2,changeDetection:0})}return o})(),Sa=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["warehouse-products"]],standalone:!0,features:[e.aNF],decls:1,vars:0,template:function(i,n){1&i&&e.nrm(0,"router-outlet")},dependencies:[g.n3],encapsulation:2})}return o})();var Ia=d(87122),Ra=d(68824);const Ea=["stockFile"],$a=["stockTemplateFile"],ja=()=>[p.QX,v.$z,C.An,Q.LG,de.sG,M.oV,p.kt,g.Wk],Da=()=>({wheelPropagation:!1}),wa=o=>({"cursor-progress":o}),Ma=(o,s)=>({"pointer-events-none":o,hidden:s}),Ga=()=>[25,50,100],Ta=o=>["/modules/warehouse/products/product",o];function Pa(o,s){if(1&o&&e.nrm(0,"img",44),2&o){const t=e.XpG(2).$implicit;e.Y8G("alt","Product thumbnail image")("ngSrc",t.thumbnail)}}function Aa(o,s){1&o&&(e.j41(0,"div",45),e.EFF(1," SIN IMAGEN "),e.k0s())}function Ba(o,s){1&o&&(e.j41(0,"div",53),e.nrm(1,"div",65),e.k0s())}function Wa(o,s){1&o&&(e.j41(0,"div",54),e.nrm(1,"div",66),e.k0s())}function Na(o,s){1&o&&(e.j41(0,"div",55),e.nrm(1,"div",67),e.k0s())}function Va(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-slide-toggle",68),e.bIt("change",function(n){e.eBV(t);const r=e.XpG(2),l=r.$implicit,c=r.$index,h=e.XpG(4);return e.Njj(h.updateProductStatus(n,l,c))}),e.k0s()}if(2&o){const t=e.XpG(2).$implicit;e.Y8G("checked",t.active)("color","primary")}}function Ya(o,s){1&o&&e.nrm(0,"mat-spinner",60),2&o&&e.Y8G("diameter",20)("color","primary")}function za(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",40)(1,"div",34)(2,"div",41)(3,"input",42),e.bIt("change",function(n){e.eBV(t);const r=e.XpG().$implicit,l=e.XpG(4);return e.Njj(l.selectFiles(n,r))}),e.k0s(),e.nrm(4,"label",43),e.DNE(5,Pa,1,2,"img",44)(6,Aa,2,0,"div",45),e.k0s()(),e.j41(7,"div",46),e.EFF(8),e.k0s(),e.j41(9,"div",47),e.EFF(10),e.k0s(),e.j41(11,"div",48)(12,"span",49),e.EFF(13),e.nI1(14,"number"),e.k0s(),e.j41(15,"span",50),e.EFF(16),e.k0s()(),e.j41(17,"div",51)(18,"div",52),e.EFF(19),e.nI1(20,"number"),e.k0s(),e.DNE(21,Ba,2,0,"div",53)(22,Wa,2,0,"div",54)(23,Na,2,0,"div",55),e.j41(24,"span",56),e.EFF(25),e.k0s()(),e.j41(26,"div",57),e.EFF(27),e.k0s(),e.j41(28,"div",58),e.DNE(29,Va,1,2,"mat-slide-toggle",59)(30,Ya,1,2,"mat-spinner",60),e.k0s(),e.j41(31,"div",61)(32,"button",62),e.nrm(33,"mat-icon",63),e.k0s(),e.j41(34,"button",64),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,r=e.XpG(4);return e.Njj(r.deleteProduct(n.id))}),e.nrm(35,"mat-icon",63),e.k0s()()()}if(2&o){const t=e.XpG(),i=t.$implicit,n=t.$index,r=e.XpG(4);e.R7$(3),e.Y8G("id",i.id)("multiple",!1)("accept","image/png, image/webp, image/jpeg, image/png"),e.R7$(),e.Y8G("for",i.id),e.R7$(),e.vxM(5,i.thumbnail?5:-1),e.R7$(),e.vxM(6,i.thumbnail?-1:6),e.R7$(),e.Y8G("matTooltip",i.upc),e.R7$(),e.SpI(" ",i.upc," "),e.R7$(),e.Y8G("matTooltip",i.name),e.R7$(),e.SpI(" ",i.name," "),e.R7$(3),e.JRh(e.i5U(14,23,i.price,"1.2-2")),e.R7$(3),e.JRh(i.currency.iso),e.R7$(3),e.JRh(e.i5U(20,26,i.stock,"1.2-2")),e.R7$(2),e.vxM(21,i.stock<20?21:-1),e.R7$(),e.vxM(22,i.stock>=20&&i.stock<30?22:-1),e.R7$(),e.vxM(23,i.stock>=30?23:-1),e.R7$(2),e.JRh(i.uom.abbr),e.R7$(2),e.SpI(" ",i.salesQuantity," "),e.R7$(2),e.vxM(29,r.isLoading&&r.selectedSlide===n?-1:29),e.R7$(),e.vxM(30,r.isLoading&&r.selectedSlide===n?30:-1),e.R7$(2),e.Y8G("routerLink",e.eq3(29,Ta,i.id)),e.R7$(),e.Y8G("svgIcon","mat_solid:edit"),e.R7$(2),e.Y8G("svgIcon","mat_solid:delete")}}function La(o,s){1&o&&(e.j41(0,"div",69)(1,"div",70),e.nrm(2,"mat-progress-spinner",71),e.k0s()()),2&o&&(e.R7$(2),e.Y8G("strokeWidth",2)("diameter",50)("mode","indeterminate"))}function Qa(o,s){1&o&&(e.DNE(0,za,36,31)(1,La,3,3),e.nv$(2,0,ja,null,1),e.qhs(0,-1))}function qa(o,s){1&o&&e.Z7z(0,Qa,4,0,null,null,e.BUC().trackByFn,!0),2&o&&e.Dyx(s)}function Xa(o,s){if(1&o&&(e.j41(0,"div",32)(1,"div",33),e.nrm(2,"div"),e.j41(3,"div",34),e.EFF(4," UPC "),e.k0s(),e.j41(5,"div",35),e.EFF(6," Nombre "),e.k0s(),e.j41(7,"div",36),e.EFF(8," Precio "),e.k0s(),e.j41(9,"div",36),e.EFF(10," Stock "),e.k0s(),e.j41(11,"div",37),e.EFF(12," S.Vendido "),e.k0s(),e.j41(13,"div",36),e.EFF(14," Activo "),e.k0s(),e.j41(15,"div",38),e.EFF(16,"Acciones"),e.k0s()(),e.DNE(17,qa,2,0),e.nI1(18,"async"),e.nrm(19,"mat-paginator",39),e.k0s()),2&o){let t;const i=e.XpG(2);e.R7$(5),e.Y8G("mat-sort-header","name"),e.R7$(2),e.Y8G("mat-sort-header","price"),e.R7$(2),e.Y8G("mat-sort-header","stock"),e.R7$(2),e.Y8G("mat-sort-header","salesQuantity"),e.R7$(2),e.Y8G("mat-sort-header","active"),e.R7$(4),e.vxM(17,(t=e.bMT(18,12,i.products$))?17:-1,t),e.R7$(2),e.Y8G("ngClass",e.l_i(14,Ma,i.isLoading,i.pagination.length<10&&i.pagination.page<1))("length",i.pagination.length)("pageIndex",i.pagination.page)("pageSize",i.pagination.size)("pageSizeOptions",e.lJ4(17,Ga))("showFirstLastButtons",!0)}}function Oa(o,s){1&o&&(e.j41(0,"div",72),e.EFF(1,"\xa1No se ha creado ning\xfan producto!"),e.k0s())}function Ua(o,s){1&o&&e.DNE(0,Xa,20,18,"div",32)(1,Oa,2,0),2&o&&e.vxM(0,s.length>0?0:1)}B.vfs=A.b.vfs;let Ha=(()=>{class o{constructor(){this.flashMessage=null,this.isLoading=!1,this.merchant=null,this.products=[],this.products$=(0,E.of)([]),this.searchInputControl=new a.MJ(null),this.selectedProduct=null,this.selectedSlide=null,this.uoms$=(0,E.of)(null),this.user=null,this._changeDetectorRef=(0,e.WQX)(e.gRc),this._fileSaverService=(0,e.WQX)(Ra.f),this._fuseConfirmationService=(0,e.WQX)(ae.G),this._productsService=(0,e.WQX)(Ae.g),this._snackBar=(0,e.WQX)(O.UG),this._unsubscribeAll=new j.B,this.store=(0,e.WQX)(S.il),this._router=(0,e.WQX)(g.Ix),this._imagesService=(0,e.WQX)(oo.M)}ngOnInit(){this.store.select(re.SW).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(fe.Xb).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(se.Dz).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.products$=this.store.select(Ce.VW),this.products$.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.products=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,u.Q)(this._unsubscribeAll),(0,f.B)(300),(0,x.Z)(null),(0,_.n)(t=>null!==t?(this.isLoading=!0,this._productsService.getProducts(0,25,"name","asc",t)):(0,E.of)()),(0,b.T)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this.waitForPaginatorLoad().then(t=>{this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,V.h)(this._sort.sortChange,this._paginator.page).pipe((0,_.n)(()=>(this.isLoading=!0,this._productsService.getProducts(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,b.T)(()=>{this.isLoading=!1})).subscribe())})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this.store.dispatch((0,It.aR)())}updateProductStatus(t,i,n){this.isLoading=!0,this.selectedSlide=n,this._productsService.updateProductStatus({id:i.id,active:t.checked}).pipe((0,u.Q)(this._unsubscribeAll),(0,U.j)(()=>{this.isLoading=!1,this.selectedSlide=-1,this._changeDetectorRef.markForCheck()})).subscribe(({data:r})=>{r&&this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:r.updateProductStatus,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}})})}exportProductsStockTemplate(){this._fileSaverService.exportAsExcelFile([{upc:"",sku:"",bCode:"",name:"",description:"",uom:"U",quantity:1,cost:0,price:0,brand:""}],"Plantilla para stock de productos",[["UPC","SKU","C\xf3digo","Nombre","Descripci\xf3n","Unidad de Medida","Cantidad","Costo","Precio","Marca"]])}generateReport(t){switch(t){case t="Productos Activos":this._productsService.getProductsActive().subscribe(({data:i})=>{this.generatePDF("open",t,i.productsActive)});break;case t="Productos Inactivos":this._productsService.getProductsInactive().subscribe(({data:i})=>{this.generatePDF("open",t,i.productsInactive)});break;case t="Productos Agotados":this._productsService.getProductsExhausted().subscribe(({data:i})=>{this.generatePDF("open",t,i.productsExhausted.map(n=>({...n,stock:n.quantity})))});break;case t="Productos en Stock":this._productsService.getProductsAvailable().subscribe(({data:i})=>{this.generatePDF("open",t,i.productsAvailable.map(n=>({...n,stock:n.quantity})))})}}generatePDF(t="open",i,n){const r={header:{text:i.toLocaleUpperCase(),style:"header",marginTop:5},content:[{lineHeight:1.3,table:{headerRows:1,widths:[80,"*",60,40,50,50,50,60],body:[[{text:"UPC",style:"table_header"},{text:"Producto",style:"table_header"},{text:"Marca",style:"table_header"},{text:"Unidad",style:"table_header"},{text:"Costo",style:"table_header"},{text:"P.Venta",style:"table_header"},{text:"Stock",style:"table_header"},{text:"S.Vendido",style:"table_header"}],...n.map(l=>[{style:"table_body",text:l.upc,alignment:"center"},{style:"table_body",text:l.name},{style:"table_body",text:"string"==typeof l.brand?l.brand:l.brand.name,alignment:"center"},{style:"table_body",text:"string"==typeof l.uom?l.uom:l.uom.abbr,alignment:"center"},{style:"table_body",text:l.cost.toFixed(2),alignment:"center"},{style:"table_body",text:l.price.toFixed(2),alignment:"center"},{style:"table_body",text:l.stock,alignment:"center"},{style:"table_body",text:l.salesQuantity,alignment:"center"}])]},layout:"lightHorizontalLines"}],footer:(l,c)=>({table:{widths:["*","*"],body:[[{text:`Reporte generador por: ${this.user.fullname} | Esta informaci\xf3n es exclusiva de ${this.merchant.name}`,bold:!0,fontSize:8},{text:`P\xe1gina ${l.toString()}/${c} - Fecha de impresi\xf3n ${G().format("DD/MM/yyyy HH:mm:ss")}`,bold:!0,fontSize:8,alignment:"right"}]]},margin:[30,0,30,0],layout:"noBorders",italics:!0}),defaultStyle:{fontSize:12},styles:{header:{fontSize:18,bold:!0,marginBottom:5,alignment:"center",fontFeatures:["c2sc","smcp"]},table_header:{fontSize:11,bold:!0,alignment:"center",fontFeatures:["c2sc","smcp"]},table_body:{fontSize:10}},pageOrientation:"landscape",pageSize:"LETTER",watermark:{text:this.merchant.name,color:"#fff",opacity:.07,angle:-35,bold:!0,italics:!1},info:{title:i,author:`${this.user.fullname}`,creationDate:G().toDate(),modDate:G().toDate(),producer:this.merchant.name}};switch(t){case t="download":B.createPdf(r).download();break;case t="open":B.createPdf(r).open();break;case t="print":B.createPdf(r).print()}}deleteProduct(t){this._fuseConfirmationService.open({title:"Eliminar Producto",message:"\xbfEsta seguro que desea eliminar el producto?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._productsService.removeProduct(t).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(({data:r})=>{this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:r.removeProduct.message,type:"success",svgIcon:"mat_solid:done"}})}),this._changeDetectorRef.markForCheck()})}trackByFn(t,i){return i.id||t}importStockFormTemplateFile(t){const i=t.target;this.isExcelFile=!!i.files[0].name.match(/(.xls|.xlsx)/),i.files.length>1&&(this.stockTemplateFile.nativeElement.value=""),this.isExcelFile?(this._productsService.importStockFormTemplateFile(t),this._router.navigateByUrl("/modules/warehouse/products/from-template")):this.stockTemplateFile.nativeElement.value=""}selectFiles(t,i){if(0===t.target.files.length)return;const n=t.target.files[0];this._imagesService.validMaxMBSize(n,2)&&this._imagesService.validImageType(n)&&this._uploadFile(t,i)}_uploadFile(t,i){this._imagesService.openCropperDialog(t,!1).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{n&&this._imagesService.uploadImage("products",n).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(r=>{this._productsService.updateProductImages(i.id,r.public_id,i.images).subscribe(l=>{this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:l.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()})})})}waitForPaginatorLoad(){var t=this;return(0,Ee.A)(function*(){for(;!t._paginator||void 0===t._paginator;)yield new Promise(i=>{setTimeout(i,200)});return t._paginator})()}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["warehouse-products-list"]],viewQuery:function(i,n){if(1&i&&(e.GBs(I.iy,5),e.GBs(F.B4,5),e.GBs(Ea,5),e.GBs($a,5)),2&i){let r;e.mGM(r=e.lsd())&&(n._paginator=r.first),e.mGM(r=e.lsd())&&(n._sort=r.first),e.mGM(r=e.lsd())&&(n.stockFile=r.first),e.mGM(r=e.lsd())&&(n.stockTemplateFile=r.first)}},standalone:!0,features:[e.aNF],decls:64,vars:27,consts:[["productMenu","matMenu"],["stockTemplateFile",""],["itemMenu","matMenu"],["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent",3,"fuseScrollbarOptions","ngClass"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","flex-wrap","items-center","gap-2","mt-6","md:fixed","right-8","shrink-0","lg:mt-0","lg:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,""],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"matMenuTriggerFor"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],["mat-menu-item","","matRipple","","routerLink","/modules/warehouse/products/product/new"],["mat-menu-item","","matRipple",""],["for","stock-template-file-input",1,"flex","items-center"],["id","stock-template-file-input","type","file","accept",".xls, .xlsx",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"change"],["mat-menu-item","","matRipple","",3,"click"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-yellow-500","to-yellow-600",3,"matMenuTriggerFor"],[1,"sm:hidden",3,"svgIcon"],[3,"xPosition"],["mat-menu-item","",3,"click"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-col","justify-between","flex-auto"],[1,"relative","grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","products-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"flex","items-center"],[1,"flex","items-center","justify-start",3,"mat-sort-header"],[1,"flex","items-center","justify-center",3,"mat-sort-header"],["matTooltip","Unidades Vendidas",1,"flex","items-center","justify-center",3,"mat-sort-header"],[1,"pr-4","text-right"],[1,"z-10","border-b","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-gray-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","products-grid","md:px-8"],[1,"relative","flex","items-center","justify-center","w-12","h-12","mr-6","overflow-hidden","border","rounded","flex-0"],["type","file",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"change","id","multiple","accept"],[1,"absolute","w-full","h-full","cursor-pointer",3,"for"],["for","thumbnail-file-input","width","46","height","46",1,"w-full","m-0.5","rounded",3,"alt","ngSrc"],[1,"flex","items-center","justify-center","w-full","h-full","text-xs","font-semibold","leading-none","text-center","uppercase"],[1,"block","truncate",3,"matTooltip"],[1,"truncate",3,"matTooltip"],[1,"flex","flex-row","justify-end","space-x-1"],[1,"font-mono"],[1,"text-xs","text-secondary"],[1,"flex","items-center","justify-end"],[1,"min-w-4"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-red-200","rounded"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-orange-200","rounded"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-green-100","rounded"],[1,"self-start","ml-1","text-xs","text-secondary"],[1,"block","text-center"],[1,"flex","justify-center","mr-3","text-center"],[3,"checked","color"],[3,"diameter","color"],[1,"flex","flex-row","justify-end","gap-2"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"flex","w-full","bg-red-600","h-1/3"],[1,"flex","w-full","bg-orange-400","h-2/4"],[1,"flex","w-full","h-full","bg-green-400"],[3,"change","checked","color"],[1,"grid","col-span-8","py-3"],[1,"flex","items-center","justify-center","w-full"],[3,"strokeWidth","diameter","mode"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(i,n){if(1&i){const r=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"div")(5,"a",7),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",8),e.nrm(8,"mat-icon",9),e.j41(9,"a",10),e.EFF(10,"Almac\xe9n"),e.k0s()(),e.j41(11,"div",8),e.nrm(12,"mat-icon",9),e.j41(13,"a",10),e.EFF(14,"Productos"),e.k0s()()(),e.j41(15,"div",11)(16,"h2",12),e.EFF(17," Productos "),e.k0s()()(),e.j41(18,"div",13)(19,"mat-form-field",14),e.nrm(20,"mat-icon",15)(21,"input",16),e.k0s(),e.j41(22,"div",17)(23,"button",18),e.nrm(24,"mat-icon",19),e.j41(25,"span",20),e.EFF(26,"Agregar"),e.k0s()(),e.j41(27,"mat-menu",null,0)(29,"button",21),e.nrm(30,"mat-icon",19),e.EFF(31," Crear Producto "),e.k0s(),e.j41(32,"button",22)(33,"label",23),e.nrm(34,"mat-icon",19),e.EFF(35," Importar Plantilla de Existencia "),e.k0s(),e.j41(36,"input",24,1),e.bIt("change",function(c){return e.eBV(r),e.Njj(n.importStockFormTemplateFile(c))}),e.k0s()(),e.j41(38,"button",25),e.bIt("click",function(){return e.eBV(r),e.Njj(n.exportProductsStockTemplate())}),e.nrm(39,"mat-icon",19),e.EFF(40," Descargar Plantilla de Existencia "),e.k0s()()(),e.j41(41,"div",17)(42,"button",26),e.nrm(43,"mat-icon",27),e.j41(44,"span",20),e.EFF(45,"Reportes"),e.k0s()(),e.j41(46,"mat-menu",28,2)(48,"button",29),e.bIt("click",function(){return e.eBV(r),e.Njj(n.generateReport("Productos Activos"))}),e.nrm(49,"mat-icon",19),e.EFF(50," Productos Activos "),e.k0s(),e.j41(51,"button",29),e.bIt("click",function(){return e.eBV(r),e.Njj(n.generateReport("Productos Inactivos"))}),e.nrm(52,"mat-icon",19),e.EFF(53," Productos Inactivos "),e.k0s(),e.j41(54,"button",29),e.bIt("click",function(){return e.eBV(r),e.Njj(n.generateReport("Productos Agotados"))}),e.nrm(55,"mat-icon",19),e.EFF(56," Productos Agotados "),e.k0s(),e.j41(57,"button",29),e.bIt("click",function(){return e.eBV(r),e.Njj(n.generateReport("Productos en Stock"))}),e.nrm(58,"mat-icon",19),e.EFF(59," Productos en Stock "),e.k0s()()()()(),e.j41(60,"div",30)(61,"div",31),e.DNE(62,Ua,2,1),e.nI1(63,"async"),e.k0s()()()}if(2&i){let r;const l=e.sdS(28),c=e.sdS(47);e.Y8G("fuseScrollbarOptions",e.lJ4(24,Da))("ngClass",e.eq3(25,wa,n.isLoading)),e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),e.R7$(2),e.Y8G("matMenuTriggerFor",l),e.R7$(),e.Y8G("svgIcon","mat_solid:expand_more"),e.R7$(6),e.Y8G("svgIcon","mat_solid:add"),e.R7$(4),e.Y8G("svgIcon","mat_solid:upload"),e.R7$(5),e.Y8G("svgIcon","mat_solid:edit_document"),e.R7$(3),e.Y8G("matMenuTriggerFor",c),e.R7$(),e.Y8G("svgIcon","mat_solid:description"),e.R7$(3),e.Y8G("xPosition","before"),e.R7$(3),e.Y8G("svgIcon","mat_solid:description"),e.R7$(3),e.Y8G("svgIcon","mat_solid:description"),e.R7$(3),e.Y8G("svgIcon","mat_solid:description"),e.R7$(3),e.Y8G("svgIcon","mat_solid:description"),e.R7$(4),e.vxM(62,(r=e.bMT(63,22,n.products$))?62:-1,r)}},dependencies:[p.Jj,H.p,v.Hl,v.$z,m.RG,m.rl,m.JW,C.m_,C.An,k.fS,k.fg,Y.Cn,Y.kk,Y.fb,Y.Cp,I.Ou,I.iy,Q.D6,Q.LG,de.mV,F.NQ,F.B4,F.aE,M.uc,M.oV,p.YU,a.X1,a.me,a.BC,a.l_,g.Wk],encapsulation:2,data:{animation:Ia.X},changeDetection:0})}return o})();var Ja=d(35526),Za=d(77005),Ka=d(33446);const io=o=>o.receptions,dt=((0,S.Mz)(io,o=>o.reception),(0,S.Mz)(io,o=>o.receptions));var Se=d(63424);const el=w.J1`
   query FindAllReceptions($page: Int, $size: Int, $sort: String, $order: Order, $search: String) {
        findAllReceptions(page: $page, size: $size, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length,
                size,
                page,
                lastPage,
                startIndex,
                endIndex
            }

            receptions {
                id
                no
                createdAt
                purchaseId
                userId
                obs
                obsSpare
                obsMissing
                obsDamaged

                user {
                    id
                    name
                    fullname
                }

                depotId
                depot {
                    id
                    name
                }


                products {
                    productId
                    quantity
                    quantitySpare
                    quantityMissing
                    quantityDamaged

                    product {
                        id,
                        name
                        uomId
                        uom {
                           id
                           abbr
                        }
                    }
                }

                purchase {
                    id
                    code
                    products {
                        productId
                        cud
                        cui
                        quantity
                    }
                    voucherNo
                    total
                }
            }
        }
    }
`,tl=w.J1`
    query FindReceptionById($findReceptionById: String!) {
        findReceptionById(id: $findReceptionById) {
            ok
            message

            reception {
                id
                concept
                warehouse
                no
                nov
                noCtrl
                date
                obs
                entity
                invoice
                currency
                tax
                discount
                services
                rate
                products {
                    upc
                    name
                    price
                    quantity
                    uom
                }
            }
        }
    }
`,ol=w.J1`
    mutation CreateReception($createReceptionInput: CreateReceptionInput!) {
        createReception(createReceptionInput: $createReceptionInput) {
            ok
            message

            reception {
                id
	            no

	            userId
	            purchaseId
	            inspectorId

	            products {
                    productId
	                quantity
	                quantitySpare
	                quantityMissing
	                quantityDamaged
                }

                createdAt

	            obs

	            haveSpare
	            obsSpare

	            haveMissing
	            obsMissing

	            haveDamaged
	            obsDamaged

	            courier {
                    name
	                idNumber
                    company
                    lastname1
                    lastname2
                    licensePlate
                    cargoDocument
                }
            }
        }
    }
`,il=w.J1`
    mutation UpdateReception($updateReceptionInput: UpdateReceptionInput!) {
        updatedReception(updateReceptionInput: $updateReceptionInput) {
            ok
            message

            reception {
                id
                concept
                warehouse
                no
                nov
                noCtrl
                date
                obs
                entity
                invoice
                currency
                tax
                discount
                services
                rate
                products {
                    upc
                    name
                    price
                    quantity
                    uom
                }
            }
        }
    }
`,nl=w.J1`
    mutation RemoveReception($removeReceptionId: String!) {
        removeReception(id: $removeReceptionId) {
            ok
            message
        }
    }
`;let ut=(()=>{class o{constructor(t,i,n){this.apolloProvider=t,this._snackBar=i,this.store=n,this._apollo=this.apolloProvider.use("BALANC")}createReception(t){return this._apollo.mutate({mutation:ol,variables:{createReceptionInput:t},errorPolicy:"all"}).pipe((0,b.T)(({data:i})=>i?i.createReception:null),(0,P.M)(i=>{i&&(this.store.dispatch((0,Se._9)({reception:i.reception})),this.store.dispatch((0,Se.cb)({reception:i.reception})))}))}getReceptions(t=0,i=50,n="no",r="desc",l=""){return this._apollo.query({query:el,errorPolicy:"all",variables:{page:t,size:i,sort:n,order:r,search:l}}).pipe((0,P.M)(({data:c})=>{c&&(this.store.dispatch((0,Se.PV)({receptions:c.findAllReceptions.receptions})),this.store.dispatch((0,Te.Bp)({pagination:c.findAllReceptions.pagination})))}))}getReceptionById(t){return this._apollo.query({query:tl,variables:{findReceptionByIdId:t},errorPolicy:"all"}).pipe((0,P.M)(({data:i})=>{i&&this.store.dispatch((0,Se.cb)({reception:i.findReceptionById.reception}))}))}updateReception(t){return this.store.select(dt).pipe((0,be.s)(1),(0,_.n)(i=>this._apollo.mutate({mutation:il,variables:{updateReceptionInput:t},errorPolicy:"all"}).pipe((0,P.M)(({data:n})=>{this.store.dispatch((0,Se.JW)({reception:n.updateReception.reception}))}))))}removeReception(t){return this.store.select(dt).pipe((0,be.s)(1),(0,_.n)(i=>this._apollo.mutate({mutation:nl,variables:{removeReceptionId:t},errorPolicy:"all"}).pipe((0,P.M)(({errors:n})=>{if(n){let c="";n.forEach(h=>c+=`\n ${h.message}.`),this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:c,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const r=(0,Ka.A)(i),l=i.findIndex(c=>c.id===t);r.splice(l,1),this.store.dispatch((0,Se.PV)({receptions:r}))}))))}static#e=this.\u0275fac=function(i){return new(i||o)(e.KVO(w.Ic),e.KVO(O.UG),e.KVO(S.il))};static#t=this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var sl=d(32488);const no=(o,s)=>s.id,rl=o=>({"grid stepper-reception-general-data-grid grid-cols-3":o}),mt=()=>({suppressScrollX:!0}),al=(o,s)=>({"pointer-events-none":o,hidden:s}),ll=()=>[10,25,50,100],pt=o=>({"stepper-reception-form-grid":o}),cl=(o,s)=>({"w-52":o,"w-64":s});function dl(o,s){if(1&o){const t=e.RV6();e.j41(0,"div")(1,"mat-checkbox",89),e.bIt("change",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.selectPurchase(n))}),e.EFF(2),e.k0s()()}if(2&o){let t;const i=s.$implicit,n=e.XpG(2);e.R7$(),e.Y8G("checked",(null==(t=n.purchaseFormGroup.get("purchase").value)?null:t.id)===i.id),e.R7$(),e.SpI(" ",i.code," ")}}function ul(o,s){if(1&o&&e.Z7z(0,dl,3,2,"div",null,e.fX1),2&o){const t=e.XpG();e.Dyx(t.purchases)}}function ml(o,s){1&o&&(e.j41(0,"div",90),e.EFF(1," No se encontraron nuevas facturas de compras "),e.k0s())}function pl(o,s){if(1&o&&(e.j41(0,"div")(1,"mat-radio-button",91),e.EFF(2),e.k0s()()),2&o){const t=s.$implicit;e.XpG(2);const i=e.sdS(22);e.R7$(),e.Y8G("value",t)("ngClass",e.l_i(3,cl,i.offsetWidth>1500,i.offsetWidth<1500)),e.R7$(),e.SpI(" ",t.name," ")}}function hl(o,s){if(1&o&&(e.j41(0,"mat-radio-group",32),e.Z7z(1,pl,3,6,"div",null,e.fX1),e.k0s()),2&o){const t=e.XpG();e.R7$(),e.Dyx(t.depots)}}function fl(o,s){1&o&&(e.j41(0,"div",90),e.EFF(1," No se encontraron almacenes "),e.k0s())}function gl(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1,"El nombre del transportista es obligatorio "),e.k0s())}function _l(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1,"El nombre del transportista no debe pasar los 255 caracteres "),e.k0s())}function vl(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1,"El nombre del transportista no debe contener n\xfameros ni caracteres no alfab\xe9ticos, excepto acentos. "),e.k0s())}function bl(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1,"El primer apellido del transportista es obligatorio"),e.k0s())}function Cl(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1,"El primer apellido del transportista no debe pasar los 255 caracteres"),e.k0s())}function Fl(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1,"El primer apellido del transportista no debe contener n\xfameros ni caracteres no alfab\xe9ticos, excepto acentos."),e.k0s())}function kl(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1,"El segundo apellido del transportista no debe pasar los 255 caracteres"),e.k0s())}function xl(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1,"El nombre de la empresa es obligatorio"),e.k0s())}function yl(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1,"El nombre de la empresa no debe pasar los 255 caracteres"),e.k0s())}function Sl(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1,"El nombre de la empresa no debe contener n\xfameros ni caracteres no alfab\xe9ticos, excepto acentos."),e.k0s())}function Il(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1,"El n\xfamero de identificaci\xf3n del transportista debe tener 11 d\xedgitos."),e.k0s())}function Rl(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1,"La chapa del veh\xedculo no debe pasar los 255 caracteres"),e.k0s())}function El(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1,"La chapa del veh\xedculo no debe contener caracteres no alfanum\xe9ricos."),e.k0s())}function $l(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1,"El n\xfamero de Carta Porte o Documento no debe pasar los 255 caracteres"),e.k0s())}function jl(o,s){1&o&&(e.j41(0,"mat-error",102),e.EFF(1," Valor m\xednimo 0 "),e.k0s())}function Dl(o,s){1&o&&(e.j41(0,"mat-error",102),e.EFF(1," Valor requerido "),e.k0s())}function wl(o,s){1&o&&(e.j41(0,"mat-error",102),e.EFF(1," Valor m\xednimo 0 "),e.k0s())}function Ml(o,s){1&o&&(e.j41(0,"mat-error",102),e.EFF(1," Valor requerido "),e.k0s())}function Gl(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Cantidad excedida "),e.k0s())}function Tl(o,s){1&o&&(e.j41(0,"mat-error",102),e.EFF(1," Valor m\xednimo 0 "),e.k0s())}function Pl(o,s){1&o&&(e.j41(0,"mat-error",102),e.EFF(1," Valor requerido "),e.k0s())}function Al(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Cantidad excedida "),e.k0s())}function Bl(o,s){if(1&o&&(e.j41(0,"div",95)(1,"div"),e.EFF(2),e.k0s(),e.j41(3,"div",97),e.EFF(4),e.k0s(),e.j41(5,"div",98),e.EFF(6),e.k0s(),e.j41(7,"div",94),e.EFF(8),e.nI1(9,"number"),e.k0s(),e.j41(10,"div",99)(11,"mat-form-field",100),e.nrm(12,"input",101),e.k0s(),e.DNE(13,jl,2,0,"mat-error",102)(14,Dl,2,0,"mat-error",102),e.k0s(),e.j41(15,"div",99)(16,"mat-form-field",100),e.nrm(17,"input",101),e.k0s(),e.DNE(18,wl,2,0,"mat-error",102)(19,Ml,2,0,"mat-error",102)(20,Gl,2,0,"mat-error"),e.k0s(),e.j41(21,"div",99)(22,"mat-form-field",100),e.nrm(23,"input",101),e.k0s(),e.DNE(24,Tl,2,0,"mat-error",102)(25,Pl,2,0,"mat-error",102)(26,Al,2,0,"mat-error"),e.k0s()()),2&o){const t=s.$implicit,i=s.$index;e.R7$(2),e.SpI(" ",i+1," "),e.R7$(),e.Y8G("matTooltip",t.get("name").value),e.R7$(),e.SpI(" ",t.get("name").value," "),e.R7$(2),e.SpI(" ",t.get("uom").value," "),e.R7$(2),e.SpI(" ",e.i5U(9,25,t.get("quantity").value,"1.0-4")," "),e.R7$(3),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("min",0)("max",9999999)("formControl",t.get("quantitySpare")),e.R7$(),e.vxM(13,t.get("quantitySpare").hasError("min")?13:-1),e.R7$(),e.vxM(14,t.get("quantitySpare").hasError("required")?14:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("min",0)("max",t.get("quantity").value)("formControl",t.get("quantityMissing")),e.R7$(),e.vxM(18,t.get("quantityMissing").hasError("min")?18:-1),e.R7$(),e.vxM(19,t.get("quantityMissing").hasError("required")?19:-1),e.R7$(),e.vxM(20,t.hasError("totalQuantityExceeded")||t.get("quantityMissing").hasError("max")?20:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("min",0)("max",t.get("quantity").value)("formControl",t.get("quantityDamaged")),e.R7$(),e.vxM(24,t.get("quantityDamaged").hasError("min")?24:-1),e.R7$(),e.vxM(25,t.get("quantityDamaged").hasError("required")?25:-1),e.R7$(),e.vxM(26,t.hasError("totalQuantityExceeded")||t.get("quantityDamaged").hasError("max")?26:-1)}}function Wl(o,s){if(1&o&&(e.j41(0,"div",57)(1,"div",92),e.nrm(2,"div"),e.j41(3,"div",93),e.EFF(4," Producto "),e.k0s(),e.j41(5,"div",93),e.EFF(6," UM "),e.k0s(),e.j41(7,"div",94),e.EFF(8," Cantidad "),e.k0s(),e.j41(9,"div",94),e.EFF(10," Sobrante "),e.k0s(),e.j41(11,"div",94),e.EFF(12," Faltante "),e.k0s(),e.j41(13,"div",94),e.EFF(14," Averiada "),e.k0s()(),e.Z7z(15,Bl,27,28,"div",95,no),e.j41(17,"div",96),e.nrm(18,"div"),e.j41(19,"div"),e.EFF(20),e.k0s(),e.nrm(21,"div"),e.j41(22,"div",94),e.EFF(23),e.nI1(24,"currency"),e.k0s(),e.j41(25,"div",94),e.EFF(26),e.nI1(27,"currency"),e.k0s(),e.j41(28,"div",94),e.EFF(29),e.nI1(30,"currency"),e.k0s(),e.j41(31,"div",94),e.EFF(32),e.nI1(33,"currency"),e.k0s()()()),2&o){let t;const i=e.XpG();e.R7$(15),e.Dyx(i.productsFormGroup.get("products").controls),e.R7$(5),e.SpI("Costos Totales ",null==(t=i.purchaseFormGroup.get("purchase").value)?null:t.currency.iso,""),e.R7$(3),e.SpI(" ",e.i5U(24,5,i.productsFormGroup.get("totals").get("ct").value,"$ ")," "),e.R7$(3),e.SpI(" ",e.i5U(27,8,i.productsFormGroup.get("totals").get("ctSpare").value,"$ ")," "),e.R7$(3),e.SpI(" ",e.i5U(30,11,i.productsFormGroup.get("totals").get("ctMissing").value,"$ ")," "),e.R7$(3),e.SpI(" ",e.i5U(33,14,i.productsFormGroup.get("totals").get("ctDamaged").value,"$ ")," ")}}function Nl(o,s){1&o&&(e.j41(0,"div",103),e.EFF(1," \xa1No ha seleccionado ning\xfan producto a\xfan! "),e.k0s())}function Vl(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Las observaciones no deben pasar los 5000 caracteres "),e.k0s())}function Yl(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Las observaciones sobre sobrante son obligatorias si tienes repuestos. "),e.k0s())}function zl(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Las observaciones sobre sobrante no deben pasar los 5000 caracteres "),e.k0s())}function Ll(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Las observaciones sobre faltantes son obligatorias si tienes faltantes. "),e.k0s())}function Ql(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Las observaciones sobre faltantes no deben pasar los 5000 caracteres "),e.k0s())}function ql(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Las observaciones sobre aver\xedas son obligatorias si tienes da\xf1os. "),e.k0s())}function Xl(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Las observaciones sobre aver\xedas no deben pasar los 5000 caracteres "),e.k0s())}function Ol(o,s){if(1&o&&(e.j41(0,"div",74)(1,"span"),e.EFF(2,", "),e.k0s(),e.j41(3,"span",76),e.EFF(4),e.k0s()()),2&o){const t=e.XpG(2);e.R7$(4),e.JRh(t.carrierForm.get("idNumber").value)}}function Ul(o,s){if(1&o&&(e.j41(0,"div",74)(1,"span",104),e.EFF(2," Carta Porte:"),e.k0s(),e.j41(3,"span",76),e.EFF(4),e.k0s()()),2&o){const t=e.XpG(2);e.R7$(4),e.SpI("",t.carrierForm.get("cargoDocument").value," ")}}function Hl(o,s){if(1&o&&(e.j41(0,"div",77)(1,"div",74)(2,"span",104),e.EFF(3,"Empresa Transportista:"),e.k0s(),e.j41(4,"span",76),e.EFF(5),e.k0s()(),e.j41(6,"div",74)(7,"div",74)(8,"span",104),e.EFF(9,"Chofer:"),e.k0s(),e.j41(10,"span",76),e.EFF(11),e.k0s()(),e.DNE(12,Ol,5,1,"div",74),e.k0s(),e.DNE(13,Ul,5,1,"div",74),e.k0s()),2&o){const t=e.XpG();e.R7$(5),e.SpI("",t.carrierForm.get("company").value," "),e.R7$(6),e.E5c("",t.carrierForm.get("name").value," ",t.carrierForm.get("lastname1").value," ",t.carrierForm.get("lastname2").value," "),e.R7$(),e.vxM(12,t.carrierForm.get("idNumber").value?12:-1),e.R7$(),e.vxM(13,t.carrierForm.get("cargoDocument").value?13:-1)}}function Jl(o,s){if(1&o&&(e.j41(0,"div",95)(1,"div"),e.EFF(2),e.k0s(),e.j41(3,"div",98),e.EFF(4),e.k0s(),e.j41(5,"div",98),e.EFF(6),e.k0s(),e.j41(7,"div",94),e.EFF(8),e.nI1(9,"number"),e.k0s(),e.j41(10,"div",94),e.EFF(11),e.nI1(12,"number"),e.k0s(),e.j41(13,"div",94),e.EFF(14),e.nI1(15,"number"),e.k0s(),e.j41(16,"div",94),e.EFF(17),e.nI1(18,"number"),e.k0s()()),2&o){const t=s.$implicit,i=s.$index;e.R7$(2),e.SpI(" ",i+1," "),e.R7$(2),e.SpI(" ",t.get("name").value," "),e.R7$(2),e.SpI(" ",t.get("uom").value," "),e.R7$(2),e.SpI(" ",e.i5U(9,7,t.get("quantity").value,"1.0-4")," "),e.R7$(3),e.SpI(" ",e.i5U(12,10,t.get("quantitySpare").value,"1.0-4")," "),e.R7$(3),e.SpI(" ",e.i5U(15,13,t.get("quantityMissing").value,"1.0-4")," "),e.R7$(3),e.SpI(" ",e.i5U(18,16,t.get("quantityDamaged").value,"1.0-4")," ")}}function Zl(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",81)(1,"span",75),e.EFF(2,"Cantidades"),e.k0s(),e.j41(3,"button",78),e.bIt("click",function(){e.eBV(t),e.XpG();const n=e.sdS(18);return e.Njj(n.selectedIndex=1)}),e.nrm(4,"mat-icon",79),e.k0s()(),e.j41(5,"div",105)(6,"div",106),e.nrm(7,"div"),e.j41(8,"div",93),e.EFF(9," Producto "),e.k0s(),e.j41(10,"div",93),e.EFF(11," UM "),e.k0s(),e.j41(12,"div",94),e.EFF(13," Cantidad "),e.k0s(),e.j41(14,"div",94),e.EFF(15," Sobrante "),e.k0s(),e.j41(16,"div",94),e.EFF(17," Faltante "),e.k0s(),e.j41(18,"div",94),e.EFF(19," Averiada "),e.k0s()(),e.Z7z(20,Jl,19,19,"div",95,no),e.j41(22,"div",106),e.nrm(23,"div"),e.j41(24,"div"),e.EFF(25),e.k0s(),e.nrm(26,"div"),e.j41(27,"div",94),e.EFF(28),e.nI1(29,"currency"),e.k0s(),e.j41(30,"div",94),e.EFF(31),e.nI1(32,"currency"),e.k0s(),e.j41(33,"div",94),e.EFF(34),e.nI1(35,"currency"),e.k0s(),e.j41(36,"div",94),e.EFF(37),e.nI1(38,"currency"),e.k0s()()()}if(2&o){let t;const i=e.XpG();e.R7$(4),e.Y8G("svgIcon","mat_solid:edit"),e.R7$(16),e.Dyx(i.productsFormGroup.get("products").controls),e.R7$(5),e.SpI("Costos Totales ",null==(t=i.purchaseFormGroup.get("purchase").value)?null:t.currency.iso,""),e.R7$(3),e.SpI(" ",e.i5U(29,6,i.productsFormGroup.get("totals").get("ct").value,"$ ")," "),e.R7$(3),e.SpI(" ",e.i5U(32,9,i.productsFormGroup.get("totals").get("ctSpare").value,"$ ")," "),e.R7$(3),e.SpI(" ",e.i5U(35,12,i.productsFormGroup.get("totals").get("ctMissing").value,"$ ")," "),e.R7$(3),e.SpI(" ",e.i5U(38,15,i.productsFormGroup.get("totals").get("ctDamaged").value,"$ ")," ")}}function Kl(o,s){1&o&&(e.j41(0,"div",103),e.EFF(1," \xa1No ha seleccionado ning\xfan producto a\xfan! "),e.k0s())}function ec(o,s){1&o&&(e.j41(0,"span",82),e.EFF(1," Sin observaciones "),e.k0s())}function tc(o,s){if(1&o&&(e.j41(0,"div",84)(1,"span",104),e.EFF(2,"Observaciones generales"),e.k0s(),e.j41(3,"div",82),e.EFF(4),e.k0s()()),2&o){const t=e.XpG();e.R7$(4),e.SpI(" ",t.observationFormGroup.get("obs").value," ")}}function oc(o,s){if(1&o&&(e.j41(0,"div",84)(1,"span",104),e.EFF(2,"Observaciones sobre sobrantes"),e.k0s(),e.j41(3,"div",82),e.EFF(4),e.k0s()()),2&o){const t=e.XpG();e.R7$(4),e.SpI(" ",t.observationFormGroup.get("obsSpare").value," ")}}function ic(o,s){if(1&o&&(e.j41(0,"div",84)(1,"span",104),e.EFF(2,"Observaciones sobre faltantes"),e.k0s(),e.j41(3,"div",82),e.EFF(4),e.k0s()()),2&o){const t=e.XpG();e.R7$(4),e.SpI(" ",t.observationFormGroup.get("obsMissing").value," ")}}function nc(o,s){if(1&o&&(e.j41(0,"div",84)(1,"span",104),e.EFF(2,"Observaciones sobre aver\xedas"),e.k0s(),e.j41(3,"div",82),e.EFF(4),e.k0s()()),2&o){const t=e.XpG();e.R7$(4),e.SpI(" ",t.observationFormGroup.get("obsDamaged").value," ")}}let sc=(()=>{class o{constructor(t,i,n,r,l,c,h,y,R,te,ne){this._changeDetectorRef=t,this._fuseConfirmationService=i,this._snackBar=n,this._receptionsService=r,this._router=l,this.store=c,this._purchasesService=h,this._depotsService=y,this._formBuilder=R,this.stepperIntl=ne,this.isLoading=!1,this.purchaseSearchInputControl=new a.MJ(null),this.depotSearchInputControl=new a.MJ(null),this._unsubscribeAll=new j.B,this.stepperIntl.optionalLabel="Opcional",this.stepperOrientation=te.observe("(min-width: 800px)").pipe((0,b.T)(({matches:uo})=>uo?"horizontal":"vertical"))}ngOnInit(){this.depotFormGroup=this._formBuilder.group({depot:[null,a.k0.required]}),this.purchaseFormGroup=this._formBuilder.group({checked:[!1],purchase:[null,a.k0.required]});const t=/^[a-zA-Z\xc0-\xd6\xd8-\xf6\xf8-\xff\s']+$/u;this.carrierForm=this._formBuilder.group({name:["",[a.k0.required,a.k0.pattern(t),a.k0.maxLength(255)]],company:["",[a.k0.required,a.k0.pattern(t),a.k0.maxLength(255)]],lastname1:["",[a.k0.required,a.k0.maxLength(255),K.t.onlyAlphabetsWithAccentPattern()]],lastname2:["",[a.k0.maxLength(255),K.t.onlyAlphabetsWithAccentPattern()]],idNumber:["",[a.k0.minLength(11),a.k0.maxLength(11)]],licensePlate:["",[a.k0.maxLength(255),a.k0.pattern(/^[a-zA-Z0-9]+$/)]],cargoDocument:["",[a.k0.maxLength(255)]]}),this.carrierForm.disable(),this.generalDataFormGroup=this._formBuilder.group({isThirdCompany:[!1],depot:this.depotFormGroup,purchase:this.purchaseFormGroup,courier:this.carrierForm}),this.productsFormGroup=this._formBuilder.group({totals:this._formBuilder.group({ct:[0],ctSpare:[0],ctMissing:[0],ctDamaged:[0]}),products:new a.Yp([])}),this.observationFormGroup=this._formBuilder.group({obs:["",[a.k0.maxLength(5e3)]],haveSpare:[!1],obsSpare:["",[a.k0.maxLength(5e3)]],haveMissing:[!1],obsMissing:["",[a.k0.maxLength(5e3)]],haveDamaged:[!1],obsDamaged:["",[a.k0.maxLength(5e3)]]}),this.store.select(re.SW).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{this.employee=n.employee}),this.store.select(Ja.vY).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{this.purchases=n,this._changeDetectorRef.markForCheck()}),this.store.select(q.c_).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{this.depots=n,this._changeDetectorRef.markForCheck()}),this.store.select(se.Dz).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{this.pagination=n,this._changeDetectorRef.markForCheck()}),this.purchaseSearchInputControl.valueChanges.pipe((0,u.Q)(this._unsubscribeAll),(0,f.B)(300),(0,_.n)(n=>this._purchasesService.findPurchases(n.trim(),Za.WM.nueva))).subscribe(),this.depotSearchInputControl.valueChanges.pipe((0,u.Q)(this._unsubscribeAll),(0,f.B)(300),(0,_.n)(n=>this._depotsService.findActiveDepots(n.trim()))).subscribe(),this.purchaseFormGroup.get("purchase").valueChanges.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{this.productsFormGroup.get("products").clear(),n&&n.products.map(l=>this.createProductFormGroup(l)).forEach(l=>{this.productsFormGroup.get("products").push(l)})}),this.productsFormGroup.get("products").valueChanges.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{const r=n.reduce((y,R)=>y+R.quantitySpare,0),l=n.reduce((y,R)=>y+R.quantityMissing,0),c=n.reduce((y,R)=>y+R.quantityDamaged,0);r>0?this.observationFormGroup.get("haveSpare").setValue(!0):this.observationFormGroup.get("haveSpare").setValue(!1),l>0?this.observationFormGroup.get("haveMissing").setValue(!0):this.observationFormGroup.get("haveMissing").setValue(!1),c>0?this.observationFormGroup.get("haveDamaged").setValue(!0):this.observationFormGroup.get("haveDamaged").setValue(!1);const h={ct:n.reduce((y,R)=>y+(R.cud+R.cui)*R.quantity,0),ctSpare:n.reduce((y,R)=>y+(R.cud+R.cui)*R.quantitySpare,0),ctMissing:n.reduce((y,R)=>y+(R.cud+R.cui)*R.quantityMissing,0),ctDamaged:n.reduce((y,R)=>y+(R.cud+R.cui)*R.quantityDamaged,0)};this.productsFormGroup.get("totals").patchValue(h,{emitEvent:!1})}),this.generalDataFormGroup.get("isThirdCompany").valueChanges.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{const r=this.carrierForm.get("name"),l=this.carrierForm.get("company"),c=this.carrierForm.get("lastname1");n?(r.setValidators([a.k0.required,a.k0.pattern(t),a.k0.maxLength(255)]),l.setValidators([a.k0.required,a.k0.pattern(t),a.k0.maxLength(255)]),c.setValidators([a.k0.required,a.k0.maxLength(255),K.t.onlyAlphabetsWithAccentPattern()]),this.carrierForm.enable()):(this.carrierForm.disable(),r.setValidators(null),l.setValidators(null),c.setValidators(null),this.carrierForm.reset()),this.carrierForm.updateValueAndValidity()}),this.observationFormGroup.get("haveSpare").valueChanges.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{const r=this.observationFormGroup.get("obsSpare");n?(r.enable(),r.setValidators([a.k0.required,a.k0.maxLength(5e3)])):(r.disable(),r.setValue(""),r.setValidators(null)),r.updateValueAndValidity()}),this.observationFormGroup.get("haveMissing").valueChanges.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{const r=this.observationFormGroup.get("obsMissing");n?(r.enable(),r.setValidators([a.k0.required,a.k0.maxLength(5e3)])):(r.disable(),r.setValue(""),r.setValidators(null)),r.updateValueAndValidity()}),this.observationFormGroup.get("haveDamaged").valueChanges.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{const r=this.observationFormGroup.get("obsDamaged");n?(r.enable(),r.setValidators([a.k0.required,a.k0.maxLength(5e3)])):(r.disable(),r.setValue(""),r.setValidators(null)),r.updateValueAndValidity(),this._changeDetectorRef.markForCheck()})}ngAfterViewInit(){this._paginator&&(this._changeDetectorRef.markForCheck(),(0,V.h)(this._paginator.page).pipe((0,_.n)(()=>(this.isLoading=!0,this._purchasesService.getPurchases(this._paginator.pageIndex,this._paginator.pageSize,"code","asc",this.purchaseSearchInputControl.value))),(0,b.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}selectPurchase(t){this.purchaseFormGroup.get("checked").value?this.purchaseFormGroup.get("purchase").setValue(t):this.purchaseFormGroup.get("purchase").setValue(null)}saveReception(){const t=this.productsFormGroup.getRawValue().products;t.forEach(c=>{delete c.name,delete c.uom,delete c.cud,delete c.cui});const i=this.purchaseFormGroup.getRawValue().purchase,n=this.observationFormGroup.getRawValue(),r=this.depotFormGroup.getRawValue().depot;n.products=t,n.purchaseId=i.id,n.depotId=r.id,n.courier=this.carrierForm.getRawValue(),this._fuseConfirmationService.open({title:"Registrar Recepci\xf3n",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,u.Q)(this._unsubscribeAll)).subscribe(c=>{"confirmed"===c&&(this.isLoading=!0,this._receptionsService.createReception(n).pipe((0,u.Q)(this._unsubscribeAll),(0,U.j)(()=>{this.isLoading=!1,this._changeDetectorRef.markForCheck()})).subscribe(h=>{h&&(this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:h.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.purchaseSearchInputControl.setValue(""),this.stepper.reset())}))})}printPage(){window.print()}createProductFormGroup(t){return this._formBuilder.group({productId:[t.productId,[a.k0.required]],name:[t.product.name],uom:[t.product.uom.abbr],cud:[t.cud],cui:[t.cui],quantity:[t.quantity,[a.k0.required]],quantitySpare:[0,[a.k0.required,a.k0.min(0),a.k0.max(9999999)]],quantityMissing:[0,[a.k0.required,a.k0.min(0),a.k0.max(t.quantity)]],quantityDamaged:[0,[a.k0.required,a.k0.min(0),a.k0.max(t.quantity)]]},{validators:this.totalQuantityValidator()})}totalQuantityValidator(){return t=>{const i=t.get("quantity")?.value,n=t.get("quantityMissing")?.value,r=t.get("quantityDamaged")?.value;return n+r>i?{totalQuantityExceeded:!0}:null}}static#e=this.\u0275fac=function(i){return new(i||o)(e.rXU(e.gRc),e.rXU(ae.G),e.rXU(O.UG),e.rXU(ut),e.rXU(g.Ix),e.rXU(S.il),e.rXU(sl.W),e.rXU(ue.t),e.rXU(a.ok),e.rXU(kt.QP),e.rXU(J.hc))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["warehouse-reception"]],viewQuery:function(i,n){if(1&i&&(e.GBs(J.M6,5),e.GBs(I.iy,5)),2&i){let r;e.mGM(r=e.lsd())&&(n.stepper=r.first),e.mGM(r=e.lsd())&&(n._paginator=r.first)}},standalone:!0,features:[e.aNF],decls:212,vars:147,consts:[["stepper",""],["gContent",""],["obs",""],["obsSpare",""],["obsMissing",""],["obsDamaged",""],[1,"flex","flex-col","flex-auto","min-w-0","overflow-auto","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","pb-3","print:hidden","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-7"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],["linear","",1,"h-full","sm:overflow-auto",3,"orientation"],["label","Datos Generales",3,"stepControl"],[1,"flex","flex-col","h-full","sm:px-4",3,"ngClass"],[1,"flex","flex-col","col-start-1","row-start-1","justify-evenly"],[1,"py-6","text-2xl","font-semibold","text-center","truncate","sm:py-0"],[1,"flex","items-center","justify-center","w-full"],["appearance","fill",1,"fuse-mat-dense","fuse-mat-rounded","min-w-52",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["fuseScrollbar","",1,"grid","h-full","col-start-1","row-start-2","reception-purchase-grid",3,"fuseScrollbarOptions"],[1,"h-full","px-6",3,"formGroup"],[1,"flex","flex-wrap","justify-center","gap-6","py-4"],[1,"border-b","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-gray-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"flex","flex-col","col-start-2","row-start-1","justify-evenly"],[1,"sticky","top-0","z-10","flex","items-center","justify-center","w-full"],["appearance","fill",1,"fuse-mat-dense","min-w-52","fuse-mat-rounded",3,"subscriptSizing"],["fuseScrollbar","",1,"h-full","col-start-2","row-start-2","px-6","border-x",3,"formGroup","fuseScrollbarOptions"],["formControlName","depot",1,"flex","flex-wrap","justify-center","w-full","gap-6","py-4"],[1,"flex","flex-col","justify-between","col-start-3","row-start-1"],[1,"py-6","mt-3","text-2xl","font-semibold","text-center","truncate","sm:py-0"],["color","primary",1,"self-center",3,"formControl"],["fuseScrollbar","",1,"grid","h-full","col-start-3","row-start-2","gap-3","p-6","sm:grid-cols-2",3,"formGroup","fuseScrollbarOptions"],["appearance","fill",1,"w-full","fuse-mat-dense",3,"subscriptSizing"],["for","name"],["matInput","","type","text","id","name","formControlName","name",3,"maxlength","required"],["for","lastname1"],["matInput","","type","text","id","lastname1","formControlName","lastname1",3,"maxlength","required"],["for","lastname2"],["matInput","","type","text","id","lastname2","formControlName","lastname2",3,"maxLength"],["for","company"],["matInput","","type","text","id","company","formControlName","company",3,"required","maxlength"],["for","idNumber"],["matInput","","type","text","id","idNumber","formControlName","idNumber",3,"minlength","maxlength"],["for","licensePlate"],["matInput","","type","text","id","licensePlate","formControlName","licensePlate",3,"maxlength"],["for","cargoDocument"],["matInput","","type","text","id","cargoDocument","formControlName","cargoDocument",3,"maxlength"],[1,"flex","items-center","justify-end","col-span-3","row-start-3","gap-x-4"],["color","primary","mat-flat-button","","matStepperNext","",3,"disabled"],["label","Cantidades Recibidas",3,"stepControl"],[1,"grid","h-full","grid-cols-1","pt-4","sm:px-4",3,"ngClass"],["fuseScrollbar","",1,"h-full","pb-6"],["fuseScrollbar","",1,"grid"],[1,"flex","items-center","justify-end","gap-x-4"],["mat-button","","matStepperPrevious",""],["label","Observaciones",3,"stepControl","optional"],["fuseScrollbar","",1,"grid","w-full","gap-4","px-4","pb-6","lg:grid-cols-4","sm:gap-6",3,"formGroup"],[1,"lg:col-span-2"],[1,"w-full","fuse-mat-textarea",3,"subscriptSizing"],["matInput","","matTextareaAutosize","",3,"formControlName","maxlength","rows","spellcheck"],[1,"w-full","text-right"],["matInput","","matTextareaAutosize","",3,"formControlName","rows","spellcheck","maxlength","required","disabled"],["matInput","","matTextareaAutosize","",3,"formControlName","rows","spellcheck","maxlength","required"],["label","Resumen",3,"stepControl"],["fuseScrollbar","",1,"flex","flex-col","justify-between","p-10","pt-8","print:row-span-2","bg-gray-50","dark:bg-primary","dark:bg-opacity-5"],[1,"flex","flex-col","w-full","gap-2"],[1,"flex","flex-row","items-center"],[1,"flex","flex-col","gap-x-6"],[1,"flex","flex-row","gap-10"],[1,"flex","flex-row"],[1,"font-bold"],[1,"ml-2"],[1,"mt-2"],["mat-icon-button","",1,"print:hidden",3,"click"],[1,"icon-size-4",3,"svgIcon"],[1,""],[1,"flex","flex-row","items-center","gap-1"],[1,"text-secondary"],[1,"flex","flex-col","gap-2"],[1,"flex","flex-col","text-md"],[1,"mt-10","font-serif"],[1,"flex","items-center","justify-end","print:hidden","gap-x-4"],["mat-button","",3,"click"],["color","primary","mat-flat-button","",3,"click","disabled"],["color","primary","formControlName","checked",1,"w-52",3,"change","checked"],[1,"w-full","p-10","text-2xl","font-medium","text-center","sm:col-span-2"],["color","primary",1,"line-clamp-2",3,"value","ngClass"],[1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","reception-form-products-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-primary","dark:bg-opacity-5"],[1,"text-left"],[1,"text-center"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","reception-form-products-grid","md:px-8"],[1,"sticky","bottom-0","z-10","grid","gap-4","px-6","py-4","font-semibold","reception-form-products-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-primary","dark:bg-opacity-5"],[1,"truncate",3,"matTooltip"],[1,"truncate"],[1,"flex","flex-col","items-center","justify-center"],[1,"fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],["matInput","","type","number",1,"font-mono","font-semibold","text-center",3,"min","max","formControl"],[1,"w-full","text-sm","text-center"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-30"],[1,"font-semibold"],[1,"grid"],[1,"grid","gap-4","px-6","py-4","font-semibold","bg-gray-100","reception-form-products-grid","md:px-8","text-md","text-secondary","dark:bg-primary","dark:bg-opacity-5"]],template:function(i,n){if(1&i){const r=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div",8)(3,"div",9)(4,"div",9)(5,"div")(6,"a",10),e.EFF(7,"Inicio"),e.k0s()(),e.j41(8,"div",11),e.nrm(9,"mat-icon",12),e.j41(10,"a",13),e.EFF(11,"Almac\xe9n"),e.k0s()(),e.j41(12,"div",11),e.nrm(13,"mat-icon",12),e.j41(14,"a",13),e.EFF(15,"Recepci\xf3n"),e.k0s()()()()(),e.nrm(16,"div",14),e.k0s(),e.j41(17,"mat-stepper",15,0),e.nI1(19,"async"),e.j41(20,"mat-step",16)(21,"div",17,1),e.nI1(23,"async"),e.j41(24,"div",18)(25,"span",19),e.EFF(26,"Seleccionar Factura"),e.k0s(),e.j41(27,"div",20)(28,"mat-form-field",21),e.nrm(29,"mat-icon",22)(30,"input",23),e.k0s()()(),e.j41(31,"div",24)(32,"form",25)(33,"div",26),e.DNE(34,ul,2,0)(35,ml,2,0),e.k0s()(),e.nrm(36,"mat-paginator",27),e.k0s(),e.j41(37,"div",28)(38,"span",19),e.EFF(39,"Seleccionar Almac\xe9n"),e.k0s(),e.j41(40,"div",29)(41,"mat-form-field",30),e.nrm(42,"mat-icon",22)(43,"input",23),e.k0s()()(),e.j41(44,"form",31),e.DNE(45,hl,3,0,"mat-radio-group",32)(46,fl,2,0),e.k0s(),e.j41(47,"div",33)(48,"span",34),e.EFF(49,"Transportista"),e.k0s(),e.j41(50,"mat-checkbox",35),e.EFF(51," \xbfHa transportado esta compra un tercero? "),e.k0s()(),e.j41(52,"form",36)(53,"div")(54,"mat-form-field",37)(55,"mat-label",38),e.EFF(56,"Nombre"),e.k0s(),e.nrm(57,"input",39),e.DNE(58,gl,2,0,"mat-error")(59,_l,2,0,"mat-error")(60,vl,2,0,"mat-error"),e.k0s()(),e.j41(61,"div")(62,"mat-form-field",37)(63,"mat-label",40),e.EFF(64," Primer Apellido"),e.k0s(),e.nrm(65,"input",41),e.DNE(66,bl,2,0,"mat-error")(67,Cl,2,0,"mat-error")(68,Fl,2,0,"mat-error"),e.k0s()(),e.j41(69,"div")(70,"mat-form-field",37)(71,"mat-label",42),e.EFF(72,"Segundo Apellido"),e.k0s(),e.nrm(73,"input",43),e.DNE(74,kl,2,0,"mat-error"),e.k0s()(),e.j41(75,"div")(76,"mat-form-field",37)(77,"mat-label",44),e.EFF(78,"Empresa"),e.k0s(),e.nrm(79,"input",45),e.DNE(80,xl,2,0,"mat-error")(81,yl,2,0,"mat-error")(82,Sl,2,0,"mat-error"),e.j41(83,"mat-hint"),e.EFF(84," Nombre de la Empresa Transportista"),e.k0s()()(),e.j41(85,"div")(86,"mat-form-field",37)(87,"mat-label",46),e.EFF(88,"N\xfamero de Identificaci\xf3n"),e.k0s(),e.nrm(89,"input",47),e.DNE(90,Il,2,0,"mat-error"),e.k0s()(),e.j41(91,"div")(92,"mat-form-field",37)(93,"mat-label",48),e.EFF(94,"Chapa del Veh\xedculo"),e.k0s(),e.nrm(95,"input",49),e.DNE(96,Rl,2,0,"mat-error")(97,El,2,0,"mat-error"),e.k0s()(),e.j41(98,"div")(99,"mat-form-field",37)(100,"mat-label",50),e.EFF(101,"N\xfamero de Carta Porte"),e.k0s(),e.nrm(102,"input",51),e.DNE(103,$l,2,0,"mat-error"),e.j41(104,"mat-hint"),e.EFF(105,"N\xfamero de Carta Porte o Documento"),e.k0s()()()(),e.j41(106,"div",52)(107,"button",53),e.EFF(108,"Siguiente"),e.k0s()()()(),e.j41(109,"mat-step",54)(110,"div",55),e.nI1(111,"async"),e.j41(112,"div",56),e.DNE(113,Wl,34,17,"div",57)(114,Nl,2,0),e.k0s(),e.j41(115,"div",58)(116,"button",59),e.EFF(117,"Atr\xe1s"),e.k0s(),e.j41(118,"button",53),e.EFF(119,"Siguiente"),e.k0s()()()(),e.j41(120,"mat-step",60)(121,"div",55),e.nI1(122,"async"),e.j41(123,"form",61)(124,"div",62)(125,"mat-form-field",63)(126,"mat-label"),e.EFF(127,"Observaci\xf3n General"),e.k0s(),e.nrm(128,"textarea",64,2),e.DNE(130,Vl,2,0,"mat-error"),e.j41(131,"mat-hint",65),e.EFF(132),e.k0s()()(),e.j41(133,"div",62)(134,"mat-form-field",63)(135,"mat-label"),e.EFF(136,"Observaciones sobre Sobrantes"),e.k0s(),e.nrm(137,"textarea",66,3),e.DNE(139,Yl,2,0,"mat-error")(140,zl,2,0,"mat-error"),e.j41(141,"mat-hint",65),e.EFF(142),e.k0s()()(),e.j41(143,"div",62)(144,"mat-form-field",63)(145,"mat-label"),e.EFF(146,"Observaciones sobre Faltantes"),e.k0s(),e.nrm(147,"textarea",67,4),e.DNE(149,Ll,2,0,"mat-error")(150,Ql,2,0,"mat-error"),e.j41(151,"mat-hint",65),e.EFF(152),e.k0s()()(),e.j41(153,"div",62)(154,"mat-form-field",63)(155,"mat-label"),e.EFF(156,"Observaciones de Aver\xedas"),e.k0s(),e.nrm(157,"textarea",67,5),e.DNE(159,ql,2,0,"mat-error")(160,Xl,2,0,"mat-error"),e.j41(161,"mat-hint",65),e.EFF(162),e.k0s()()()(),e.j41(163,"div",58)(164,"button",59),e.EFF(165,"Atr\xe1s"),e.k0s(),e.j41(166,"button",53),e.EFF(167,"Siguiente"),e.k0s()()()(),e.j41(168,"mat-step",68)(169,"div",55),e.nI1(170,"async"),e.j41(171,"div",69)(172,"div",70)(173,"div",71)(174,"div",72)(175,"div",73)(176,"div",74)(177,"span",75),e.EFF(178,"Factura:"),e.k0s(),e.j41(179,"span",76),e.EFF(180),e.k0s()(),e.j41(181,"div",74)(182,"span",75),e.EFF(183,"Almac\xe9n:"),e.k0s(),e.j41(184,"span",76),e.EFF(185),e.k0s()()(),e.DNE(186,Hl,14,6,"div",77),e.k0s(),e.j41(187,"button",78),e.bIt("click",function(){e.eBV(r);const c=e.sdS(18);return e.Njj(c.selectedIndex=0)}),e.nrm(188,"mat-icon",79),e.k0s()(),e.DNE(189,Zl,39,18)(190,Kl,2,0),e.j41(191,"div",80)(192,"div",81)(193,"span",75),e.EFF(194,"Observaciones"),e.k0s(),e.j41(195,"button",78),e.bIt("click",function(){e.eBV(r);const c=e.sdS(18);return e.Njj(c.selectedIndex=2)}),e.nrm(196,"mat-icon",79),e.k0s()(),e.DNE(197,ec,2,0,"span",82),e.j41(198,"div",83),e.DNE(199,tc,5,1,"div",84)(200,oc,5,1,"div",84)(201,ic,5,1,"div",84)(202,nc,5,1,"div",84),e.k0s()()(),e.j41(203,"span",85),e.EFF(204),e.k0s()(),e.j41(205,"div",86)(206,"button",59),e.EFF(207,"Atr\xe1s"),e.k0s(),e.j41(208,"button",87),e.bIt("click",function(){return e.eBV(r),e.Njj(n.printPage())}),e.EFF(209,"Imprimir"),e.k0s(),e.j41(210,"button",88),e.bIt("click",function(){return e.eBV(r),e.Njj(n.saveReception())}),e.EFF(211,"Registrar Recepci\xf3n"),e.k0s()()()()()()}if(2&i){let r,l;const c=e.sdS(129),h=e.sdS(138),y=e.sdS(148),R=e.sdS(158);e.R7$(9),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("orientation",e.bMT(19,122,n.stepperOrientation)),e.R7$(3),e.Y8G("stepControl",n.generalDataFormGroup),e.R7$(),e.Y8G("ngClass",e.eq3(132,rl,"horizontal"===e.bMT(23,124,n.stepperOrientation))),e.R7$(7),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.purchaseSearchInputControl)("autocomplete","off")("placeholder","Buscar Compra..."),e.R7$(),e.Y8G("fuseScrollbarOptions",e.lJ4(134,mt)),e.R7$(),e.Y8G("formGroup",n.purchaseFormGroup),e.R7$(2),e.vxM(34,n.purchases.length>0?34:35),e.R7$(2),e.Y8G("ngClass",e.l_i(135,al,n.isLoading,n.pagination.length<25&&n.pagination.page<1))("length",n.pagination.length)("pageIndex",n.pagination.page)("pageSize",n.pagination.size)("pageSizeOptions",e.lJ4(138,ll))("showFirstLastButtons",!1),e.R7$(5),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.depotSearchInputControl)("autocomplete","off")("placeholder","Buscar Almac\xe9n..."),e.R7$(),e.Y8G("formGroup",n.depotFormGroup)("fuseScrollbarOptions",e.lJ4(139,mt)),e.R7$(),e.vxM(45,n.depots.length>0?45:46),e.R7$(5),e.Y8G("formControl",n.generalDataFormGroup.get("isThirdCompany")),e.R7$(2),e.Y8G("formGroup",n.carrierForm)("fuseScrollbarOptions",e.lJ4(140,mt)),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("maxlength",255)("required",n.generalDataFormGroup.get("isThirdCompany").value),e.R7$(),e.vxM(58,n.carrierForm.get("name").hasError("required")?58:-1),e.R7$(),e.vxM(59,n.carrierForm.get("name").hasError("maxlength")?59:-1),e.R7$(),e.vxM(60,n.carrierForm.get("name").hasError("pattern")?60:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("maxlength",255)("required",n.generalDataFormGroup.get("isThirdCompany").value),e.R7$(),e.vxM(66,n.carrierForm.get("lastname1").hasError("required")?66:-1),e.R7$(),e.vxM(67,n.carrierForm.get("lastname1").hasError("maxlength")?67:-1),e.R7$(),e.vxM(68,n.carrierForm.get("lastname1").hasError("pattern")?68:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("maxLength",255),e.R7$(),e.vxM(74,n.carrierForm.get("lastname2").hasError("maxlength")?74:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("required",n.generalDataFormGroup.get("isThirdCompany").value)("maxlength",255),e.R7$(),e.vxM(80,n.carrierForm.get("company").hasError("required")?80:-1),e.R7$(),e.vxM(81,n.carrierForm.get("company").hasError("maxlength")?81:-1),e.R7$(),e.vxM(82,n.carrierForm.get("company").hasError("pattern")?82:-1),e.R7$(4),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("minlength",11)("maxlength",11),e.R7$(),e.vxM(90,n.carrierForm.get("idNumber").hasError("minlength")||n.carrierForm.get("idNumber").hasError("maxlength")?90:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("maxlength",255),e.R7$(),e.vxM(96,n.carrierForm.get("licensePlate").hasError("maxlength")?96:-1),e.R7$(),e.vxM(97,n.carrierForm.get("licensePlate").hasError("pattern")?97:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("maxlength",255),e.R7$(),e.vxM(103,n.carrierForm.get("cargoDocument").hasError("maxlength")?103:-1),e.R7$(4),e.Y8G("disabled",n.generalDataFormGroup.invalid),e.R7$(2),e.Y8G("stepControl",n.productsFormGroup),e.R7$(),e.Y8G("ngClass",e.eq3(141,pt,"horizontal"===e.bMT(111,126,n.stepperOrientation))),e.R7$(3),e.vxM(113,n.productsFormGroup.get("products").controls.length>0?113:114),e.R7$(5),e.Y8G("disabled",n.productsFormGroup.invalid),e.R7$(2),e.Y8G("stepControl",n.observationFormGroup)("optional",n.observationFormGroup.valid),e.R7$(),e.Y8G("ngClass",e.eq3(143,pt,"horizontal"===e.bMT(122,128,n.stepperOrientation))),e.R7$(2),e.Y8G("formGroup",n.observationFormGroup),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","obs")("maxlength",5e3)("rows",2)("spellcheck",!1),e.R7$(2),e.vxM(130,n.observationFormGroup.get("obs").hasError("maxlength")?130:-1),e.R7$(2),e.SpI("",c.value.length||0,"/5000"),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","obsSpare")("rows",2)("spellcheck",!1)("maxlength",5e3)("required",n.observationFormGroup.get("haveSpare").value)("disabled",!n.observationFormGroup.get("haveSpare").value),e.R7$(2),e.vxM(139,n.observationFormGroup.get("obsSpare").hasError("required")?139:-1),e.R7$(),e.vxM(140,n.observationFormGroup.get("obsSpare").hasError("maxlength")?140:-1),e.R7$(2),e.SpI("",h.value.length||0,"/5000"),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","obsMissing")("rows",2)("spellcheck",!1)("maxlength",5e3)("required",n.observationFormGroup.get("haveMissing").value),e.R7$(2),e.vxM(149,n.observationFormGroup.get("obsMissing").hasError("required")?149:-1),e.R7$(),e.vxM(150,n.observationFormGroup.get("obsMissing").hasError("maxlength")?150:-1),e.R7$(2),e.SpI("",y.value.length||0,"/5000"),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(3),e.Y8G("formControlName","obsDamaged")("rows",2)("spellcheck",!1)("maxlength",5e3)("required",n.observationFormGroup.get("haveDamaged").value),e.R7$(2),e.vxM(159,n.observationFormGroup.get("obsDamaged").hasError("required")?159:-1),e.R7$(),e.vxM(160,n.observationFormGroup.get("obsDamaged").hasError("maxlength")?160:-1),e.R7$(2),e.SpI("",R.value.length||0,"/5000"),e.R7$(4),e.Y8G("disabled",n.observationFormGroup.invalid),e.R7$(2),e.Y8G("stepControl",n.depotFormGroup),e.R7$(),e.Y8G("ngClass",e.eq3(145,pt,"horizontal"===e.bMT(170,130,n.stepperOrientation))),e.R7$(11),e.SpI("",null==(r=n.purchaseFormGroup.get("purchase").value)?null:r.code," "),e.R7$(5),e.SpI("",null==(l=n.depotFormGroup.get("depot").value)?null:l.name," "),e.R7$(),e.vxM(186,n.generalDataFormGroup.get("isThirdCompany").value?186:-1),e.R7$(2),e.Y8G("svgIcon","mat_solid:edit"),e.R7$(),e.vxM(189,n.productsFormGroup.get("products").controls.length>0?189:190),e.R7$(7),e.Y8G("svgIcon","mat_solid:edit"),e.R7$(),e.vxM(197,n.observationFormGroup.get("obs").value||n.observationFormGroup.get("obsSpare").value||n.observationFormGroup.get("obsMissing").value||n.observationFormGroup.get("obsDamaged").value?-1:197),e.R7$(2),e.vxM(199,n.observationFormGroup.get("obs").value?199:-1),e.R7$(),e.vxM(200,n.observationFormGroup.get("obsSpare").value?200:-1),e.R7$(),e.vxM(201,n.observationFormGroup.get("obsMissing").value?201:-1),e.R7$(),e.vxM(202,n.observationFormGroup.get("obsDamaged").value?202:-1),e.R7$(2),e.SpI("Recibido por: ",n.employee.fullname," "),e.R7$(6),e.Y8G("disabled",n.generalDataFormGroup.invalid||n.productsFormGroup.invalid||n.observationFormGroup.invalid)}},dependencies:[p.Jj,p.oe,p.QX,H.p,v.Hl,v.$z,v.iY,me.g7,me.So,m.RG,m.rl,m.nJ,m.MV,m.TL,m.JW,C.m_,C.An,k.fS,k.fg,I.Ou,I.iy,We.Wk,We.VT,We._g,F.NQ,J.aP,J.V5,J.M6,J.F7,J.FR,M.uc,M.oV,p.YU,a.X1,a.qT,a.me,a.Q0,a.BC,a.cb,a.YS,a.xh,a.tU,a.VZ,a.zX,a.l_,a.j4,a.JD],encapsulation:2,changeDetection:0})}return o})();class rc{}const ac=()=>({wheelPropagation:!1}),lc=(o,s)=>({"pointer-events-none":o,hidden:s}),cc=()=>[10,25,50,100];function dc(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",24)(1,"div",21),e.EFF(2),e.k0s(),e.j41(3,"div",25),e.EFF(4),e.nI1(5,"date"),e.k0s(),e.j41(6,"div",21),e.EFF(7),e.k0s(),e.j41(8,"div",26),e.EFF(9),e.nI1(10,"currency"),e.k0s(),e.j41(11,"div",26),e.EFF(12),e.nI1(13,"currency"),e.k0s(),e.j41(14,"div",26),e.EFF(15),e.nI1(16,"currency"),e.k0s(),e.j41(17,"div",26),e.EFF(18),e.nI1(19,"currency"),e.k0s(),e.j41(20,"div",27)(21,"button",28),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,r=e.XpG(4);return e.Njj(r.viewReceptionReport(n))}),e.nrm(22,"mat-icon",29),e.k0s()()()}if(2&o){const t=s,i=e.XpG().$implicit;e.R7$(2),e.SpI(" ",i.no," "),e.R7$(2),e.SpI(" ",e.i5U(5,8,i.createdAt,"dd/MM/yyyy")," "),e.R7$(3),e.SpI(" ",i.purchase.code," "),e.R7$(2),e.SpI(" ",e.i5U(10,11,t.ctQuantity,"$ ")," "),e.R7$(3),e.SpI(" ",e.i5U(13,14,t.ctQuantitySpare,"$ ")," "),e.R7$(3),e.SpI(" ",e.i5U(16,17,t.ctQuantityMissing,"$ ")," "),e.R7$(3),e.SpI(" ",e.i5U(19,20,t.ctQuantityDamaged,"$ ")," "),e.R7$(4),e.Y8G("svgIcon","mat_solid:assignment")}}function uc(o,s){if(1&o&&e.DNE(0,dc,23,23,"div",24),2&o){let t;const i=s.$implicit,n=e.XpG(4);e.vxM(0,(t=n.calcTotalsCost(i))?0:-1,t)}}function mc(o,s){1&o&&e.Z7z(0,uc,1,1,null,null,e.BUC().trackByFn,!0),2&o&&e.Dyx(s)}function pc(o,s){if(1&o&&(e.j41(0,"div",19)(1,"div",20)(2,"div",21),e.EFF(3," N\xfamero "),e.k0s(),e.j41(4,"div",21),e.EFF(5," Fecha "),e.k0s(),e.j41(6,"div",21),e.EFF(7," Factura "),e.k0s(),e.j41(8,"div",22),e.EFF(9," Costo total "),e.k0s(),e.j41(10,"div",22),e.EFF(11," CT.Sobrante "),e.k0s(),e.j41(12,"div",22),e.EFF(13," CT.Faltante "),e.k0s(),e.j41(14,"div",22),e.EFF(15," CT.Averiada "),e.k0s(),e.j41(16,"div",21),e.EFF(17," Acciones "),e.k0s()(),e.DNE(18,mc,2,0),e.nI1(19,"async"),e.k0s(),e.nrm(20,"mat-paginator",23)),2&o){let t;const i=e.XpG(2);e.R7$(18),e.vxM(18,(t=e.bMT(19,7,i.receptions$))?18:-1,t),e.R7$(2),e.Y8G("ngClass",e.l_i(9,lc,i.isLoading,i.pagination.length<10&&i.pagination.page<1))("length",i.pagination.length)("pageIndex",i.pagination.page)("pageSize",i.pagination.size)("pageSizeOptions",e.lJ4(12,cc))("showFirstLastButtons",!0)}}function hc(o,s){1&o&&(e.j41(0,"div",30),e.EFF(1," \xa1No se ha registrado ninguna recepci\xf3n hasta el momento! "),e.k0s())}function fc(o,s){1&o&&e.DNE(0,pc,21,13)(1,hc,2,0),2&o&&e.vxM(0,s.length>0?0:1)}let gc=(()=>{class o{constructor(t,i,n){this._changeDetectorRef=t,this._receptionsService=i,this.store=n,this.isLoading=!1,this.reception=new rc,this.receptions$=(0,E.of)([]),this.searchInputControl=new a.MJ(null),this.user=null,this.merchant=null,this._unsubscribeAll=new j.B,this._documentsService=(0,e.WQX)(xe.Q)}ngOnInit(){this.store.select(re.SW).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(fe.Xb).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(se.Dz).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.receptions$=this.store.select(dt),this.searchInputControl.valueChanges.pipe((0,u.Q)(this._unsubscribeAll),(0,f.B)(300),(0,_.n)(t=>{if(null!==t)return this.isLoading=!0,this._receptionsService.getReceptions(0,25,"no","desc",t)}),(0,b.T)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"no",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,V.h)(this._sort.sortChange,this._paginator.page).pipe((0,_.n)(()=>(this.isLoading=!0,this._receptionsService.getReceptions(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,b.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}viewReceptionReport(t){this._documentsService.generateReceptionDocument(t,this.merchant,this.user)}trackByFn(t,i){return i.id||t}calcTotalsCost(t){const n=t.purchase.products,r=t.products.map(c=>{const h=n.find(y=>y.productId===c.productId);return{...c,...h}});return{ctQuantity:r.reduce((c,h)=>c+(h.cud+h.cui)*h.quantity,0),ctQuantitySpare:r.reduce((c,h)=>c+(h.cud+h.cui)*h.quantitySpare,0),ctQuantityMissing:r.reduce((c,h)=>c+(h.cud+h.cui)*h.quantityMissing,0),ctQuantityDamaged:r.reduce((c,h)=>c+(h.cud+h.cui)*h.quantityDamaged,0)}}static#e=this.\u0275fac=function(i){return new(i||o)(e.rXU(e.gRc),e.rXU(ut),e.rXU(S.il))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["warehouse-reception-list"]],viewQuery:function(i,n){if(1&i&&(e.GBs(I.iy,5),e.GBs(F.B4,5)),2&i){let r;e.mGM(r=e.lsd())&&(n._paginator=r.first),e.mGM(r=e.lsd())&&(n._sort=r.first)}},standalone:!0,features:[e.aNF],decls:30,vars:13,consts:[["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent",3,"fuseScrollbarOptions"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","","routerLink","/modules/warehouse/receptions/new",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto","sm:mb-18"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","receptions-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"text-center"],[1,"text-end"],[1,"border-b","first-letter:z-10","-mb-1","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","text-swamp-200","bg-gray-50","dark:bg-slate-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","receptions-grid","md:px-8"],[1,"font-mono","text-center"],[1,"font-mono","text-end"],[1,"flex","flex-row","flex-wrap","justify-center","gap-3"],["mat-stroked-button","","matTooltip","Informe de Recepci\xf3n",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(i,n){if(1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",5),e.nrm(8,"mat-icon",6),e.j41(9,"a",7),e.EFF(10,"Almac\xe9n"),e.k0s()(),e.j41(11,"div",5),e.nrm(12,"mat-icon",6),e.j41(13,"a",7),e.EFF(14,"Recepciones"),e.k0s()()(),e.j41(15,"div",8)(16,"h2",9),e.EFF(17," Registro de Recepciones "),e.k0s()()(),e.j41(18,"div",10)(19,"mat-form-field",11),e.nrm(20,"mat-icon",12)(21,"input",13),e.k0s(),e.j41(22,"button",14),e.nrm(23,"mat-icon",15),e.j41(24,"span",16),e.EFF(25,"Agregar"),e.k0s()()()(),e.j41(26,"div",17)(27,"div",18),e.DNE(28,fc,2,1),e.nI1(29,"async"),e.k0s()()()),2&i){let r;e.Y8G("fuseScrollbarOptions",e.lJ4(12,ac)),e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),e.R7$(2),e.Y8G("svgIcon","mat_solid:add"),e.R7$(5),e.vxM(28,(r=e.bMT(29,10,n.receptions$))?28:-1,r)}},dependencies:[p.Jj,p.oe,p.vh,v.Hl,v.$z,m.RG,m.rl,m.JW,C.m_,C.An,k.fS,k.fg,I.Ou,I.iy,F.NQ,F.B4,p.YU,a.X1,a.me,a.BC,a.l_,g.Wk,H.p],encapsulation:2,changeDetection:0})}return o})(),_c=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["warehouse-receptions"]],standalone:!0,features:[e.aNF],decls:1,vars:0,template:function(i,n){1&i&&e.nrm(0,"router-outlet")},dependencies:[g.n3],encapsulation:2})}return o})();var vc=d(65571);const ht=o=>o.stocks,bc=(0,S.Mz)(ht,o=>o.stock),so=(0,S.Mz)(ht,o=>o.stocks),ft=(0,S.Mz)(ht,o=>o.subStocks),Cc=["searchDepotInput"],gt=(o,s)=>s.id;function Fc(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-option",29),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.addDepot(n))}),e.EFF(1),e.k0s()}if(2&o){const t=s.$implicit;e.Y8G("value",t.name),e.R7$(),e.SpI(" ",t.name," ")}}function kc(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," El almac\xe9n es obligatorio "),e.k0s())}function xc(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-option",29),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.addProductIdToMovement(n))}),e.j41(1,"div",30)(2,"span",31),e.EFF(3),e.k0s(),e.j41(4,"div",32)(5,"span",33),e.EFF(6),e.k0s()()()()}if(2&o){const t=s.$implicit;e.Y8G("value",t),e.R7$(3),e.JRh(t.name),e.R7$(3),e.Lme("",t.quantity," ",t.uom,"")}}function yc(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," El producto es obligatorio "),e.k0s())}function Sc(o,s){1&o&&(e.j41(0,"mat-option",17),e.EFF(1," Inventario inicial "),e.k0s()),2&o&&e.Y8G("value","inicial")}function Ic(o,s){1&o&&(e.j41(0,"mat-option",17),e.EFF(1," Por ajuste de inventario "),e.k0s()),2&o&&e.Y8G("value","ajuste")}function Rc(o,s){1&o&&(e.j41(0,"mat-option",17),e.EFF(1," Por gasto "),e.k0s()),2&o&&e.Y8G("value","gasto")}function Ec(o,s){1&o&&(e.j41(0,"mat-option",17),e.EFF(1," Por activo fijo tangible "),e.k0s()),2&o&&e.Y8G("value","activo")}function $c(o,s){1&o&&(e.j41(0,"mat-option",23),e.EFF(1," Por merma del producto "),e.k0s()),2&o&&e.Y8G("value","averia")}function jc(o,s){1&o&&(e.j41(0,"mat-option",23),e.EFF(1," Por promoci\xf3n del proveedor "),e.k0s()),2&o&&e.Y8G("value","promocion")}function Dc(o,s){1&o&&(e.j41(0,"mat-option",23),e.EFF(1," Por compra de mercanc\xedas "),e.k0s()),2&o&&e.Y8G("value","compra")}function wc(o,s){1&o&&(e.j41(0,"mat-option",23),e.EFF(1," Por venta de mercanc\xedas "),e.k0s()),2&o&&e.Y8G("value","venta")}function Mc(o,s){1&o&&(e.j41(0,"mat-option",23),e.EFF(1," Movimiento entre almacenes "),e.k0s()),2&o&&e.Y8G("value","between")}function Gc(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," El motivo es obligatorio "),e.k0s())}function Tc(o,s){if(1&o&&(e.j41(0,"mat-error"),e.EFF(1),e.k0s()),2&o){const t=e.XpG();e.R7$(),e.SpI(" La cantidad debe ser mayor que ",t.selectedProduct.inStock?0:.1," ")}}function Pc(o,s){if(1&o&&(e.j41(0,"mat-error"),e.EFF(1),e.k0s()),2&o){const t=e.XpG();e.R7$(),e.SpI(" La cantidad debe ser menor que ","salida"===t.movementType?t.selectedSubStock?t.selectedSubStock.quantity:t.selectedProduct.quantity:999999," ")}}function Ac(o,s){if(1&o&&(e.j41(0,"mat-hint"),e.EFF(1),e.k0s()),2&o){const t=e.XpG();e.R7$(),e.SpI("Cantidades menores o iguales a ",t.selectedSubStock?t.selectedSubStock.quantity:t.selectedProduct.quantity,"")}}function Bc(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-option",29),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.addStockToForm(n))}),e.j41(1,"div",34)(2,"span",33),e.EFF(3),e.k0s(),e.j41(4,"span",33),e.EFF(5),e.nI1(6,"date"),e.k0s(),e.j41(7,"span",33),e.EFF(8),e.nI1(9,"number"),e.k0s()()()}if(2&o){const t=s.$implicit;e.Y8G("value",t),e.R7$(3),e.JRh(null!=t&&null!=t.purchase&&t.purchase.voucherNo?t.purchase.voucherNo:"-"),e.R7$(2),e.JRh(e.i5U(6,4,t.createdAt,"dd/MM/yyyy HH:mm")),e.R7$(3),e.JRh(e.i5U(9,7,t.quantity,"1.2-2"))}}function Wc(o,s){1&o&&(e.j41(0,"mat-error"),e.EFF(1," El producto es obligatorio "),e.k0s())}function Nc(o,s){if(1&o&&(e.j41(0,"div",19)(1,"mat-form-field",20)(2,"mat-label"),e.EFF(3,"Compra"),e.k0s(),e.nrm(4,"mat-icon",14)(5,"input",15),e.j41(6,"mat-autocomplete",21,4),e.Z7z(8,Bc,10,10,"mat-option",17,gt),e.nI1(10,"async"),e.k0s(),e.DNE(11,Wc,2,0,"mat-error"),e.k0s()()),2&o){const t=e.sdS(7),i=e.XpG();e.R7$(4),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",i.searchSubStockControl)("matAutocomplete",t)("placeholder","Buscar productos"),e.R7$(),e.Y8G("displayWith",i.displayFn),e.R7$(2),e.Dyx(e.bMT(10,6,i.subStockFiltered)),e.R7$(3),e.vxM(11,i.movementForm.get("stockId").hasError("required")?11:-1)}}const ro={name:"",quantity:0,inStock:!0,countSubStocks:0};let Vc=(()=>{class o{constructor(t){this.data=t,this.searchDepotsControl=new a.MJ(null,[a.k0.required]),this.searchProductInStockControl=new a.MJ(null,[a.k0.required]),this.searchSubStockControl=new a.MJ(null),this.selectedDepotName="",this.selectedProduct=ro,this.selectedSubStock=null,this._changeDetectorRef=(0,e.WQX)(e.gRc),this._depotsService=(0,e.WQX)(ue.t),this._dialogRef=(0,e.WQX)(X.CP),this._formBuilder=(0,e.WQX)(a.ok),this._fuseConfirmationService=(0,e.WQX)(ae.G),this._movementsService=(0,e.WQX)(Ue),this._snackBar=(0,e.WQX)(O.UG),this._stocksService=(0,e.WQX)(pe.t),this._unsubscribeAll=new j.B,this.store=(0,e.WQX)(S.il)}ngOnInit(){this.movementForm=this._formBuilder.group({id:new a.MJ,productId:new a.MJ(null,[a.k0.required]),reason:new a.MJ(null,[a.k0.required]),quantity:new a.MJ(0,[a.k0.min(0),a.k0.max(9999999)]),observation:new a.MJ(""),depotId:new a.MJ(null,[a.k0.required]),stockId:new a.MJ(null),purchaseId:new a.MJ(null)}),N.H.IsNullOrEmpty(this.data.subStock)?this.store.dispatch((0,ge.DC)()):(this.searchSubStockControl.setValue(this.data.subStock),this.movementForm.get("reason").setValue($.aY.ajuste),this.movementForm.get("stockId").setValue(this.data.subStock.id),this.movementForm.get("purchaseId").setValue(this.data.subStock.purchaseId),this.selectedSubStock=this.data.subStock),this.productsInStock$=this.store.select(Ce.IP),this.subStocks$=this.store.select(ft),this.depotsFiltered=this.searchDepotsControl.valueChanges.pipe((0,f.B)(200),(0,x.Z)(null),(0,L.Z)(t=>null!==t&&"string"==typeof t&&t!==this.selectedDepotName?this._depotsService.findActiveDepots(t.trim()):N.H.IsNullOrEmpty(this.depots$)||!this.data.stock?this._depotsService.findActiveDepots(""):this.depots$)),this.depotsFiltered.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.depots$=(0,E.of)(t)}),this.productsInStockFiltered=this.searchProductInStockControl.valueChanges.pipe((0,f.B)(200),(0,x.Z)(null),(0,L.Z)(t=>{"string"!=typeof t&&(t=t?.name);const i=this.movementForm.get("depotId").value;return!N.H.IsNullOrEmpty(t)&&"string"==typeof t&&i&&this.selectedProduct.name!==t?this._stocksService.getProductsInStockByDepot(i,t.trim()):this.productsInStock$})),this.subStockFiltered=this.searchSubStockControl.valueChanges.pipe((0,f.B)(200),(0,x.Z)(null),(0,L.Z)(t=>{const i=this.movementForm.get("depotId").value,n=this.movementForm.get("productId").value;return null!==t&&"string"==typeof t&&i?this._stocksService.findSubStocks(0,100,"updatedAt","asc",t,i,n,!1,!1).pipe((0,b.T)(r=>r.stocks)):this.subStocks$})),this.subStockFiltered.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.subStocks$=(0,E.of)(t)}),this.data.stock&&(this.movementForm.get("depotId").setValue(this.data.stock.depotId),this.movementForm.get("productId").setValue(this.data.stock.productId),this.selectedDepotName=this.data.stock.depot.name,this.selectedProduct={name:this.data.stock.product.name,inStock:!0,quantity:this.data.stock.quantity,countSubStocks:this.data.stock.countSubStocks},this.searchDepotsControl.setValue(this.data.stock.depot.name),this.searchProductInStockControl.setValue(this.data.stock),this._changeDetectorRef.markForCheck())}ngAfterViewInit(){N.H.IsNullOrEmpty(this.data.stock)||setTimeout(()=>{this.searchDepotInput.nativeElement.blur(),this.autocomplete&&this.autocomplete.closePanel()},200)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this.store.dispatch((0,ge.DC)())}closeDialog(){this._dialogRef.close()}reasonChange(t){const i=t.value;switch(this.selectedSubStock=null,i===$.aY.ajuste?this.selectedProduct.countSubStocks>1&&(this.movementForm.get("stockId").setValidators([a.k0.required]),this.searchSubStockControl.setValidators([a.k0.required]),this.movementForm.get("stockId").reset(),setTimeout(()=>{this.searchSubStockControl.setValue(""),this._changeDetectorRef.markForCheck()},300)):(this.movementForm.get("stockId").clearValidators(),this.searchSubStockControl.clearValidators(),this.movementForm.get("stockId").reset(),this.searchSubStockControl.reset()),i){case $.aY.inicial:case $.aY.ajuste:case $.aY.compra:this.movementType=$.UB.entrada,this.movementForm.get("quantity").setValidators([a.k0.required,a.k0.min(this.selectedProduct.inStock?0:.1),a.k0.max(999999)]);break;case $.aY.promocion:case $.aY.averia:case $.aY.venta:case $.aY.between:case $.aY.gasto:case $.aY.activo:this.movementType=$.UB.salida,this.movementForm.get("quantity").setValidators([a.k0.required,a.k0.min(.1),a.k0.max(this.selectedSubStock?this.selectedSubStock.quantity:this.selectedProduct.quantity)])}this._changeDetectorRef.markForCheck()}addDepot(t){this.selectedDepotName=t.name,this.movementForm.get("depotId").setValue(t.id),this._stocksService.getProductsInStockByDepot(t.id,"").pipe((0,u.Q)(this._unsubscribeAll)).subscribe(),this.movementForm.get("depotId").setValue(t.id),this.movementForm.get("productId").setValue(null),this.searchProductInStockControl.setValue(null),this.selectedProduct=ro,this.selectedSubStock=null,this._changeDetectorRef.markForCheck()}addProductIdToMovement(t){this.selectedProduct=t,this.selectedSubStock=null,this.movementForm.get("productId").setValue(t.productId),this.movementForm.get("reason").reset(),this.store.dispatch((0,ge.DC)()),this._changeDetectorRef.markForCheck()}addStockToForm(t){this.movementForm.get("stockId").setValue(t.id),this.movementForm.get("purchaseId").setValue(t.purchaseId),this.selectedSubStock=t,this._changeDetectorRef.markForCheck()}createMovement(){if(this.searchDepotsControl.invalid||this.searchProductInStockControl.invalid||this.searchSubStockControl.invalid)return;let t=this.movementForm.getRawValue();t.quantity=Number(t.quantity.toFixed(4));let i=t.quantity;if(t.reason===$.aY.ajuste){let c=0;c=this.selectedSubStock?this.selectedSubStock.quantity:this.selectedProduct.quantity,c<t.quantity?(i=t.quantity-c,this.movementType=$.UB.entrada):(i=c-t.quantity,this.movementType=$.UB.salida)}let n=null,r=null;this.movementType===$.UB.entrada&&(n=t.depotId),this.movementType===$.UB.salida&&(r=t.depotId),delete t.id,delete t.depotId,t={...t,depotEndId:n,depotInitId:r},this._fuseConfirmationService.open({title:`Registrar ${this.movementType}`,message:`\xbfEst\xe1 seguro desea realizar un movimiento por\n            ${i} ${this.selectedProduct.name.toLowerCase()}s?`,icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,u.Q)(this._unsubscribeAll)).subscribe(c=>{"confirmed"===c&&this._movementsService.createMovement(t).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(({data:h})=>{h&&(this._snackBar.openFromComponent(T.p,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:"Movimiento registrado correctamente",type:"success",svgIcon:"mat_solid:done"}}),this.closeDialog())})})}displayFn(t){return N.H.IsNullOrEmpty(t)?"":`${t?.purchase?.voucherNo?t.purchase.voucherNo:"-"}      ${G(t.createdAt).format("DD/MM/yyyy HH:mm")}        ${t.quantity.toFixed(2)}`}productInStockDisplayFn(t){return N.H.IsNullOrEmpty(t)?"":N.H.IsNullOrEmpty(t.name)?`${t.product.name} - ${t.quantity.toFixed(2)} ${t.product.uom.abbr}`:`${t.name} - ${t.quantity.toFixed(2)} ${t.uom}`}static#e=this.\u0275fac=function(i){return new(i||o)(e.rXU(X.Vh))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["movement-dialog"]],viewQuery:function(i,n){if(1&i&&(e.GBs(Cc,5),e.GBs(D.pN,5)),2&i){let r;e.mGM(r=e.lsd())&&(n.searchDepotInput=r.first),e.mGM(r=e.lsd())&&(n.autocomplete=r.first)}},standalone:!0,features:[e.aNF],decls:72,vars:43,consts:[["searchDepotInput",""],["depotsInitAutocomplete","matAutocomplete"],["productsAutocomplete","matAutocomplete"],["reason",""],["subStockAutocomplete","matAutocomplete"],[1,"relative","flex","flex-col","w-full","h-full","max-h-screen"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["mat-dialog-title","",1,"text-2xl","font-semibold","text-gray-400"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6"],[1,"w-full","overflow-hidden"],[1,"flex","border-t"],[1,"grid","w-full","gap-3","pt-8","sm:grid-cols-2","sm:gap-5",3,"formGroup","autocomplete"],[1,"sm:col-span-2","sm:px-4"],["appearance","fill",1,"w-full","fuse-mat-no-subscript"],["matPrefix","",3,"svgIcon"],["type","text","matInput","","required","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete"],[3,"value"],[1,"grid","w-full","gap-3","sm:grid-cols-2","sm:px-4","sm:col-span-2"],[1,"sm:col-span-2"],[1,"w-full","fuse-mat-no-subscript"],[1,"ath-autocomplete",3,"displayWith"],[3,"selectionChange","formControlName","required"],["disabled","",3,"value"],["matInput","","type","number",3,"formControlName","min","max","required"],["matInput","",3,"formControlName","required","placeholder"],[1,"flex","items-center","justify-center","w-full","px-8","py-4","sm:justify-end","bg-gray-50","dark:bg-black/10"],["mat-button","",1,"-ml-4",3,"click","color"],["mat-flat-button","",3,"click","disabled","color"],[3,"click","value"],[1,"grid","grid-cols-6","w-52","sm:w-120","lg:w-128"],[1,"col-span-5","truncate"],[1,"flex","justify-end","col-span-1"],[1,""],[1,"grid","grid-cols-3","w-full"]],template:function(i,n){if(1&i){const r=e.RV6();e.j41(0,"div",5),e.qex(1),e.j41(2,"div",6)(3,"span",7),e.EFF(4,"Registrar movimiento"),e.k0s()(),e.bVm(),e.j41(5,"div",8),e.qex(6),e.j41(7,"div",9)(8,"div",10)(9,"form",11)(10,"div",12)(11,"mat-form-field",13)(12,"mat-label"),e.EFF(13,"Almac\xe9n"),e.k0s(),e.nrm(14,"mat-icon",14)(15,"input",15,0),e.j41(17,"mat-autocomplete",16,1),e.Z7z(19,Fc,2,2,"mat-option",17,gt),e.nI1(21,"async"),e.k0s(),e.DNE(22,kc,2,0,"mat-error"),e.k0s()(),e.j41(23,"div",18)(24,"div",19)(25,"mat-form-field",20)(26,"mat-label"),e.EFF(27,"Producto"),e.k0s(),e.nrm(28,"mat-icon",14)(29,"input",15),e.j41(30,"mat-autocomplete",21,2),e.Z7z(32,xc,7,4,"mat-option",17,gt),e.nI1(34,"async"),e.k0s(),e.DNE(35,yc,2,0,"mat-error"),e.k0s()(),e.j41(36,"div")(37,"mat-form-field",20)(38,"mat-label"),e.EFF(39,"Motivo"),e.k0s(),e.j41(40,"mat-select",22,3),e.bIt("selectionChange",function(c){return e.eBV(r),e.Njj(n.reasonChange(c))}),e.DNE(42,Sc,2,1,"mat-option",17)(43,Ic,2,1,"mat-option",17)(44,Rc,2,1,"mat-option",17)(45,Ec,2,1,"mat-option",17)(46,$c,2,1,"mat-option",23)(47,jc,2,1,"mat-option",23)(48,Dc,2,1,"mat-option",23)(49,wc,2,1,"mat-option",23)(50,Mc,2,1,"mat-option",23),e.k0s(),e.DNE(51,Gc,2,0,"mat-error"),e.k0s()(),e.j41(52,"div")(53,"mat-form-field",20)(54,"mat-label"),e.EFF(55,"Cantidad de movimiento"),e.k0s(),e.nrm(56,"input",24),e.DNE(57,Tc,2,1,"mat-error")(58,Pc,2,1,"mat-error")(59,Ac,2,1,"mat-hint"),e.k0s()(),e.DNE(60,Nc,12,8,"div",19),e.k0s(),e.j41(61,"div",12)(62,"mat-form-field",20)(63,"mat-label"),e.EFF(64,"Observaci\xf3n"),e.k0s(),e.nrm(65,"textarea",25),e.k0s()()()()(),e.bVm(),e.k0s(),e.qex(66),e.j41(67,"div",26)(68,"button",27),e.bIt("click",function(){return e.eBV(r),e.Njj(n.closeDialog())}),e.EFF(69,"Cancelar"),e.k0s(),e.j41(70,"button",28),e.bIt("click",function(){return e.eBV(r),e.Njj(n.createMovement())}),e.EFF(71,"Aceptar"),e.k0s()(),e.bVm(),e.k0s()}if(2&i){const r=e.sdS(18),l=e.sdS(31);e.R7$(9),e.Y8G("formGroup",n.movementForm)("autocomplete","off"),e.R7$(5),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.searchDepotsControl)("matAutocomplete",r)("placeholder","Buscar almacenes"),e.R7$(4),e.Dyx(e.bMT(21,39,n.depotsFiltered)),e.R7$(3),e.vxM(22,n.movementForm.get("depotId").hasError("required")?22:-1),e.R7$(6),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.searchProductInStockControl)("matAutocomplete",l)("placeholder","Buscar productos"),e.R7$(),e.Y8G("displayWith",n.productInStockDisplayFn),e.R7$(2),e.Dyx(e.bMT(34,41,n.productsInStockFiltered)),e.R7$(3),e.vxM(35,n.movementForm.get("productId").hasError("required")?35:-1),e.R7$(5),e.Y8G("formControlName","reason")("required",!0),e.R7$(2),e.vxM(42,n.selectedProduct.inStock?-1:42),e.R7$(),e.vxM(43,n.selectedProduct.inStock?43:-1),e.R7$(),e.vxM(44,n.selectedProduct.inStock?44:-1),e.R7$(),e.vxM(45,n.selectedProduct.inStock?45:-1),e.R7$(),e.vxM(46,n.selectedProduct.inStock?46:-1),e.R7$(),e.vxM(47,n.selectedProduct.inStock?47:-1),e.R7$(),e.vxM(48,n.selectedProduct.inStock?48:-1),e.R7$(),e.vxM(49,n.selectedProduct.inStock?49:-1),e.R7$(),e.vxM(50,n.selectedProduct.inStock?50:-1),e.R7$(),e.vxM(51,n.movementForm.get("reason").hasError("required")?51:-1),e.R7$(5),e.Y8G("formControlName","quantity")("min",n.selectedProduct.inStock?0:.1)("max","salida"===n.movementType?n.selectedSubStock?n.selectedSubStock.quantity:n.selectedProduct.quantity:999999)("required",!0),e.R7$(),e.vxM(57,n.movementForm.get("quantity").hasError("min")?57:-1),e.R7$(),e.vxM(58,n.movementForm.get("quantity").hasError("max")?58:-1),e.R7$(),e.vxM(59,"salida"===n.movementType&&"ajuste"!==n.movementForm.get("reason").value?59:-1),e.R7$(),e.vxM(60,n.selectedProduct.countSubStocks>1&&"ajuste"===n.movementForm.get("reason").value?60:-1),e.R7$(5),e.Y8G("formControlName","observation")("required",!1)("placeholder","Observaci\xf3n"),e.R7$(3),e.Y8G("color","warn"),e.R7$(2),e.Y8G("disabled",n.movementForm.invalid||n.searchDepotsControl.invalid||n.searchProductInStockControl.invalid||n.searchSubStockControl.invalid)("color","primary")}},dependencies:[p.Jj,D.jL,D.$3,oe.wT,D.pN,v.Hl,v.$z,X.hM,X.BI,m.RG,m.rl,m.nJ,m.MV,m.TL,m.JW,C.m_,C.An,k.fS,k.fg,Z.Ve,Z.VO,a.X1,a.qT,a.me,a.Q0,a.BC,a.cb,a.YS,a.VZ,a.zX,a.l_,a.j4,a.JD,p.QX,p.vh],encapsulation:2,changeDetection:0})}return o})();const Yc=(o,s)=>s.id,zc=()=>({wheelPropagation:!1}),Lc=()=>[null,null],Qc=(o,s)=>({"pointer-events-none":o,hidden:s}),qc=()=>[25,50,100],Xc=o=>({$implicit:o}),Oc=(o,s,t)=>({"bg-green-100":o,"bg-orange-200":s,"bg-red-200":t}),Uc=o=>({"height.%":o}),Hc=(o,s,t,i,n,r)=>({"bg-green-600 animate-pulse":o,"bg-green-400":s,"bg-orange-600":t,"bg-orange-400":i,"bg-red-600":n,"bg-red-400":r});function Jc(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-option",34),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.addDepot(n))}),e.EFF(1),e.k0s()}if(2&o){const t=s.$implicit;e.Y8G("value",t.name),e.R7$(),e.SpI(" ",t.name," ")}}function Zc(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-icon",35),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.resetDepot())}),e.k0s()}}function Kc(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-option",34),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.addProduct(n))}),e.EFF(1),e.k0s()}if(2&o){const t=s.$implicit;e.Y8G("value",t.name),e.R7$(),e.SpI(" ",t.name," ")}}function ed(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-icon",35),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.resetProduct())}),e.k0s()}}function td(o,s){if(1&o&&e.nrm(0,"mat-icon",51),2&o){let t;const i=e.XpG().$implicit,n=e.XpG(4);e.Y8G("svgIcon",(null==(t=n.selectedStock())?null:t.id)===i.id?"mat_solid:expand_more":"mat_solid:expand_less")}}function od(o,s){1&o&&e.nrm(0,"mat-spinner",52),2&o&&e.Y8G("diameter",20)}function id(o,s){1&o&&e.eu8(0)}function nd(o,s){if(1&o&&(e.j41(0,"div",54),e.DNE(1,id,1,0,"ng-container",55),e.k0s()),2&o){const t=e.XpG().$implicit;e.XpG(4);const i=e.sdS(62);e.R7$(),e.Y8G("ngTemplateOutlet",i)("ngTemplateOutletContext",e.eq3(2,Xc,t))}}function sd(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",43)(1,"div",44),e.EFF(2),e.k0s(),e.j41(3,"div",39),e.EFF(4),e.k0s(),e.j41(5,"div",44),e.EFF(6),e.k0s(),e.j41(7,"div",45)(8,"span",46),e.EFF(9),e.nI1(10,"number"),e.k0s(),e.j41(11,"span",47),e.EFF(12),e.k0s()(),e.j41(13,"div",48),e.EFF(14),e.nI1(15,"date"),e.k0s(),e.j41(16,"div",49)(17,"button",50),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(4);return e.Njj(r.toggleDetails(n))}),e.DNE(18,td,1,1,"mat-icon",51)(19,od,1,1,"mat-spinner",52),e.k0s(),e.j41(20,"button",53),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(4);return e.Njj(r.viewStowageCard(n))}),e.nrm(21,"mat-icon",51),e.k0s(),e.j41(22,"button",53),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(4);return e.Njj(r.openDialog(n))}),e.nrm(23,"mat-icon",51),e.k0s()()(),e.DNE(24,nd,2,4,"div",54)}if(2&o){let t,i,n;const r=s.$implicit,l=e.XpG(4);e.R7$(2),e.SpI(" ",r.product.name," "),e.R7$(2),e.SpI(" ",null==r||null==r.product||null==r.product.brand?null:r.product.brand.name," "),e.R7$(2),e.SpI(" ",r.depot.name," "),e.R7$(3),e.JRh(e.i5U(10,12,r.quantity,"1.2-2")),e.R7$(3),e.JRh(null==r||null==r.product||null==r.product.uom?null:r.product.uom.abbr),e.R7$(2),e.SpI(" ",e.i5U(15,15,r.updatedAt,"dd/MM/yyyy HH:mm")," "),e.R7$(3),e.Y8G("disabled",r.countSubStocks<2||0===r.quantity),e.R7$(),e.vxM(18,(null==(t=l.selectedStock())?null:t.id)===r.id&&l.subStocksIsLoading()?-1:18),e.R7$(),e.vxM(19,l.subStocksIsLoading()&&(null==(i=l.selectedStock())?null:i.id)===r.id?19:-1),e.R7$(2),e.Y8G("svgIcon","mat_solid:plagiarism"),e.R7$(2),e.Y8G("svgIcon","mat_solid:swap_horiz"),e.R7$(),e.vxM(24,(null==(n=l.selectedStock())?null:n.id)===r.id&&l.selectedSubStocks().length>0?24:-1)}}function rd(o,s){1&o&&e.Z7z(0,sd,25,18,null,null,e.BUC().trackByFn,!0),2&o&&e.Dyx(s)}function ad(o,s){if(1&o&&(e.j41(0,"div",36)(1,"div",37)(2,"div",38)(3,"span"),e.EFF(4,"Producto"),e.k0s()(),e.j41(5,"div",39),e.EFF(6,"Marca"),e.k0s(),e.j41(7,"div",39),e.EFF(8,"Almac\xe9n"),e.k0s(),e.j41(9,"div",40)(10,"span"),e.EFF(11,"Cantidad"),e.k0s()(),e.j41(12,"div",40),e.EFF(13,"Fecha de Actualizaci\xf3n "),e.k0s(),e.j41(14,"div",41),e.EFF(15,"Acciones"),e.k0s()(),e.DNE(16,rd,2,0),e.nI1(17,"async"),e.nrm(18,"mat-paginator",42),e.k0s()),2&o){let t;const i=e.XpG(2);e.R7$(2),e.Y8G("mat-sort-header","product.name"),e.R7$(7),e.Y8G("mat-sort-header","quantity"),e.R7$(3),e.Y8G("mat-sort-header","updatedAt"),e.R7$(4),e.vxM(16,(t=e.bMT(17,10,i.stocks$))?16:-1,t),e.R7$(2),e.Y8G("ngClass",e.l_i(12,Qc,i.isLoading,i.pagination.length<10&&i.pagination.page<1))("length",i.pagination.length)("pageIndex",i.pagination.page)("pageSize",i.pagination.size)("pageSizeOptions",e.lJ4(15,qc))("showFirstLastButtons",!0)}}function ld(o,s){1&o&&(e.j41(0,"div",56),e.EFF(1,"\xa1No se han encontrado productos en el inventario!"),e.k0s())}function cd(o,s){1&o&&e.DNE(0,ad,19,16,"div",36)(1,ld,2,0),2&o&&e.vxM(0,s.length>0?0:1)}function dd(o,s){1&o&&e.nrm(0,"div",65)}function ud(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",61)(1,"div",44),e.EFF(2),e.k0s(),e.j41(3,"div",39),e.EFF(4),e.nI1(5,"date"),e.k0s(),e.j41(6,"div",62),e.nI1(7,"number"),e.j41(8,"div",63),e.EFF(9),e.nI1(10,"number"),e.k0s(),e.j41(11,"div",64),e.DNE(12,dd,1,0,"div",65),e.k0s()(),e.j41(13,"div",62),e.nI1(14,"number"),e.j41(15,"div",63),e.EFF(16),e.nI1(17,"number"),e.k0s(),e.j41(18,"div",66),e.nrm(19,"div",67),e.k0s()(),e.j41(20,"div",68)(21,"button",53),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.openDialog(r.selectedStock(),n))}),e.nrm(22,"mat-icon",51),e.k0s()()()}if(2&o){const t=s.$implicit;e.R7$(2),e.SpI(" ",(null==t||null==t.purchase?null:t.purchase.voucherNo)||"-"," "),e.R7$(2),e.SpI(" ",e.i5U(5,11,null==t?null:t.createdAt,"dd/MM/yyyy HH:mm a")," "),e.R7$(2),e.Y8G("matTooltip",(t.purchasedQuantity%1!=0?e.i5U(7,14,t.purchasedQuantity,"1.2-2"):t.purchasedQuantity)+" comprados"),e.R7$(3),e.JRh(t.purchasedQuantity%1!=0?e.i5U(10,17,t.purchasedQuantity,"1.2-2"):t.purchasedQuantity),e.R7$(3),e.vxM(12,t.purchasedQuantity>0?12:-1),e.R7$(),e.Y8G("matTooltip",(t.quantity%1!=0?e.i5U(14,20,t.quantity,"1.2-2"):t.quantity)+" disponibles"),e.R7$(3),e.JRh(t.quantity%1!=0?e.i5U(17,23,t.quantity,"1.2-2"):t.quantity),e.R7$(2),e.Y8G("ngClass",e.sMw(26,Oc,t.quantity>=t.purchasedQuantity,t.quantity/t.purchasedQuantity*100>=50&&t.quantity/t.purchasedQuantity*100<99,t.quantity/t.purchasedQuantity*100>=0&&t.quantity/t.purchasedQuantity*100<50)),e.R7$(),e.Y8G("ngStyle",e.eq3(30,Uc,t.quantity>t.purchasedQuantity?100:t.quantity/t.purchasedQuantity*100))("ngClass",e.l4e(32,Hc,t.quantity>t.purchasedQuantity,t.quantity/t.purchasedQuantity*100>=99,t.quantity/t.purchasedQuantity*100>=50&&t.quantity/t.purchasedQuantity*100<=70,t.quantity/t.purchasedQuantity*100>70&&t.quantity/t.purchasedQuantity*100<99,t.quantity/t.purchasedQuantity*100>=0&&t.quantity/t.purchasedQuantity*100<=20,t.quantity/t.purchasedQuantity*100>20&&t.quantity/t.purchasedQuantity*100<50)),e.R7$(3),e.Y8G("svgIcon","mat_solid:swap_horiz")}}function md(o,s){if(1&o&&(e.j41(0,"div",57)(1,"div",58)(2,"div"),e.EFF(3,"N\xfamero de Compra"),e.k0s(),e.j41(4,"div",59)(5,"span"),e.EFF(6,"Fecha"),e.k0s()(),e.j41(7,"div",59)(8,"span"),e.EFF(9,"Comprado"),e.k0s()(),e.j41(10,"div",59)(11,"span"),e.EFF(12,"Disponible"),e.k0s()(),e.j41(13,"div",60),e.EFF(14,"Ajuste"),e.k0s()(),e.Z7z(15,ud,23,39,"div",61,Yc),e.k0s()),2&o){const t=e.XpG();e.R7$(15),e.Dyx(t.selectedSubStocks())}}B.vfs=A.b.vfs;let pd=(()=>{class o{constructor(){this.availability=null,this.isLoading=!1,this.merchant=null,this.selectedDepot=null,this.selectedProduct=null,this.stocks=[],this.user=null,this.searchDepotsControl=new a.MJ(null),this.searchInputControl=new a.MJ(null),this.searchProductsControl=new a.MJ(null),this.stocks$=(0,E.of)([]),this.selectedStock=(0,e.vPA)(null),this.selectedSubStocks=(0,e.vPA)([]),this.subStocksIsLoading=(0,e.vPA)(!1),this._changeDetectorRef=(0,e.WQX)(e.gRc),this._depotsService=(0,e.WQX)(ue.t),this._documentsService=(0,e.WQX)(xe.Q),this._dialog=(0,e.WQX)(X.bZ),this._stocksService=(0,e.WQX)(pe.t),this._unsubscribeAll=new j.B,this.store=(0,e.WQX)(S.il)}ngOnInit(){this.store.select(re.SW).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(fe.Xb).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.stocks$=this.store.select(so),this.stocks$.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.stocks=t,this._changeDetectorRef.markForCheck()}),this.store.select(se.Dz).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,u.Q)(this._unsubscribeAll),(0,f.B)(300),(0,x.Z)(null),(0,_.n)(t=>null!==t?(this.isLoading=!0,this._stocksService.getStocks(this.pagination.page,this.pagination.size,"updatedAt","desc",t,this.selectedDepot?this.selectedDepot.id:null,this.selectedProduct?this.selectedProduct.id:null)):(0,E.of)()),(0,b.T)(()=>{this.isLoading=!1})).subscribe(),this.depotsFiltered=this.searchDepotsControl.valueChanges.pipe((0,f.B)(200),(0,x.Z)(null),(0,U.j)(()=>{this.isLoading=!1}),(0,L.Z)(t=>null!==t&&"string"==typeof t&&(this.selectedDepot&&t!==this.selectedDepot.name||!this.selectedDepot)?(this.isLoading=!0,this._depotsService.findActiveDepots(t.trim())):(0,E.of)())),this.productsFiltered=this.searchProductsControl.valueChanges.pipe((0,f.B)(200),(0,x.Z)(null),(0,U.j)(()=>{this.isLoading=!1}),(0,L.Z)(t=>{if(null!==t&&"string"==typeof t&&(this.selectedProduct&&t!==this.selectedProduct.name||!this.selectedProduct)){this.isLoading=!0;const i=this.selectedDepot?this.selectedDepot.id:null;return this._stocksService.findStockProducts(t.trim(),10,i,this.availability)}return(0,E.of)()})),this.store.select(ft).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.selectedStock()&&this.selectedSubStocks.set(t),N.H.IsNullOrEmpty(t)&&this.selectedStock()&&this.selectedStock.set(null)})}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"updatedAt",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,V.h)(this._sort.sortChange,this._paginator.page).pipe((0,_.n)(()=>(this.isLoading=!0,this._stocksService.getStocks(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,"",this.selectedDepot?this.selectedDepot.id:null,this.selectedProduct?this.selectedProduct.id:null))),(0,b.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this.store.dispatch((0,ge.Rw)()),this.store.dispatch((0,ge.DC)())}viewStowageCard(t){this._stocksService.getStockMovements(t.depotId,t.productId).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(i=>{this._documentsService.generateStowageCardDocument({...t,movements:i},this.merchant,this.user)})}addDepot(t){this.selectedDepot=t,this.selectedProduct=null,this.searchProductsControl.setValue(""),this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}resetDepot(){this.selectedDepot=null,this.searchDepotsControl.setValue(""),this.selectedProduct=null,this.searchProductsControl.setValue("",{emitEvent:!1}),this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addProduct(t){this.selectedProduct=t,this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}resetProduct(){this.selectedProduct=null,this.searchProductsControl.setValue(""),this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}trackByFn(t,i){return t||i.id}openDialog(t,i){this._dialog.open(Vc,{data:{stock:t,subStock:i},panelClass:"ath-dialog-panel",disableClose:!0})}toggleDetails(t){const i=this.selectedStock();i&&i.id===t.id?this.closeDetails():(this.selectedStock.set(t),this.subStocksIsLoading.set(!0),this._stocksService.findSubStocks(0,20,"updatedAt","desc",null,t.depotId,t.productId,!0,!1).pipe((0,u.Q)(this._unsubscribeAll),(0,U.j)(()=>{this.subStocksIsLoading.set(!1)})).subscribe())}closeDetails(){this.store.dispatch((0,ge.DC)()),this.selectedSubStocks.set([])}generateReport(){this._stocksService.findStocks(this.selectedDepot?.id,this.selectedProduct?.id,this.availability).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{t=t.sort((n,r)=>n.product.name.localeCompare(r.product.name));let i="Inventario ";null!==this.availability&&(i+=this.availability?"disponible":"agotado"),this.selectedDepot&&(i+=` para ${this.selectedDepot.name}`),this.selectedProduct&&(i+=` de ${this.selectedProduct.name}`),this.generatePDF("open",i,t)})}generatePDF(t="open",i,n){const r={header:{text:i.toLocaleUpperCase(),style:"header",marginTop:5},content:[{lineHeight:1.3,table:{headerRows:1,widths:[75,"*",120,40,50,50,50],body:[[{text:"UPC",style:"table_header"},{text:"Producto",style:"table_header"},{text:"Almac\xe9n",style:"table_header"},{text:"U/M",style:"table_header"},{text:"Costo",style:"table_header"},{text:"P.Venta",style:"table_header"},{text:"Stock",style:"table_header"}],...n.map(l=>[{style:"table_body",text:l.product.upc,alignment:"center"},{style:"table_body",text:l.product.name},{style:"table_body",text:l.depot.name,alignment:"center"},{style:"table_body",text:l.product?.uom?.abbr,alignment:"center"},{style:"table_body",text:l.product.cost.toFixed(2),alignment:"center"},{style:"table_body",text:l.product.price.toFixed(2),alignment:"center"},{style:"table_body",text:l.quantity,alignment:"center"}])]},layout:"lightHorizontalLines"}],footer:(l,c)=>({table:{widths:["*","*"],body:[[{text:`Reporte generador por: ${this.user.fullname} | Esta informaci\xf3n es exclusiva de ${this.merchant.name}`,bold:!0,fontSize:8},{text:`P\xe1gina ${l.toString()}/${c} - Fecha de impresi\xf3n ${G().format("DD/MM/yyyy HH:mm:ss")}`,bold:!0,fontSize:8,alignment:"right"}]]},margin:[30,0,30,0],layout:"noBorders",italics:!0}),defaultStyle:{fontSize:12},styles:{header:{fontSize:18,bold:!0,marginBottom:5,alignment:"center",fontFeatures:["c2sc","smcp"]},table_header:{fontSize:11,bold:!0,alignment:"center",fontFeatures:["c2sc","smcp"]},table_body:{fontSize:10}},pageOrientation:"landscape",pageSize:"LETTER",watermark:{text:this.merchant.name,color:"#fff",opacity:.07,angle:-35,bold:!0,italics:!1},info:{title:i,author:`${this.user.fullname}`,creationDate:G().toDate(),modDate:G().toDate(),producer:this.merchant.name}};switch(t){case t="download":B.createPdf(r).download();break;case t="open":B.createPdf(r).open();break;case t="print":B.createPdf(r).print()}}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["warehouse-stocks"]],viewQuery:function(i,n){if(1&i&&(e.GBs(I.iy,5),e.GBs(F.B4,5)),2&i){let r;e.mGM(r=e.lsd())&&(n._paginator=r.first),e.mGM(r=e.lsd())&&(n._sort=r.first)}},standalone:!0,features:[e.aNF],decls:63,vars:32,consts:[["depotsDepotsAutocomplete","matAutocomplete"],["depotsProductsAutocomplete","matAutocomplete"],["itemMenu","matMenu"],["rowDetailsTemplate",""],["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent",3,"fuseScrollbarOptions"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8","md:pb-15","xl:pb-8"],[1,"flex-1","min-w-64"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","flex-wrap","items-center","gap-4","mt-4","md:fixed","md:max-w-1/2","lg:max-w-2/3","xl:max-w-max","md:justify-end","right-4","shrink-0","lg:pt-13","xl:pt-0","xl:mt-0","lg:ml-4"],["appearance","fill",1,"w-full","sm:w-auto","fuse-mat-dense","fuse-mat-no-subscript","mat-fuse-de","fuse-mat-rounded","sm:min-w-72",3,"subscriptSizing"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete"],[3,"value"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer"],["appearance","fill",1,"w-full","sm:w-auto","fuse-mat-dense","fuse-mat-no-subscript","mat-fuse-de","fuse-mat-rounded","sm:min-w-60",3,"subscriptSizing"],["matTooltip","Registros de inventarios con compras","mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"routerLink"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],["matTooltip","Registrar movimientos","mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"click"],[3,"svgIcon"],[1,""],["mat-raised-button","",1,"xl:mr-4","text-white","bg-gradient-to-r","from-yellow-500","to-yellow-600",3,"matMenuTriggerFor"],[1,"sm:hidden",3,"svgIcon"],[3,"xPosition"],["mat-menu-item","",3,"disabled"],["mat-menu-item","",3,"click"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto"],[3,"click","value"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer",3,"click"],[1,"relative","grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","stocks-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"flex","items-center",3,"mat-sort-header"],[1,"text-center"],[1,"flex","justify-center","items-center",3,"mat-sort-header"],[1,"pr-4","text-right"],[1,"border-b","first-letter:z-10","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","text-swamp-200","bg-gray-50","dark:bg-slate-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","stocks-grid","md:px-8"],[1,"truncate"],[1,"flex","flex-row","justify-end","space-x-1"],[1,"font-mono"],[1,"text-xs","text-secondary"],[1,"text-center","min-w-40"],[1,"flex","flex-row","justify-end","gap-2"],["mat-stroked-button","",1,"h-7","min-h-7","min-w-10","px-2","leading-6",3,"click","disabled"],[1,"icon-size-5",3,"svgIcon"],[1,"text-primary",3,"diameter"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"grid","pb-2","bg-card"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"],[1,"flex","flex-col","w-full","shadow","overflow-hidden","border-b"],[1,"z-10","grid","grid-cols-5","gap-4","px-8","py-4","font-semibold","shadow","md:px-14","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"flex","justify-center","items-center"],[1,"pr-6","text-right"],[1,"z-0","grid","grid-cols-5","items-center","gap-4","px-8","py-3","bg-white","border-b","dark:bg-default","md:px-14"],[1,"flex","justify-self-center","text-sm",3,"matTooltip"],[1,"min-w-4"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-green-100","rounded"],[1,"flex","w-full","h-full","bg-green-400"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","rounded",3,"ngClass"],[1,"flex","w-full","bg-orange-400",3,"ngStyle","ngClass"],[1,"flex","justify-end","pr-6"]],template:function(i,n){if(1&i){const r=e.RV6();e.j41(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7)(4,"div")(5,"a",8),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",9),e.nrm(8,"mat-icon",10),e.j41(9,"a",11),e.EFF(10,"Almac\xe9n"),e.k0s()(),e.j41(11,"div",9),e.nrm(12,"mat-icon",10),e.j41(13,"a",11),e.EFF(14,"Inventario"),e.k0s()()(),e.j41(15,"div",12)(16,"h2",13),e.EFF(17," Inventario "),e.k0s()()(),e.j41(18,"div",14)(19,"mat-form-field",15),e.nrm(20,"mat-icon",16)(21,"input",17),e.j41(22,"mat-autocomplete",18,0),e.Z7z(24,Jc,2,2,"mat-option",19,e.fX1),e.nI1(26,"async"),e.k0s(),e.DNE(27,Zc,1,0,"mat-icon",20),e.k0s(),e.j41(28,"mat-form-field",21),e.nrm(29,"mat-icon",16)(30,"input",17),e.j41(31,"mat-autocomplete",18,1),e.Z7z(33,Kc,2,2,"mat-option",19,e.fX1),e.nI1(35,"async"),e.k0s(),e.DNE(36,ed,1,0,"mat-icon",20),e.k0s(),e.j41(37,"button",22)(38,"span",23),e.EFF(39,"Compras"),e.k0s()(),e.j41(40,"button",24),e.bIt("click",function(){return e.eBV(r),e.Njj(n.openDialog(null))}),e.nrm(41,"mat-icon",25),e.j41(42,"span",23),e.EFF(43,"Mover"),e.k0s()(),e.j41(44,"div",26)(45,"button",27),e.nrm(46,"mat-icon",28),e.j41(47,"span",23),e.EFF(48,"Reportes"),e.k0s()(),e.j41(49,"mat-menu",29,2)(51,"button",30),e.nrm(52,"mat-icon",25),e.EFF(53," Pr\xf3ximamente "),e.k0s(),e.j41(54,"button",31),e.bIt("click",function(){return e.eBV(r),e.Njj(n.generateReport())}),e.nrm(55,"mat-icon",25),e.EFF(56," Generar "),e.k0s()()()()(),e.j41(57,"div",32)(58,"div",33),e.DNE(59,cd,2,1),e.nI1(60,"async"),e.k0s()()(),e.DNE(61,md,17,0,"ng-template",null,3,e.C5r)}if(2&i){let r;const l=e.sdS(23),c=e.sdS(32),h=e.sdS(50);e.Y8G("fuseScrollbarOptions",e.lJ4(30,zc)),e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.searchDepotsControl)("matAutocomplete",l)("placeholder","Filtre por Almac\xe9n"),e.R7$(3),e.Dyx(e.bMT(26,24,n.depotsFiltered)),e.R7$(3),e.vxM(27,n.selectedDepot?27:-1),e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.searchProductsControl)("matAutocomplete",c)("placeholder","Filtre por Productos"),e.R7$(3),e.Dyx(e.bMT(35,26,n.productsFiltered)),e.R7$(3),e.vxM(36,n.selectedProduct?36:-1),e.R7$(),e.Y8G("routerLink",e.lJ4(31,Lc)),e.R7$(4),e.Y8G("svgIcon","mat_solid:swap_horiz"),e.R7$(4),e.Y8G("matMenuTriggerFor",h),e.R7$(),e.Y8G("svgIcon","mat_solid:description"),e.R7$(3),e.Y8G("xPosition","before"),e.R7$(2),e.Y8G("disabled",!0),e.R7$(),e.Y8G("svgIcon","mat_solid:description"),e.R7$(3),e.Y8G("svgIcon","mat_solid:description"),e.R7$(4),e.vxM(59,(r=e.bMT(60,28,n.stocks$))?59:-1,r)}},dependencies:[p.Jj,p.vh,a.YN,a.me,a.BC,H.p,D.jL,D.$3,oe.wT,D.pN,v.Hl,v.$z,vc.Vg,m.RG,m.rl,m.JW,m.yw,C.m_,C.An,k.fS,k.fg,Y.Cn,Y.kk,Y.fb,Y.Cp,I.Ou,I.iy,Z.Ve,F.NQ,F.B4,F.aE,p.YU,p.B3,a.X1,a.l_,g.Wk,M.uc,M.oV,Q.D6,Q.LG,p.T3,p.QX],encapsulation:2,changeDetection:0})}return o})();const hd=(o,s)=>s.id,fd=()=>({wheelPropagation:!1}),gd=(o,s)=>({"pointer-events-none":o,hidden:s}),_d=()=>[10,25,50,100];function vd(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",23)(1,"div",21),e.EFF(2),e.k0s(),e.j41(3,"div",25),e.EFF(4),e.nI1(5,"date"),e.k0s(),e.j41(6,"div",22),e.EFF(7),e.k0s(),e.j41(8,"div",26)(9,"button",27),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.viewIncomeReport(n))}),e.nrm(10,"mat-icon",28),e.k0s()()()}if(2&o){const t=s.$implicit;e.R7$(2),e.SpI(" ",t.no," "),e.R7$(2),e.SpI(" ",e.i5U(5,4,t.createdAt,"dd/MM/yyyy hh:mm a")," "),e.R7$(3),e.SpI(" ",t.user.fullname," "),e.R7$(3),e.Y8G("svgIcon","mat_solid:assignment")}}function bd(o,s){if(1&o&&(e.j41(0,"div",19)(1,"div",20)(2,"div",21),e.EFF(3," N\xfamero "),e.k0s(),e.j41(4,"div",21),e.EFF(5," Fecha "),e.k0s(),e.j41(6,"div",22),e.EFF(7," Empleado "),e.k0s(),e.j41(8,"div",21),e.EFF(9," Acciones "),e.k0s()(),e.Z7z(10,vd,11,7,"div",23,hd),e.k0s(),e.nrm(12,"mat-paginator",24)),2&o){const t=e.XpG();e.R7$(10),e.Dyx(t.incomes),e.R7$(2),e.Y8G("ngClass",e.l_i(6,gd,t.isLoading,t.pagination.length<10&&t.pagination.page<1))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.lJ4(9,_d))("showFirstLastButtons",!0)}}function Cd(o,s){1&o&&(e.j41(0,"div",29),e.EFF(1," \xa1No se ha registrado ninguna entrada hasta el momento! "),e.k0s())}let Fd=(()=>{class o{constructor(){this.isLoading=!1,this.incomes=[],this.searchInputControl=new a.MJ(null),this.user=null,this.merchant=null,this._unsubscribeAll=new j.B,this._changeDetectorRef=(0,e.WQX)(e.gRc),this._incomesService=(0,e.WQX)(Xe),this._documentsService=(0,e.WQX)(xe.Q),this.store=(0,e.WQX)(S.il)}ngOnInit(){this.store.select(re.SW).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(fe.Xb).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(se.Dz).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.store.select(qe).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.incomes=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,u.Q)(this._unsubscribeAll),(0,f.B)(300),(0,_.n)(t=>{if(null!==t)return this.isLoading=!0,this._incomesService.getIncomes(0,25,"no","desc",t)}),(0,b.T)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"no",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,V.h)(this._sort.sortChange,this._paginator.page).pipe((0,_.n)(()=>(this.isLoading=!0,this._incomesService.getIncomes(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,b.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}viewIncomeReport(t){this._documentsService.generateIncomeReportDocument(t,this.merchant,this.user)}trackByFn(t,i){return i.id||t}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["warehouse-incomes-list"]],viewQuery:function(i,n){if(1&i&&(e.GBs(I.iy,5),e.GBs(F.B4,5)),2&i){let r;e.mGM(r=e.lsd())&&(n._paginator=r.first),e.mGM(r=e.lsd())&&(n._sort=r.first)}},standalone:!0,features:[e.aNF],decls:30,vars:11,consts:[["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent",3,"fuseScrollbarOptions"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","lg:mt-0","lg:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","","routerLink","/modules/warehouse/incomes/form",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto","sm:mb-18"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","incomes-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"text-center"],[1,"text-left"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","incomes-grid","md:px-8"],[1,"border-b","first-letter:z-10","-mb-1","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","text-swamp-200","bg-gray-50","dark:bg-slate-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"font-mono","text-center"],[1,"flex","flex-row","flex-wrap","justify-center","gap-3"],["mat-stroked-button","","matTooltip","Informe de entrada",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",5),e.nrm(8,"mat-icon",6),e.j41(9,"a",7),e.EFF(10,"Almac\xe9n"),e.k0s()(),e.j41(11,"div",5),e.nrm(12,"mat-icon",6),e.j41(13,"a",7),e.EFF(14,"Entradas"),e.k0s()()(),e.j41(15,"div",8)(16,"h2",9),e.EFF(17," Registro de entradas "),e.k0s()()(),e.j41(18,"div",10)(19,"mat-form-field",11),e.nrm(20,"mat-icon",12)(21,"input",13),e.k0s(),e.j41(22,"button",14),e.nrm(23,"mat-icon",15),e.j41(24,"span",16),e.EFF(25,"Agregar"),e.k0s()()()(),e.j41(26,"div",17)(27,"div",18),e.DNE(28,bd,13,10)(29,Cd,2,0),e.k0s()()()),2&i&&(e.Y8G("fuseScrollbarOptions",e.lJ4(10,fd)),e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),e.R7$(2),e.Y8G("svgIcon","mat_solid:add"),e.R7$(5),e.vxM(28,n.incomes.length>0?28:29))},dependencies:[p.vh,p.YU,m.RG,m.rl,m.JW,F.NQ,F.B4,I.Ou,I.iy,v.Hl,v.$z,C.m_,C.An,k.fS,k.fg,a.X1,a.me,a.BC,a.l_,g.Wk,H.p],encapsulation:2})}return o})();var kd=d(88903),xd=d(47305),yd=d(78357),Sd=d(7997),Id=d(49098);const Rd=["locationFilter"],Ed=["depotFilter"],$d=["statusFilter"],jd=(o,s)=>s.id,Dd=()=>({wheelPropagation:!1}),wd=o=>({"cursor-progress":o}),Md=()=>["/modules/warehouse/inventory-periods/admin"],ao=(o,s,t)=>({"periods-grid-1":o,"periods-grid-2":s,"periods-grid-3":t}),ze=o=>({hidden:o}),Gd=()=>["abierto","cerrado"],Td=(o,s)=>({"pointer-events-none":o,hidden:s}),Pd=()=>[10,25,50,100],Ad=(o,s)=>({"text-green-700 bg-green-50":o,"text-orange-700 bg-orange-50":s}),Bd=o=>["/modules/warehouse/inventory-periods/ipv",o];function Wd(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-icon",44),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.range.reset())}),e.k0s()}}function Nd(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-form-field",32)(1,"mat-date-range-input",33),e.nrm(2,"input",34)(3,"input",35),e.k0s(),e.nrm(4,"mat-datepicker-toggle",36)(5,"mat-date-range-picker",37,3),e.DNE(7,Wd,1,0,"mat-icon",38),e.k0s(),e.j41(8,"div",39)(9,"button",40),e.nrm(10,"mat-icon",41),e.j41(11,"span",17),e.EFF(12,"Reportes"),e.k0s()(),e.j41(13,"mat-menu",42,4)(15,"button",43),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.getIpvByDateRange())}),e.EFF(16,"Ingreso por ventas (IPVs)"),e.k0s()()()}if(2&o){const t=e.sdS(6),i=e.sdS(14),n=e.XpG();e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("formGroup",n.range)("rangePicker",t)("max",n.maxDate),e.R7$(3),e.Y8G("for",t),e.R7$(3),e.vxM(7,n.range.get("start").value||n.range.get("end").value?7:-1),e.R7$(2),e.Y8G("disabled",!n.range.get("start").value||!n.range.get("end").value||n.range.invalid)("matMenuTriggerFor",i),e.R7$(),e.Y8G("svgIcon","mat_solid:plagiarism")}}function Vd(o,s){if(1&o){const t=e.RV6();e.j41(0,"button",55),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,r=e.XpG(2);return e.Njj(r.viewPeriodReport(n))}),e.nrm(1,"mat-icon",51),e.k0s()}2&o&&(e.R7$(),e.Y8G("svgIcon","mat_solid:plagiarism"))}function Yd(o,s){if(1&o){const t=e.RV6();e.j41(0,"button",55),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,r=e.XpG(2);return e.Njj(r.viewOpenedPeriodReport(n))}),e.nrm(1,"mat-icon",51),e.k0s()}2&o&&(e.R7$(),e.Y8G("svgIcon","mat_solid:plagiarism"))}function zd(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",45)(1,"div",46),e.EFF(2),e.k0s(),e.j41(3,"div",46),e.EFF(4),e.k0s(),e.j41(5,"div",47),e.EFF(6),e.nI1(7,"date"),e.k0s(),e.j41(8,"div",47),e.EFF(9),e.nI1(10,"date"),e.k0s(),e.j41(11,"div",25)(12,"span",48),e.EFF(13),e.k0s()(),e.j41(14,"div",49)(15,"button",50),e.nrm(16,"mat-icon",51),e.k0s(),e.DNE(17,Vd,2,1,"button",52)(18,Yd,2,1,"button",52),e.j41(19,"button",53),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.getIpvByPeriodId(n.id))}),e.nrm(20,"mat-icon",51),e.k0s(),e.j41(21,"button",54),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.openShrinkagesLosesDialog(n))}),e.nrm(22,"mat-icon",51),e.k0s()()()}if(2&o){const t=s.$implicit,i=e.XpG(2);e.Y8G("ngClass",e.sMw(24,ao,1===i.user.accessLevel,2===i.user.accessLevel,3===i.user.accessLevel)),e.R7$(),e.Y8G("ngClass",e.eq3(28,ze,i.user.accessLevel<3)),e.R7$(),e.SpI(" ",t.location.name," "),e.R7$(),e.Y8G("ngClass",e.eq3(30,ze,1===i.user.accessLevel)),e.R7$(),e.SpI(" ",t.depot.name," "),e.R7$(2),e.SpI(" ",e.i5U(7,18,t.open,"dd/MM/yyyy HH:mm a")," "),e.R7$(3),e.SpI(" ",e.i5U(10,21,t.close,"dd/MM/yyyy HH:mm a")," "),e.R7$(3),e.Y8G("ngClass",e.l_i(32,Ad,"open"===t.state,"close"===t.state)),e.R7$(),e.SpI(" ","open"===t.state?"ABIERTO":"CERRADO"," "),e.R7$(2),e.Y8G("routerLink",e.eq3(35,Bd,t.id))("disabled","close"===t.state),e.R7$(),e.Y8G("svgIcon","mat_solid:lock"),e.R7$(),e.vxM(17,"close"===t.state?17:-1),e.R7$(),e.vxM(18,"open"===t.state?18:-1),e.R7$(),e.Y8G("disabled","open"===t.state),e.R7$(),e.Y8G("svgIcon","mat_solid:print"),e.R7$(),e.Y8G("disabled","close"===t.state),e.R7$(),e.Y8G("svgIcon","mat_solid:delete_sweep")}}function Ld(o,s){if(1&o&&e.Z7z(0,zd,23,37,"div",45,jd),2&o){const t=e.XpG();e.Dyx(t.periods)}}function Qd(o,s){1&o&&(e.j41(0,"div",56),e.EFF(1," \xa1No se ha creado ninguna per\xedodo de almac\xe9n! "),e.k0s())}let qd=(()=>{class o{constructor(){this.isLoading=!1,this.merchant=null,this.periods=[],this.user=null,this.searchLocationsControl=new a.MJ(null),this.searchDepotsControl=new a.MJ(null),this.searchInputControl=new a.MJ,this.filterInputControl=new a.MJ,this.selectedLocation=null,this.selectedDepot=null,this.selectedStatus=[],this.maxDate=new Date,this.range=new a.gE({start:new a.MJ({disabled:!1,value:null},[K.t.futureDateValidator()]),end:new a.MJ({disabled:!1,value:null},[K.t.futureDateValidator()])}),this._changeDetectorRef=(0,e.WQX)(e.gRc),this._locationsService=(0,e.WQX)(Id.O),this._depotsService=(0,e.WQX)(ue.t),this._periodsService=(0,e.WQX)(je.w),this._documentsService=(0,e.WQX)(xe.Q),this._unsubscribeAll=new j.B,this._printerService=(0,e.WQX)(Sd.k),this._matDialog=(0,e.WQX)(X.bZ),this._dialog=(0,e.WQX)(X.bZ),this.store=(0,e.WQX)(S.il)}ngOnInit(){this.store.select(re.SW).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(fe.Xb).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(fs).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.periods=t,this._changeDetectorRef.markForCheck()}),this.store.select(se.Dz).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.locationsFiltered=this.searchLocationsControl.valueChanges.pipe((0,f.B)(200),(0,x.Z)(null),(0,U.j)(()=>{this.isLoading=!1}),(0,L.Z)(t=>null!==t&&"string"==typeof t&&(this.selectedLocation&&t!==this.selectedLocation.name||!this.selectedLocation)?(this.isLoading=!0,this._locationsService.findActiveLocations(t.trim())):(0,E.of)())),this.depotsFiltered=this.searchDepotsControl.valueChanges.pipe((0,f.B)(200),(0,x.Z)(null),(0,U.j)(()=>{this.isLoading=!1}),(0,L.Z)(t=>null!==t&&"string"==typeof t&&(this.selectedDepot&&t!==this.selectedDepot.name||!this.selectedDepot)?(this.isLoading=!0,this._depotsService.findActiveDepots(t.trim())):(0,E.of)())),this.filterInputControl.valueChanges.pipe((0,u.Q)(this._unsubscribeAll),(0,f.B)(300),(0,_.n)(t=>(this.isLoading=!0,this._periodsService.findAllPeriods(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.selectedLocation?.id,this.selectedDepot?.id,this.selectedStatus,this.range.get("start").value,this.range.get("end").value))),(0,b.T)(()=>{this.isLoading=!1})).subscribe(),this.range.valueChanges.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this._periodsService.findAllPeriods(0,this.pagination.size,this._sort.active,this._sort.direction,this.searchInputControl.value,this.selectedLocation?.id,this.selectedDepot?.id,this.selectedStatus,t.start,t.end).pipe((0,u.Q)(this._unsubscribeAll)).subscribe()})}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"updatedAt",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,V.h)(this._sort.sortChange,this._paginator.page).pipe((0,_.n)(()=>(this.isLoading=!0,this._periodsService.findAllPeriods(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,""))),(0,b.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this.store.dispatch((0,He.w$)())}resetLocation(){this.selectedLocation=null,this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addLocation(t){this.selectedLocation=t,this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}resetDepot(){this.selectedDepot=null,this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addDepot(t){this.selectedDepot=t,this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addStatus(t){this.selectedStatus=t.map(i=>"abierto"===i?Be.open:Be.close),this.filterInputControl.setValue(""),this._changeDetectorRef.markForCheck()}getIpvByPeriodId(t){this._periodsService.getIpvByPeriodId(t).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(i=>{i&&this._printerService.printIpvTicket(i).pipe((0,u.Q)(this._unsubscribeAll)).subscribe()})}getIpvByDateRange(){const{start:t,end:i}=this.range.getRawValue();!t||!i||(N.H.IsNullOrEmpty(this.selectedDepot)?this._dialog.open(xd.K,{data:{filterProperties:["depot"]},width:"450px",panelClass:"ath-dialog-panel",disableClose:!0}).afterClosed().pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{N.H.IsNullOrEmpty(n.depot)||"cancelled"===n||this._periodsService.getIpvByDateRange(n.depot.id,t,i).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(r=>{this._documentsService.generatePeriodCloseDocument(r,this.merchant,this.user,null,{start:r.openedAt,end:r.closedAT},n.depot)})}):this._periodsService.getIpvByDateRange(this.selectedDepot.id,t,i).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(n=>{this._documentsService.generatePeriodCloseDocument(n,this.merchant,this.user,null,{start:n.openedAt,end:n.closedAT},this.selectedDepot)}))}viewPeriodReport(t){this._periodsService.getIpvByPeriodId(t.id).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(i=>{this._documentsService.generatePeriodCloseDocument(i,this.merchant,this.user,t)})}viewOpenedPeriodReport(t){this._periodsService.getIpvByDepotId(t.depotId).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(i=>{this._documentsService.generatePeriodCloseDocument(i,this.merchant,this.user,t)})}openShrinkagesLosesDialog(t){this._periodsService.findCurrentPeriodByDepotIdWithCurrentStock(t.depotId).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(({data:i})=>{i&&this._matDialog.open(kd.e,{data:{...i.findCurrentPeriodByDepotId.period,id:t.id},panelClass:"ath-dialog-panel",disableClose:!0})})}existTableFilter(){return this.statusFilter?.hasFilter||this.locationFilter?.hasFilter||this.depotFilter?.hasFilter}clearTableFilters(){this.statusFilter?.hasFilter&&this.statusFilter.clearFilter(),this.locationFilter?.hasFilter&&this.locationFilter.clearFilter(),this.depotFilter?.hasFilter&&this.depotFilter.clearFilter()}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["warehouse-period-list"]],viewQuery:function(i,n){if(1&i&&(e.GBs(I.iy,5),e.GBs(F.B4,5),e.GBs(Rd,5),e.GBs(Ed,5),e.GBs($d,5)),2&i){let r;e.mGM(r=e.lsd())&&(n._paginator=r.first),e.mGM(r=e.lsd())&&(n._sort=r.first),e.mGM(r=e.lsd())&&(n.locationFilter=r.first),e.mGM(r=e.lsd())&&(n.depotFilter=r.first),e.mGM(r=e.lsd())&&(n.statusFilter=r.first)}},standalone:!0,features:[e.aNF],decls:56,vars:46,consts:[["locationFilter",""],["depotFilter",""],["statusFilter",""],["picker",""],["reportsMenu","matMenu"],["fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent",3,"fuseScrollbarOptions","ngClass"],[1,"relative","flex","flex-col","px-6","py-8","border-b","lg:flex-row","flex-0","lg:items-center","lg:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","sm:leading-10"],[1,"flex","flex-wrap","items-center","gap-2","mt-6","md:fixed","right-8","shrink-0","lg:mt-0","lg:ml-4"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"routerLink"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto"],[1,"relative","grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900",3,"ngClass"],[1,"flex","items-center","justify-start",3,"ngClass"],[3,"dataChange","filterType","searchEntityControl","entitiesFiltered"],[1,"flex","items-center","justify-center","min-w-40",3,"mat-sort-header"],[1,"flex","items-center","justify-center"],[3,"mat-sort-header"],[3,"dataChange","filterType","data"],[1,"flex","items-center","justify-end","mr-9"],["color","warn","mat-icon-button","","matTooltip","Limpiar filtros",1,"w-6","h-6","min-h-6","min-w-6",3,"click","disabled"],[1,"icon-size-4",3,"svgIcon"],[1,"border-b","first-letter:z-10","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-slate-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"sm:mx-4","min-w-64","fuse-mat-dense","fuse-mat-rounded",3,"subscriptSizing"],[3,"formGroup","rangePicker","max"],["matStartDate","","formControlName","start","placeholder","Fecha de inicio"],["matEndDate","","formControlName","end","placeholder","Fecha final"],["matPrefix","",3,"for"],["disabled","false"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer"],[1,""],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-yellow-500","to-yellow-600",3,"disabled","matMenuTriggerFor"],[3,"svgIcon"],["xPosition","before"],["mat-menu-item","",3,"click"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer",3,"click"],[1,"z-0","grid","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","md:px-8",3,"ngClass"],[1,"text-left",3,"ngClass"],[1,"text-center","min-w-40"],[1,"px-2","py-0.5","rounded-full","text-sm",3,"ngClass"],[1,"flex","flex-row","justify-center","gap-2"],["mat-stroked-button","","routerLinkActive","router-link-active","matTooltip","Cerrar inventario",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink","disabled"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","","matTooltip","Ver reporte de cierre",1,"px-2","leading-6","min-w-10","min-h-7","h-7"],["matTooltip","Imprimir reporte de cierre (ipv)","mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click","disabled"],["matTooltip","Registrar mermas o p\xe9rdidas","mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click","disabled"],["mat-stroked-button","","matTooltip","Ver reporte de cierre",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(i,n){if(1&i){const r=e.RV6();e.j41(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"div")(5,"a",9),e.EFF(6,"Inicio"),e.k0s()(),e.j41(7,"div",10),e.nrm(8,"mat-icon",11),e.j41(9,"a",12),e.EFF(10,"Almac\xe9n"),e.k0s()(),e.j41(11,"div",10),e.nrm(12,"mat-icon",11),e.j41(13,"a",12),e.EFF(14,"Per\xedodos"),e.k0s()()(),e.j41(15,"div",13)(16,"h2",14),e.EFF(17," Registro de cierres de almac\xe9n "),e.k0s()()(),e.j41(18,"div",15),e.DNE(19,Nd,17,9),e.j41(20,"button",16)(21,"span",17),e.EFF(22,"Abrir Inventario"),e.k0s()()()(),e.j41(23,"div",18)(24,"div",19)(25,"div",20)(26,"div",21)(27,"div",22)(28,"span"),e.EFF(29,"Unidad Comercial"),e.k0s(),e.j41(30,"table-filter",23,0),e.bIt("dataChange",function(c){return e.eBV(r),e.Njj(n.addLocation(c))}),e.k0s()(),e.j41(32,"div",22)(33,"span"),e.EFF(34,"Almac\xe9n"),e.k0s(),e.j41(35,"table-filter",23,1),e.bIt("dataChange",function(c){return e.eBV(r),e.Njj(n.addDepot(c))}),e.k0s()(),e.j41(37,"div",24)(38,"span"),e.EFF(39,"Fecha de apertura"),e.k0s()(),e.j41(40,"div",24)(41,"span"),e.EFF(42,"Fecha de Cierre"),e.k0s()(),e.j41(43,"div",25)(44,"span",26),e.EFF(45,"Estado"),e.k0s(),e.j41(46,"table-filter",27,2),e.bIt("dataChange",function(c){return e.eBV(r),e.Njj(n.addStatus(c))}),e.k0s()(),e.j41(48,"div",28)(49,"span"),e.EFF(50,"Acciones"),e.k0s(),e.j41(51,"button",29),e.bIt("click",function(){return e.eBV(r),e.Njj(n.clearTableFilters())}),e.nrm(52,"mat-icon",30),e.k0s()()(),e.DNE(53,Ld,2,0)(54,Qd,2,0),e.nrm(55,"mat-paginator",31),e.k0s()()()()}2&i&&(e.Y8G("fuseScrollbarOptions",e.lJ4(29,Dd))("ngClass",e.eq3(30,wd,n.isLoading)),e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(7),e.vxM(19,n.user.accessLevel>=3?19:-1),e.R7$(),e.Y8G("routerLink",e.lJ4(32,Md)),e.R7$(6),e.Y8G("ngClass",e.sMw(33,ao,1===n.user.accessLevel,2===n.user.accessLevel,3===n.user.accessLevel)),e.R7$(),e.Y8G("ngClass",e.eq3(37,ze,n.user.accessLevel<3)),e.R7$(3),e.Y8G("filterType","filterEntity")("searchEntityControl",n.searchLocationsControl)("entitiesFiltered",n.locationsFiltered),e.R7$(2),e.Y8G("ngClass",e.eq3(39,ze,1===n.user.accessLevel)),e.R7$(3),e.Y8G("filterType","filterEntity")("searchEntityControl",n.searchDepotsControl)("entitiesFiltered",n.depotsFiltered),e.R7$(2),e.Y8G("mat-sort-header","open"),e.R7$(3),e.Y8G("mat-sort-header","close"),e.R7$(4),e.Y8G("mat-sort-header","state"),e.R7$(2),e.Y8G("filterType","multiSelect")("data",e.lJ4(41,Gd)),e.R7$(5),e.Y8G("disabled",!n.existTableFilter()),e.R7$(),e.Y8G("svgIcon","mat_solid:filter_list_off"),e.R7$(),e.vxM(53,n.periods.length>0?53:54),e.R7$(2),e.Y8G("ngClass",e.l_i(42,Td,n.isLoading,n.pagination.length<10&&n.pagination.page<1))("length",n.pagination.length)("pageIndex",n.pagination.page)("pageSize",n.pagination.size)("pageSizeOptions",e.lJ4(45,Pd))("showFirstLastButtons",!0))},dependencies:[p.vh,v.Hl,v.$z,v.iY,m.RG,m.rl,m.JW,m.yw,C.m_,C.An,k.fS,Y.Cn,Y.kk,Y.fb,Y.Cp,I.Ou,I.iy,F.NQ,F.B4,F.aE,M.uc,M.oV,p.YU,a.X1,a.me,a.BC,a.cb,a.j4,a.JD,g.Wk,H.p,yd.i,ie.X6,ie.bU,ie.el,ie.xR,ie.IG,ie.SG],encapsulation:2,changeDetection:0})}return o})(),Xd=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["warehouse-receptions"]],standalone:!0,features:[e.aNF],decls:1,vars:0,template:function(i,n){1&i&&e.nrm(0,"router-outlet")},dependencies:[g.n3],encapsulation:2})}return o})();var ke=d(16551),Od=d(23301),lo=d(63425),Ud=d(47399),Hd=d(79451),_t=d(99437),Jd=d(18810);let Zd=(()=>{class o{constructor(){this._dispatchesService=(0,e.WQX)(Re)}resolve(t,i){return this._dispatchesService.getDispatches()}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),Kd=(()=>{class o{constructor(){this._dispatchesService=(0,e.WQX)(Re),this._router=(0,e.WQX)(g.Ix)}resolve(t,i){const n=t.paramMap.get("dispatchId");if("new"!==n)return this._dispatchesService.findDispatchById(n).pipe((0,_t.W)(r=>{console.error(r);const l=i.url.split("/").slice(0,-1).join("/");return this._router.navigateByUrl(l),(0,Jd.$)(r)}))}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),eu=(()=>{class o{constructor(t){this._incomesService=t}resolve(t,i){return this._incomesService.getIncomes()}static#e=this.\u0275fac=function(i){return new(i||o)(e.KVO(Xe))};static#t=this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),tu=(()=>{class o{constructor(t){this._movementsService=t}resolve(t,i){return this._movementsService.getMovements()}static#e=this.\u0275fac=function(i){return new(i||o)(e.KVO(Ue))};static#t=this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var ou=d(76856);let iu=(()=>{class o{constructor(t){this._periodsService=t}resolve(t,i){return this._periodsService.findAllPeriods()}static#e=this.\u0275fac=function(i){return new(i||o)(e.KVO(je.w))};static#t=this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var vt=d(43801);let su=(()=>{class o{constructor(t){this._receptionsService=t}resolve(t,i){return this._receptionsService.getReceptions()}static#e=this.\u0275fac=function(i){return new(i||o)(e.KVO(ut))};static#t=this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),ru=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["warehouse-periods"]],standalone:!0,features:[e.aNF],decls:1,vars:0,template:function(i,n){1&i&&e.nrm(0,"router-outlet")},dependencies:[g.n3],encapsulation:2})}return o})();var bt=d(90882),au=d(27115),co=d(77540);const lu=(o,s)=>s.id,cu=(o,s)=>({"dark:hover:bg-hover hover:bg-gray-100":o,"bg-primary-50 dark:bg-hover":s}),du=(o,s)=>[o,s],uu=(o,s,t)=>({"bg-green-100":o,"bg-orange-200":s,"bg-red-200":t}),mu=o=>({"height.%":o}),pu=(o,s,t,i,n,r)=>({"bg-green-600 animate-pulse":o,"bg-green-400":s,"bg-orange-600":t,"bg-orange-400":i,"bg-red-600":n,"bg-red-400":r});function hu(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-option",10),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.addDepot(n))}),e.EFF(1),e.k0s()}if(2&o){const t=s.$implicit;e.Y8G("value",t.name),e.R7$(),e.SpI(" ",t.name," ")}}function fu(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-option",10),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.addProduct(n))}),e.EFF(1),e.k0s()}if(2&o){const t=s.$implicit;e.Y8G("value",t.name),e.R7$(),e.SpI(" ",t.name," ")}}function gu(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-icon",11),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.resetAll())}),e.k0s()}}function _u(o,s){1&o&&e.nrm(0,"mat-icon",12),2&o&&e.Y8G("svgIcon","mat_solid:search")}function vu(o,s){if(1&o&&e.nrm(0,"img",21),2&o){const t=e.XpG().$implicit;e.Y8G("ngSrc",t.product.thumbnail)}}function bu(o,s){if(1&o&&(e.j41(0,"div",31),e.EFF(1),e.k0s()),2&o){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.product.name.charAt(0)," ")}}function Cu(o,s){1&o&&e.nrm(0,"div",28)}function Fu(o,s){if(1&o){const t=e.RV6();e.j41(0,"a",19),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.selectStock(n))}),e.j41(1,"div",20),e.DNE(2,vu,1,1,"img",21)(3,bu,2,1),e.k0s(),e.j41(4,"div",22)(5,"div",23),e.EFF(6),e.k0s(),e.j41(7,"div",24),e.EFF(8),e.k0s()(),e.j41(9,"div",25),e.nI1(10,"number"),e.j41(11,"div",26),e.EFF(12),e.nI1(13,"number"),e.k0s(),e.j41(14,"div",27),e.DNE(15,Cu,1,0,"div",28),e.k0s()(),e.j41(16,"div",25),e.nI1(17,"number"),e.j41(18,"div",26),e.EFF(19),e.nI1(20,"number"),e.k0s(),e.j41(21,"div",29),e.nrm(22,"div",30),e.k0s()()()}if(2&o){const t=s.$implicit,i=e.XpG(2);e.Y8G("ngClass",e.l_i(25,cu,!i.selectedStock||i.selectedStock.id!==t.id,i.selectedStock&&i.selectedStock.id===t.id))("routerLink",e.l_i(28,du,"../../"+t.depotId,t.productId)),e.R7$(2),e.vxM(2,null!=t&&null!=t.product&&t.product.thumbnail?2:3),e.R7$(4),e.SpI(" ",t.product.name," "),e.R7$(2),e.SpI(" ",t.depot.name," "),e.R7$(),e.Y8G("matTooltip",(t.remainingPurchasedQuantity%1!=0?e.i5U(10,13,t.remainingPurchasedQuantity,"1.2-2"):t.remainingPurchasedQuantity)+" comprados"),e.R7$(3),e.JRh(t.remainingPurchasedQuantity%1!=0?e.i5U(13,16,t.remainingPurchasedQuantity,"1.2-2"):t.remainingPurchasedQuantity),e.R7$(3),e.vxM(15,t.remainingPurchasedQuantity>0?15:-1),e.R7$(),e.Y8G("matTooltip",(t.quantity%1!=0?e.i5U(17,19,t.quantity,"1.2-2"):t.quantity)+" disponibles"),e.R7$(3),e.JRh(t.quantity%1!=0?e.i5U(20,22,t.quantity,"1.2-2"):t.quantity),e.R7$(2),e.Y8G("ngClass",e.sMw(31,uu,t.quantity>=t.remainingPurchasedQuantity,t.quantity/t.remainingPurchasedQuantity*100>=50&&t.quantity/t.remainingPurchasedQuantity*100<99,t.quantity/t.remainingPurchasedQuantity*100>=0&&t.quantity/t.remainingPurchasedQuantity*100<50)),e.R7$(),e.Y8G("ngStyle",e.eq3(35,mu,t.quantity>t.remainingPurchasedQuantity?100:t.quantity/t.remainingPurchasedQuantity*100))("ngClass",e.l4e(37,pu,t.quantity>t.remainingPurchasedQuantity,t.quantity/t.remainingPurchasedQuantity*100>=99,t.quantity/t.remainingPurchasedQuantity*100>=50&&t.quantity/t.remainingPurchasedQuantity*100<=70,t.quantity/t.remainingPurchasedQuantity*100>70&&t.quantity/t.remainingPurchasedQuantity*100<99,t.quantity/t.remainingPurchasedQuantity*100>=0&&t.quantity/t.remainingPurchasedQuantity*100<=20,t.quantity/t.remainingPurchasedQuantity*100>20&&t.quantity/t.remainingPurchasedQuantity*100<50))}}function ku(o,s){if(1&o&&(e.j41(0,"div")(1,"div",13)(2,"span",14),e.EFF(3,"Producto/Almac\xe9n"),e.k0s(),e.nrm(4,"mat-icon",15)(5,"mat-icon",16),e.k0s(),e.j41(6,"div",17),e.Z7z(7,Fu,23,44,"a",18,lu),e.k0s()()),2&o){const t=e.XpG();e.R7$(4),e.Y8G("svgIcon","mat_solid:arrow_upward"),e.R7$(),e.Y8G("svgIcon","mat_solid:arrow_downward"),e.R7$(2),e.Dyx(t.stocks)}}function xu(o,s){1&o&&(e.j41(0,"div",32),e.nrm(1,"mat-icon",33),e.j41(2,"div",34),e.EFF(3," No hay stock "),e.k0s()()),2&o&&(e.R7$(),e.Y8G("svgIcon","mat_solid:inventory_2"))}let yu=(()=>{class o{constructor(){this.stocks=[],this.isLoading=!1,this.selectedStock=null,this.selectedDepot=null,this.selectedProduct=null,this.searchInputControl=new a.MJ(null),this.searchDepotsControl=new a.MJ(null),this.searchProductsControl=new a.MJ(null),this.depotId=e.hFB.required(),this.productId=e.hFB.required(),this._changeDetectorRef=(0,e.WQX)(e.gRc),this._stocksService=(0,e.WQX)(pe.t),this._depotsService=(0,e.WQX)(ue.t),this.store=(0,e.WQX)(S.il),this._unsubscribeAll=new j.B}ngOnInit(){(N.H.IsNullOrEmpty(this.depotId())||N.H.IsNullOrEmpty(this.productId()))&&this._stocksService.findStocksForSideNav(0,10,null,null).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(),this.store.select(so).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.stocks=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,u.Q)(this._unsubscribeAll),(0,f.B)(300),(0,x.Z)(null),(0,_.n)(t=>null!==t?(this.isLoading=!0,this._stocksService.findStocksForSideNav(0,10,this.selectedDepot?this.selectedDepot.id:null,this.selectedProduct?this.selectedProduct.id:null,!1)):(0,E.of)()),(0,b.T)(()=>{this.isLoading=!1})).subscribe(),this.depotsFiltered=this.searchDepotsControl.valueChanges.pipe((0,f.B)(200),(0,x.Z)(null),(0,U.j)(()=>{this.isLoading=!1}),(0,L.Z)(t=>null!==t&&"string"==typeof t&&(this.selectedDepot&&t!==this.selectedDepot.name||!this.selectedDepot)?(this.isLoading=!0,this._depotsService.findActiveDepots(t.trim())):(0,E.of)())),this.productsFiltered=this.searchProductsControl.valueChanges.pipe((0,f.B)(200),(0,x.Z)(null),(0,U.j)(()=>{this.isLoading=!1}),(0,L.Z)(t=>{if(null!==t&&"string"==typeof t&&(this.selectedProduct&&t!==this.selectedProduct.name||!this.selectedProduct)){this.isLoading=!0;const i=this.selectedDepot?this.selectedDepot.id:null;return this._stocksService.findStockProducts(t.trim(),10,i,!0)}return(0,E.of)()})),this.store.select(se.Dz).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}addDepot(t){this.selectedDepot=t,this.selectedProduct=null,this.searchProductsControl.setValue(""),this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}addProduct(t){this.selectedProduct=t,this.searchInputControl.setValue(""),this._changeDetectorRef.markForCheck()}resetAll(){this.selectedDepot=null,this.selectedProduct=null,this.searchInputControl.setValue(""),this.searchDepotsControl.setValue(""),this.searchProductsControl.setValue(""),this._changeDetectorRef.markForCheck()}selectStock(t){this.selectedStock=this.selectedStock&&this.selectedStock?.id==t.id?null:t,this.store.dispatch((0,ge.hX)({stock:this.selectedStock})),this._changeDetectorRef.markForCheck()}onScrollDown(){(this.pagination.page+1)*this.pagination.size<this.pagination.length&&this._stocksService.findStocksForSideNav(this.pagination.page+1,this.pagination.size,this.selectedDepot?.id,this.selectedProduct?.id,!0).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(),console.log("onScrollDown")}onScrollUp(){console.log("onScrollUp")}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["sub-stocks-sidebar"]],inputs:{depotId:[e.Mj6.SignalBased,"depotId"],productId:[e.Mj6.SignalBased,"productId"]},standalone:!0,features:[e.aNF],decls:21,vars:18,consts:[["depotsDepotsAutocomplete","matAutocomplete"],["depotsProductsAutocomplete","matAutocomplete"],["infiniteScroll","",1,"bg-card","h-full","overflow-auto","relative","flex","w-full","min-w-0","flex-auto","flex-col","dark:bg-transparent","lg:min-w-100","lg:max-w-100",3,"scrolled","scrolledUp","infiniteScrollDistance","infiniteScrollUpDistance","scrollWindow","infiniteScrollThrottle"],[1,"flex","flex-wrap","flex-row","sm:flex-col","border-b","bg-gray-50","sm:px-4","py-4","dark:bg-transparent"],[1,"flex","justify-around","gap-3","items-center"],["appearance","fill",1,"fuse-mat-rounded","fuse-mat-dense","w-full",3,"subscriptSizing"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[1,"ath-autocomplete"],[3,"value"],["svgIcon","mat_solid:cancel",1,"cursor-pointer"],[3,"click","value"],["svgIcon","mat_solid:cancel",1,"cursor-pointer",3,"click"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],[1,"sticky","h-5","top-0","z-30","grid","sidebar-stock-grid","items-center","text-sm","text-secondary","px-5","border-b","bg-gray-50","dark:bg-card"],[1,"col-span-2"],["matTooltip","Cantidad de productos comprados",1,"icon-size-3","justify-self-center",3,"svgIcon"],["matTooltip","Cantidad de productos en inventario",1,"icon-size-3","justify-self-center",3,"svgIcon"],[1,"flex-auto","overflow-y-auto"],[1,"z-20","cursor-pointer","grid","sidebar-stock-grid","border-b","py-5","px-2","sm:px-4",3,"ngClass","routerLink"],[1,"z-20","cursor-pointer","grid","sidebar-stock-grid","border-b","py-5","px-2","sm:px-4",3,"click","ngClass","routerLink"],[1,"relative","flex","h-10","w-10","flex-0","items-center","justify-center"],["width","40","height","40","alt","Product Image",1,"h-full","w-full","rounded-sm","object-cover",3,"ngSrc"],[1,"mx-3.5","min-w-0"],[1,"truncate","font-medium","leading-5"],[1,"text-secondary","truncate","leading-5"],[1,"flex","justify-self-center","text-sm",3,"matTooltip"],[1,"min-w-4"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-green-100","rounded"],[1,"flex","w-full","h-full","bg-green-400"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","rounded",3,"ngClass"],[1,"flex","w-full","bg-orange-400",3,"ngStyle","ngClass"],[1,"flex","h-full","w-full","items-center","justify-center","rounded-sm","bg-gray-200","text-lg","uppercase","text-gray-600","dark:bg-gray-700","dark:text-gray-200"],[1,"flex","h-full","flex-auto","flex-col","items-center","justify-center"],[1,"icon-size-24",3,"svgIcon"],[1,"text-secondary","mt-4","text-2xl","font-semibold","tracking-tight"]],template:function(i,n){if(1&i){const r=e.RV6();e.j41(0,"div",2),e.bIt("scrolled",function(){return e.eBV(r),e.Njj(n.onScrollDown())})("scrolledUp",function(){return e.eBV(r),e.Njj(n.onScrollUp())}),e.j41(1,"div",3)(2,"div",4)(3,"mat-form-field",5),e.nrm(4,"input",6),e.j41(5,"mat-autocomplete",7,0),e.Z7z(7,hu,2,2,"mat-option",8,e.fX1),e.nI1(9,"async"),e.k0s()(),e.j41(10,"mat-form-field",5),e.nrm(11,"input",6),e.j41(12,"mat-autocomplete",7,1),e.Z7z(14,fu,2,2,"mat-option",8,e.fX1),e.nI1(16,"async"),e.k0s()(),e.DNE(17,gu,1,0,"mat-icon",9)(18,_u,1,1),e.k0s()(),e.DNE(19,ku,9,2,"div")(20,xu,4,1),e.k0s()}if(2&i){const r=e.sdS(6),l=e.sdS(13);e.Y8G("infiniteScrollDistance",2)("infiniteScrollUpDistance",2)("scrollWindow",!1)("infiniteScrollThrottle",150),e.R7$(3),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("formControl",n.searchDepotsControl)("matAutocomplete",r)("placeholder","Buscar Almac\xe9n"),e.R7$(3),e.Dyx(e.bMT(9,14,n.depotsFiltered)),e.R7$(3),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("formControl",n.searchProductsControl)("matAutocomplete",l)("placeholder","Buscar Producto"),e.R7$(3),e.Dyx(e.bMT(16,16,n.productsFiltered)),e.R7$(3),e.vxM(17,n.selectedProduct||n.selectedDepot?17:18),e.R7$(2),e.vxM(19,n.stocks&&n.stocks.length>0?19:20)}},dependencies:[p.Jj,v.Hl,C.m_,C.An,M.uc,M.oV,k.fg,m.RG,m.rl,m.JW,p.kt,g.Wk,p.YU,p.QX,D.jL,D.$3,oe.wT,D.pN,k.fS,a.X1,a.me,a.BC,a.l_,p.B3,co.eO,co.DP],styles:["sub-stocks-sidebar .sidebar-stock-grid{grid-template-columns:40px auto 60px 60px}\n"],encapsulation:2})}return o})();const Su=(o,s,t)=>({"bg-green-100":o,"bg-orange-200":s,"bg-red-200":t}),Iu=o=>({"height.%":o}),Ru=(o,s,t,i,n,r)=>({"bg-green-600 animate-pulse":o,"bg-green-400":s,"bg-orange-600":t,"bg-orange-400":i,"bg-red-600":n,"bg-red-400":r});function Eu(o,s){if(1&o&&(e.j41(0,"div",14),e.nrm(1,"mat-icon",15),e.j41(2,"a",16),e.EFF(3),e.k0s()()),2&o){let t;const i=e.XpG();e.R7$(),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(2),e.JRh(null==(t=i.selectedStock())||null==t.depot?null:t.depot.name)}}function $u(o,s){if(1&o&&e.nrm(0,"img",19),2&o){const t=e.XpG();e.Y8G("ngSrc",t.selectedStock().product.thumbnail)}}function ju(o,s){if(1&o&&(e.j41(0,"div",24)(1,"span"),e.EFF(2),e.k0s()()),2&o){let t;const i=e.XpG();e.R7$(2),e.JRh(null==(t=i.selectedStock())||null==t.product||null==t.product.name?null:t.product.name.charAt(0))}}function Du(o,s){if(1&o&&(e.j41(0,"div",27),e.nI1(1,"number"),e.j41(2,"div",28),e.EFF(3),e.nI1(4,"number"),e.k0s(),e.j41(5,"div",29),e.nrm(6,"div",30),e.k0s()(),e.j41(7,"div",27),e.nI1(8,"number"),e.j41(9,"div",28),e.EFF(10),e.nI1(11,"number"),e.k0s(),e.j41(12,"div",31),e.nrm(13,"div",32),e.k0s()()),2&o){const t=e.XpG(2);e.Y8G("matTooltip",(t.selectedStock().remainingPurchasedQuantity%1!=0?e.i5U(1,7,t.selectedStock().remainingPurchasedQuantity,"1.2-2"):t.selectedStock().remainingPurchasedQuantity)+" comprados"),e.R7$(3),e.JRh(t.selectedStock().remainingPurchasedQuantity%1!=0?e.i5U(4,10,t.selectedStock().remainingPurchasedQuantity,"1.2-2"):t.selectedStock().remainingPurchasedQuantity),e.R7$(4),e.Y8G("matTooltip",(t.selectedStock().quantity%1!=0?e.i5U(8,13,t.selectedStock().quantity,"1.2-2"):t.selectedStock().quantity)+" disponibles"),e.R7$(3),e.JRh(t.selectedStock().quantity%1!=0?e.i5U(11,16,t.selectedStock().quantity,"1.2-2"):t.selectedStock().quantity),e.R7$(2),e.Y8G("ngClass",e.sMw(19,Su,t.selectedStock().quantity>=t.selectedStock().remainingPurchasedQuantity,t.selectedStock().quantity/t.selectedStock().remainingPurchasedQuantity*100>=50&&t.selectedStock().quantity/t.selectedStock().remainingPurchasedQuantity*100<99,t.selectedStock().quantity/t.selectedStock().remainingPurchasedQuantity*100>=0&&t.selectedStock().quantity/t.selectedStock().remainingPurchasedQuantity*100<50)),e.R7$(),e.Y8G("ngStyle",e.eq3(23,Iu,t.selectedStock().quantity>t.selectedStock().remainingPurchasedQuantity?100:t.selectedStock().quantity/t.selectedStock().remainingPurchasedQuantity*100))("ngClass",e.l4e(25,Ru,t.selectedStock().quantity>t.selectedStock().remainingPurchasedQuantity,t.selectedStock().quantity/t.selectedStock().remainingPurchasedQuantity*100>=99,t.selectedStock().quantity/t.selectedStock().remainingPurchasedQuantity*100>=50&&t.selectedStock().quantity/t.selectedStock().remainingPurchasedQuantity*100<=70,t.selectedStock().quantity/t.selectedStock().remainingPurchasedQuantity*100>70&&t.selectedStock().quantity/t.selectedStock().remainingPurchasedQuantity*100<99,t.selectedStock().quantity/t.selectedStock().remainingPurchasedQuantity*100>=0&&t.selectedStock().quantity/t.selectedStock().remainingPurchasedQuantity*100<=20,t.selectedStock().quantity/t.selectedStock().remainingPurchasedQuantity*100>20&&t.selectedStock().quantity/t.selectedStock().remainingPurchasedQuantity*100<50))}}function wu(o,s){if(1&o&&(e.j41(0,"div",25),e.DNE(1,Du,14,32),e.k0s(),e.j41(2,"h2",26),e.EFF(3),e.k0s()),2&o){const t=e.XpG();e.R7$(),e.vxM(1,t.selectedStock().remainingPurchasedQuantity>0?1:-1),e.R7$(2),e.SpI(" ",t.selectedStock().product.name," ")}}let Mu=(()=>{class o{constructor(){this.selectedStock=(0,e.vPA)(null),this.searchInputControl=new a.MJ(null),this.depotId=e.hFB.required(),this.productId=e.hFB.required(),this.drawerMode=(0,e.vPA)("side"),this.drawerOpened=(0,e.vPA)(!1),this._stocksService=(0,e.WQX)(pe.t),this._fuseMediaWatcherService=(0,e.WQX)(au.F),this.store=(0,e.WQX)(S.il),this._unsubscribeAll=new j.B}ngOnInit(){this._fuseMediaWatcherService.onMediaChange$.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(({matchingAliases:t})=>{let i;t.includes("md")?this.drawerMode.set("side"):(this.drawerMode.set("over"),i=!1),i=!(!N.H.IsNullOrEmpty(this.depotId())&&!N.H.IsNullOrEmpty(this.productId())),this.drawerOpened.set(i)}),this.store.select(bc).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.selectedStock.set(t)}),this.searchInputControl.valueChanges.pipe((0,u.Q)(this._unsubscribeAll),(0,f.B)(300),(0,x.Z)(null),(0,_.n)(t=>null!==t?this._stocksService.findSubStocks(0,10,"createdAt","desc",t,this.depotId(),this.productId(),!1,!0):(0,E.of)())).subscribe()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}toggleMenu(){this.drawerOpened.set(!this.drawerOpened())}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["sub-stocks"]],inputs:{depotId:[e.Mj6.SignalBased,"depotId"],productId:[e.Mj6.SignalBased,"productId"]},standalone:!0,features:[e.aNF],decls:35,vars:15,consts:[["drawer",""],[1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-hidden"],[1,"h-full","flex-auto"],[1,"md:w-100","dark:bg-gray-900",3,"mode","opened"],[1,"h-full",3,"depotId","productId"],[1,"flex","h-full","flex-col","overflow-hidden"],[1,"flex","flex-col","overflow-hidden"],[1,"relative","flex","items-center","w-full","h-24","px-4","flex-0","md:px-6","z-49","border-b","bg-card","dark:bg-transparent","print:hidden"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"relative","w-full","flex","px-6","py-8","flex-row","flex-0","md:items-center","justify-between","md:px-8"],[1,"flex-1","min-w-64"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],["routerLink","../../",1,"ml-1","text-primary-500"],[1,"mt-2","flex","gap-3","h-10"],["width","40","height","40","alt","Product Image",1,"h-full","w-full","rounded-sm","object-cover",3,"ngSrc"],[1,"flex","flex-wrap","items-center","mt-2","sm:mt-0","shrink-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64","mr-4",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"flex","h-full","min-w-10","w-full","items-center","justify-center","rounded-sm","bg-gray-200","text-lg","uppercase","text-gray-600","dark:bg-gray-700","dark:text-gray-200"],[1,"flex","flex-col","justify-between","items-center","ml-1"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","justify-self-center","text-sm",3,"matTooltip"],[1,"min-w-4"],[1,"flex","items-end","w-1","h-4","ml-1","overflow-hidden","bg-green-100","rounded"],[1,"flex","w-full","h-full","bg-green-400"],[1,"flex","items-end","w-1","h-4","ml-1","overflow-hidden","rounded",3,"ngClass"],[1,"flex","w-full","bg-orange-400",3,"ngStyle","ngClass"]],template:function(i,n){if(1&i){const r=e.RV6();e.j41(0,"div",1)(1,"mat-drawer-container",2)(2,"mat-drawer",3,0),e.nrm(4,"sub-stocks-sidebar",4),e.k0s(),e.j41(5,"mat-drawer-content",5)(6,"div",6)(7,"div",7)(8,"button",8),e.bIt("click",function(){return e.eBV(r),e.Njj(n.toggleMenu())}),e.nrm(9,"mat-icon",9),e.k0s(),e.j41(10,"div",10)(11,"div",11)(12,"div",12)(13,"div")(14,"a",13),e.EFF(15,"Inicio"),e.k0s()(),e.j41(16,"div",14),e.nrm(17,"mat-icon",15),e.j41(18,"a",16),e.EFF(19,"Almac\xe9n"),e.k0s()(),e.j41(20,"div",14),e.nrm(21,"mat-icon",15),e.j41(22,"a",17),e.EFF(23,"Inventario"),e.k0s()(),e.DNE(24,Eu,4,2,"div",14),e.k0s(),e.j41(25,"div",18)(26,"div"),e.DNE(27,$u,1,1,"img",19)(28,ju,3,1),e.k0s(),e.DNE(29,wu,4,2),e.k0s()(),e.j41(30,"div",20)(31,"mat-form-field",21),e.nrm(32,"mat-icon",22)(33,"input",23),e.k0s()()()(),e.nrm(34,"router-outlet"),e.k0s()()()()}if(2&i){let r;e.R7$(2),e.Y8G("mode",n.drawerMode())("opened",n.drawerOpened()),e.R7$(2),e.Y8G("depotId",n.depotId())("productId",n.productId()),e.R7$(5),e.Y8G("svgIcon","mat_solid:menu"),e.R7$(8),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(4),e.Y8G("svgIcon","mat_solid:chevron_right"),e.R7$(3),e.vxM(24,n.selectedStock()?24:-1),e.R7$(3),e.vxM(27,n.selectedStock()&&null!=(r=n.selectedStock())&&null!=r.product&&r.product.thumbnail?27:28),e.R7$(2),e.vxM(29,n.selectedStock()?29:-1),e.R7$(2),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","mat_solid:search"),e.R7$(),e.Y8G("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Buscar por # de compra")}},dependencies:[yu,v.Hl,v.iY,C.m_,C.An,M.uc,M.oV,p.YU,g.n3,bt.$C,bt.qe,bt.$l,m.RG,m.rl,m.JW,D.jL,a.X1,a.me,a.BC,a.l_,g.Wk,k.fg,p.kt,p.QX,p.B3],encapsulation:2})}return o})();const Gu=(o,s)=>s.id,Tu=()=>({wheelPropagation:!1}),Pu=(o,s)=>({"pointer-events-none":o,hidden:s}),Au=()=>[10,25,50,100],Bu=(o,s,t)=>({"bg-green-100":o,"bg-orange-200":s,"bg-red-200":t}),Wu=o=>({"height.%":o}),Nu=(o,s,t,i,n,r)=>({"bg-green-600 animate-pulse":o,"bg-green-400":s,"bg-orange-600":t,"bg-orange-400":i,"bg-red-600":n,"bg-red-400":r});function Vu(o,s){1&o&&e.nrm(0,"div",14)}function Yu(o,s){if(1&o&&(e.j41(0,"div",8)(1,"div",9),e.EFF(2),e.k0s(),e.j41(3,"div",10),e.EFF(4),e.nI1(5,"date"),e.k0s(),e.j41(6,"div",11),e.nI1(7,"number"),e.j41(8,"div",12),e.EFF(9),e.nI1(10,"number"),e.k0s(),e.j41(11,"div",13),e.DNE(12,Vu,1,0,"div",14),e.k0s()(),e.j41(13,"div",11),e.nI1(14,"number"),e.j41(15,"div",12),e.EFF(16),e.nI1(17,"number"),e.k0s(),e.j41(18,"div",15),e.nrm(19,"div",16),e.k0s()()()),2&o){const t=s.$implicit;e.R7$(2),e.SpI(" ",t.purchase.voucherNo," "),e.R7$(2),e.SpI(" ",e.i5U(5,10,t.purchase.voucherDate,"dd/MM/yyyy HH:mm")," "),e.R7$(2),e.Y8G("matTooltip",(t.purchasedQuantity%1!=0?e.i5U(7,13,t.purchasedQuantity,"1.2-2"):t.purchasedQuantity)+" comprados"),e.R7$(3),e.JRh(t.purchasedQuantity%1!=0?e.i5U(10,16,t.purchasedQuantity,"1.2-2"):t.purchasedQuantity),e.R7$(3),e.vxM(12,t.purchasedQuantity>0?12:-1),e.R7$(),e.Y8G("matTooltip",(t.quantity%1!=0?e.i5U(14,19,t.quantity,"1.2-2"):t.quantity)+" disponibles"),e.R7$(3),e.JRh(t.quantity%1!=0?e.i5U(17,22,t.quantity,"1.2-2"):t.quantity),e.R7$(2),e.Y8G("ngClass",e.sMw(25,Bu,t.quantity>=t.purchasedQuantity,t.quantity/t.purchasedQuantity*100>=50&&t.quantity/t.purchasedQuantity*100<99,t.quantity/t.purchasedQuantity*100>=0&&t.quantity/t.purchasedQuantity*100<50)),e.R7$(),e.Y8G("ngStyle",e.eq3(29,Wu,t.quantity>t.purchasedQuantity?100:t.quantity/t.purchasedQuantity*100))("ngClass",e.l4e(31,Nu,t.quantity>t.purchasedQuantity,t.quantity/t.purchasedQuantity*100>=99,t.quantity/t.purchasedQuantity*100>=50&&t.quantity/t.purchasedQuantity*100<=70,t.quantity/t.purchasedQuantity*100>70&&t.quantity/t.purchasedQuantity*100<99,t.quantity/t.purchasedQuantity*100>=0&&t.quantity/t.purchasedQuantity*100<=20,t.quantity/t.purchasedQuantity*100>20&&t.quantity/t.purchasedQuantity*100<50))}}function zu(o,s){if(1&o&&e.Z7z(0,Yu,20,38,"div",8,Gu),2&o){const t=e.XpG();e.Dyx(t.purchaseStocks)}}function Lu(o,s){}let Qu=(()=>{class o{constructor(){this.purchaseStocks=[],this.isLoading=!1,this.depotId=e.hFB.required(),this.productId=e.hFB.required(),this._stocksService=(0,e.WQX)(pe.t),this.store=(0,e.WQX)(S.il),this._changeDetectorRef=(0,e.WQX)(e.gRc),this._unsubscribeAll=new j.B}ngOnInit(){this.store.select(se.Lx).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.store.select(ft).pipe((0,u.Q)(this._unsubscribeAll)).subscribe(t=>{this.purchaseStocks=t,this._changeDetectorRef.markForCheck()})}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"updatedAt",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,V.h)(this._sort.sortChange,this._paginator.page).pipe((0,_.n)(()=>(this.isLoading=!0,this._stocksService.findSubStocks(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,"",this.depotId(),this.productId(),!1,!0))),(0,b.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["sub-stocks-list"]],viewQuery:function(i,n){if(1&i&&(e.GBs(I.iy,5),e.GBs(F.B4,5)),2&i){let r;e.mGM(r=e.lsd())&&(n._paginator=r.first),e.mGM(r=e.lsd())&&(n._sort=r.first)}},inputs:{depotId:[e.Mj6.SignalBased,"depotId"],productId:[e.Mj6.SignalBased,"productId"]},standalone:!0,features:[e.aNF],decls:19,vars:17,consts:[["fuseScrollbar","",1,"flex","flex-col","flex-auto","min-w-0","bg-card","dark:bg-transparent",3,"fuseScrollbarOptions"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto"],[1,"relative","grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","grid-cols-4","gap-4","px-6","py-4","font-semibold","shadow","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[3,"mat-sort-header"],[1,"flex","justify-center","items-center",3,"mat-sort-header"],[1,"border-b","first-letter:z-10","sm:inset-x-0","sm:sticky","sm:bottom-0","sm:border-t","sm:border-b-0","text-swamp-200","bg-gray-50","dark:bg-slate-900",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"z-0","grid","grid-cols-4","items-center","gap-4","px-6","py-3","bg-white","border-b","dark:bg-default","md:px-8"],[1,"truncate"],[1,"text-center"],[1,"flex","justify-self-center","text-sm",3,"matTooltip"],[1,"min-w-4"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-green-100","rounded"],[1,"flex","w-full","h-full","bg-green-400"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","rounded",3,"ngClass"],[1,"flex","w-full","bg-orange-400",3,"ngStyle","ngClass"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e.EFF(6,"N\xfamero de Compra"),e.k0s(),e.j41(7,"div",6)(8,"span"),e.EFF(9,"Fecha"),e.k0s()(),e.j41(10,"div",6)(11,"span"),e.EFF(12,"Comprado"),e.k0s()(),e.j41(13,"div",6)(14,"span"),e.EFF(15,"Disponible"),e.k0s()()(),e.DNE(16,zu,2,0)(17,Lu,0,0),e.nrm(18,"mat-paginator",7),e.k0s()()()()),2&i&&(e.Y8G("fuseScrollbarOptions",e.lJ4(12,Tu)),e.R7$(5),e.Y8G("mat-sort-header","purchase.voucherNo"),e.R7$(2),e.Y8G("mat-sort-header","purchase.voucherDat"),e.R7$(3),e.Y8G("mat-sort-header","purchasedQuantity"),e.R7$(3),e.Y8G("mat-sort-header","quantity"),e.R7$(3),e.vxM(16,n.purchaseStocks.length>0?16:17),e.R7$(2),e.Y8G("ngClass",e.l_i(13,Pu,n.isLoading,n.pagination.length<10&&n.pagination.page<1))("length",n.pagination.length)("pageIndex",n.pagination.page)("pageSize",n.pagination.size)("pageSizeOptions",e.lJ4(16,Au))("showFirstLastButtons",!0))},dependencies:[v.Hl,C.m_,Y.Cn,oe.pZ,me.g7,p.YU,m.RG,k.fS,p.QX,p.vh,H.p,p.B3,M.oV,I.Ou,I.iy,F.NQ,F.B4,F.aE],encapsulation:2})}return o})();var Ou=d(34413);const Uu=[{path:"",component:W,resolve:{},children:[{path:"depots",component:Bo,resolve:{depots:ke.ug,employees:Ou.MI}},{path:"incomes",component:dn,children:[{path:"",component:Fd,resolve:{incomes:eu}},{path:"form",component:cn,resolve:{products:vt.Bj,depots:ke.oi}}]},{path:"inventory-periods",component:ru,children:[{path:"",component:qd,resolve:{periods:iu}},{path:"admin",component:hs,resolve:{depots:ke.nn}},{path:"ipv/:periodId",component:Fs,resolve:{ipv:(o,s)=>{const t=o.params.periodId;return t?(0,e.WQX)(je.w).findIpvByPeriodId(t):null}}}]},{path:"movements",component:es,resolve:{movements:tu}},{path:"stocks",component:pd,resolve:{stocks:(o,s)=>{const t=(0,e.WQX)(g.Ix);return(0,e.WQX)(pe.t).getStocks().pipe((0,_t.W)(i=>t.navigateByUrl("/desktop")))}}},{path:"stocks/:depotId/:productId",component:Mu,children:[{path:"",component:Qu,resolve:{purchaseStocks:(o,s)=>{const t=(0,e.WQX)(g.Ix),i=o.params.depotId,n=o.params.productId;return(0,e.WQX)(pe.t).findSubStocks(0,10,"createdAt","desc","",i,n,!1,!0).pipe((0,_t.W)(r=>t.navigateByUrl("/desktop")))}}}]},{path:"products",component:Sa,children:[{path:"",component:Ha,resolve:{products:vt.Bj}},{path:"product/:productId",component:ya,resolve:{brands:Ud.T,categories:Hd.V7,uoms:lo.B,depots:ke.MQ,product:vt.eX,currency:Od.I}},{path:"from-template",component:En,resolve:{depots:ke.MQ,uoms:lo.B}}]},{path:"receptions",component:_c,children:[{path:"new",component:sc,resolve:{purchases:ou.O0,depots:ke.MQ}},{path:"list",component:gc,resolve:{receptions:su}}]},{path:"dispatches",component:Xd,children:[{path:"",component:Li,resolve:{dispatches:Zd}},{path:"form",component:Di,data:{permissions:{only:["Administrador","Super Administrador","despachos-create"]}},resolve:{depots:ke.Jq}},{path:"confirm/:dispatchId",component:hi,resolve:{dispatch:Kd}}]}]}]}}]);